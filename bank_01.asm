org $018000

;===================================================================================================

DrawObjects:

.type1_subtype_1_data_offset
#_018000: dw $03D8 ; 0000
#_018002: dw $02E8 ; 0001
#_018004: dw $02F8 ; 0002
#_018006: dw $0328 ; 0003
#_018008: dw $0338 ; 0004
#_01800A: dw $0400 ; 0005
#_01800C: dw $0410 ; 0006
#_01800E: dw $0388 ; 0007
#_018010: dw $0390 ; 0008
#_018012: dw $0420 ; 0009
#_018014: dw $042A ; 000A
#_018016: dw $0434 ; 000B
#_018018: dw $043E ; 000C
#_01801A: dw $0448 ; 000D
#_01801C: dw $0452 ; 000E
#_01801E: dw $045C ; 000F
#_018020: dw $0466 ; 0010
#_018022: dw $0470 ; 0011
#_018024: dw $047A ; 0012
#_018026: dw $0484 ; 0013
#_018028: dw $048E ; 0014
#_01802A: dw $0498 ; 0015
#_01802C: dw $04A2 ; 0016
#_01802E: dw $04AC ; 0017
#_018030: dw $04B6 ; 0018
#_018032: dw $04C0 ; 0019
#_018034: dw $04CA ; 001A
#_018036: dw $04D4 ; 001B
#_018038: dw $04DE ; 001C
#_01803A: dw $04E8 ; 001D
#_01803C: dw $04F2 ; 001E
#_01803E: dw $04FC ; 001F
#_018040: dw $0506 ; 0020
#_018042: dw $0598 ; 0021
#_018044: dw $0600 ; 0022
#_018046: dw $063C ; 0023
#_018048: dw $063C ; 0024
#_01804A: dw $063C ; 0025
#_01804C: dw $063C ; 0026
#_01804E: dw $063C ; 0027
#_018050: dw $0642 ; 0028
#_018052: dw $064C ; 0029
#_018054: dw $0652 ; 002A
#_018056: dw $0658 ; 002B
#_018058: dw $065E ; 002C
#_01805A: dw $0664 ; 002D
#_01805C: dw $066A ; 002E
#_01805E: dw $0688 ; 002F
#_018060: dw $0694 ; 0030
#_018062: dw $06A8 ; 0031
#_018064: dw $06A8 ; 0032
#_018066: dw $06A8 ; 0033
#_018068: dw $06C8 ; 0034
#_01806A: dw $0000 ; 0035
#_01806C: dw $078A ; 0036
#_01806E: dw $07AA ; 0037
#_018070: dw $0E26 ; 0038
#_018072: dw $084A ; 0039
#_018074: dw $086A ; 003A
#_018076: dw $0882 ; 003B
#_018078: dw $08CA ; 003C
#_01807A: dw $085A ; 003D
#_01807C: dw $08FA ; 003E
#_01807E: dw $091A ; 003F
#_018080: dw $0920 ; 0040
#_018082: dw $092A ; 0041
#_018084: dw $0930 ; 0042
#_018086: dw $0936 ; 0043
#_018088: dw $093C ; 0044
#_01808A: dw $0942 ; 0045
#_01808C: dw $0948 ; 0046
#_01808E: dw $094E ; 0047
#_018090: dw $096C ; 0048
#_018092: dw $097E ; 0049
#_018094: dw $098E ; 004A
#_018096: dw $0902 ; 004B
#_018098: dw $099E ; 004C
#_01809A: dw $09D8 ; 004D
#_01809C: dw $09D8 ; 004E
#_01809E: dw $09D8 ; 004F
#_0180A0: dw $09FA ; 0050
#_0180A2: dw $156C ; 0051
#_0180A4: dw $1590 ; 0052
#_0180A6: dw $1D86 ; 0053
#_0180A8: dw $0000 ; 0054
#_0180AA: dw $0A14 ; 0055
#_0180AC: dw $0A24 ; 0056
#_0180AE: dw $0A54 ; 0057
#_0180B0: dw $0A54 ; 0058
#_0180B2: dw $0A84 ; 0059
#_0180B4: dw $0A84 ; 005A
#_0180B6: dw $14DC ; 005B
#_0180B8: dw $1500 ; 005C
#_0180BA: dw $061E ; 005D
#_0180BC: dw $0E52 ; 005E
#_0180BE: dw $0600 ; 005F
#_0180C0: dw $03D8 ; 0060
#_0180C2: dw $02C8 ; 0061
#_0180C4: dw $02D8 ; 0062
#_0180C6: dw $0308 ; 0063
#_0180C8: dw $0318 ; 0064
#_0180CA: dw $03E0 ; 0065
#_0180CC: dw $03F0 ; 0066
#_0180CE: dw $0378 ; 0067
#_0180D0: dw $0380 ; 0068
#_0180D2: dw $05FA ; 0069
#_0180D4: dw $0648 ; 006A
#_0180D6: dw $064A ; 006B
#_0180D8: dw $0670 ; 006C
#_0180DA: dw $067C ; 006D
#_0180DC: dw $06A8 ; 006E
#_0180DE: dw $06A8 ; 006F
#_0180E0: dw $06A8 ; 0070
#_0180E2: dw $06C8 ; 0071
#_0180E4: dw $0000 ; 0072
#_0180E6: dw $07AA ; 0073
#_0180E8: dw $07CA ; 0074
#_0180EA: dw $084A ; 0075
#_0180EC: dw $089A ; 0076
#_0180EE: dw $08B2 ; 0077
#_0180F0: dw $090A ; 0078
#_0180F2: dw $0926 ; 0079
#_0180F4: dw $0928 ; 007A
#_0180F6: dw $0912 ; 007B
#_0180F8: dw $09F8 ; 007C
#_0180FA: dw $1D7E ; 007D
#_0180FC: dw $0000 ; 007E
#_0180FE: dw $0A34 ; 007F
#_018100: dw $0A44 ; 0080
#_018102: dw $0A54 ; 0081
#_018104: dw $0A6C ; 0082
#_018106: dw $0A84 ; 0083
#_018108: dw $0A9C ; 0084
#_01810A: dw $1524 ; 0085
#_01810C: dw $1548 ; 0086
#_01810E: dw $085A ; 0087
#_018110: dw $0606 ; 0088
#_018112: dw $0E52 ; 0089
#_018114: dw $05FA ; 008A
#_018116: dw $06A0 ; 008B
#_018118: dw $06A2 ; 008C
#_01811A: dw $0B12 ; 008D
#_01811C: dw $0B14 ; 008E
#_01811E: dw $09B0 ; 008F
#_018120: dw $0B46 ; 0090
#_018122: dw $0B56 ; 0091
#_018124: dw $1F52 ; 0092
#_018126: dw $1F5A ; 0093
#_018128: dw $0288 ; 0094
#_01812A: dw $0E82 ; 0095
#_01812C: dw $1DF2 ; 0096
#_01812E: dw $0000 ; 0097
#_018130: dw $0000 ; 0098
#_018132: dw $0000 ; 0099
#_018134: dw $0000 ; 009A
#_018136: dw $0000 ; 009B
#_018138: dw $0000 ; 009C
#_01813A: dw $0000 ; 009D
#_01813C: dw $0000 ; 009E
#_01813E: dw $0000 ; 009F
#_018140: dw $03D8 ; 00A0
#_018142: dw $03D8 ; 00A1
#_018144: dw $03D8 ; 00A2
#_018146: dw $03D8 ; 00A3
#_018148: dw $05AA ; 00A4
#_01814A: dw $05B2 ; 00A5
#_01814C: dw $05B2 ; 00A6
#_01814E: dw $05B2 ; 00A7
#_018150: dw $05B2 ; 00A8
#_018152: dw $00E0 ; 00A9
#_018154: dw $00E0 ; 00AA
#_018156: dw $00E0 ; 00AB
#_018158: dw $00E0 ; 00AC
#_01815A: dw $0110 ; 00AD
#_01815C: dw $0000 ; 00AE
#_01815E: dw $0000 ; 00AF
#_018160: dw $06A4 ; 00B0
#_018162: dw $06A6 ; 00B1
#_018164: dw $0AE6 ; 00B2
#_018166: dw $0B06 ; 00B3
#_018168: dw $0B0C ; 00B4
#_01816A: dw $0B16 ; 00B5
#_01816C: dw $0B26 ; 00B6
#_01816E: dw $0B36 ; 00B7
#_018170: dw $1F52 ; 00B8
#_018172: dw $1F5A ; 00B9
#_018174: dw $0288 ; 00BA
#_018176: dw $0EBA ; 00BB
#_018178: dw $0E82 ; 00BC
#_01817A: dw $1DF2 ; 00BD
#_01817C: dw $0000 ; 00BE
#_01817E: dw $0000 ; 00BF
#_018180: dw $03D8 ; 00C0
#_018182: dw $0510 ; 00C1
#_018184: dw $05AA ; 00C2
#_018186: dw $05AA ; 00C3
#_018188: dw $0000 ; 00C4
#_01818A: dw $0168 ; 00C5
#_01818C: dw $00E0 ; 00C6
#_01818E: dw $0158 ; 00C7
#_018190: dw $0100 ; 00C8
#_018192: dw $0110 ; 00C9
#_018194: dw $0178 ; 00CA
#_018196: dw $072A ; 00CB
#_018198: dw $072A ; 00CC
#_01819A: dw $072A ; 00CD
#_01819C: dw $075A ; 00CE
#_01819E: dw $0670 ; 00CF
#_0181A0: dw $0670 ; 00D0
#_0181A2: dw $0130 ; 00D1
#_0181A4: dw $0148 ; 00D2
#_0181A6: dw $072A ; 00D3
#_0181A8: dw $072A ; 00D4
#_0181AA: dw $072A ; 00D5
#_0181AC: dw $075A ; 00D6
#_0181AE: dw $00E0 ; 00D7
#_0181B0: dw $0110 ; 00D8
#_0181B2: dw $00F0 ; 00D9
#_0181B4: dw $0110 ; 00DA
#_0181B6: dw $0000 ; 00DB
#_0181B8: dw $0AB4 ; 00DC
#_0181BA: dw $08DA ; 00DD
#_0181BC: dw $0ADE ; 00DE
#_0181BE: dw $0188 ; 00DF
#_0181C0: dw $01A0 ; 00E0
#_0181C2: dw $01B0 ; 00E1
#_0181C4: dw $01C0 ; 00E2
#_0181C6: dw $01D0 ; 00E3
#_0181C8: dw $01E0 ; 00E4
#_0181CA: dw $01F0 ; 00E5
#_0181CC: dw $0200 ; 00E6
#_0181CE: dw $0120 ; 00E7
#_0181D0: dw $02A8 ; 00E8
#_0181D2: dw $0000 ; 00E9
#_0181D4: dw $0000 ; 00EA
#_0181D6: dw $0000 ; 00EB
#_0181D8: dw $0000 ; 00EC
#_0181DA: dw $0000 ; 00ED
#_0181DC: dw $0000 ; 00EE
#_0181DE: dw $0000 ; 00EF
#_0181E0: dw $0000 ; 00F0
#_0181E2: dw $0000 ; 00F1
#_0181E4: dw $0000 ; 00F2
#_0181E6: dw $0000 ; 00F3
#_0181E8: dw $0000 ; 00F4
#_0181EA: dw $0000 ; 00F5
#_0181EC: dw $0000 ; 00F6
#_0181EE: dw $0000 ; 00F7
#_0181F0: dw $0000 ; 00F8
#_0181F2: dw $0000 ; 00F9
#_0181F4: dw $0000 ; 00FA
#_0181F6: dw $0000 ; 00FB
#_0181F8: dw $0000 ; 00FC
#_0181FA: dw $0000 ; 00FD
#_0181FC: dw $0000 ; 00FE
#_0181FE: dw $0000 ; 00FF

;---------------------------------------------------------------------------------------------------

.type1_subtype_1_routine
#_018200: dw RoomDraw_Rightwards2x2_1to15or32                            ; 0000
#_018202: dw RoomDraw_Rightwards2x4_1to15or26                            ; 0001
#_018204: dw RoomDraw_Rightwards2x4_1to15or26                            ; 0002
#_018206: dw RoomDraw_Object_Rightwards2x4spaced4_1to16                  ; 0003
#_018208: dw RoomDraw_Object_Rightwards2x4spaced4_1to16                  ; 0004
#_01820A: dw RoomDraw_Rightwards2x2_1to16_BothBG                         ; 0005
#_01820C: dw RoomDraw_Rightwards2x2_1to16_BothBG                         ; 0006
#_01820E: dw RoomDraw_Rightwards2x2_1to16                                ; 0007
#_018210: dw RoomDraw_Rightwards2x2_1to16                                ; 0008
#_018212: dw RoomDraw_DiagonalAcute_1to16                                ; 0009
#_018214: dw RoomDraw_DiagonalGrave_1to16                                ; 000A
#_018216: dw RoomDraw_DiagonalGrave_1to16                                ; 000B
#_018218: dw RoomDraw_DiagonalAcute_1to16                                ; 000C
#_01821A: dw RoomDraw_DiagonalAcute_1to16                                ; 000D
#_01821C: dw RoomDraw_DiagonalGrave_1to16                                ; 000E
#_01821E: dw RoomDraw_DiagonalGrave_1to16                                ; 000F
#_018220: dw RoomDraw_DiagonalAcute_1to16                                ; 0010
#_018222: dw RoomDraw_DiagonalAcute_1to16                                ; 0011
#_018224: dw RoomDraw_DiagonalGrave_1to16                                ; 0012
#_018226: dw RoomDraw_DiagonalGrave_1to16                                ; 0013
#_018228: dw RoomDraw_DiagonalAcute_1to16                                ; 0014
#_01822A: dw RoomDraw_DiagonalAcute_1to16_BothBG                         ; 0015
#_01822C: dw RoomDraw_DiagonalGrave_1to16_BothBG                         ; 0016
#_01822E: dw RoomDraw_DiagonalGrave_1to16_BothBG                         ; 0017
#_018230: dw RoomDraw_DiagonalAcute_1to16_BothBG                         ; 0018
#_018232: dw RoomDraw_DiagonalAcute_1to16_BothBG                         ; 0019
#_018234: dw RoomDraw_DiagonalGrave_1to16_BothBG                         ; 001A
#_018236: dw RoomDraw_DiagonalGrave_1to16_BothBG                         ; 001B
#_018238: dw RoomDraw_DiagonalAcute_1to16_BothBG                         ; 001C
#_01823A: dw RoomDraw_DiagonalAcute_1to16_BothBG                         ; 001D
#_01823C: dw RoomDraw_DiagonalGrave_1to16_BothBG                         ; 001E
#_01823E: dw RoomDraw_DiagonalGrave_1to16_BothBG                         ; 001F
#_018240: dw RoomDraw_DiagonalAcute_1to16_BothBG                         ; 0020
#_018242: dw RoomDraw_Rightwards1x2_1to16_plus2                          ; 0021
#_018244: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus3                   ; 0022
#_018246: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus2                   ; 0023
#_018248: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus2                   ; 0024
#_01824A: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus2                   ; 0025
#_01824C: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus2                   ; 0026
#_01824E: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus2                   ; 0027
#_018250: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus2                   ; 0028
#_018252: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus2                   ; 0029
#_018254: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus2                   ; 002A
#_018256: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus2                   ; 002B
#_018258: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus2                   ; 002C
#_01825A: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus2                   ; 002D
#_01825C: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus2                   ; 002E
#_01825E: dw RoomDraw_RightwardsTopCorners1x2_1to16_plus13               ; 002F
#_018260: dw RoomDraw_RightwardsBottomCorners1x2_1to16_plus13            ; 0030
#_018262: dw RoomDraw_Nothing_A                                          ; 0031
#_018264: dw RoomDraw_Nothing_A                                          ; 0032
#_018266: dw RoomDraw_Rightwards4x4_1to16                                ; 0033
#_018268: dw RoomDraw_Rightwards1x1Solid_1to16_plus3                     ; 0034
#_01826A: dw RoomDraw_DoorSwitcherer                                     ; 0035
#_01826C: dw RoomDraw_RightwardsDecor4x4spaced2_1to16                    ; 0036
#_01826E: dw RoomDraw_RightwardsDecor4x4spaced2_1to16                    ; 0037
#_018270: dw RoomDraw_RightwardsStatue2x3spaced2_1to16                   ; 0038
#_018272: dw RoomDraw_RightwardsPillar2x4spaced4_1to16                   ; 0039
#_018274: dw RoomDraw_RightwardsDecor4x3spaced4_1to16                    ; 003A
#_018276: dw RoomDraw_RightwardsDecor4x3spaced4_1to16                    ; 003B
#_018278: dw RoomDraw_RightwardsDoubled2x2spaced2_1to16                  ; 003C
#_01827A: dw RoomDraw_RightwardsPillar2x4spaced4_1to16                   ; 003D
#_01827C: dw RoomDraw_RightwardsDecor2x2spaced12_1to16                   ; 003E
#_01827E: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus2                   ; 003F
#_018280: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus2                   ; 0040
#_018282: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus2                   ; 0041
#_018284: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus2                   ; 0042
#_018286: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus2                   ; 0043
#_018288: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus2                   ; 0044
#_01828A: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus2                   ; 0045
#_01828C: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus2                   ; 0046
#_01828E: dw RoomDraw_Waterfall47                                        ; 0047
#_018290: dw RoomDraw_Waterfall48                                        ; 0048
#_018292: dw RoomDraw_RightwardsFloorTile4x2_1to16                       ; 0049
#_018294: dw RoomDraw_RightwardsFloorTile4x2_1to16                       ; 004A
#_018296: dw RoomDraw_RightwardsDecor2x2spaced12_1to16                   ; 004B
#_018298: dw RoomDraw_RightwardsBar4x3_1to16                             ; 004C
#_01829A: dw RoomDraw_RightwardsShelf4x4_1to16                           ; 004D
#_01829C: dw RoomDraw_RightwardsShelf4x4_1to16                           ; 004E
#_01829E: dw RoomDraw_RightwardsShelf4x4_1to16                           ; 004F
#_0182A0: dw RoomDraw_RightwardsLine1x1_1to16plus1                       ; 0050
#_0182A2: dw RoomDraw_RightwardsCannonHole4x3_1to16                      ; 0051
#_0182A4: dw RoomDraw_RightwardsCannonHole4x3_1to16                      ; 0052
#_0182A6: dw RoomDraw_Rightwards2x2_1to16                                ; 0053
#_0182A8: dw RoomDraw_Nothing_B                                          ; 0054
#_0182AA: dw RoomDraw_RightwardsDecor4x2spaced8_1to16                    ; 0055
#_0182AC: dw RoomDraw_RightwardsDecor4x2spaced8_1to16                    ; 0056
#_0182AE: dw RoomDraw_Nothing_C                                          ; 0057
#_0182B0: dw RoomDraw_Nothing_C                                          ; 0058
#_0182B2: dw RoomDraw_Nothing_C                                          ; 0059
#_0182B4: dw RoomDraw_Nothing_C                                          ; 005A
#_0182B6: dw RoomDraw_RightwardsCannonHole4x3_1to16                      ; 005B
#_0182B8: dw RoomDraw_RightwardsCannonHole4x3_1to16                      ; 005C
#_0182BA: dw RoomDraw_RightwardsBigRail1x3_1to16plus5                    ; 005D
#_0182BC: dw RoomDraw_RightwardsBlock2x2spaced2_1to16                    ; 005E
#_0182BE: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus23                  ; 005F
#_0182C0: dw RoomDraw_Downwards2x2_1to15or32                             ; 0060
#_0182C2: dw RoomDraw_Downwards4x2_1to15or26                             ; 0061
#_0182C4: dw RoomDraw_Downwards4x2_1to15or26                             ; 0062
#_0182C6: dw RoomDraw_Downwards4x2_1to16_BothBG                          ; 0063
#_0182C8: dw RoomDraw_Downwards4x2_1to16_BothBG                          ; 0064
#_0182CA: dw RoomDraw_DownwardsDecor4x2spaced4_1to16                     ; 0065
#_0182CC: dw RoomDraw_DownwardsDecor4x2spaced4_1to16                     ; 0066
#_0182CE: dw RoomDraw_Downwards2x2_1to16                                 ; 0067
#_0182D0: dw RoomDraw_Downwards2x2_1to16                                 ; 0068
#_0182D2: dw RoomDraw_DownwardsHasEdge1x1_1to16_plus3                    ; 0069
#_0182D4: dw RoomDraw_DownwardsEdge1x1_1to16                             ; 006A
#_0182D6: dw RoomDraw_DownwardsEdge1x1_1to16                             ; 006B
#_0182D8: dw RoomDraw_DownwardsLeftCorners2x1_1to16_plus12               ; 006C
#_0182DA: dw RoomDraw_DownwardsRightCorners2x1_1to16_plus12              ; 006D
#_0182DC: dw RoomDraw_Nothing_A                                          ; 006E
#_0182DE: dw RoomDraw_Nothing_A                                          ; 006F
#_0182E0: dw RoomDraw_DownwardsFloor4x4_1to16                            ; 0070
#_0182E2: dw RoomDraw_Downwards1x1Solid_1to16_plus3                      ; 0071
#_0182E4: dw RoomDraw_Nothing_B                                          ; 0072
#_0182E6: dw RoomDraw_DownwardsDecor4x4spaced2_1to16                     ; 0073
#_0182E8: dw RoomDraw_DownwardsDecor4x4spaced2_1to16                     ; 0074
#_0182EA: dw RoomDraw_DownwardsPillar2x4spaced2_1to16                    ; 0075
#_0182EC: dw RoomDraw_DownwardsDecor4x4spaced4_1to16                     ; 0076
#_0182EE: dw RoomDraw_DownwardsDecor4x4spaced4_1to16                     ; 0077
#_0182F0: dw RoomDraw_DownwardsDecor2x2spaced12_1to16                    ; 0078
#_0182F2: dw RoomDraw_DownwardsEdge1x1_1to16                             ; 0079
#_0182F4: dw RoomDraw_DownwardsEdge1x1_1to16                             ; 007A
#_0182F6: dw RoomDraw_DownwardsDecor2x2spaced12_1to16                    ; 007B
#_0182F8: dw RoomDraw_DownwardsLine1x1_1to16plus1                        ; 007C
#_0182FA: dw RoomDraw_Downwards2x2_1to16                                 ; 007D
#_0182FC: dw RoomDraw_Nothing_B                                          ; 007E
#_0182FE: dw RoomDraw_DownwardsDecor2x4spaced8_1to16                     ; 007F
#_018300: dw RoomDraw_DownwardsDecor2x4spaced8_1to16                     ; 0080
#_018302: dw RoomDraw_DownwardsDecor2x4spaced2_1to16                     ; 0081
#_018304: dw RoomDraw_DownwardsDecor2x4spaced2_1to16                     ; 0082
#_018306: dw RoomDraw_DownwardsDecor2x4spaced2_1to16                     ; 0083
#_018308: dw RoomDraw_DownwardsDecor2x4spaced2_1to16                     ; 0084
#_01830A: dw RoomDraw_DownwardsCannonHole3x4_1to16                       ; 0085
#_01830C: dw RoomDraw_DownwardsCannonHole3x4_1to16                       ; 0086
#_01830E: dw RoomDraw_DownwardsPillar2x4spaced2_1to16                    ; 0087
#_018310: dw RoomDraw_DownwardsBigRail3x1_1to16plus5                     ; 0088
#_018312: dw RoomDraw_DownwardsBlock2x2spaced2_1to16                     ; 0089
#_018314: dw RoomDraw_DownwardsHasEdge1x1_1to16_plus23                   ; 008A
#_018316: dw RoomDraw_DownwardsEdge1x1_1to16plus7                        ; 008B
#_018318: dw RoomDraw_DownwardsEdge1x1_1to16plus7                        ; 008C
#_01831A: dw RoomDraw_DownwardsEdge1x1_1to16                             ; 008D
#_01831C: dw RoomDraw_DownwardsEdge1x1_1to16                             ; 008E
#_01831E: dw RoomDraw_DownwardsBar2x5_1to16                              ; 008F
#_018320: dw RoomDraw_Downwards4x2_1to15or26                             ; 0090
#_018322: dw RoomDraw_Downwards4x2_1to15or26                             ; 0091
#_018324: dw RoomDraw_Downwards2x2_1to15or32                             ; 0092
#_018326: dw RoomDraw_Downwards2x2_1to15or32                             ; 0093
#_018328: dw RoomDraw_DownwardsFloor4x4_1to16                            ; 0094
#_01832A: dw RoomDraw_DownwardsFakePots2x2_1to16                         ; 0095
#_01832C: dw RoomDraw_DownwardsHammerPegs2x2_1to16                       ; 0096
#_01832E: dw RoomDraw_Nothing_B                                          ; 0097
#_018330: dw RoomDraw_Nothing_B                                          ; 0098
#_018332: dw RoomDraw_Nothing_B                                          ; 0099
#_018334: dw RoomDraw_Nothing_B                                          ; 009A
#_018336: dw RoomDraw_Nothing_B                                          ; 009B
#_018338: dw RoomDraw_Nothing_B                                          ; 009C
#_01833A: dw RoomDraw_Nothing_B                                          ; 009D
#_01833C: dw RoomDraw_Nothing_B                                          ; 009E
#_01833E: dw RoomDraw_Nothing_B                                          ; 009F
#_018340: dw RoomDraw_DiagonalCeilingTopLeftA                            ; 00A0
#_018342: dw RoomDraw_DiagonalCeilingBottomLeftA                         ; 00A1
#_018344: dw RoomDraw_DiagonalCeilingTopRightA                           ; 00A2
#_018346: dw RoomDraw_DiagonalCeilingBottomRightA                        ; 00A3
#_018348: dw RoomDraw_BigHole4x4_1to16                                   ; 00A4
#_01834A: dw RoomDraw_DiagonalCeilingTopLeftB                            ; 00A5
#_01834C: dw RoomDraw_DiagonalCeilingBottomLeftB                         ; 00A6
#_01834E: dw RoomDraw_DiagonalCeilingTopRightB                           ; 00A7
#_018350: dw RoomDraw_DiagonalCeilingBottomRightB                        ; 00A8
#_018352: dw RoomDraw_DiagonalCeilingTopLeftB                            ; 00A9
#_018354: dw RoomDraw_DiagonalCeilingBottomLeftB                         ; 00AA
#_018356: dw RoomDraw_DiagonalCeilingTopRightB                           ; 00AB
#_018358: dw RoomDraw_DiagonalCeilingBottomRightB                        ; 00AC
#_01835A: dw RoomDraw_Nothing_B                                          ; 00AD
#_01835C: dw RoomDraw_Nothing_B                                          ; 00AE
#_01835E: dw RoomDraw_Nothing_B                                          ; 00AF
#_018360: dw RoomDraw_RightwardsEdge1x1_1to16plus7                       ; 00B0
#_018362: dw RoomDraw_RightwardsEdge1x1_1to16plus7                       ; 00B1
#_018364: dw RoomDraw_Rightwards4x4_1to16                                ; 00B2
#_018366: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus2                   ; 00B3
#_018368: dw RoomDraw_RightwardsHasEdge1x1_1to16_plus2                   ; 00B4
#_01836A: dw RoomDraw_Weird2x4_1_to_16                                   ; 00B5
#_01836C: dw RoomDraw_Rightwards2x4_1to15or26                            ; 00B6
#_01836E: dw RoomDraw_Rightwards2x4_1to15or26                            ; 00B7
#_018370: dw RoomDraw_Rightwards2x2_1to15or32                            ; 00B8
#_018372: dw RoomDraw_Rightwards2x2_1to15or32                            ; 00B9
#_018374: dw RoomDraw_Rightwards4x4_1to16                                ; 00BA
#_018376: dw RoomDraw_RightwardsBlock2x2spaced2_1to16                    ; 00BB
#_018378: dw RoomDraw_RightwardsFakePots2x2_1to16                        ; 00BC
#_01837A: dw RoomDraw_RightwardsHammerPegs2x2_1to16                      ; 00BD
#_01837C: dw RoomDraw_Nothing_B                                          ; 00BE
#_01837E: dw RoomDraw_Nothing_B                                          ; 00BF
#_018380: dw RoomDraw_4x4BlocksIn4x4SuperSquare                          ; 00C0
#_018382: dw RoomDraw_ClosedChestPlatform                                ; 00C1
#_018384: dw RoomDraw_4x4BlocksIn4x4SuperSquare                          ; 00C2
#_018386: dw RoomDraw_3x3FloorIn4x4SuperSquare                           ; 00C3
#_018388: dw RoomDraw_4x4FloorOneIn4x4SuperSquare                        ; 00C4
#_01838A: dw RoomDraw_4x4FloorIn4x4SuperSquare                           ; 00C5
#_01838C: dw RoomDraw_4x4FloorIn4x4SuperSquare                           ; 00C6
#_01838E: dw RoomDraw_4x4FloorIn4x4SuperSquare                           ; 00C7
#_018390: dw RoomDraw_4x4FloorIn4x4SuperSquare                           ; 00C8
#_018392: dw RoomDraw_4x4FloorIn4x4SuperSquare                           ; 00C9
#_018394: dw RoomDraw_4x4FloorIn4x4SuperSquare                           ; 00CA
#_018396: dw RoomDraw_Nothing_E                                          ; 00CB
#_018398: dw RoomDraw_Nothing_E                                          ; 00CC
#_01839A: dw RoomDraw_MovingWallWest                                     ; 00CD
#_01839C: dw RoomDraw_MovingWallEast                                     ; 00CE
#_01839E: dw RoomDraw_Nothing_D                                          ; 00CF
#_0183A0: dw RoomDraw_Nothing_D                                          ; 00D0
#_0183A2: dw RoomDraw_4x4FloorIn4x4SuperSquare                           ; 00D1
#_0183A4: dw RoomDraw_4x4FloorIn4x4SuperSquare                           ; 00D2
#_0183A6: dw RoomDraw_CheckIfWallIsMoved                                 ; 00D3
#_0183A8: dw RoomDraw_CheckIfWallIsMoved                                 ; 00D4
#_0183AA: dw RoomDraw_CheckIfWallIsMoved                                 ; 00D5
#_0183AC: dw RoomDraw_CheckIfWallIsMoved                                 ; 00D6
#_0183AE: dw RoomDraw_3x3FloorIn4x4SuperSquare                           ; 00D7
#_0183B0: dw RoomDraw_WaterOverlayA8x8_1to16                             ; 00D8
#_0183B2: dw RoomDraw_4x4FloorIn4x4SuperSquare                           ; 00D9
#_0183B4: dw RoomDraw_WaterOverlayB8x8_1to16                             ; 00DA
#_0183B6: dw RoomDraw_4x4FloorTwoIn4x4SuperSquare                        ; 00DB
#_0183B8: dw RoomDraw_OpenChestPlatform                                  ; 00DC
#_0183BA: dw RoomDraw_TableRock4x4_1to16                                 ; 00DD
#_0183BC: dw RoomDraw_Spike2x2In4x4SuperSquare                           ; 00DE
#_0183BE: dw RoomDraw_4x4FloorIn4x4SuperSquare                           ; 00DF
#_0183C0: dw RoomDraw_4x4FloorIn4x4SuperSquare                           ; 00E0
#_0183C2: dw RoomDraw_4x4FloorIn4x4SuperSquare                           ; 00E1
#_0183C4: dw RoomDraw_4x4FloorIn4x4SuperSquare                           ; 00E2
#_0183C6: dw RoomDraw_4x4FloorIn4x4SuperSquare                           ; 00E3
#_0183C8: dw RoomDraw_4x4FloorIn4x4SuperSquare                           ; 00E4
#_0183CA: dw RoomDraw_4x4FloorIn4x4SuperSquare                           ; 00E5
#_0183CC: dw RoomDraw_4x4FloorIn4x4SuperSquare                           ; 00E6
#_0183CE: dw RoomDraw_4x4FloorIn4x4SuperSquare                           ; 00E7
#_0183D0: dw RoomDraw_4x4FloorIn4x4SuperSquare                           ; 00E8
#_0183D2: dw RoomDraw_Nothing_B                                          ; 00E9
#_0183D4: dw RoomDraw_Nothing_B                                          ; 00EA
#_0183D6: dw RoomDraw_Nothing_B                                          ; 00EB
#_0183D8: dw RoomDraw_Nothing_B                                          ; 00EC
#_0183DA: dw RoomDraw_Nothing_B                                          ; 00ED
#_0183DC: dw RoomDraw_Nothing_B                                          ; 00EE
#_0183DE: dw RoomDraw_Nothing_B                                          ; 00EF
#_0183E0: dw RoomDraw_Nothing_B                                          ; 00F0
#_0183E2: dw RoomDraw_Nothing_B                                          ; 00F1
#_0183E4: dw RoomDraw_Nothing_B                                          ; 00F2
#_0183E6: dw RoomDraw_Nothing_B                                          ; 00F3
#_0183E8: dw RoomDraw_Nothing_B                                          ; 00F4
#_0183EA: dw RoomDraw_Nothing_B                                          ; 00F5
#_0183EC: dw RoomDraw_Nothing_B                                          ; 00F6
#_0183EE: dw RoomDraw_Nothing_B                                          ; 00F7

;===================================================================================================

.type1_subtype_2_data_offset
#_0183F0: dw $0B66 ; 0100
#_0183F2: dw $0B86 ; 0101
#_0183F4: dw $0BA6 ; 0102
#_0183F6: dw $0BC6 ; 0103
#_0183F8: dw $0C66 ; 0104
#_0183FA: dw $0C86 ; 0105
#_0183FC: dw $0CA6 ; 0106
#_0183FE: dw $0CC6 ; 0107
#_018400: dw $0BE6 ; 0108
#_018402: dw $0C06 ; 0109
#_018404: dw $0C26 ; 010A
#_018406: dw $0C46 ; 010B
#_018408: dw $0CE6 ; 010C
#_01840A: dw $0D06 ; 010D
#_01840C: dw $0D26 ; 010E
#_01840E: dw $0D46 ; 010F
#_018410: dw $0D66 ; 0110
#_018412: dw $0D7E ; 0111
#_018414: dw $0D96 ; 0112
#_018416: dw $0DAE ; 0113
#_018418: dw $0DC6 ; 0114
#_01841A: dw $0DDE ; 0115
#_01841C: dw $0DF6 ; 0116
#_01841E: dw $0E0E ; 0117
#_018420: dw $0398 ; 0118
#_018422: dw $03A0 ; 0119
#_018424: dw $03A8 ; 011A
#_018426: dw $03B0 ; 011B
#_018428: dw $0E32 ; 011C
#_01842A: dw $0E26 ; 011D
#_01842C: dw $0EA2 ; 011E
#_01842E: dw $0E9A ; 011F
#_018430: dw $0ECA ; 0120
#_018432: dw $0ED2 ; 0121
#_018434: dw $0EDE ; 0122
#_018436: dw $0EDE ; 0123
#_018438: dw $0F1E ; 0124
#_01843A: dw $0F3E ; 0125
#_01843C: dw $0F5E ; 0126
#_01843E: dw $0F6A ; 0127
#_018440: dw $0EF6 ; 0128
#_018442: dw $0F72 ; 0129
#_018444: dw $0F92 ; 012A
#_018446: dw $0FA2 ; 012B
#_018448: dw $0FA2 ; 012C
#_01844A: dw $1088 ; 012D
#_01844C: dw $10A8 ; 012E
#_01844E: dw $10A8 ; 012F
#_018450: dw $10C8 ; 0130
#_018452: dw $10C8 ; 0131
#_018454: dw $10C8 ; 0132
#_018456: dw $10C8 ; 0133
#_018458: dw $0E52 ; 0134
#_01845A: dw $1108 ; 0135
#_01845C: dw $1108 ; 0136
#_01845E: dw $12A8 ; 0137
#_018460: dw $1148 ; 0138
#_018462: dw $1160 ; 0139
#_018464: dw $1178 ; 013A
#_018466: dw $1190 ; 013B
#_018468: dw $1458 ; 013C
#_01846A: dw $1488 ; 013D
#_01846C: dw $2062 ; 013E
#_01846E: dw $2086 ; 013F

;---------------------------------------------------------------------------------------------------

.type1_subtype_2_routine
#_018470: dw RoomDraw_4x4Object                                          ; 0100
#_018472: dw RoomDraw_4x4Object                                          ; 0101
#_018474: dw RoomDraw_4x4Object                                          ; 0102
#_018476: dw RoomDraw_4x4Object                                          ; 0103
#_018478: dw RoomDraw_4x4Object                                          ; 0104
#_01847A: dw RoomDraw_4x4Object                                          ; 0105
#_01847C: dw RoomDraw_4x4Object                                          ; 0106
#_01847E: dw RoomDraw_4x4Object                                          ; 0107
#_018480: dw RoomDraw_4x4Corner_BothBG                                   ; 0108
#_018482: dw RoomDraw_4x4Corner_BothBG                                   ; 0109
#_018484: dw RoomDraw_4x4Corner_BothBG                                   ; 010A
#_018486: dw RoomDraw_4x4Corner_BothBG                                   ; 010B
#_018488: dw RoomDraw_4x4Corner_BothBG                                   ; 010C
#_01848A: dw RoomDraw_4x4Corner_BothBG                                   ; 010D
#_01848C: dw RoomDraw_4x4Corner_BothBG                                   ; 010E
#_01848E: dw RoomDraw_4x4Corner_BothBG                                   ; 010F
#_018490: dw RoomDraw_WeirdCornerBottom_BothBG                           ; 0110
#_018492: dw RoomDraw_WeirdCornerBottom_BothBG                           ; 0111
#_018494: dw RoomDraw_WeirdCornerBottom_BothBG                           ; 0112
#_018496: dw RoomDraw_WeirdCornerBottom_BothBG                           ; 0113
#_018498: dw RoomDraw_WeirdCornerTop_BothBG                              ; 0114
#_01849A: dw RoomDraw_WeirdCornerTop_BothBG                              ; 0115
#_01849C: dw RoomDraw_WeirdCornerTop_BothBG                              ; 0116
#_01849E: dw RoomDraw_WeirdCornerTop_BothBG                              ; 0117
#_0184A0: dw RoomDraw_Object_2x2_rightwards                              ; 0118
#_0184A2: dw RoomDraw_Object_2x2_rightwards                              ; 0119
#_0184A4: dw RoomDraw_Object_2x2_rightwards                              ; 011A
#_0184A6: dw RoomDraw_Object_2x2_rightwards                              ; 011B
#_0184A8: dw RoomDraw_4x4Object                                          ; 011C
#_0184AA: dw RoomDraw_Single2x3Pillar                                    ; 011D
#_0184AC: dw RoomDraw_Single2x2                                          ; 011E
#_0184AE: dw RoomDraw_EnabledStarSwitch                                  ; 011F
#_0184B0: dw RoomDraw_LitTorch                                           ; 0120
#_0184B2: dw RoomDraw_Single2x3Pillar                                    ; 0121
#_0184B4: dw RoomDraw_Bed2x5                                             ; 0122
#_0184B6: dw RoomDraw_TableRock2x3                                       ; 0123
#_0184B8: dw RoomDraw_4x4Object                                          ; 0124
#_0184BA: dw RoomDraw_4x4Object                                          ; 0125
#_0184BC: dw RoomDraw_Single2x3Pillar                                    ; 0126
#_0184BE: dw RoomDraw_Object_2x2_rightwards                              ; 0127
#_0184C0: dw RoomDraw_Bed2x5                                             ; 0128
#_0184C2: dw RoomDraw_4x4Object                                          ; 0129
#_0184C4: dw RoomDraw_PortraitOfMario                                    ; 012A
#_0184C6: dw RoomDraw_Object_2x2_rightwards                              ; 012B
#_0184C8: dw RoomDraw_DrawRightwards3x6                                  ; 012C
#_0184CA: dw RoomDraw_InterRoomFatStairsUp                               ; 012D
#_0184CC: dw RoomDraw_InterRoomFatStairsDown_A                           ; 012E
#_0184CE: dw RoomDraw_InterRoomFatStairsDown_B                           ; 012F
#_0184D0: dw RoomDraw_AutoStairs_North_MultiLayer_A                      ; 0130
#_0184D2: dw RoomDraw_AutoStairs_North_MultiLayer_B                      ; 0131
#_0184D4: dw RoomDraw_AutoStairs_North_MergedLayer_A                     ; 0132
#_0184D6: dw RoomDraw_AutoStairs_North_MergedLayer_B                     ; 0133
#_0184D8: dw RoomDraw_Object_2x2_rightwards                              ; 0134
#_0184DA: dw RoomDraw_WaterHopStairs_A                                   ; 0135
#_0184DC: dw RoomDraw_WaterHopStairs_B                                   ; 0136
#_0184DE: dw RoomDraw_DamFloodGate                                       ; 0137
#_0184E0: dw RoomDraw_SpiralStairsGoingUpUpper                           ; 0138
#_0184E2: dw RoomDraw_SpiralStairsGoingDownUpper                         ; 0139
#_0184E4: dw RoomDraw_SpiralStairsGoingUpLower                           ; 013A
#_0184E6: dw RoomDraw_SpiralStairsGoingDownLower                         ; 013B
#_0184E8: dw RoomDraw_SanctuaryWall                                      ; 013C
#_0184EA: dw RoomDraw_TableRock2x3                                       ; 013D
#_0184EC: dw RoomDraw_Utility6x3                                         ; 013E
#_0184EE: dw RoomDraw_MagicBatAltar                                      ; 013F

;===================================================================================================

.type1_subtype_3_data_offset
#_0184F0: dw $1614 ; 0F80
#_0184F2: dw $162C ; 0F81
#_0184F4: dw $1654 ; 0F82
#_0184F6: dw $0A0E ; 0F83
#_0184F8: dw $0A0C ; 0F84
#_0184FA: dw $09FC ; 0F85
#_0184FC: dw $09FE ; 0F86
#_0184FE: dw $0A00 ; 0F87
#_018500: dw $0A02 ; 0F88
#_018502: dw $0A04 ; 0F89
#_018504: dw $0A06 ; 0F8A
#_018506: dw $0A08 ; 0F8B
#_018508: dw $0A0A ; 0F8C
#_01850A: dw $0000 ; 0F8D
#_01850C: dw $0A10 ; 0F8E
#_01850E: dw $0A12 ; 0F8F
#_018510: dw $1DDA ; 0F90
#_018512: dw $1DE2 ; 0F91
#_018514: dw $1DD6 ; 0F92
#_018516: dw $1DEA ; 0F93
#_018518: dw $15FC ; 0F94
#_01851A: dw $1DFA ; 0F95
#_01851C: dw $1DF2 ; 0F96
#_01851E: dw $1488 ; 0F97
#_018520: dw $1494 ; 0F98
#_018522: dw $149C ; 0F99
#_018524: dw $14A4 ; 0F9A
#_018526: dw $10E8 ; 0F9B
#_018528: dw $10E8 ; 0F9C
#_01852A: dw $10E8 ; 0F9D
#_01852C: dw $11A8 ; 0F9E
#_01852E: dw $11C8 ; 0F9F
#_018530: dw $11E8 ; 0FA0
#_018532: dw $1208 ; 0FA1
#_018534: dw $03B8 ; 0FA2
#_018536: dw $03C0 ; 0FA3
#_018538: dw $03C8 ; 0FA4
#_01853A: dw $03D0 ; 0FA5
#_01853C: dw $1228 ; 0FA6
#_01853E: dw $1248 ; 0FA7
#_018540: dw $1268 ; 0FA8
#_018542: dw $1288 ; 0FA9
#_018544: dw $0000 ; 0FAA
#_018546: dw $0E5A ; 0FAB
#_018548: dw $0E62 ; 0FAC
#_01854A: dw $0000 ; 0FAD
#_01854C: dw $0000 ; 0FAE
#_01854E: dw $0E82 ; 0FAF
#_018550: dw $0E8A ; 0FB0
#_018552: dw $14AC ; 0FB1
#_018554: dw $14C4 ; 0FB2
#_018556: dw $10E8 ; 0FB3
#_018558: dw $1614 ; 0FB4
#_01855A: dw $1614 ; 0FB5
#_01855C: dw $1614 ; 0FB6
#_01855E: dw $1614 ; 0FB7
#_018560: dw $1614 ; 0FB8
#_018562: dw $1614 ; 0FB9
#_018564: dw $1CBE ; 0FBA
#_018566: dw $1CEE ; 0FBB
#_018568: dw $1D1E ; 0FBC
#_01856A: dw $1D4E ; 0FBD
#_01856C: dw $1D8E ; 0FBE
#_01856E: dw $1D96 ; 0FBF
#_018570: dw $1D9E ; 0FC0
#_018572: dw $1DA6 ; 0FC1
#_018574: dw $1DAE ; 0FC2
#_018576: dw $1DB6 ; 0FC3
#_018578: dw $1DBE ; 0FC4
#_01857A: dw $1DC6 ; 0FC5
#_01857C: dw $1DCE ; 0FC6
#_01857E: dw $0220 ; 0FC7
#_018580: dw $0260 ; 0FC8
#_018582: dw $0280 ; 0FC9
#_018584: dw $1F3A ; 0FCA
#_018586: dw $1F62 ; 0FCB
#_018588: dw $1F92 ; 0FCC
#_01858A: dw $1FF2 ; 0FCD
#_01858C: dw $2016 ; 0FCE
#_01858E: dw $1F42 ; 0FCF
#_018590: dw $0EAA ; 0FD0
#_018592: dw $1F4A ; 0FD1
#_018594: dw $1F52 ; 0FD2
#_018596: dw $1F5A ; 0FD3
#_018598: dw $202E ; 0FD4
#_01859A: dw $2062 ; 0FD5
#_01859C: dw $09B8 ; 0FD6
#_01859E: dw $09C0 ; 0FD7
#_0185A0: dw $09C8 ; 0FD8
#_0185A2: dw $09D0 ; 0FD9
#_0185A4: dw $0FA2 ; 0FDA
#_0185A6: dw $0FB2 ; 0FDB
#_0185A8: dw $0FC4 ; 0FDC
#_0185AA: dw $0FF4 ; 0FDD
#_0185AC: dw $1018 ; 0FDE
#_0185AE: dw $1020 ; 0FDF
#_0185B0: dw $15B4 ; 0FE0
#_0185B2: dw $15D8 ; 0FE1
#_0185B4: dw $20F6 ; 0FE2
#_0185B6: dw $0EBA ; 0FE3
#_0185B8: dw $22E6 ; 0FE4
#_0185BA: dw $22EE ; 0FE5
#_0185BC: dw $05DA ; 0FE6
#_0185BE: dw $281E ; 0FE7
#_0185C0: dw $2AE0 ; 0FE8
#_0185C2: dw $2D2A ; 0FE9
#_0185C4: dw $2F2A ; 0FEA
#_0185C6: dw $22F6 ; 0FEB
#_0185C8: dw $2316 ; 0FEC
#_0185CA: dw $232E ; 0FED
#_0185CC: dw $2346 ; 0FEE
#_0185CE: dw $235E ; 0FEF
#_0185D0: dw $2376 ; 0FF0
#_0185D2: dw $23B6 ; 0FF1
#_0185D4: dw $1E9A ; 0FF2
#_0185D6: dw $0000 ; 0FF3
#_0185D8: dw $2436 ; 0FF4
#_0185DA: dw $149C ; 0FF5
#_0185DC: dw $24B6 ; 0FF6
#_0185DE: dw $24E6 ; 0FF7
#_0185E0: dw $2516 ; 0FF8
#_0185E2: dw $1028 ; 0FF9
#_0185E4: dw $1040 ; 0FFA
#_0185E6: dw $1060 ; 0FFB
#_0185E8: dw $1070 ; 0FFC
#_0185EA: dw $1078 ; 0FFD
#_0185EC: dw $1080 ; 0FFE
#_0185EE: dw $0000 ; 0FFF

;---------------------------------------------------------------------------------------------------

.type1_subtype_3_routine
#_0185F0: dw RoomDraw_EmptyWaterFace                                     ; 0F80
#_0185F2: dw RoomDraw_SpittingWaterFace                                  ; 0F81
#_0185F4: dw RoomDraw_DrenchingWaterFace                                 ; 0F82
#_0185F6: dw RoomDraw_SomariaLine_increment_count                        ; 0F83
#_0185F8: dw RoomDraw_SomariaLine                                        ; 0F84
#_0185FA: dw RoomDraw_SomariaLine                                        ; 0F85
#_0185FC: dw RoomDraw_SomariaLine                                        ; 0F86
#_0185FE: dw RoomDraw_SomariaLine                                        ; 0F87
#_018600: dw RoomDraw_SomariaLine                                        ; 0F88
#_018602: dw RoomDraw_SomariaLine                                        ; 0F89
#_018604: dw RoomDraw_SomariaLine                                        ; 0F8A
#_018606: dw RoomDraw_SomariaLine                                        ; 0F8B
#_018608: dw RoomDraw_SomariaLine                                        ; 0F8C
#_01860A: dw RoomDraw_PrisonCell                                         ; 0F8D
#_01860C: dw RoomDraw_SomariaLine_increment_count                        ; 0F8E
#_01860E: dw RoomDraw_SomariaLine                                        ; 0F8F
#_018610: dw RoomDraw_Object_2x2_rightwards                              ; 0F90
#_018612: dw RoomDraw_Object_2x2_rightwards                              ; 0F91
#_018614: dw RoomDraw_RupeeFloor                                         ; 0F92
#_018616: dw RoomDraw_Object_2x2_rightwards                              ; 0F93
#_018618: dw RoomDraw_TableRock2x3                                       ; 0F94
#_01861A: dw RoomDraw_KholdstareShell                                    ; 0F95
#_01861C: dw RoomDraw_HammerPegSingle                                    ; 0F96
#_01861E: dw RoomDraw_PrisonCell                                         ; 0F97
#_018620: dw RoomDraw_BigKeyLock                                         ; 0F98
#_018622: dw RoomDraw_Chest                                              ; 0F99
#_018624: dw RoomDraw_OpenChest                                          ; 0F9A
#_018626: dw RoomDraw_AutoStairs_South_MultiLayer_A                      ; 0F9B
#_018628: dw RoomDraw_AutoStairs_South_MultiLayer_B                      ; 0F9C
#_01862A: dw RoomDraw_AutoStairs_South_MultiLayer_C                      ; 0F9D
#_01862C: dw RoomDraw_StraightInterroomStairsGoingUpNorthUpper           ; 0F9E
#_01862E: dw RoomDraw_StraightInterroomStairsGoingDownNorthUpper         ; 0F9F
#_018630: dw RoomDraw_StraightInterroomStairsGoingUpSouthUpper           ; 0FA0
#_018632: dw RoomDraw_StraightInterroomStairsGoingDownSouthUpper         ; 0FA1
#_018634: dw RoomDraw_Object_2x2_rightwards                              ; 0FA2
#_018636: dw RoomDraw_Object_2x2_rightwards                              ; 0FA3
#_018638: dw RoomDraw_Object_2x2_rightwards                              ; 0FA4
#_01863A: dw RoomDraw_Object_2x2_rightwards                              ; 0FA5
#_01863C: dw RoomDraw_StraightInterroomStairsGoingUpNorthLower           ; 0FA6
#_01863E: dw RoomDraw_StraightInterroomStairsGoingDownNorthLower         ; 0FA7
#_018640: dw RoomDraw_StraightInterroomStairsGoingUpSouthLower           ; 0FA8
#_018642: dw RoomDraw_StraightInterroomStairsGoingDownSouthLower         ; 0FA9
#_018644: dw RoomDraw_LampCones                                          ; 0FAA
#_018646: dw RoomDraw_WeirdGloveRequiredPot                              ; 0FAB
#_018648: dw RoomDraw_BigGrayRock                                        ; 0FAC
#_01864A: dw RoomDraw_AgahnimsAltar                                      ; 0FAD
#_01864C: dw RoomDraw_AgahnimsWindows                                    ; 0FAE
#_01864E: dw RoomDraw_SinglePot                                          ; 0FAF
#_018650: dw RoomDraw_WeirdUglyPot                                       ; 0FB0
#_018652: dw RoomDraw_BigChest                                           ; 0FB1
#_018654: dw RoomDraw_OpenBigChest                                       ; 0FB2
#_018656: dw RoomDraw_AutoStairs_South_MergedLayer                       ; 0FB3
#_018658: dw RoomDraw_ChestPlatformVerticalWall                          ; 0FB4
#_01865A: dw RoomDraw_ChestPlatformVerticalWall                          ; 0FB5
#_01865C: dw RoomDraw_DrawRightwards3x6                                  ; 0FB6
#_01865E: dw RoomDraw_DrawRightwards3x6                                  ; 0FB7
#_018660: dw RoomDraw_ChestPlatformVerticalWall                          ; 0FB8
#_018662: dw RoomDraw_ChestPlatformVerticalWall                          ; 0FB9
#_018664: dw RoomDraw_VerticalTurtleRockPipe                             ; 0FBA
#_018666: dw RoomDraw_VerticalTurtleRockPipe                             ; 0FBB
#_018668: dw RoomDraw_HorizontalTurtleRockPipe                           ; 0FBC
#_01866A: dw RoomDraw_HorizontalTurtleRockPipe                           ; 0FBD
#_01866C: dw RoomDraw_Object_2x2_rightwards                              ; 0FBE
#_01866E: dw RoomDraw_Object_2x2_rightwards                              ; 0FBF
#_018670: dw RoomDraw_Object_2x2_rightwards                              ; 0FC0
#_018672: dw RoomDraw_Object_2x2_rightwards                              ; 0FC1
#_018674: dw RoomDraw_Object_2x2_rightwards                              ; 0FC2
#_018676: dw RoomDraw_Object_2x2_rightwards                              ; 0FC3
#_018678: dw RoomDraw_Object_2x2_rightwards                              ; 0FC4
#_01867A: dw RoomDraw_Object_2x2_rightwards                              ; 0FC5
#_01867C: dw RoomDraw_Object_2x2_rightwards                              ; 0FC6
#_01867E: dw RoomDraw_BombableFloor                                      ; 0FC7
#_018680: dw RoomDraw_4x4Object                                          ; 0FC8
#_018682: dw RoomDraw_Object_2x2_rightwards                              ; 0FC9
#_018684: dw RoomDraw_Object_2x2_rightwards                              ; 0FCA
#_018686: dw RoomDraw_BigWallDecor                                       ; 0FCB
#_018688: dw RoomDraw_SmithyFurnace                                      ; 0FCC
#_01868A: dw RoomDraw_Utility6x3                                         ; 0FCD
#_01868C: dw RoomDraw_TableRock2x3                                       ; 0FCE
#_01868E: dw RoomDraw_Object_2x2_rightwards                              ; 0FCF
#_018690: dw RoomDraw_Single2x2                                          ; 0FD0
#_018692: dw RoomDraw_Object_2x2_rightwards                              ; 0FD1
#_018694: dw RoomDraw_Object_2x2_rightwards                              ; 0FD2
#_018696: dw RoomDraw_Object_2x2_rightwards                              ; 0FD3
#_018698: dw RoomDraw_FortuneTellerRoom                                  ; 0FD4
#_01869A: dw RoomDraw_Utility3x5                                         ; 0FD5
#_01869C: dw RoomDraw_Object_2x2_rightwards                              ; 0FD6
#_01869E: dw RoomDraw_Object_2x2_rightwards                              ; 0FD7
#_0186A0: dw RoomDraw_Object_2x2_rightwards                              ; 0FD8
#_0186A2: dw RoomDraw_Object_2x2_rightwards                              ; 0FD9
#_0186A4: dw RoomDraw_TableBowl                                          ; 0FDA
#_0186A6: dw RoomDraw_Utility3x5                                         ; 0FDB
#_0186A8: dw RoomDraw_HorizontalTurtleRockPipe                           ; 0FDC
#_0186AA: dw RoomDraw_Utility6x3                                         ; 0FDD
#_0186AC: dw RoomDraw_Object_2x2_rightwards                              ; 0FDE
#_0186AE: dw RoomDraw_Object_2x2_rightwards                              ; 0FDF
#_0186B0: dw RoomDraw_ArcheryGameTargetDoor                              ; 0FE0
#_0186B2: dw RoomDraw_ArcheryGameTargetDoor                              ; 0FE1
#_0186B4: dw RoomDraw_VitreousGooGraphics                                ; 0FE2
#_0186B6: dw RoomDraw_Object_2x2_rightwards                              ; 0FE3
#_0186B8: dw RoomDraw_Object_2x2_rightwards                              ; 0FE4
#_0186BA: dw RoomDraw_Object_2x2_rightwards                              ; 0FE5
#_0186BC: dw RoomDraw_4x4Object                                          ; 0FE6
#_0186BE: dw RoomDraw_TableRock2x3                                       ; 0FE7
#_0186C0: dw RoomDraw_TableRock2x3                                       ; 0FE8
#_0186C2: dw RoomDraw_SolidWallDecor3x4                                  ; 0FE9
#_0186C4: dw RoomDraw_SolidWallDecor3x4                                  ; 0FEA
#_0186C6: dw RoomDraw_4x4Object                                          ; 0FEB
#_0186C8: dw RoomDraw_TableRock2x3                                       ; 0FEC
#_0186CA: dw RoomDraw_TableRock2x3                                       ; 0FED
#_0186CC: dw RoomDraw_SolidWallDecor3x4                                  ; 0FEE
#_0186CE: dw RoomDraw_SolidWallDecor3x4                                  ; 0FEF
#_0186D0: dw RoomDraw_LightBeamOnFloor                                   ; 0FF0
#_0186D2: dw RoomDraw_BigLightBeamOnFloor                                ; 0FF1
#_0186D4: dw RoomDraw_TrinexxShell                                       ; 0FF2
#_0186D6: dw RoomDraw_BG2MaskFull                                        ; 0FF3
#_0186D8: dw RoomDraw_FloorLight                                         ; 0FF4
#_0186DA: dw RoomDraw_Object_2x2_rightwards                              ; 0FF5
#_0186DC: dw RoomDraw_BigWallDecor                                       ; 0FF6
#_0186DE: dw RoomDraw_BigWallDecor                                       ; 0FF7
#_0186E0: dw RoomDraw_GanonTriforceFloorDecor                            ; 0FF8
#_0186E2: dw RoomDraw_TableRock2x3                                       ; 0FF9
#_0186E4: dw RoomDraw_4x4Object                                          ; 0FFA
#_0186E6: dw RoomDraw_VitreousGooDamage                                  ; 0FFB
#_0186E8: dw RoomDraw_Object_2x2_rightwards                              ; 0FFC
#_0186EA: dw RoomDraw_Object_2x2_rightwards                              ; 0FFD
#_0186EC: dw RoomDraw_Object_2x2_rightwards                              ; 0FFE
#_0186EE: dw RoomDraw_Nothing_B                                          ; 0FFF

;===================================================================================================

DoorDrawRoutines:
#_0186F0: dw RoomDraw_Door_North
#_0186F2: dw RoomDraw_Door_South
#_0186F4: dw RoomDraw_Door_West
#_0186F6: dw RoomDraw_Door_East

;===================================================================================================

RoomData_TileMapPointers:
.upper_layer
#_0186F8: dl $7E2000+$000
#_0186FB: dl $7E2000+$002
#_0186FE: dl $7E2000+$004
#_018701: dl $7E2000+$006

#_018704: dl $7E2000+$080
#_018707: dl $7E2000+$082
#_01870A: dl $7E2000+$084
#_01870D: dl $7E2000+$086

#_018710: dl $7E2000+$100
#_018713: dl $7E2000+$180
#_018716: dl $7E2000+$200

;---------------------------------------------------------------------------------------------------

.lower_layer
#_018719: dl $7E4000+$000
#_01871C: dl $7E4000+$002
#_01871F: dl $7E4000+$004
#_018722: dl $7E4000+$006

#_018725: dl $7E4000+$080
#_018728: dl $7E4000+$082
#_01872B: dl $7E4000+$084
#_01872E: dl $7E4000+$086

#_018731: dl $7E4000+$100
#_018734: dl $7E4000+$180
#_018737: dl $7E4000+$200

;===================================================================================================
; TODO analyze
;===================================================================================================
Underworld_LoadRoom:
#_01873A: JSR Underworld_LoadHeader

#_01873D: STZ.w $03F4

#_018740: REP #$30

#_018742: LDX.w $0110 ; this holds roomID*3

#_018745: LDA.l RoomData_ObjectDataPointers+1,X
#_018749: STA.b $B8

#_01874B: LDA.l RoomData_ObjectDataPointers+0,X
#_01874F: STA.b $B7

#_018751: LDA.b $AD
#_018753: STA.w $0428

#_018756: LDA.w #$FF30
#_018759: STA.w $041C

;---------------------------------------------------------------------------------------------------

#_01875C: STZ.w $041A
#_01875F: STZ.w $0420
#_018762: STZ.w $0312
#_018765: STZ.w $0310
#_018768: STZ.w $0422
#_01876B: STZ.w $0424

#_01876E: LDA.w #$FFFF
#_018771: STA.w $0436

#_018774: STZ.w $0452
#_018777: STZ.w $0454
#_01877A: STZ.w $0456

#_01877D: STZ.w $068A
#_018780: STZ.w $044E
#_018783: STZ.w $0450

#_018786: STZ.b $FC

;---------------------------------------------------------------------------------------------------

#_018788: STZ.w $045C
#_01878B: STZ.w $0438
#_01878E: STZ.w $043A
#_018791: STZ.w $043C

#_018794: STZ.w $043E
#_018797: STZ.w $0440
#_01879A: STZ.w $0442
#_01879D: STZ.w $0444

#_0187A0: STZ.w $0446
#_0187A3: STZ.w $0448
#_0187A6: STZ.w $049A
#_0187A9: STZ.w $049C

#_0187AC: STZ.w $049E
#_0187AF: STZ.w $04AE

#_0187B2: STZ.w $047E
#_0187B5: STZ.w $0480
#_0187B8: STZ.w $0482
#_0187BB: STZ.w $0484

#_0187BE: STZ.w $04A2
#_0187C1: STZ.w $04A4
#_0187C4: STZ.w $04A6
#_0187C7: STZ.w $04A8

#_0187CA: STZ.w $19E2
#_0187CD: STZ.w $19E4
#_0187D0: STZ.w $19E6
#_0187D3: STZ.w $19E8
#_0187D6: STZ.w $19E0

#_0187D9: STZ.w $0430
#_0187DC: STZ.w $0432
#_0187DF: STZ.w $042C
#_0187E2: STZ.w $042E

#_0187E5: STZ.w $0496
#_0187E8: STZ.w $0498

#_0187EB: STZ.w $04B0

;---------------------------------------------------------------------------------------------------

#_0187EE: LDX.w #$001E

#_0187F1: STZ.w $0460

.next_obj_clear
#_0187F4: STZ.w $19A0,X ; clears door related stuff
#_0187F7: STZ.w $1980,X
#_0187FA: STZ.w $19C0,X

#_0187FD: STZ.w $04F0,X ; clears dynamic object stuff
#_018800: STZ.w $0500,X
#_018803: STZ.w $0520,X
#_018806: STZ.w $0540,X

#_018809: DEX
#_01880A: DEX
#_01880B: BPL .next_obj_clear

;---------------------------------------------------------------------------------------------------

#_01880D: STZ.b $BA

#_01880F: JSR RoomDraw_DrawFloors

#_018812: LDY.b $BA
#_018814: PHY

#_018815: LDA.b [$B7],Y
#_018817: AND.w #$00FF
#_01881A: STA.w $040E

#_01881D: LSR A
#_01881E: LSR A
#_01881F: STA.b $00

#_018821: ASL A
#_018822: CLC
#_018823: ADC.b $00
#_018825: TAX

#_018826: LDA.l RoomDraw_LayoutPointers+1,X
#_01882A: STA.b $B8

#_01882C: LDA.l RoomDraw_LayoutPointers+0,X
#_018830: STA.b $B7

#_018832: STZ.b $BA

#_018834: JSR RoomDraw_DrawAllObjects

#_018837: PLY
#_018838: INY
#_018839: STY.b $BA

#_01883B: LDX.w $0110

#_01883E: LDA.l RoomData_ObjectDataPointers+1,X
#_018842: STA.b $B8

#_018844: LDA.l RoomData_ObjectDataPointers+0,X
#_018848: STA.b $B7

#_01884A: JSR RoomDraw_DrawAllObjects

#_01884D: INC.b $BA
#_01884F: INC.b $BA

;---------------------------------------------------------------------------------------------------

#_018851: LDX.w #$001E

.save_next_lower_layer_pointer
#_018854: LDA.l RoomData_TileMapPointers_lower_layer+1,X
#_018858: STA.b $C0,X

#_01885A: DEX
#_01885B: DEX
#_01885C: DEX
#_01885D: BPL .save_next_lower_layer_pointer

#_01885F: JSR RoomDraw_DrawAllObjects

;---------------------------------------------------------------------------------------------------

#_018862: INC.b $BA
#_018864: INC.b $BA

#_018866: LDX.w #$001E

.save_next_upper_layer_pointer
#_018869: LDA.l RoomData_TileMapPointers_upper_layer+1,X
#_01886D: STA.b $C0,X

#_01886F: DEX
#_018870: DEX
#_018871: DEX
#_018872: BPL .save_next_upper_layer_pointer

#_018874: JSR RoomDraw_DrawAllObjects

;---------------------------------------------------------------------------------------------------

#_018877: STZ.b $BA

.next_block
#_018879: LDX.b $BA

#_01887B: LDA.l $7EF940,X
#_01887F: CMP.b $A0
#_018881: BNE .block_not_in_this_room

#_018883: LDA.l $7EF942,X
#_018887: STA.b $08

#_018889: TAY

#_01888A: JSR DrawObjects_PushableBlock

.block_not_in_this_room
#_01888D: LDA.b $BA
#_01888F: CLC
#_018890: ADC.w #$0004
#_018893: STA.b $BA

#_018895: CMP.w #$018C
#_018898: BNE .next_block

;---------------------------------------------------------------------------------------------------

#_01889A: REP #$20

#_01889C: LDA.w $042C
#_01889F: STA.w $042E
#_0188A2: STA.w $0478

#_0188A5: STZ.b $BA

.next_torch_check
#_0188A7: LDX.b $BA

#_0188A9: LDA.l $7EFB40,X
#_0188AD: CMP.b $A0
#_0188AF: BEQ .torches_in_this_room

#_0188B1: INX
#_0188B2: INX

.find_next_torch
#_0188B3: LDA.l $7EFB40,X

#_0188B7: INX
#_0188B8: INX
#_0188B9: STX.b $BA

#_0188BB: CMP.w #$FFFF
#_0188BE: BNE .find_next_torch

#_0188C0: CPX.w #$0120
#_0188C3: BNE .next_torch_check

#_0188C5: BRA .exit

;---------------------------------------------------------------------------------------------------

.torches_in_this_room
#_0188C7: INX
#_0188C8: INX

.draw_next_torch
#_0188C9: LDA.l $7EFB40,X
#_0188CD: STA.b $08

#_0188CF: INX
#_0188D0: INX
#_0188D1: STX.b $BA

#_0188D3: JSR DrawObjects_LightableTorch

#_0188D6: LDX.b $BA

#_0188D8: LDA.l $7EFB40,X
#_0188DC: CMP.w #$FFFF
#_0188DF: BNE .draw_next_torch

;---------------------------------------------------------------------------------------------------

.exit
#_0188E1: SEP #$30

#_0188E3: RTL

;===================================================================================================

RoomDraw_DrawAllObjects:
.next_type_1
#_0188E4: STZ.b $B2
#_0188E6: STZ.b $B4

#_0188E8: LDY.b $BA

#_0188EA: LDA.b [$B7],Y
#_0188EC: CMP.w #$FFFF
#_0188EF: BEQ .return

#_0188F1: STA.b $00

#_0188F3: CMP.w #$FFF0
#_0188F6: BEQ .try_type_2

#_0188F8: JSR RoomData_DrawObject_Type1

#_0188FB: BRA .next_type_1

.return
#_0188FD: RTS

;---------------------------------------------------------------------------------------------------

.try_type_2
#_0188FE: INC.b $BA
#_018900: INC.b $BA

.next_type_2
#_018902: LDY.b $BA

#_018904: LDA.b [$B7],Y
#_018906: CMP.w #$FFFF
#_018909: BEQ .return

#_01890B: STA.b $00

#_01890D: JSR RoomData_DrawObject_Type2

#_018910: INC.b $BA
#_018912: INC.b $BA

#_018914: BRA .next_type_2

;===================================================================================================

RoomData_DrawObject_Type2:
#_018916: AND.w #$00F0
#_018919: LSR A
#_01891A: LSR A
#_01891B: LSR A
#_01891C: STA.b $02

#_01891E: LDA.b $00
#_018920: XBA
#_018921: AND.w #$00FF
#_018924: STA.b $0A
#_018926: STA.b $04

#_018928: LDA.b $00
#_01892A: AND.w #$0003
#_01892D: ASL A
#_01892E: TAX

#_01892F: LDA.l DoorDrawRoutines,X
#_018933: STA.b $0E

#_018935: LDX.b $02

#_018937: LDA.b $04

#_018939: JMP.w ($000E)

;===================================================================================================

RoomData_DrawObject_Type1:
#_01893C: SEP #$20

#_01893E: AND.b #$FC
#_018940: CMP.b #$FC
#_018942: BEQ .subtype_2

#_018944: STA.b $08

#_018946: LDA.b $00
#_018948: AND.b #$03
#_01894A: STA.b $B2

#_01894C: LDA.b $01
#_01894E: AND.b #$03
#_018950: STA.b $B4

#_018952: INY
#_018953: INY

#_018954: LDA.b [$B7],Y
#_018956: STA.b $04

#_018958: INY
#_018959: STY.b $BA

#_01895B: LDA.b $01
#_01895D: LSR A
#_01895E: LSR A
#_01895F: LSR A
#_018960: ROR.b $08
#_018962: STA.b $09

#_018964: STZ.b $03
#_018966: STZ.b $05

;---------------------------------------------------------------------------------------------------

#_018968: REP #$20

#_01896A: LDA.b $04
#_01896C: ASL A
#_01896D: CMP.w #$01F0
#_018970: BCS .subtype_3

#_018972: TAX

#_018973: LDA.l DrawObjects_type1_subtype_1_routine,X
#_018977: STA.b $0E

#_018979: LDA.l DrawObjects_type1_subtype_1_data_offset,X
#_01897D: TAX

#_01897E: LDY.b $08

#_018980: JMP.w ($000E)

;---------------------------------------------------------------------------------------------------

.subtype_2
#_018983: REP #$20

#_018985: LDA.b $00
#_018987: XBA
#_018988: AND.w #$03F0
#_01898B: LSR A
#_01898C: LSR A
#_01898D: LSR A
#_01898E: STA.b $08

#_018990: INY

#_018991: LDA.b [$B7],Y
#_018993: XBA
#_018994: AND.w #$0FC0

#_018997: ASL A
#_018998: ORA.b $08
#_01899A: STA.b $08

#_01899C: LDA.b [$B7],Y
#_01899E: XBA
#_01899F: AND.w #$003F

#_0189A2: INY
#_0189A3: INY
#_0189A4: STY.b $BA

#_0189A6: ASL A
#_0189A7: TAX

#_0189A8: LDA.l DrawObjects_type1_subtype_2_routine,X
#_0189AC: STA.b $0E

#_0189AE: LDA.l DrawObjects_type1_subtype_2_data_offset,X
#_0189B2: TAX

#_0189B3: LDY.b $08

#_0189B5: JMP.w ($000E)

;---------------------------------------------------------------------------------------------------

.subtype_3
#_0189B8: AND.w #$000E
#_0189BB: ASL A
#_0189BC: ASL A
#_0189BD: ASL A
#_0189BE: STA.b $04

#_0189C0: LDA.b $B4
#_0189C2: ASL A
#_0189C3: ASL A
#_0189C4: ORA.b $B2
#_0189C6: TSB.b $04

#_0189C8: LDA.b $04
#_0189CA: ASL A
#_0189CB: TAX

#_0189CC: LDA.l DrawObjects_type1_subtype_3_routine,X
#_0189D0: STA.b $0E

#_0189D2: LDA.l DrawObjects_type1_subtype_3_data_offset,X
#_0189D6: TAX

#_0189D7: LDY.b $08

#_0189D9: JMP.w ($000E)

;===================================================================================================

RoomDraw_DrawFloors:
#_0189DC: LDX.w #$001E

.next_pointer_a
#_0189DF: LDA.l RoomData_TileMapPointers_lower_layer+0,X
#_0189E3: STA.b $BF,X

#_0189E5: LDA.l RoomData_TileMapPointers_lower_layer+1,X
#_0189E9: STA.b $C0,X

#_0189EB: DEX
#_0189EC: DEX
#_0189ED: DEX
#_0189EE: BPL .next_pointer_a

;---------------------------------------------------------------------------------------------------

#_0189F0: LDY.b $BA

#_0189F2: INC.b $BA

#_0189F4: STZ.b $0C

#_0189F6: LDA.b [$B7],Y
#_0189F8: PHA

#_0189F9: AND.w #$00F0
#_0189FC: STA.w $0490

#_0189FF: TAX

#_018A00: JSR RoomDraw_FloorChunks

;---------------------------------------------------------------------------------------------------

#_018A03: LDX.w #$001E

.next_pointer_b
#_018A06: LDA.l RoomData_TileMapPointers_upper_layer+1,X
#_018A0A: STA.b $C0,X

#_018A0C: DEX
#_018A0D: DEX
#_018A0E: DEX
#_018A0F: BPL .next_pointer_b

#_018A11: STZ.b $0C

#_018A13: PLA
#_018A14: AND.w #$000F

#_018A17: ASL A ; x16
#_018A18: ASL A
#_018A19: ASL A
#_018A1A: ASL A

#_018A1B: STA.w $046A

#_018A1E: TAX

;===================================================================================================

RoomDraw_FloorChunks:
.next_super
#_018A1F: LDY.b $0C

#_018A21: LDA.w RoomDraw_QuadrantDataOffset,Y
#_018A24: TAY

#_018A25: LDA.w #$0008
#_018A28: STA.b $0E

.next_square
#_018A2A: LDA.w #$0008
#_018A2D: JSR RoomDraw_A_Many32x32Blocks

#_018A30: ADC.w #$01C0
#_018A33: TAY

#_018A34: DEC.b $0E
#_018A36: BNE .next_square

#_018A38: INC.b $0C
#_018A3A: INC.b $0C

#_018A3C: LDA.b $0C
#_018A3E: CMP.w #$0008
#_018A41: BNE .next_super

#_018A43: RTS

;===================================================================================================

RoomDraw_A_Many32x32Blocks:
#_018A44: STA.b $0A

.next_set
#_018A46: LDA.w #$0002
#_018A49: STA.b $04

.next_block
#_018A4B: LDA.w RoomDrawObjectData+0,X
#_018A4E: STA.b [$BF],Y

#_018A50: LDA.w RoomDrawObjectData+2,X
#_018A53: STA.b [$C2],Y

#_018A55: LDA.w RoomDrawObjectData+4,X
#_018A58: STA.b [$C5],Y

#_018A5A: LDA.w RoomDrawObjectData+6,X
#_018A5D: STA.b [$C8],Y

#_018A5F: LDA.w RoomDrawObjectData+8,X
#_018A62: STA.b [$CB],Y

#_018A64: LDA.w RoomDrawObjectData+10,X
#_018A67: STA.b [$CE],Y

#_018A69: LDA.w RoomDrawObjectData+12,X
#_018A6C: STA.b [$D1],Y

#_018A6E: LDA.w RoomDrawObjectData+14,X
#_018A71: STA.b [$D4],Y

#_018A73: TYA
#_018A74: CLC
#_018A75: ADC.w #$0100
#_018A78: TAY

#_018A79: DEC.b $04
#_018A7B: BNE .next_block

#_018A7D: TYA
#_018A7E: SEC
#_018A7F: SBC.w #$01F8
#_018A82: TAY

#_018A83: DEC.b $0A
#_018A85: BNE .next_set

#_018A87: CLC

#_018A88: RTS

;===================================================================================================

RoomDraw_Downwards4x2_1to15or26:
#_018A89: JSR RoomDraw_GetObjectSize_1to15or26

#_018A8C: LDA.w #$0100
#_018A8F: JMP.w RoomDraw_Downwards4x2VariableSpacing

;===================================================================================================

RoomDraw_Rightwards2x4_1to15or26:
#_018A92: JSR RoomDraw_GetObjectSize_1to15or26

#_018A95: STX.b $0A

.next
#_018A97: LDA.w #$0002
#_018A9A: JSR RoomDraw_Object_4xN

#_018A9D: LDX.b $0A

#_018A9F: DEC.b $B2
#_018AA1: BNE .next

;===================================================================================================

RoomDraw_Nothing_B:
#_018AA3: RTS

;===================================================================================================

RoomDraw_Downwards4x2_1to16_BothBG:
#_018AA4: TXA
#_018AA5: TYX
#_018AA6: TAY

#_018AA7: JSR RoomDraw_GetObjectSize_1to16

.next_row
#_018AAA: LDA.w RoomDrawObjectData+0,Y
#_018AAD: STA.l $7E4000,X
#_018AB1: STA.l $7E2000,X

#_018AB5: LDA.w RoomDrawObjectData+2,Y
#_018AB8: STA.l $7E4002,X
#_018ABC: STA.l $7E2002,X

#_018AC0: LDA.w RoomDrawObjectData+4,Y
#_018AC3: STA.l $7E4004,X
#_018AC7: STA.l $7E2004,X

#_018ACB: LDA.w RoomDrawObjectData+6,Y
#_018ACE: STA.l $7E4006,X
#_018AD2: STA.l $7E2006,X

#_018AD6: LDA.w RoomDrawObjectData+8,Y
#_018AD9: STA.l $7E4080,X
#_018ADD: STA.l $7E2080,X

#_018AE1: LDA.w RoomDrawObjectData+10,Y
#_018AE4: STA.l $7E4082,X
#_018AE8: STA.l $7E2082,X

#_018AEC: LDA.w RoomDrawObjectData+12,Y
#_018AEF: STA.l $7E4084,X
#_018AF3: STA.l $7E2084,X

#_018AF7: LDA.w RoomDrawObjectData+14,Y
#_018AFA: STA.l $7E4086,X
#_018AFE: STA.l $7E2086,X

#_018B02: TXA
#_018B03: CLC
#_018B04: ADC.w #$0100
#_018B07: TAX

#_018B08: DEC.b $B2
#_018B0A: BNE .next_row

#_018B0C: RTS

;===================================================================================================

RoomDraw_Object_Rightwards2x4spaced4_1to16:
#_018B0D: TXA
#_018B0E: TYX
#_018B0F: TAY

#_018B10: JSR RoomDraw_GetObjectSize_1to16

.next_row
#_018B13: LDA.w RoomDrawObjectData+0,Y
#_018B16: STA.l $7E4000,X
#_018B1A: STA.l $7E2000,X

#_018B1E: LDA.w RoomDrawObjectData+2,Y
#_018B21: STA.l $7E4080,X
#_018B25: STA.l $7E2080,X

#_018B29: LDA.w RoomDrawObjectData+4,Y
#_018B2C: STA.l $7E4100,X
#_018B30: STA.l $7E2100,X

#_018B34: LDA.w RoomDrawObjectData+6,Y
#_018B37: STA.l $7E4180,X
#_018B3B: STA.l $7E2180,X

#_018B3F: LDA.w RoomDrawObjectData+8,Y
#_018B42: STA.l $7E4002,X
#_018B46: STA.l $7E2002,X

#_018B4A: LDA.w RoomDrawObjectData+10,Y
#_018B4D: STA.l $7E4082,X
#_018B51: STA.l $7E2082,X

#_018B55: LDA.w RoomDrawObjectData+12,Y
#_018B58: STA.l $7E4102,X
#_018B5C: STA.l $7E2102,X

#_018B60: LDA.w RoomDrawObjectData+14,Y
#_018B63: STA.l $7E4182,X
#_018B67: STA.l $7E2182,X

#_018B6B: INX ; +4
#_018B6C: INX
#_018B6D: INX
#_018B6E: INX

#_018B6F: DEC.b $B2
#_018B71: BNE .next_row

#_018B73: RTS

;===================================================================================================

RoomDraw_Downwards2x2_1to16:
#_018B74: JSR RoomDraw_GetObjectSize_1to16

#_018B77: BRA RoomDraw_Downwards2x2_1to15or32_draw_next_2x2

;===================================================================================================

RoomDraw_Rightwards2x2_1to16:
#_018B79: JSR RoomDraw_GetObjectSize_1to16

#_018B7C: BRA RoomDraw_Rightwards2x2_1to15or32_draw_next_2x2

;===================================================================================================

RoomDraw_Downwards2x2_1to15or32:
#_018B7E: JSR RoomDraw_GetObjectSize_1to15or32

.draw_next_2x2
#_018B81: JSR RoomDraw_Object_2x2_downwards

#_018B84: DEC.b $B2
#_018B86: BNE .draw_next_2x2

#_018B88: RTS

;===================================================================================================

RoomDraw_Rightwards2x2_1to15or32:
#_018B89: JSR RoomDraw_GetObjectSize_1to15or32

.draw_next_2x2
#_018B8C: JSR RoomDraw_Object_2x2_rightwards
#_018B8F: DEC.b $B2

#_018B91: BNE .draw_next_2x2

#_018B93: RTS

;===================================================================================================

RoomDraw_4x4BlocksIn4x4SuperSquare:
#_018B94: INC.b $B2
#_018B96: INC.b $B4

.next_super_square
#_018B98: LDA.b $B2
#_018B9A: STA.b $0A

.next_square
#_018B9C: LDA.w RoomDrawObjectData+0,X
#_018B9F: STA.b [$BF],Y
#_018BA1: STA.b [$C2],Y
#_018BA3: STA.b [$C5],Y
#_018BA5: STA.b [$C8],Y
#_018BA7: STA.b [$CB],Y
#_018BA9: STA.b [$CE],Y
#_018BAB: STA.b [$D1],Y
#_018BAD: STA.b [$D4],Y

#_018BAF: TYA
#_018BB0: CLC
#_018BB1: ADC.w #$0100
#_018BB4: TAY

#_018BB5: LDA.w RoomDrawObjectData+0,X
#_018BB8: STA.b [$BF],Y
#_018BBA: STA.b [$C2],Y
#_018BBC: STA.b [$C5],Y
#_018BBE: STA.b [$C8],Y
#_018BC0: STA.b [$CB],Y
#_018BC2: STA.b [$CE],Y
#_018BC4: STA.b [$D1],Y
#_018BC6: STA.b [$D4],Y

#_018BC8: TYA
#_018BC9: SEC
#_018BCA: SBC.w #$00F8
#_018BCD: TAY

#_018BCE: DEC.b $0A
#_018BD0: BNE .next_square

#_018BD2: LDA.b $08
#_018BD4: CLC
#_018BD5: ADC.w #$0200
#_018BD8: STA.b $08

#_018BDA: TAY

#_018BDB: DEC.b $B4
#_018BDD: BNE .next_super_square

#_018BDF: RTS

;===================================================================================================

RoomDraw_DiagonalCeilingTopLeftA:
#_018BE0: LDA.w #$0004
#_018BE3: JSR RoomDraw_GetObjectSize_1to16_timesA

.next
#_018BE6: JSR RoomDraw_LineOf8x8_use_B2_for_count
#_018BE9: ADC.w #$0080
#_018BEC: STA.b $08

#_018BEE: TAY

#_018BEF: DEC.b $B2
#_018BF1: BNE .next

#_018BF3: RTS

;===================================================================================================

RoomDraw_DiagonalCeilingBottomLeftA:
#_018BF4: LDA.w #$0004
#_018BF7: JSR RoomDraw_GetObjectSize_1to16_timesA

#_018BFA: INC.b $B4

.next
#_018BFC: LDA.b $B4
#_018BFE: JSR RoomDraw_LineOf8x8

#_018C01: ADC.w #$0080
#_018C04: STA.b $08

#_018C06: TAY

#_018C07: INC.b $B4

#_018C09: DEC.b $B2
#_018C0B: BNE .next

#_018C0D: RTS

;===================================================================================================

RoomDraw_DiagonalCeilingTopRightA:
#_018C0E: LDA.w #$0004
#_018C11: JSR RoomDraw_GetObjectSize_1to16_timesA

.next
#_018C14: JSR RoomDraw_LineOf8x8_use_B2_for_count
#_018C17: ADC.w #$0082
#_018C1A: STA.b $08

#_018C1C: TAY

#_018C1D: DEC.b $B2
#_018C1F: BNE .next

#_018C21: RTS

;===================================================================================================

RoomDraw_DiagonalCeilingBottomRightA:
#_018C22: LDA.w #$0004
#_018C25: JSR RoomDraw_GetObjectSize_1to16_timesA

.next
#_018C28: JSR RoomDraw_LineOf8x8_use_B2_for_count
#_018C2B: SEC
#_018C2C: SBC.w #$007E
#_018C2F: STA.b $08

#_018C31: TAY

#_018C32: DEC.b $B2
#_018C34: BNE .next

#_018C36: RTS

;===================================================================================================

RoomDraw_Rightwards2x2_1to16_BothBG:
#_018C37: JSR RoomDraw_GetObjectSize_1to16

#_018C3A: STX.b $0A

.next
#_018C3C: LDA.w #$0002
#_018C3F: JSR RoomDraw_Object_4xN

#_018C42: TYA
#_018C43: CLC
#_018C44: ADC.w #$0008
#_018C47: TAY

#_018C48: LDX.b $0A

#_018C4A: DEC.b $B2
#_018C4C: BNE .next

#_018C4E: RTS

;===================================================================================================

RoomDraw_DownwardsDecor4x2spaced4_1to16:
#_018C4F: JSR RoomDraw_GetObjectSize_1to16

#_018C52: LDA.w #$0300
#_018C55: JMP.w RoomDraw_Downwards4x2VariableSpacing

;===================================================================================================

RoomDraw_DiagonalAcute_1to16:
#_018C58: LDA.w #$0007
#_018C5B: JSR RoomDraw_GetObjectSize_1to16_timesA

#_018C5E: JMP.w RoomDraw_DrawDiagonalAcute_start

;===================================================================================================

RoomDraw_DiagonalGrave_1to16:
#_018C61: LDA.w #$0007
#_018C64: JSR RoomDraw_GetObjectSize_1to16_timesA

#_018C67: JMP.w RoomDraw_DrawDiagonalGrave_start

;===================================================================================================

RoomDraw_DiagonalAcute_1to16_BothBG:
#_018C6A: TXA
#_018C6B: TYX
#_018C6C: TAY

#_018C6D: LDA.w #$0006

#_018C70: JSR RoomDraw_GetObjectSize_1to16_timesA
#_018C73: LDA.w #$FF82

.next_bg
#_018C76: STA.b $0E

.next
#_018C78: LDA.w RoomDrawObjectData+0,Y
#_018C7B: STA.l $7E4000,X
#_018C7F: STA.l $7E2000,X

#_018C83: LDA.w RoomDrawObjectData+2,Y
#_018C86: STA.l $7E4080,X
#_018C8A: STA.l $7E2080,X

#_018C8E: LDA.w RoomDrawObjectData+4,Y
#_018C91: STA.l $7E4100,X
#_018C95: STA.l $7E2100,X

#_018C99: LDA.w RoomDrawObjectData+6,Y
#_018C9C: STA.l $7E4180,X
#_018CA0: STA.l $7E2180,X

#_018CA4: LDA.w RoomDrawObjectData+8,Y
#_018CA7: STA.l $7E4200,X
#_018CAB: STA.l $7E2200,X

#_018CAF: TXA
#_018CB0: CLC
#_018CB1: ADC.b $0E
#_018CB3: TAX

#_018CB4: DEC.b $B2
#_018CB6: BNE .next

#_018CB8: RTS

;===================================================================================================

#RoomDraw_DiagonalGrave_1to16_BothBG:
#_018CB9: TXA
#_018CBA: TYX
#_018CBB: TAY

#_018CBC: LDA.w #$0006
#_018CBF: JSR RoomDraw_GetObjectSize_1to16_timesA

#_018CC2: LDA.w #$0082

#_018CC5: BRA .next_bg

;===================================================================================================

RoomDraw_ClosedChestPlatform:
#_018CC7: LDA.b $B2
#_018CC9: CLC
#_018CCA: ADC.w #$0004
#_018CCD: STA.b $B2
#_018CCF: STA.b $0A

#_018CD1: INC.b $B4

#_018CD3: JSR RoomDraw_ChestPlatformHorizontalWallWithCorners

#_018CD6: STX.w $0006

#_018CD9: LDA.b $08
#_018CDB: STA.b $04

#_018CDD: CLC
#_018CDE: ADC.w #$0180
#_018CE1: STA.b $08

#_018CE3: LDA.b $B4
#_018CE5: STA.b $0E

;---------------------------------------------------------------------------------------------------

.next_vertical_wall
#_018CE7: LDA.b $B2
#_018CE9: STA.b $0A

#_018CEB: LDY.b $08
#_018CED: LDX.b $06

#_018CEF: JSR RoomDraw_ChestPlatformVerticalWall

#_018CF2: TXA
#_018CF3: CLC
#_018CF4: ADC.w #$000C
#_018CF7: TAX

#_018CF8: TYA
#_018CF9: CLC
#_018CFA: ADC.w #$0006
#_018CFD: TAY

.next_horizontal_carpet
#_018CFE: JSR RoomDraw_Object_2x2_rightwards

#_018D01: DEC.b $0A
#_018D03: BNE .next_horizontal_carpet

#_018D05: TXA
#_018D06: CLC
#_018D07: ADC.w #$0008
#_018D0A: TAX

#_018D0B: JSR RoomDraw_ChestPlatformVerticalWall

#_018D0E: LDA.b $08
#_018D10: CLC
#_018D11: ADC.w #$0100
#_018D14: STA.b $08

#_018D16: DEC.b $0E
#_018D18: BNE .next_vertical_wall

;---------------------------------------------------------------------------------------------------

#_018D1A: TXA
#_018D1B: CLC
#_018D1C: ADC.w #$000C
#_018D1F: TAX

#_018D20: LDY.b $08

#_018D22: LDA.b $B2
#_018D24: STA.b $0A

#_018D26: JSR RoomDraw_ChestPlatformHorizontalWallWithCorners
#_018D29: LDA.w #$FF80

.looking_for_bottom
#_018D2C: SEC
#_018D2D: SBC.w #$0080

#_018D30: DEC.b $B4
#_018D32: BNE .looking_for_bottom

#_018D34: CLC
#_018D35: ADC.b $08

#_018D37: INC.b $B2
#_018D39: INC.b $B2
#_018D3B: ASL.b $B2

#_018D3D: CLC
#_018D3E: ADC.b $B2
#_018D40: TAY

#_018D41: LDX.w #$0590
#_018D44: JMP.w RoomDraw_Object_2x2_rightwards

;===================================================================================================

RoomDraw_ChestPlatformHorizontalWallWithCorners:
#_018D47: JSR RoomDraw_ChestPlatformCorner

.next
#_018D4A: LDA.w #$0002
#_018D4D: JSR RoomDraw_Rightwards1x2_rightwards

#_018D50: TXA
#_018D51: SEC
#_018D52: SBC.w #$000C
#_018D55: TAX

#_018D56: DEC.b $0A
#_018D58: BNE .next

#_018D5A: JMP.w RoomDraw_ChestPlatformCorner_advance_from_A

;===================================================================================================

RoomDraw_Rightwards1x2_1to16_plus2:
#_018D5D: LDA.b $B2
#_018D5F: ASL A
#_018D60: ASL A

#_018D61: ORA.b $B4

#_018D63: ASL A
#_018D64: INC A
#_018D65: STA.b $B2

#_018D67: LDA.w #$0002
#_018D6A: JSR RoomDraw_Rightwards1x2_rightwards

.next_set
#_018D6D: TXA
#_018D6E: SEC
#_018D6F: SBC.w #$0006
#_018D72: TAX

#_018D73: LDA.w #$0001
#_018D76: JSR RoomDraw_Rightwards1x2_rightwards

#_018D79: DEC.b $B2
#_018D7B: BNE .next_set

#_018D7D: LDA.w #$0001

;===================================================================================================

; TODO bad name
RoomDraw_Rightwards1x2_rightwards:
#_018D80: STA.b $0E

.next
#_018D82: LDA.w RoomDrawObjectData+0,X
#_018D85: STA.b [$BF],Y

#_018D87: LDA.w RoomDrawObjectData+2,X
#_018D8A: STA.b [$CB],Y

#_018D8C: LDA.w RoomDrawObjectData+4,X
#_018D8F: STA.b [$D7],Y

#_018D91: TXA
#_018D92: CLC
#_018D93: ADC.w #$0006
#_018D96: TAX

#_018D97: INY
#_018D98: INY

#_018D99: DEC.b $0E
#_018D9B: BNE .next

#_018D9D: RTS

;===================================================================================================

RoomDraw_3x3FloorIn4x4SuperSquare:
#_018D9E: INC.b $B2
#_018DA0: INC.b $B4

.next_super_square
#_018DA2: LDA.b $B2
#_018DA4: STA.b $0A

.next_square
#_018DA6: LDA.w RoomDrawObjectData+0,X
#_018DA9: STA.b [$BF],Y
#_018DAB: STA.b [$C2],Y
#_018DAD: STA.b [$C5],Y
#_018DAF: STA.b [$CB],Y
#_018DB1: STA.b [$CE],Y
#_018DB3: STA.b [$D1],Y

#_018DB5: TYA
#_018DB6: CLC
#_018DB7: ADC.w #$0100
#_018DBA: TAY

#_018DBB: LDA.w RoomDrawObjectData+0,X
#_018DBE: STA.b [$BF],Y
#_018DC0: STA.b [$C2],Y
#_018DC2: STA.b [$C5],Y

#_018DC4: TYA
#_018DC5: SEC
#_018DC6: SBC.w #$00FA
#_018DC9: TAY

#_018DCA: DEC.b $0A
#_018DCC: BNE .next_square

#_018DCE: LDA.b $08
#_018DD0: CLC
#_018DD1: ADC.w #$0180
#_018DD4: STA.b $08

#_018DD6: TAY

#_018DD7: DEC.b $B4
#_018DD9: BNE .next_super_square

#_018DDB: RTS

;===================================================================================================

RoomDraw_BigHole4x4_1to16:
#_018DDC: LDA.w #$0004
#_018DDF: JSR RoomDraw_GetObjectSize_1to16_timesA

#_018DE2: STA.b $B4
#_018DE4: STA.b $0E

#_018DE6: PHY

;---------------------------------------------------------------------------------------------------

.next_pit_square
#_018DE7: JSR RoomDraw_LineOf8x8_use_B2_for_count
#_018DEA: STA.b $0C

#_018DEC: ADC.w #$0080
#_018DEF: STA.b $08

#_018DF1: TAY

#_018DF2: DEC.b $0E
#_018DF4: BNE .next_pit_square

;---------------------------------------------------------------------------------------------------

#_018DF6: PLY
#_018DF7: STY.b $08

#_018DF9: LDA.w #$0002
#_018DFC: STA.b $0E

#_018DFE: LDX.w #$063C

.next_verticals_row
#_018E01: LDA.b $B2
#_018E03: DEC A
#_018E04: DEC A
#_018E05: STA.b $0A

#_018E07: LDA.w RoomDrawObjectData+0,X
#_018E0A: STA.b [$BF],Y

#_018E0C: LDA.w RoomDrawObjectData+2,X

.next_vertical_edge
#_018E0F: STA.b [$C2],Y

#_018E11: INY
#_018E12: INY

#_018E13: DEC.b $0A
#_018E15: BNE .next_vertical_edge

#_018E17: LDA.w RoomDrawObjectData+4,X
#_018E1A: STA.b [$C2],Y

#_018E1C: TXA
#_018E1D: CLC
#_018E1E: ADC.w #$0006
#_018E21: TAX

#_018E22: LDY.b $0C

#_018E24: DEC.b $0E
#_018E26: BNE .next_verticals_row

;---------------------------------------------------------------------------------------------------

#_018E28: LDA.b $08
#_018E2A: CLC
#_018E2B: ADC.w #$0080

#_018E2E: LDY.b $B2
#_018E30: DEY
#_018E31: STY.b $B4

#_018E33: DEC.b $B4

.advance_A
#_018E35: INC A
#_018E36: INC A

#_018E37: DEY
#_018E38: BNE .advance_A

#_018E3A: STA.b $0C

#_018E3C: LDA.w #$0002
#_018E3F: STA.b $0E

#_018E41: LDA.b $08
#_018E43: CLC
#_018E44: ADC.w #$0080
#_018E47: TAY

#_018E48: LDX.w #$0648

;---------------------------------------------------------------------------------------------------

.next_horizontal_row
#_018E4B: LDA.b $B4
#_018E4D: STA.b $0A

.next_horizontal_edge
#_018E4F: LDA.w RoomDrawObjectData+0,X
#_018E52: STA.b [$BF],Y

#_018E54: TYA
#_018E55: CLC
#_018E56: ADC.w #$0080
#_018E59: TAY

#_018E5A: DEC.b $0A
#_018E5C: BNE .next_horizontal_edge

#_018E5E: INX
#_018E5F: INX

#_018E60: LDY.b $0C

#_018E62: DEC.b $0E
#_018E64: BNE .next_horizontal_row

#_018E66: RTS

;===================================================================================================

RoomDraw_DiagonalCeilingTopLeftB:
#_018E67: LDA.w #$0004
#_018E6A: JSR RoomDraw_GetObjectSize_1to16_timesA

.next
#_018E6D: JSR RoomDraw_LineOf8x8_use_B2_for_count
#_018E70: ADC.w #$0080
#_018E73: STA.b $08

#_018E75: TAY

#_018E76: DEC.b $B2
#_018E78: BNE .next

#_018E7A: RTS

;===================================================================================================

RoomDraw_DiagonalCeilingBottomLeftB:
#_018E7B: LDA.w #$0004
#_018E7E: JSR RoomDraw_GetObjectSize_1to16_timesA

#_018E81: INC.b $B4

.next
#_018E83: LDA.b $B4
#_018E85: JSR RoomDraw_LineOf8x8

#_018E88: ADC.w #$0080
#_018E8B: STA.b $08

#_018E8D: TAY

#_018E8E: INC.b $B4

#_018E90: DEC.b $B2
#_018E92: BNE .next

#_018E94: RTS

;===================================================================================================

RoomDraw_DiagonalCeilingTopRightB:
#_018E95: LDA.w #$0004
#_018E98: JSR RoomDraw_GetObjectSize_1to16_timesA

.next
#_018E9B: JSR RoomDraw_LineOf8x8_use_B2_for_count
#_018E9E: ADC.w #$0082
#_018EA1: STA.b $08

#_018EA3: TAY

#_018EA4: DEC.b $B2
#_018EA6: BNE .next

#_018EA8: RTS

;===================================================================================================

RoomDraw_DiagonalCeilingBottomRightB:
#_018EA9: LDA.w #$0004
#_018EAC: JSR RoomDraw_GetObjectSize_1to16_timesA

.next
#_018EAF: JSR RoomDraw_LineOf8x8_use_B2_for_count
#_018EB2: SEC
#_018EB3: SBC.w #$007E
#_018EB6: STA.b $08

#_018EB8: TAY

#_018EB9: DEC.b $B2
#_018EBB: BNE .next

#_018EBD: RTS

;===================================================================================================

RoomDraw_DownwardsHasEdge1x1_1to16_plus23:
#_018EBE: LDA.w #$0015

#_018EC1: BRA RoomDraw_DownwardsHasEdge1x1_1to16

;===================================================================================================

RoomDraw_DownwardsHasEdge1x1_1to16_plus3:
#_018EC3: LDA.w #$0002

;===================================================================================================

RoomDraw_DownwardsHasEdge1x1_1to16:
#_018EC6: JSR RoomDraw_GetObjectSize_1to16_timesA

#_018EC9: LDA.w #$00E3
#_018ECC: JSR RoomDraw_SmallRailCorner

#_018ECF: BCC .next

#_018ED1: LDA.w RoomDrawObjectData+0,X
#_018ED4: STA.b [$BF],Y

.next
#_018ED6: TYA
#_018ED7: CLC
#_018ED8: ADC.w #$0080
#_018EDB: TAY

#_018EDC: LDA.w RoomDrawObjectData+2,X
#_018EDF: STA.b [$BF],Y

#_018EE1: DEC.b $B2
#_018EE3: BNE .next

#_018EE5: LDA.w RoomDrawObjectData+4,X
#_018EE8: STA.b [$CB],Y

#_018EEA: RTS

;===================================================================================================

RoomDraw_RightwardsHasEdge1x1_1to16_plus23:
#_018EEB: LDA.w #$0015

#_018EEE: BRA RoomDraw_RightwardsHasEdge1x1_1to16

;===================================================================================================

RoomDraw_RightwardsHasEdge1x1_1to16_plus3:
#_018EF0: LDA.w #$0002

;===================================================================================================

RoomDraw_RightwardsHasEdge1x1_1to16:
#_018EF3: JSR RoomDraw_GetObjectSize_1to16_timesA

#_018EF6: LDA.w #$00E2
#_018EF9: JSR RoomDraw_SmallRailCorner
#_018EFC: BCC .no_corner_needed

#_018EFE: LDA.w RoomDrawObjectData+0,X
#_018F01: STA.b [$BF],Y

.no_corner_needed
#_018F03: JSR RoomDraw_LineOf8x8_advance_and_use_B2_for_count

#_018F06: LDA.w RoomDrawObjectData+2,X
#_018F09: STA.b [$BF],Y

#_018F0B: RTS

;===================================================================================================

RoomDraw_DownwardsBigRail3x1_1to16plus5:
#_018F0C: JSR RoomDraw_GetObjectSize_1to16
#_018F0F: JSR RoomDraw_Object_2x2_downwards

#_018F12: TXA
#_018F13: CLC
#_018F14: ADC.w #$0008
#_018F17: TAX

.next
#_018F18: LDA.w RoomDrawObjectData+0,X
#_018F1B: STA.b [$BF],Y

#_018F1D: LDA.w RoomDrawObjectData+2,X
#_018F20: STA.b [$C2],Y

#_018F22: TYA
#_018F23: CLC
#_018F24: ADC.w #$0080
#_018F27: TAY

#_018F28: DEC.b $B2
#_018F2A: BNE .next

#_018F2C: INX
#_018F2D: INX
#_018F2E: INX
#_018F2F: INX

;===================================================================================================

RoomDraw_Single2x3Pillar:
#_018F30: LDA.w #$0002
#_018F33: JMP.w RoomDraw_Rightwards1x2_rightwards

;===================================================================================================

RoomDraw_RightwardsBigRail1x3_1to16plus5:
#_018F36: JSR RoomDraw_GetObjectSize_1to16

#_018F39: INC.b $B2

#_018F3B: LDA.w #$0002
#_018F3E: JSR RoomDraw_Rightwards1x2_rightwards

.next
#_018F41: LDA.w RoomDrawObjectData+0,X
#_018F44: STA.b [$BF],Y

#_018F46: LDA.w RoomDrawObjectData+2,X
#_018F49: STA.b [$CB],Y

#_018F4B: LDA.w RoomDrawObjectData+4,X
#_018F4E: STA.b [$D7],Y

#_018F50: INY
#_018F51: INY

#_018F52: DEC.b $B2
#_018F54: BNE .next

#_018F56: INX ; +6
#_018F57: INX
#_018F58: INX
#_018F59: INX
#_018F5A: INX
#_018F5B: INX

#_018F5C: LDA.w #$0002

#_018F5F: JMP.w RoomDraw_Rightwards1x2_rightwards

;===================================================================================================

RoomDraw_RightwardsHasEdge1x1_1to16_plus2:
#_018F62: JSR RoomDraw_GetObjectSize_1to16
#_018F65: LDA.w #$01DB
#_018F68: JSR RoomDraw_SmallRailCorner
#_018F6B: BCC .no_corner_needed

#_018F6D: CMP.w #$01A6
#_018F70: BEQ .no_corner_needed

#_018F72: CMP.w #$01DD
#_018F75: BEQ .no_corner_needed

#_018F77: CMP.w #$01FC
#_018F7A: BEQ .no_corner_needed

#_018F7C: LDA.w RoomDrawObjectData+0,X
#_018F7F: STA.b [$BF],Y

.no_corner_needed
#_018F81: JSR RoomDraw_LineOf8x8_advance_and_use_B2_for_count

#_018F84: LDA.w RoomDrawObjectData+2,X
#_018F87: STA.b [$BF],Y

#_018F89: RTS

;===================================================================================================

RoomDraw_DownwardsEdge1x1_1to16:
#_018F8A: JSR RoomDraw_GetObjectSize_1to16

.next
#_018F8D: LDA.w RoomDrawObjectData+0,X
#_018F90: STA.b [$BF],Y

#_018F92: TYA
#_018F93: CLC
#_018F94: ADC.w #$0080
#_018F97: TAY

#_018F98: DEC.b $B2
#_018F9A: BNE .next

#_018F9C: RTS

;===================================================================================================

RoomDraw_4x4FloorTwoIn4x4SuperSquare:
#_018F9D: LDX.w $0490

#_018FA0: BRA RoomDraw_4x4FloorIn4x4SuperSquare

;===================================================================================================

RoomDraw_4x4FloorOneIn4x4SuperSquare:
#_018FA2: LDX.w $046A

;===================================================================================================

RoomDraw_4x4FloorIn4x4SuperSquare:
#_018FA5: INC.b $B2
#_018FA7: INC.b $B4

.next
#_018FA9: LDA.b $B2
#_018FAB: JSR RoomDraw_A_Many32x32Blocks

#_018FAE: LDA.b $08
#_018FB0: CLC
#_018FB1: ADC.w #$0200
#_018FB4: STA.b $08

#_018FB6: TAY

#_018FB7: DEC.b $B4
#_018FB9: BNE .next

#_018FBB: RTS

;===================================================================================================

RoomDraw_Nothing_D:
#_018FBC: RTS

;===================================================================================================

RoomDraw_RightwardsTopCorners1x2_1to16_plus13:
#_018FBD: LDA.w #$000A
#_018FC0: JSR RoomDraw_GetObjectSize_1to16_timesA

#_018FC3: LDA.w RoomDrawObjectData+0,X
#_018FC6: STA.b $0E

#_018FC8: INX
#_018FC9: INX

#_018FCA: LDA.b [$BF],Y
#_018FCC: AND.w #$03FF
#_018FCF: CMP.w #$00E2
#_018FD2: BEQ .skip_corner

#_018FD4: JSR .draw_corner

.skip_corner
#_018FD7: INX
#_018FD8: INX
#_018FD9: INX
#_018FDA: INX

.next
#_018FDB: LDA.w RoomDrawObjectData+0,X
#_018FDE: STA.b [$BF],Y

#_018FE0: LDA.b $0E
#_018FE2: STA.b [$CB],Y

#_018FE4: INY
#_018FE5: INY

#_018FE6: DEC.b $B2
#_018FE8: BNE .next

#_018FEA: INX
#_018FEB: INX

;---------------------------------------------------------------------------------------------------

.draw_corner
#_018FEC: LDA.w RoomDrawObjectData+0,X
#_018FEF: STA.b [$BF],Y

#_018FF1: LDA.w RoomDrawObjectData+2,X
#_018FF4: STA.b [$C2],Y

#_018FF6: LDA.b $0E
#_018FF8: STA.b [$CB],Y
#_018FFA: STA.b [$CE],Y

#_018FFC: INY
#_018FFD: INY
#_018FFE: INY
#_018FFF: INY

#_019000: RTS

;===================================================================================================

RoomDraw_RightwardsBottomCorners1x2_1to16_plus13:
#_019001: LDA.w #$000A
#_019004: JSR RoomDraw_GetObjectSize_1to16_timesA

#_019007: LDA.w RoomDrawObjectData+0,X
#_01900A: STA.b $0E

#_01900C: INX
#_01900D: INX

#_01900E: LDA.b [$CB],Y
#_019010: AND.w #$03FF
#_019013: CMP.w #$00E2
#_019016: BEQ .skip_corner

#_019018: JSR .draw_corner

.skip_corner
#_01901B: INX
#_01901C: INX
#_01901D: INX
#_01901E: INX

.next
#_01901F: LDA.b $0E
#_019021: STA.b [$BF],Y

#_019023: LDA.w RoomDrawObjectData+0,X
#_019026: STA.b [$CB],Y

#_019028: INY
#_019029: INY

#_01902A: DEC.b $B2
#_01902C: BNE .next

#_01902E: INX
#_01902F: INX

;---------------------------------------------------------------------------------------------------

.draw_corner
#_019030: LDA.b $0E
#_019032: STA.b [$BF],Y
#_019034: STA.b [$C2],Y

#_019036: LDA.w RoomDrawObjectData+0,X
#_019039: STA.b [$CB],Y

#_01903B: LDA.w RoomDrawObjectData+2,X
#_01903E: STA.b [$CE],Y

#_019040: INY
#_019041: INY
#_019042: INY
#_019043: INY

#_019044: RTS

;===================================================================================================

RoomDraw_DownwardsLeftCorners2x1_1to16_plus12:
#_019045: LDA.w #$000A
#_019048: JSR RoomDraw_GetObjectSize_1to16_timesA

#_01904B: LDA.w RoomDrawObjectData+0,X
#_01904E: STA.b $0E

#_019050: INX
#_019051: INX

#_019052: LDA.b [$BF],Y
#_019054: AND.w #$03FF
#_019057: CMP.w #$00E3
#_01905A: BEQ .skip_corner

#_01905C: JSR .draw_corner

.skip_corner
#_01905F: INX
#_019060: INX
#_019061: INX
#_019062: INX

.next
#_019063: LDA.w RoomDrawObjectData+0,X
#_019066: STA.b [$BF],Y

#_019068: LDA.b $0E
#_01906A: STA.b [$C2],Y

#_01906C: TYA
#_01906D: CLC
#_01906E: ADC.w #$0080
#_019071: TAY

#_019072: DEC.b $B2
#_019074: BNE .next

#_019076: INX
#_019077: INX

;---------------------------------------------------------------------------------------------------

.draw_corner
#_019078: LDA.w RoomDrawObjectData+0,X
#_01907B: STA.b [$BF],Y

#_01907D: LDA.w RoomDrawObjectData+2,X
#_019080: STA.b [$CB],Y

#_019082: LDA.b $0E
#_019084: STA.b [$C2],Y
#_019086: STA.b [$CE],Y

#_019088: TYA
#_019089: CLC
#_01908A: ADC.w #$0100
#_01908D: TAY

#_01908E: RTS

;===================================================================================================

RoomDraw_DownwardsRightCorners2x1_1to16_plus12:
#_01908F: LDA.w #$000A
#_019092: JSR RoomDraw_GetObjectSize_1to16_timesA

#_019095: LDA.w RoomDrawObjectData+0,X
#_019098: STA.b $0E

#_01909A: INX
#_01909B: INX

#_01909C: LDA.b [$C2],Y
#_01909E: AND.w #$03FF
#_0190A1: CMP.w #$00E3
#_0190A4: BEQ .skip_corner

#_0190A6: JSR .draw_corner

.skip_corner
#_0190A9: INX
#_0190AA: INX
#_0190AB: INX
#_0190AC: INX

.next
#_0190AD: LDA.b $0E
#_0190AF: STA.b [$BF],Y

#_0190B1: LDA.w RoomDrawObjectData+0,X
#_0190B4: STA.b [$C2],Y

#_0190B6: TYA
#_0190B7: CLC
#_0190B8: ADC.w #$0080
#_0190BB: TAY

#_0190BC: DEC.b $B2
#_0190BE: BNE .next

#_0190C0: INX
#_0190C1: INX

;---------------------------------------------------------------------------------------------------

.draw_corner
#_0190C2: LDA.b $0E
#_0190C4: STA.b [$BF],Y
#_0190C6: STA.b [$CB],Y

#_0190C8: LDA.w RoomDrawObjectData+0,X
#_0190CB: STA.b [$C2],Y

#_0190CD: LDA.w RoomDrawObjectData+2,X
#_0190D0: STA.b [$CE],Y

#_0190D2: TYA
#_0190D3: CLC
#_0190D4: ADC.w #$0100
#_0190D7: TAY

#_0190D8: RTS

;===================================================================================================

RoomDraw_RightwardsEdge1x1_1to16plus7:
#_0190D9: LDA.w #$0008
#_0190DC: JSR RoomDraw_GetObjectSize_1to16_timesA

#_0190DF: JMP.w RoomDraw_LineOf8x8_use_B2_for_count

;===================================================================================================

RoomDraw_DownwardsEdge1x1_1to16plus7:
#_0190E2: LDA.w #$0008
#_0190E5: JSR RoomDraw_GetObjectSize_1to16_timesA

.next
#_0190E8: LDA.w RoomDrawObjectData+0,X
#_0190EB: STA.b [$BF],Y

#_0190ED: TYA
#_0190EE: CLC
#_0190EF: ADC.w #$0080
#_0190F2: TAY

#_0190F3: DEC.b $B2
#_0190F5: BNE .next

#_0190F7: RTS

;===================================================================================================

RoomDraw_Nothing_A:
#_0190F8: RTS

;===================================================================================================

RoomDraw_DownwardsFloor4x4_1to16:
#_0190F9: STX.b $0A

#_0190FB: JSR RoomDraw_GetObjectSize_1to16

.next
#_0190FE: LDX.b $0A
#_019100: JSR RoomDraw_4x4Object

#_019103: LDA.b $08
#_019105: CLC
#_019106: ADC.w #$0200
#_019109: STA.b $08

#_01910B: TAY

#_01910C: DEC.b $B2
#_01910E: BNE .next

#_019110: RTS

;===================================================================================================

RoomDraw_Rightwards4x4_1to16:
#_019111: STX.b $0A

#_019113: JSR RoomDraw_GetObjectSize_1to16

.next
#_019116: LDX.b $0A
#_019118: JSR RoomDraw_4x4Object

#_01911B: DEC.b $B2

#_01911D: BNE .next

#_01911F: RTS

;===================================================================================================

RoomDraw_Downwards1x1Solid_1to16_plus3:
#_019120: LDA.w #$0004
#_019123: JSR RoomDraw_GetObjectSize_1to16_timesA

.next
#_019126: LDA.w RoomDrawObjectData+0,X
#_019129: STA.b [$BF],Y

#_01912B: TYA
#_01912C: CLC
#_01912D: ADC.w #$0080
#_019130: TAY

#_019131: DEC.b $B2
#_019133: BNE .next

#_019135: RTS

;===================================================================================================

RoomDraw_Rightwards1x1Solid_1to16_plus3:
#_019136: LDA.w #$0004
#_019139: JSR RoomDraw_GetObjectSize_1to16_timesA

#_01913C: JMP.w RoomDraw_LineOf8x8_use_B2_for_count

;===================================================================================================
; TODO unused object to examine
RoomDraw_DoorSwitcherer:
#_01913F: STY.w $04B0

#_019142: LDA.b $BF
#_019144: CMP.w #$4000
#_019147: BNE .lower_layer_a

#_019149: TYA
#_01914A: ORA.w #$2000
#_01914D: STA.w $04B0

#_019150: TAY

.lower_layer_a
#_019151: LDA.w $0402
#_019154: AND.w #$1000
#_019157: BEQ .dont_draw

#_019159: STY.b $08

#_01915B: LDY.w #$0052
#_01915E: LDY.b $08

#_019160: LDA.w #$0003
#_019163: STA.b $0E

#_019165: JSR DrawUnusedDoorSwitchObject

#_019168: LDY.w #$0052

#_01916B: LDA.b $08
#_01916D: CLC
#_01916E: ADC.w #$000A

#_019171: LDY.b $BF
#_019173: CPY.w #$4000
#_019176: BNE .lower_layer_b

#_019178: CLC
#_019179: ADC.w #$0004

;---------------------------------------------------------------------------------------------------

.lower_layer_b
#_01917C: LDA.w #$0003
#_01917F: STA.b $0E

#_019181: JSR RoomDraw_DrawUnreachableDoorSwitcher

#_019184: RTS

;---------------------------------------------------------------------------------------------------

.dont_draw
#_019185: LDA.w $04B0
#_019188: ORA.w #$8000
#_01918B: STA.w $04B0

#_01918E: RTS

;===================================================================================================

RoomDraw_Nothing_E:
#_01918F: RTS

;===================================================================================================

RoomDraw_MovingWallWest:
#_019190: JSR RoomDraw_CheckIfWallIsMoved
#_019193: BCS .continue

#_019195: RTS

;---------------------------------------------------------------------------------------------------

.continue
#_019196: INC.w $0428

#_019199: LDA.b $B2
#_01919B: ASL A
#_01919C: TAY

#_01919D: LDA.w RoomDraw_MovingWallDirection,Y
#_0191A0: PHA

#_0191A1: ASL A
#_0191A2: ADC.w #$0004
#_0191A5: STA.b $0E

#_0191A7: LDA.b $B4
#_0191A9: ASL A
#_0191AA: STA.w $041E

#_0191AD: TAY

#_0191AE: LDA.w MovingWallObjectCount,Y
#_0191B1: STA.b $0C

#_0191B3: TAY

#_0191B4: LDA.b $08

.adjust_A
#_0191B6: DEC A
#_0191B7: DEC A

#_0191B8: DEY
#_0191B9: BNE .adjust_A

#_0191BB: PHA

#_0191BC: STA.b $06

#_0191BE: LDX.w #$03D8

;---------------------------------------------------------------------------------------------------

.next_row
#_0191C1: LDA.b $0E
#_0191C3: STA.b $0A

#_0191C5: LDY.b $06

#_0191C7: LDA.w RoomDrawObjectData+0,X
#_0191CA: STA.b [$BF],Y

.next_fill
#_0191CC: LDA.w RoomDrawObjectData+2,X
#_0191CF: STA.b [$CB],Y

#_0191D1: TYA
#_0191D2: CLC
#_0191D3: ADC.w #$0080
#_0191D6: TAY

#_0191D7: DEC.b $0A
#_0191D9: BNE .next_fill

#_0191DB: LDA.w RoomDrawObjectData+4,X
#_0191DE: STA.b [$CB],Y

#_0191E0: INC.b $06
#_0191E2: INC.b $06

#_0191E4: DEC.b $0C
#_0191E6: BNE .next_row

;---------------------------------------------------------------------------------------------------

#_0191E8: PLA
#_0191E9: DEC A
#_0191EA: DEC A
#_0191EB: STA.b $06

#_0191ED: TAY

#_0191EE: JSR MovingWall_FillReplacementBuffer

#_0191F1: LDY.b $08
#_0191F3: LDX.w #$072A

#_0191F6: JSR RoomDraw_ChestPlatformCorner

#_0191F9: PLA
#_0191FA: STA.b $0E

#_0191FC: LDA.b $08
#_0191FE: CLC
#_0191FF: ADC.w #$0180
#_019202: TAY

.next_vertical
#_019203: JSR RoomDraw_ChestPlatformVerticalWall

#_019206: TYA
#_019207: CLC
#_019208: ADC.w #$0100
#_01920B: TAY

#_01920C: DEC.b $0E
#_01920E: BNE .next_vertical

;===================================================================================================

RoomDraw_ChestPlatformCorner_advance_from_X:
#_019210: TXA

;===================================================================================================

RoomDraw_ChestPlatformCorner_advance_from_A:
#_019211: CLC
#_019212: ADC.w #$000C
#_019215: TAX

;===================================================================================================

RoomDraw_ChestPlatformCorner:
#_019216: LDA.w #$0003

#_019219: JMP.w RoomDraw_Rightwards1x2_rightwards

;===================================================================================================

RoomDraw_MovingWallEast:
#_01921C: JSR RoomDraw_CheckIfWallIsMoved
#_01921F: BCS .continue

#_019221: RTS

;---------------------------------------------------------------------------------------------------

.continue
#_019222: INC.w $0428

#_019225: LDY.b $08

#_019227: LDX.w #$075A
#_01922A: JSR RoomDraw_ChestPlatformCorner

#_01922D: LDA.b $B2
#_01922F: ASL A
#_019230: TAY

#_019231: LDA.w RoomDraw_MovingWallDirection,Y
#_019234: STA.b $0E

#_019236: PHA

#_019237: LDA.b $08
#_019239: CLC
#_01923A: ADC.w #$0180
#_01923D: TAY

.next_vertical
#_01923E: JSR RoomDraw_ChestPlatformVerticalWall

#_019241: TYA
#_019242: CLC
#_019243: ADC.w #$0100
#_019246: TAY

#_019247: DEC.b $0E
#_019249: BNE .next_vertical

;---------------------------------------------------------------------------------------------------

#_01924B: JSR RoomDraw_ChestPlatformCorner_advance_from_X

#_01924E: PLA
#_01924F: ASL A
#_019250: ADC.w #$0004
#_019253: STA.b $0E

#_019255: LDA.b $B4
#_019257: ASL A
#_019258: STA.w $041E

#_01925B: TAY

#_01925C: LDA.w MovingWallObjectCount,Y
#_01925F: STA.b $0C

#_019261: LDA.b $08
#_019263: CLC
#_019264: ADC.w #$0006
#_019267: STA.b $06

;---------------------------------------------------------------------------------------------------

#_019269: LDX.w #$03D8

.next_row
#_01926C: LDA.b $0E
#_01926E: STA.b $0A

#_019270: LDY.b $06

#_019272: LDA.w RoomDrawObjectData+0,X
#_019275: STA.b [$BF],Y

.next_horizontal
#_019277: LDA.w RoomDrawObjectData+2,X
#_01927A: STA.b [$CB],Y

#_01927C: TYA
#_01927D: CLC
#_01927E: ADC.w #$0080
#_019281: TAY

#_019282: DEC.b $0A
#_019284: BNE .next_horizontal

#_019286: LDA.w RoomDrawObjectData+4,X
#_019289: STA.b [$CB],Y

#_01928B: INC.b $06
#_01928D: INC.b $06

#_01928F: DEC.b $0C
#_019291: BNE .next_row

#_019293: LDY.b $06

#_019295: JMP.w MovingWall_FillReplacementBuffer

;===================================================================================================

RoomDraw_CheckIfWallIsMoved:
#_019298: STZ.w $041C
#_01929B: STZ.w $041A

#_01929E: SEP #$30

#_0192A0: LDX.b #$00
#_0192A2: TXY

#_0192A3: LDA.b $AE
#_0192A5: CMP.b #$1C
#_0192A7: BCC .not_moving_wall_tag

#_0192A9: CMP.b #$20
#_0192AB: BCC .has_moving_wall_tag

.not_moving_wall_tag
#_0192AD: LDY.b #$02
#_0192AF: INX

#_0192B0: LDA.b $AF
#_0192B2: CMP.b #$1C
#_0192B4: BCC .draw_wall

#_0192B6: CMP.b #$20
#_0192B8: BCS .draw_wall

.has_moving_wall_tag
#_0192BA: LDA.w $0403
#_0192BD: AND.w DoorFlagMasks-1,Y
#_0192C0: BEQ .draw_wall

#_0192C2: STZ.w $046C

#_0192C5: STZ.b $AE,X

#_0192C7: STZ.w $0414

#_0192CA: REP #$31

#_0192CC: RTS

.draw_wall
#_0192CD: REP #$30
#_0192CF: SEC

#_0192D0: RTS

;===================================================================================================

MovingWall_FillReplacementBuffer:
#_0192D1: LDX.w #$007E

#_0192D4: LDA.w #$01EC

.set_next
#_0192D7: STA.l $7EC880,X

#_0192DB: DEX
#_0192DC: DEX
#_0192DD: BPL .set_next

;---------------------------------------------------------------------------------------------------

#_0192DF: LDA.b $06
#_0192E1: AND.w #$003F
#_0192E4: LSR A
#_0192E5: STA.b $0A

#_0192E7: TYA
#_0192E8: AND.w #$0040
#_0192EB: BEQ .upper_layer

#_0192ED: LDA.w #$0400
#_0192F0: TSB.b $0A

.upper_layer
#_0192F2: LDA.b $0A
#_0192F4: ORA.w #$1000
#_0192F7: STA.w $042A

#_0192FA: RTS

;===================================================================================================

RoomDraw_RightwardsDecor4x4spaced2_1to16:
#_0192FB: JSR RoomDraw_GetObjectSize_1to16
#_0192FE: STX.b $0A

.next
#_019300: LDX.b $0A
#_019302: JSR RoomDraw_4x4Object

#_019305: INY
#_019306: INY
#_019307: INY
#_019308: INY

#_019309: DEC.b $B2
#_01930B: BNE .next

#_01930D: RTS

;===================================================================================================

RoomDraw_DownwardsDecor4x4spaced2_1to16:
#_01930E: JSR RoomDraw_GetObjectSize_1to16
#_019311: STX.b $0A

.next
#_019313: LDX.b $0A
#_019315: JSR RoomDraw_4x4Object

#_019318: TYA
#_019319: CLC
#_01931A: ADC.w #$02F8
#_01931D: TAY

#_01931E: DEC.b $B2
#_019320: BNE .next

#_019322: RTS

;===================================================================================================

RoomDraw_RightwardsStatue2x3spaced2_1to16:
#_019323: JSR RoomDraw_GetObjectSize_1to16

.next
#_019326: LDX.w #$0E26

#_019329: LDA.w #$0002
#_01932C: JSR RoomDraw_Rightwards1x2_rightwards

#_01932F: INY
#_019330: INY
#_019331: INY
#_019332: INY

#_019333: DEC.b $B2
#_019335: BNE .next

#_019337: RTS

;===================================================================================================

RoomDraw_RightwardsBlock2x2spaced2_1to16:
#_019338: JSR RoomDraw_GetObjectSize_1to16

.next
#_01933B: JSR RoomDraw_Object_2x2_rightwards

#_01933E: INY
#_01933F: INY
#_019340: INY
#_019341: INY

#_019342: DEC.b $B2
#_019344: BNE .next

#_019346: RTS

;===================================================================================================

RoomDraw_DownwardsBlock2x2spaced2_1to16:
#_019347: JSR RoomDraw_GetObjectSize_1to16

.next
#_01934A: JSR RoomDraw_Object_2x2_downwards
#_01934D: CLC
#_01934E: ADC.w #$0100
#_019351: TAY

#_019352: DEC.b $B2
#_019354: BNE .next

#_019356: RTS

;===================================================================================================

RoomDraw_DownwardsPillar2x4spaced2_1to16:
#_019357: JSR RoomDraw_GetObjectSize_1to16
#_01935A: STX.b $0C

.next
#_01935C: LDX.b $0C

#_01935E: LDA.w #$0002
#_019361: JSR RoomDraw_Object_4xN

#_019364: TYA
#_019365: CLC
#_019366: ADC.w #$02FC
#_019369: TAY

#_01936A: DEC.b $B2
#_01936C: BNE .next

#_01936E: RTS

;===================================================================================================

RoomDraw_RightwardsPillar2x4spaced4_1to16:
#_01936F: JSR RoomDraw_GetObjectSize_1to16

#_019372: STX.b $0C

.next
#_019374: LDX.b $0C

#_019376: LDA.w #$0002
#_019379: JSR RoomDraw_Object_4xN

#_01937C: TYA
#_01937D: CLC
#_01937E: ADC.w #$0008
#_019381: TAY

#_019382: DEC.b $B2
#_019384: BNE .next

#_019386: RTS

;===================================================================================================

RoomDraw_RightwardsDecor4x3spaced4_1to16:
#_019387: STX.b $0A

#_019389: JSR RoomDraw_GetObjectSize_1to16

.next
#_01938C: LDX.b $0A

#_01938E: LDA.w #$0004
#_019391: JSR RoomDraw_Rightwards1x2_rightwards

#_019394: TYA
#_019395: CLC
#_019396: ADC.w #$0008
#_019399: TAY

#_01939A: DEC.b $B2
#_01939C: BNE .next

#_01939E: RTS

;===================================================================================================

RoomDraw_DownwardsDecor4x4spaced4_1to16:
#_01939F: STX.b $0A

#_0193A1: JSR RoomDraw_GetObjectSize_1to16

.next
#_0193A4: LDX.b $0A

#_0193A6: LDA.w #$0003
#_0193A9: JSR RoomDraw_Object_4xN

#_0193AC: TYA
#_0193AD: CLC
#_0193AE: ADC.w #$03FA
#_0193B1: TAY

#_0193B2: DEC.b $B2
#_0193B4: BNE .next

#_0193B6: RTS

;===================================================================================================

RoomDraw_RightwardsDoubled2x2spaced2_1to16:
#_0193B7: JSR RoomDraw_GetObjectSize_1to16

.next
#_0193BA: LDX.w #$08CA

#_0193BD: JSR RoomDraw_Object_2x2_downwards

#_0193C0: CLC
#_0193C1: ADC.w #$0200
#_0193C4: TAY

#_0193C5: TXA
#_0193C6: CLC
#_0193C7: ADC.w #$0008
#_0193CA: TAX

#_0193CB: JSR RoomDraw_Object_2x2_downwards

#_0193CE: LDA.b $08
#_0193D0: CLC
#_0193D1: ADC.w #$0008
#_0193D4: STA.b $08

#_0193D6: TAY

#_0193D7: DEC.b $B2
#_0193D9: BNE .next

#_0193DB: RTS

;===================================================================================================

RoomDraw_TableRock4x4_1to16:
#_0193DC: INC.b $B2

#_0193DE: ASL.b $B4
#_0193E0: INC.b $B4

#_0193E2: JSR .draw_rock_segment

#_0193E5: INX ; +8
#_0193E6: INX
#_0193E7: INX
#_0193E8: INX
#_0193E9: INX
#_0193EA: INX
#_0193EB: INX
#_0193EC: INX

;---------------------------------------------------------------------------------------------------

.next_rock
#_0193ED: JSR .draw_rock_segment

#_0193F0: DEC.b $B4
#_0193F2: BNE .next_rock

#_0193F4: JSR .draw_rock_segment_with_advance

;---------------------------------------------------------------------------------------------------

.draw_rock_segment_with_advance
#_0193F7: INX ; +8
#_0193F8: INX
#_0193F9: INX
#_0193FA: INX
#_0193FB: INX
#_0193FC: INX
#_0193FD: INX
#_0193FE: INX

;---------------------------------------------------------------------------------------------------

.draw_rock_segment
#_0193FF: LDA.b $B2
#_019401: STA.b $0E

#_019403: LDA.w RoomDrawObjectData+0,X
#_019406: STA.b [$BF],Y

.next_rock_sub
#_019408: LDA.w RoomDrawObjectData+2,X
#_01940B: STA.b [$C2],Y

#_01940D: LDA.w RoomDrawObjectData+4,X
#_019410: STA.b [$C5],Y

#_019412: INY
#_019413: INY
#_019414: INY
#_019415: INY

#_019416: DEC.b $0E
#_019418: BNE .next_rock_sub

;---------------------------------------------------------------------------------------------------

#_01941A: LDA.w RoomDrawObjectData+6,X
#_01941D: STA.b [$C2],Y

#_01941F: LDA.b $08
#_019421: CLC
#_019422: ADC.w #$0080
#_019425: STA.b $08

#_019427: TAY

#_019428: RTS

;===================================================================================================

RoomDraw_Spike2x2In4x4SuperSquare:
#_019429: INC.b $B2
#_01942B: INC.b $B4

.next_super
#_01942D: LDA.b $B2
#_01942F: STA.b $0E

.next
#_019431: JSR RoomDraw_Object_2x2_rightwards

#_019434: DEC.b $0E
#_019436: BNE .next

#_019438: LDA.b $08
#_01943A: CLC
#_01943B: ADC.w #$0100
#_01943E: STA.b $08

#_019440: TAY

#_019441: DEC.b $B4
#_019443: BNE .next_super

#_019445: RTS

;===================================================================================================

RoomDraw_DownwardsDecor2x2spaced12_1to16:
#_019446: JSR RoomDraw_GetObjectSize_1to16

.next
#_019449: JSR RoomDraw_Object_2x2_downwards

#_01944C: CLC
#_01944D: ADC.w #$0600
#_019450: TAY

#_019451: DEC.b $B2
#_019453: BNE .next

#_019455: RTS

;===================================================================================================

RoomDraw_RightwardsDecor2x2spaced12_1to16:
#_019456: JSR RoomDraw_GetObjectSize_1to16

.next
#_019459: JSR RoomDraw_Object_2x2_downwards

#_01945C: CLC
#_01945D: ADC.w #$FF1C
#_019460: TAY

#_019461: DEC.b $B2
#_019463: BNE .next

#_019465: RTS

;===================================================================================================

RoomDraw_Waterfall47:
#_019466: JSR RoomDraw_GetObjectSize_1to16

#_019469: ASL.b $B2

#_01946B: JSR RoomDraw_DrawObject2x2and1

#_01946E: TXA
#_01946F: CLC
#_019470: ADC.w #$000A
#_019473: TAX

#_019474: INY
#_019475: INY

.next
#_019476: JSR RoomDraw_DrawObject2x2and1

#_019479: INY
#_01947A: INY

#_01947B: DEC.b $B2
#_01947D: BNE .next

#_01947F: TXA
#_019480: CLC
#_019481: ADC.w #$000A
#_019484: TAX

#_019485: JMP.w RoomDraw_DrawObject2x2and1

;===================================================================================================

RoomDraw_Waterfall48:
#_019488: JSR RoomDraw_GetObjectSize_1to16

#_01948B: ASL.b $B2

#_01948D: LDA.w #$0001
#_019490: JSR RoomDraw_Rightwards1x2_rightwards

.next
#_019493: LDA.w RoomDrawObjectData+0,X
#_019496: STA.b [$BF],Y

#_019498: LDA.w RoomDrawObjectData+2,X
#_01949B: STA.b [$CB],Y

#_01949D: LDA.w RoomDrawObjectData+4,X
#_0194A0: STA.b [$D7],Y

#_0194A2: INY
#_0194A3: INY

#_0194A4: DEC.b $B2
#_0194A6: BNE .next

;---------------------------------------------------------------------------------------------------

#_0194A8: INX ; +6
#_0194A9: INX
#_0194AA: INX
#_0194AB: INX
#_0194AC: INX
#_0194AD: INX

#_0194AE: LDA.w #$0001
#_0194B1: JMP.w RoomDraw_Rightwards1x2_rightwards

;===================================================================================================

RoomDraw_RightwardsFloorTile4x2_1to16:
#_0194B4: JSR RoomDraw_GetObjectSize_1to16

#_0194B7: LDA.w #$0008
#_0194BA: JMP.w RoomDraw_Downwards4x2VariableSpacing

;===================================================================================================

RoomDraw_RightwardsBar4x3_1to16:
#_0194BD: JSR RoomDraw_GetObjectSize_1to16

#_0194C0: ASL.b $B2

#_0194C2: JSR RoomDraw_RightwardBarSegment

#_0194C5: INY
#_0194C6: INY

#_0194C7: TXA
#_0194C8: CLC
#_0194C9: ADC.w #$0006
#_0194CC: TAX

;---------------------------------------------------------------------------------------------------

.next
#_0194CD: JSR RoomDraw_RightwardBarSegment

#_0194D0: INY
#_0194D1: INY
#_0194D2: DEC.b $B2

#_0194D4: BNE .next

#_0194D6: TXA
#_0194D7: CLC
#_0194D8: ADC.w #$0006
#_0194DB: TAX

#_0194DC: JMP.w RoomDraw_RightwardBarSegment

;===================================================================================================

RoomDraw_RightwardsShelf4x4_1to16:
#_0194DF: JSR RoomDraw_GetObjectSize_1to16

#_0194E2: LDA.w #$0001
#_0194E5: JSR RoomDraw_Object_4xN

.next
#_0194E8: LDA.w #$0002
#_0194EB: JSR RoomDraw_Object_4xN

#_0194EE: TXA
#_0194EF: SEC
#_0194F0: SBC.w #$0010
#_0194F3: TAX

#_0194F4: DEC.b $B2
#_0194F6: BNE .next

#_0194F8: TXA
#_0194F9: CLC
#_0194FA: ADC.w #$0010
#_0194FD: TAX

#_0194FE: JMP.w RoomDraw_RightwardShelfEnd

;===================================================================================================

RoomDraw_WaterOverlayA8x8_1to16:
#_019501: LDA.b $B2
#_019503: ASL A
#_019504: TAX

#_019505: LDA.w WaterOverlayHDMAPositionOffset,X
#_019508: STA.b $B2

#_01950A: LDA.w WaterOverlayHDMASize,X
#_01950D: STA.w $0686

#_019510: LDA.b $B4
#_019512: ASL A
#_019513: TAX

#_019514: LDA.w WaterOverlayHDMAPositionOffset,X
#_019517: STA.b $B4

#_019519: LDA.w WaterOverlayHDMASize,X
#_01951C: STA.w $0684

#_01951F: SEC
#_019520: SBC.w #$0018
#_019523: STA.w $0688

#_019526: TYA
#_019527: AND.w #$007E
#_01952A: ASL A
#_01952B: ASL A
#_01952C: STA.w $0680

;---------------------------------------------------------------------------------------------------

#_01952F: LDA.b $B2
#_019531: ASL A
#_019532: ASL A
#_019533: ASL A
#_019534: ASL A

#_019535: CLC
#_019536: ADC.w $062C

#_019539: CLC
#_01953A: ADC.w $0680
#_01953D: STA.w $0680

#_019540: TYA
#_019541: AND.w #$1F80
#_019544: LSR A
#_019545: LSR A
#_019546: LSR A
#_019547: LSR A
#_019548: STA.w $0682

#_01954B: LDA.b $B4
#_01954D: ASL A
#_01954E: ASL A
#_01954F: ASL A
#_019550: ASL A

#_019551: CLC
#_019552: ADC.w $062E

#_019555: CLC
#_019556: ADC.w $0682
#_019559: STA.w $0682

;---------------------------------------------------------------------------------------------------

#_01955C: SEP #$30

#_01955E: LDA.w $0403
#_019561: AND.w DoorFlagMasks+1
#_019564: BEQ RoomDraw_NoWater

#_019566: STZ.b $AF

#_019568: STZ.w $0414

#_01956B: REP #$30

#_01956D: LDA.w $0442
#_019570: STA.w $0440

#_019573: LDA.w $0444
#_019576: STA.w $0448

#_019579: STZ.w $0444
#_01957C: STZ.w $0442

#_01957F: LDA.w $04AE
#_019582: STA.w $049E

#_019585: STZ.w $04AE

#_019588: LDA.b $B2
#_01958A: DEC A
#_01958B: ASL A
#_01958C: ASL A
#_01958D: STA.b $0E

#_01958F: LDA.b $08
#_019591: ADC.b $0E
#_019593: STA.b $08

#_019595: LDA.b $B4
#_019597: DEC A
#_019598: XBA
#_019599: STA.b $0E

#_01959B: LDA.b $08
#_01959D: ADC.b $0E
#_01959F: TAX

;===================================================================================================

#RoomTag_WaterOff_AdjustWater:
#_0195A0: LDY.w #$1438

#_0195A3: LDA.w #$0004
#_0195A6: STA.b $0E

.next_floor
#_0195A8: LDA.w RoomDrawObjectData+0,Y
#_0195AB: STA.l $7E2000,X

#_0195AF: LDA.w RoomDrawObjectData+2,Y
#_0195B2: STA.l $7E2002,X

#_0195B6: LDA.w RoomDrawObjectData+4,Y
#_0195B9: STA.l $7E2004,X

#_0195BD: LDA.w RoomDrawObjectData+6,Y
#_0195C0: STA.l $7E2006,X

#_0195C4: TYA
#_0195C5: CLC
#_0195C6: ADC.w #$0008
#_0195C9: TAY

#_0195CA: TXA
#_0195CB: CLC
#_0195CC: ADC.w #$0080
#_0195CF: TAX

#_0195D0: DEC.b $0E
#_0195D2: BNE .next_floor

#_0195D4: RTS

;===================================================================================================

RoomDraw_NoWater:
#_0195D5: REP #$30

#_0195D7: LDX.w #$0110
#_0195DA: LDY.b $08

.next_chunk
#_0195DC: LDA.b $B2
#_0195DE: JSR RoomDraw_A_Many32x32Blocks

#_0195E1: LDA.b $08
#_0195E3: CLC
#_0195E4: ADC.w #$0200
#_0195E7: STA.b $08

#_0195E9: TAY

#_0195EA: DEC.b $B4
#_0195EC: BNE .next_chunk

#_0195EE: RTS

;===================================================================================================

RoomDraw_WaterOverlayB8x8_1to16:
#_0195EF: LDA.b $B2
#_0195F1: ASL A
#_0195F2: TAX

#_0195F3: LDA.w WaterOverlayHDMAPositionOffset,X
#_0195F6: STA.b $B2

#_0195F8: LDA.w WaterOverlayHDMASize,X
#_0195FB: SEC
#_0195FC: SBC.w #$0018
#_0195FF: STA.w $0686

#_019602: LDA.b $B4
#_019604: ASL A
#_019605: TAX

#_019606: LDA.w WaterOverlayHDMAPositionOffset,X
#_019609: STA.b $B4

#_01960B: LDA.w WaterOverlayHDMASize,X
#_01960E: SEC
#_01960F: SBC.w #$0008
#_019612: STA.w $0688

#_019615: SEC
#_019616: SBC.w #$0018
#_019619: STA.w $0684

#_01961C: STZ.w $068A

;---------------------------------------------------------------------------------------------------

#_01961F: TYA
#_019620: AND.w #$007E
#_019623: ASL A
#_019624: ASL A
#_019625: STA.w $0680

#_019628: LDA.b $B2
#_01962A: ASL A ; x16
#_01962B: ASL A
#_01962C: ASL A
#_01962D: ASL A

#_01962E: CLC
#_01962F: ADC.w $062C

#_019632: CLC
#_019633: ADC.w $0680
#_019636: STA.w $0680

#_019639: TYA
#_01963A: AND.w #$1F80
#_01963D: LSR A ; /16
#_01963E: LSR A
#_01963F: LSR A
#_019640: LSR A
#_019641: STA.w $0682

#_019644: LDA.b $B4
#_019646: ASL A ; x16
#_019647: ASL A
#_019648: ASL A
#_019649: ASL A

#_01964A: CLC
#_01964B: ADC.w $062E

#_01964E: CLC
#_01964F: ADC.w $0682

#_019652: SEC
#_019653: SBC.w #$0008
#_019656: STA.w $0682

;---------------------------------------------------------------------------------------------------

#_019659: SEP #$30

#_01965B: LDA.w $0403
#_01965E: AND.w DoorFlagMasks+1
#_019661: BEQ .not_drained_or_maybe_not_filled

#_019663: STZ.b $AF

#_019665: BRA .continue

;---------------------------------------------------------------------------------------------------
; TODO
.not_drained_or_maybe_not_filled
#_019667: REP #$30

#_019669: LDA.w $0442
#_01966C: STA.w $0440

#_01966F: LDA.w $0444
#_019672: STA.w $0448

#_019675: STZ.w $0444
#_019678: STZ.w $0442

#_01967B: LDA.w $04AE
#_01967E: STA.w $049E

#_019681: STZ.w $04AE
#_019684: STZ.w $0414

;---------------------------------------------------------------------------------------------------

.continue
#_019687: REP #$30

#_019689: LDA.b $B4
#_01968B: ASL A
#_01968C: TAX

#_01968D: LDA.w WaterOverlayObjectCount,X
#_019690: STA.b $04

#_019692: LDX.w #$0110

;---------------------------------------------------------------------------------------------------

.next_chunk
#_019695: LDY.b $08

#_019697: LDA.b $B2
#_019699: STA.b $0A

.next_tile
#_01969B: LDA.w RoomDrawObjectData+0,X
#_01969E: STA.b [$BF],Y

#_0196A0: LDA.w RoomDrawObjectData+2,X
#_0196A3: STA.b [$C2],Y

#_0196A5: LDA.w RoomDrawObjectData+4,X
#_0196A8: STA.b [$C5],Y

#_0196AA: LDA.w RoomDrawObjectData+6,X
#_0196AD: STA.b [$C8],Y

#_0196AF: LDA.w RoomDrawObjectData+8,X
#_0196B2: STA.b [$CB],Y

#_0196B4: LDA.w RoomDrawObjectData+10,X
#_0196B7: STA.b [$CE],Y

#_0196B9: LDA.w RoomDrawObjectData+12,X
#_0196BC: STA.b [$D1],Y

#_0196BE: LDA.w RoomDrawObjectData+14,X
#_0196C1: STA.b [$D4],Y

#_0196C3: INY ; +8
#_0196C4: INY
#_0196C5: INY
#_0196C6: INY
#_0196C7: INY
#_0196C8: INY
#_0196C9: INY
#_0196CA: INY

#_0196CB: DEC.b $0A
#_0196CD: BNE .next_tile

#_0196CF: LDA.b $08
#_0196D1: CLC
#_0196D2: ADC.w #$0100
#_0196D5: STA.b $08

#_0196D7: DEC.b $04
#_0196D9: BNE .next_chunk

#_0196DB: RTS

;===================================================================================================


RoomDraw_RightwardsLine1x1_1to16plus1:
#_0196DC: JSR RoomDraw_GetObjectSize_1to16

#_0196DF: INC.b $B2

#_0196E1: JMP.w RoomDraw_LineOf8x8_use_B2_for_count

;===================================================================================================

RoomDraw_DownwardsLine1x1_1to16plus1:
#_0196E4: JSR RoomDraw_GetObjectSize_1to16

#_0196E7: INC.b $B2

.next
#_0196E9: LDA.w RoomDrawObjectData+0,X
#_0196EC: STA.b [$BF],Y

#_0196EE: TYA
#_0196EF: CLC
#_0196F0: ADC.w #$0080
#_0196F3: TAY

#_0196F4: DEC.b $B2
#_0196F6: BNE .next

#_0196F8: RTS

;===================================================================================================

RoomDraw_RightwardsDecor4x2spaced8_1to16:
#_0196F9: JSR RoomDraw_GetObjectSize_1to16

#_0196FC: LDA.w #$0018
#_0196FF: JMP.w RoomDraw_Downwards4x2VariableSpacing

;===================================================================================================

RoomDraw_DownwardsDecor2x4spaced8_1to16:
#_019702: STX.b $0A

#_019704: JSR RoomDraw_GetObjectSize_1to16

.next
#_019707: LDX.b $0A

#_019709: LDA.w #$0002
#_01970C: JSR RoomDraw_Object_4xN

#_01970F: TYA
#_019710: CLC
#_019711: ADC.w #$05FC
#_019714: TAY

#_019715: DEC.b $B2
#_019717: BNE .next

#_019719: RTS

;===================================================================================================

RoomDraw_Nothing_C:
#_01971A: RTS

;===================================================================================================

RoomDraw_DownwardsDecor2x4spaced2_1to16:
#_01971B: STX.b $0A

#_01971D: JSR RoomDraw_GetObjectSize_1to16

.next
#_019720: LDX.b $0A

#_019722: LDA.w #$0003
#_019725: JSR RoomDraw_Object_4xN

#_019728: TYA
#_019729: CLC
#_01972A: ADC.w #$02FA
#_01972D: TAY

#_01972E: DEC.b $B2
#_019730: BNE .next

#_019732: RTS

;===================================================================================================

RoomDraw_OpenChestPlatform:
#_019733: LDA.b $BF
#_019735: CMP.w #$4000
#_019738: BNE .lower_layer

#_01973A: TYA
#_01973B: ORA.w #$2000
#_01973E: TAY

.lower_layer
#_01973F: TYX

#_019740: LDY.w #$0AB4

#_019743: INC.b $B2

#_019745: LDA.b $B4
#_019747: ASL A
#_019748: CLC
#_019749: ADC.w #$0005
#_01974C: STA.b $B4

;---------------------------------------------------------------------------------------------------

.next_segment
#_01974E: JSR .draw_segment

#_019751: DEC.b $B4
#_019753: BNE .next_segment

#_019755: INY
#_019756: INY

#_019757: JSR .draw_segment

#_01975A: INY
#_01975B: INY

;---------------------------------------------------------------------------------------------------

.draw_segment
#_01975C: PHX

#_01975D: LDA.b $B2
#_01975F: STA.b $0A

;---------------------------------------------------------------------------------------------------

#_019761: LDA.w RoomDrawObjectData+0,Y
#_019764: STA.l $7E2000,X

#_019768: LDA.w RoomDrawObjectData+6,Y

.next_fill_a
#_01976B: STA.l $7E2002,X

#_01976F: INX
#_019770: INX

#_019771: DEC.b $0A
#_019773: BNE .next_fill_a

;---------------------------------------------------------------------------------------------------

#_019775: LDA.w RoomDrawObjectData+12,Y
#_019778: STA.l $7E2002,X

#_01977C: LDA.w RoomDrawObjectData+18,Y
#_01977F: STA.l $7E2004,X
#_019783: STA.l $7E2006,X
#_019787: STA.l $7E2008,X
#_01978B: STA.l $7E200A,X

#_01978F: LDA.b $B2
#_019791: STA.b $0A

#_019793: LDA.w RoomDrawObjectData+24,Y
#_019796: STA.l $7E200C,X

;---------------------------------------------------------------------------------------------------

#_01979A: LDA.w RoomDrawObjectData+30,Y

.next_fill_b
#_01979D: STA.l $7E200E,X

#_0197A1: INX
#_0197A2: INX

#_0197A3: DEC.b $0A
#_0197A5: BNE .next_fill_b

;---------------------------------------------------------------------------------------------------

#_0197A7: LDA.w RoomDrawObjectData+36,Y
#_0197AA: STA.l $7E200E,X

#_0197AE: PLA
#_0197AF: CLC
#_0197B0: ADC.w #$0080
#_0197B3: TAX

#_0197B4: RTS

;===================================================================================================

RoomDraw_DownwardsBar2x5_1to16:
#_0197B5: LDA.w #$0002
#_0197B8: JSR RoomDraw_GetObjectSize_1to16_timesA

#_0197BB: ASL.b $B2

#_0197BD: LDA.w RoomDrawObjectData+0,X
#_0197C0: STA.b [$BF],Y

#_0197C2: LDA.w RoomDrawObjectData+2,X
#_0197C5: STA.b [$C2],Y

.next
#_0197C7: LDA.w RoomDrawObjectData+4,X
#_0197CA: STA.b [$CB],Y

#_0197CC: LDA.w RoomDrawObjectData+6,X
#_0197CF: STA.b [$CE],Y

#_0197D1: TYA
#_0197D2: CLC
#_0197D3: ADC.w #$0080
#_0197D6: TAY

#_0197D7: DEC.b $B2
#_0197D9: BNE .next

#_0197DB: RTS

;===================================================================================================

RoomDraw_Weird2x4_1_to_16:
#_0197DC: JSR RoomDraw_GetObjectSize_1to16

.next
#_0197DF: LDX.w #$0B16
#_0197E2: LDA.w #$0002
#_0197E5: JSR RoomDraw_Object_4xN

#_0197E8: DEC.b $B2
#_0197EA: BNE .next

#_0197EC: RTS

;===================================================================================================

RoomDraw_4x4Object:
#_0197ED: LDA.w #$0004

;===================================================================================================

RoomDraw_Object_4xN:
#_0197F0: STA.b $0E

.next
#_0197F2: LDA.w RoomDrawObjectData+0,X
#_0197F5: STA.b [$BF],Y

#_0197F7: LDA.w RoomDrawObjectData+2,X
#_0197FA: STA.b [$CB],Y

#_0197FC: LDA.w RoomDrawObjectData+4,X
#_0197FF: STA.b [$D7],Y

#_019801: LDA.w RoomDrawObjectData+6,X
#_019804: STA.b [$DA],Y

#_019806: TXA
#_019807: CLC
#_019808: ADC.w #$0008
#_01980B: TAX

#_01980C: INY
#_01980D: INY

#_01980E: DEC.b $0E
#_019810: BNE .next

#_019812: RTS

;===================================================================================================

RoomDraw_4x4Corner_BothBG:
#_019813: TXA
#_019814: TYX
#_019815: TAY

#_019816: LDA.w #$0004

;---------------------------------------------------------------------------------------------------

.set_count
#_019819: STA.b $0E

.next
#_01981B: LDA.w RoomDrawObjectData+0,Y
#_01981E: STA.l $7E4000,X
#_019822: STA.l $7E2000,X

#_019826: LDA.w RoomDrawObjectData+2,Y
#_019829: STA.l $7E4080,X
#_01982D: STA.l $7E2080,X

#_019831: LDA.w RoomDrawObjectData+4,Y
#_019834: STA.l $7E4100,X
#_019838: STA.l $7E2100,X

#_01983C: LDA.w RoomDrawObjectData+6,Y
#_01983F: STA.l $7E4180,X
#_019843: STA.l $7E2180,X

#_019847: TYA
#_019848: CLC
#_019849: ADC.w #$0008
#_01984C: TAY

#_01984D: INX
#_01984E: INX

#_01984F: DEC.b $0E
#_019851: BNE .next

#_019853: RTS

;===================================================================================================

RoomDraw_WeirdCornerBottom_BothBG:
#_019854: TXA
#_019855: TYX
#_019856: TAY

#_019857: LDA.w #$0003
#_01985A: BRA RoomDraw_4x4Corner_BothBG_set_count

;===================================================================================================

RoomDraw_WeirdCornerTop_BothBG:
#_01985C: TXA
#_01985D: TYX
#_01985E: TAY

#_01985F: LDA.w #$0004
#_019862: STA.b $0E

.next
#_019864: LDA.w RoomDrawObjectData+0,Y
#_019867: STA.l $7E4000,X
#_01986B: STA.l $7E2000,X

#_01986F: LDA.w RoomDrawObjectData+2,Y
#_019872: STA.l $7E4080,X
#_019876: STA.l $7E2080,X

#_01987A: LDA.w RoomDrawObjectData+4,Y
#_01987D: STA.l $7E4100,X
#_019881: STA.l $7E2100,X

#_019885: TYA
#_019886: CLC
#_019887: ADC.w #$0006
#_01988A: TAY

#_01988B: INX
#_01988C: INX

#_01988D: DEC.b $0E
#_01988F: BNE .next

#_019891: RTS

;===================================================================================================

RoomDraw_LitTorch:
#_019892: INC.w $045A

;===================================================================================================

RoomDraw_Object_2x2_rightwards:
#_019895: LDA.w RoomDrawObjectData+0,X
#_019898: STA.b [$BF],Y

#_01989A: LDA.w RoomDrawObjectData+2,X
#_01989D: STA.b [$CB],Y

#_01989F: LDA.w RoomDrawObjectData+4,X
#_0198A2: STA.b [$C2],Y

#_0198A4: LDA.w RoomDrawObjectData+6,X
#_0198A7: STA.b [$CE],Y

#_0198A9: INY
#_0198AA: INY
#_0198AB: INY
#_0198AC: INY

#_0198AD: RTS

;===================================================================================================

RoomDraw_BigKeyLock:
#_0198AE: LDX.w $0498

#_0198B1: TYA
#_0198B2: STA.w $06E0,X

#_0198B5: LDA.w $0402
#_0198B8: AND.w RoomFlagMask,X
#_0198BB: BNE .lock_opened

#_0198BD: INX
#_0198BE: INX
#_0198BF: STX.w $0498

#_0198C2: LDX.w #$1494
#_0198C5: BRA RoomDraw_Object_2x2_rightwards

.lock_opened
#_0198C7: STZ.w $06E0,X

#_0198CA: INX
#_0198CB: INX
#_0198CC: STX.w $0498

;---------------------------------------------------------------------------------------------------

#EXIT_0198CF:
#_0198CF: RTS

;===================================================================================================

RoomDraw_Chest:
#_0198D0: LDA.b $10
#_0198D2: AND.w #$00FF
#_0198D5: CMP.w #$001A
#_0198D8: BEQ EXIT_0198CF

#_0198DA: LDX.w $0496

#_0198DD: TYA
#_0198DE: STA.w $06E0,X

#_0198E1: LDA.b $BF
#_0198E3: CMP.w #$4000
#_0198E6: BNE .lower_layer

#_0198E8: TYA
#_0198E9: ORA.w #$2000
#_0198EC: STA.w $06E0,X

.lower_layer
#_0198EF: LDA.w $0402
#_0198F2: AND.w RoomFlagMask,X
#_0198F5: BNE RoomDraw_Chest_opened

#_0198F7: INX
#_0198F8: INX
#_0198F9: STX.w $0496
#_0198FC: STX.w $0498

#_0198FF: LDY.w #$FF00
#_019902: LDX.w #$0000

;---------------------------------------------------------------------------------------------------

#_019905: LDA.b $AE
#_019907: AND.w #$00FF
#_01990A: CMP.w #$0027
#_01990D: BEQ .tag_1_invisible

#_01990F: CMP.w #$003C
#_019912: BEQ .tag_1_invisible

#_019914: CMP.w #$003E
#_019917: BEQ .tag_1_invisible

#_019919: CMP.w #$0029
#_01991C: BCC .tag_1_not_invisible

#_01991E: CMP.w #$0033
#_019921: BCC .tag_1_invisible

;---------------------------------------------------------------------------------------------------

.tag_1_not_invisible
#_019923: LDA.b $AF
#_019925: AND.w #$00FF
#_019928: CMP.w #$0027
#_01992B: BEQ .tag_2_invisible

#_01992D: CMP.w #$003C
#_019930: BEQ .tag_2_invisible

#_019932: CMP.w #$003E
#_019935: BEQ .tag_2_invisible

#_019937: CMP.w #$0029
#_01993A: BCC .tag_2_not_invisible

#_01993C: CMP.w #$0033
#_01993F: BCS .tag_2_not_invisible

.tag_2_invisible
#_019941: LDY.w #$00FF

#_019944: INX
#_019945: INX

;---------------------------------------------------------------------------------------------------

.tag_1_invisible
#_019946: LDA.w $0402
#_019949: AND.l RoomFlagMask,X
#_01994D: BEQ EXIT_0198CF

#_01994F: TYA
#_019950: AND.b $AE
#_019952: STA.b $AE

.tag_2_not_invisible
#_019954: LDY.b $08
#_019956: LDX.w #$149C

#_019959: JMP.w RoomDraw_Object_2x2_rightwards

;===================================================================================================

RoomDraw_Chest_opened:
#_01995C: STZ.w $06E0,X

#_01995F: INX
#_019960: INX
#_019961: STX.w $0496
#_019964: STX.w $0498

#_019967: LDY.w #$FF00
#_01996A: LDX.w #$0000

;---------------------------------------------------------------------------------------------------

#_01996D: LDA.b $AE
#_01996F: AND.w #$00FF
#_019972: CMP.w #$0027
#_019975: BEQ .tag_1_invisible

#_019977: CMP.w #$003C
#_01997A: BEQ .tag_1_invisible

#_01997C: CMP.w #$003E
#_01997F: BEQ .tag_1_invisible

#_019981: CMP.w #$0029
#_019984: BCC .tag_1_not_invisible

#_019986: CMP.w #$0033
#_019989: BCC .tag_1_invisible

;---------------------------------------------------------------------------------------------------

.tag_1_not_invisible
#_01998B: LDA.b $AF
#_01998D: AND.w #$00FF
#_019990: CMP.w #$0027
#_019993: BEQ .tag_2_invisible

#_019995: CMP.w #$003C
#_019998: BEQ .tag_2_invisible

#_01999A: CMP.w #$003E
#_01999D: BEQ .tag_2_invisible

#_01999F: CMP.w #$0029
#_0199A2: BCC .tag_2_not_invisible

#_0199A4: CMP.w #$0033
#_0199A7: BCS .tag_2_not_invisible

.tag_2_invisible
#_0199A9: LDY.w #$00FF
#_0199AC: INX
#_0199AD: INX

.tag_1_invisible
#_0199AE: TYA
#_0199AF: AND.b $AE
#_0199B1: STA.b $AE

.tag_2_not_invisible
#_0199B3: LDY.b $08
#_0199B5: LDX.w #$14A4

;===================================================================================================

RoomDraw_OpenChest:
#_0199B8: JMP.w RoomDraw_Object_2x2_rightwards

;===================================================================================================

RoomDraw_BigChest:
#_0199BB: LDX.w $0496

#_0199BE: TYA
#_0199BF: ORA.w #$8000
#_0199C2: STA.w $06E0,X

#_0199C5: LDA.b $BF
#_0199C7: CMP.w #$4000
#_0199CA: BNE .lower_layer

#_0199CC: TYA
#_0199CD: ORA.w #$A000
#_0199D0: STA.w $06E0,X

.lower_layer
#_0199D3: LDA.w $0402
#_0199D6: AND.w RoomFlagMask,X
#_0199D9: BNE RoomDraw_BigChest_opened

#_0199DB: INX
#_0199DC: INX
#_0199DD: STX.w $0496
#_0199E0: STX.w $0498

#_0199E3: LDX.w #$14AC

;===================================================================================================

RoomDraw_TableRock2x3:
#_0199E6: LDA.w #$0004
#_0199E9: JMP.w RoomDraw_Rightwards1x2_rightwards

;===================================================================================================

RoomDraw_SolidWallDecor3x4:
#_0199EC: LDA.w #$0003
#_0199EF: JMP.w RoomDraw_Object_4xN

;===================================================================================================

RoomDraw_BigChest_opened:
#_0199F2: STZ.w $06E0,X

#_0199F5: INX
#_0199F6: INX
#_0199F7: STX.w $0496
#_0199FA: STX.w $0498

#_0199FD: LDX.w #$14C4

;===================================================================================================

RoomDraw_OpenBigChest:
#_019A00: LDA.w #$0004
#_019A03: JMP.w RoomDraw_Rightwards1x2_rightwards

;===================================================================================================

RoomDraw_BigWallDecor:
#_019A06: LDA.w #$0008
#_019A09: JMP.w RoomDraw_Rightwards1x2_rightwards

;===================================================================================================

RoomDraw_Utility6x3:
#_019A0C: LDA.w #$0006
#_019A0F: JMP.w RoomDraw_Rightwards1x2_rightwards

;===================================================================================================

RoomDraw_MagicBatAltar:
#_019A12: TXY

#_019A13: LDA.b $BF
#_019A15: CMP.w #$4000
#_019A18: BNE .lower_layer

#_019A1A: LDA.b $08
#_019A1C: ORA.w #$2000
#_019A1F: STA.b $08

.lower_layer
#_019A21: LDX.b $08

#_019A23: LDA.w #$0008
#_019A26: STA.b $0E

;---------------------------------------------------------------------------------------------------

.next
#_019A28: LDA.w RoomDrawObjectData+0,Y
#_019A2B: STA.l $7E2000,X

#_019A2F: LDA.w RoomDrawObjectData+2,Y
#_019A32: STA.l $7E2080,X

#_019A36: LDA.w RoomDrawObjectData+4,Y
#_019A39: STA.l $7E2100,X

#_019A3D: LDA.w RoomDrawObjectData+6,Y
#_019A40: STA.l $7E2180,X

#_019A44: LDA.w RoomDrawObjectData+8,Y
#_019A47: STA.l $7E2200,X

#_019A4B: LDA.w RoomDrawObjectData+10,Y
#_019A4E: STA.l $7E2280,X

#_019A52: LDA.w RoomDrawObjectData+12,Y
#_019A55: STA.l $7E2300,X

#_019A59: TYA
#_019A5A: CLC
#_019A5B: ADC.w #$000E
#_019A5E: TAY

#_019A5F: INX
#_019A60: INX

#_019A61: DEC.b $0E
#_019A63: BNE .next

#_019A65: RTS

;===================================================================================================

RoomDraw_SmithyFurnace:
#_019A66: LDY.w #$1F92
#_019A69: LDA.w #$0006
#_019A6C: JMP.w RoomDraw_SomeBigDecors

;===================================================================================================

RoomDraw_EnabledStarSwitch:
#_019A6F: PHX

#_019A70: LDX.w $0432

#_019A73: TYA
#_019A74: LSR A
#_019A75: STA.w $06A0,X

#_019A78: LDA.b $BF
#_019A7A: CMP.w #$4000
#_019A7D: BNE .lower_layer

#_019A7F: TYA
#_019A80: ORA.w #$2000
#_019A83: LSR A
#_019A84: STA.w $06A0,X

.lower_layer
#_019A87: INX
#_019A88: INX
#_019A89: STX.w $0432

#_019A8C: PLX

;===================================================================================================

RoomDraw_Single2x2:
#_019A8D: JMP.w RoomDraw_Object_2x2_downwards

;===================================================================================================

RoomDraw_VerticalTurtleRockPipe:
#_019A90: LDA.w #$0004
#_019A93: JSR RoomDraw_Rightwards1x2_rightwards

#_019A96: LDA.b $08
#_019A98: CLC
#_019A99: ADC.w #$0180
#_019A9C: TAY

#_019A9D: LDA.w #$0004
#_019AA0: JMP.w RoomDraw_Rightwards1x2_rightwards

;===================================================================================================

RoomDraw_HorizontalTurtleRockPipe:
#_019AA3: LDA.w #$0006
#_019AA6: JMP.w RoomDraw_Object_4xN

;===================================================================================================

RoomDraw_RupeeFloor:
#_019AA9: LDA.w $0402
#_019AAC: AND.w #$1000
#_019AAF: BNE .exit

#_019AB1: LDA.w #$0003
#_019AB4: STA.b $0E

#_019AB6: LDY.w #$1DD6
#_019AB9: LDX.b $08

; Lower layer?
#_019ABB: LDA.b $BF
#_019ABD: CMP.w #$4000
#_019AC0: BNE .next

#_019AC2: TXA
#_019AC3: ORA.w #$2000
#_019AC6: TAX

.next
#_019AC7: LDA.w RoomDrawObjectData+0,Y
#_019ACA: STA.l $7E2000,X
#_019ACE: STA.l $7E2180,X
#_019AD2: STA.l $7E2300,X

#_019AD6: LDA.w RoomDrawObjectData+2,Y
#_019AD9: STA.l $7E2080,X
#_019ADD: STA.l $7E2200,X
#_019AE1: STA.l $7E2380,X

#_019AE5: INX ; +4
#_019AE6: INX
#_019AE7: INX
#_019AE8: INX

#_019AE9: DEC.b $0E
#_019AEB: BNE .next

.exit
#_019AED: RTS

;===================================================================================================

RoomDraw_Bed2x5:
#_019AEE: LDA.w #$0005
#_019AF1: STA.b $0E

.next
#_019AF3: LDA.w RoomDrawObjectData+0,X
#_019AF6: STA.b [$BF],Y

#_019AF8: LDA.w RoomDrawObjectData+2,X
#_019AFB: STA.b [$C2],Y

#_019AFD: LDA.w RoomDrawObjectData+4,X
#_019B00: STA.b [$C5],Y

#_019B02: LDA.w RoomDrawObjectData+6,X
#_019B05: STA.b [$C8],Y

#_019B07: TXA
#_019B08: CLC
#_019B09: ADC.w #$0008
#_019B0C: TAX

#_019B0D: TYA
#_019B0E: CLC
#_019B0F: ADC.w #$0080
#_019B12: TAY

#_019B13: DEC.b $0E
#_019B15: BNE .next

#_019B17: RTS

;===================================================================================================

UNREACHABLE_019B18:
#_019B18: LDA.w #$0002
#_019B1B: JMP.w RoomDraw_Object_4xN

;===================================================================================================

RoomDraw_WaterHopStairs_A:
#_019B1E: LDA.b $AF
#_019B20: AND.w #$00FF
#_019B23: CMP.w #$001B
#_019B26: BNE .continue

#_019B28: LDA.b $A0
#_019B2A: ASL A
#_019B2B: TAX

#_019B2C: LDA.l $7EF000,X
#_019B30: AND.w #$0100
#_019B33: BNE .continue

#_019B35: JMP.w RoomDraw_WaterHopStairs_B

;---------------------------------------------------------------------------------------------------

.continue
#_019B38: LDX.w $0444

#_019B3B: TYA
#_019B3C: LSR A
#_019B3D: STA.w $06B8,X

#_019B40: INX
#_019B41: INX
#_019B42: STX.w $0444

#_019B45: LDX.w #$1108

;===================================================================================================

RoomDraw_PortraitOfMario:
#_019B48: LDA.w #$0001
#_019B4B: STA.b $B2

#_019B4D: JMP.w RoomDraw_Downwards4x2VariableSpacing

;===================================================================================================

RoomDraw_DrawRightwards3x6:
#_019B50: LDA.w #$0006
#_019B53: JMP.w RoomDraw_Rightwards1x2_rightwards

;===================================================================================================

RoomDraw_SanctuaryWall:
#_019B56: TXY

#_019B57: LDX.b $08
#_019B59: LDA.w #$0006

#_019B5C: STA.b $0E

.next
#_019B5E: LDA.w RoomDrawObjectData+0,Y
#_019B61: STA.l $7E2000,X
#_019B65: STA.l $7E2008,X
#_019B69: STA.l $7E2010,X
#_019B6D: STA.l $7E201C,X
#_019B71: STA.l $7E2024,X
#_019B75: STA.l $7E202C,X

#_019B79: ORA.w #$4000
#_019B7C: STA.l $7E2002,X
#_019B80: STA.l $7E200A,X
#_019B84: STA.l $7E2012,X
#_019B88: STA.l $7E201E,X
#_019B8C: STA.l $7E2026,X
#_019B90: STA.l $7E202E,X

#_019B94: LDA.w RoomDrawObjectData+12,Y
#_019B97: STA.l $7E2004,X
#_019B9B: STA.l $7E200C,X
#_019B9F: STA.l $7E2020,X
#_019BA3: STA.l $7E2028,X

#_019BA7: ORA.w #$4000
#_019BAA: STA.l $7E2006,X
#_019BAE: STA.l $7E200E,X
#_019BB2: STA.l $7E2022,X
#_019BB6: STA.l $7E202A,X

#_019BBA: INY
#_019BBB: INY

#_019BBC: TXA
#_019BBD: CLC
#_019BBE: ADC.w #$0080
#_019BC1: TAX

#_019BC2: DEC.b $0E
#_019BC4: BNE .next

;---------------------------------------------------------------------------------------------------

#_019BC6: TYA
#_019BC7: CLC
#_019BC8: ADC.w #$000C
#_019BCB: TAX

#_019BCC: LDA.b $08
#_019BCE: CLC
#_019BCF: ADC.w #$0014
#_019BD2: TAY

#_019BD3: LDA.w #$0004
#_019BD6: JMP.w RoomDraw_Rightwards1x2_rightwards

;===================================================================================================

RoomDraw_ChestPlatformVerticalWall:
#_019BD9: LDA.w RoomDrawObjectData+0,X
#_019BDC: STA.b [$BF],Y

#_019BDE: LDA.w RoomDrawObjectData+2,X
#_019BE1: STA.b [$C2],Y

#_019BE3: LDA.w RoomDrawObjectData+4,X
#_019BE6: STA.b [$C5],Y

#_019BE8: LDA.w RoomDrawObjectData+6,X
#_019BEB: STA.b [$CB],Y

#_019BED: LDA.w RoomDrawObjectData+8,X
#_019BF0: STA.b [$CE],Y

#_019BF2: LDA.w RoomDrawObjectData+10,X
#_019BF5: STA.b [$D1],Y

#_019BF7: RTS

;===================================================================================================

RoomDraw_DamFloodGate:
#_019BF8: LDA.w $0402
#_019BFB: AND.w #$0800
#_019BFE: BNE .draw_water

#_019C00: LDA.w #$000A
#_019C03: JSR RoomDraw_Object_4xN

#_019C06: LDA.w #$000F
#_019C09: STA.w $0470

#_019C0C: LDA.b $08
#_019C0E: STA.w $0472

#_019C11: RTS

;---------------------------------------------------------------------------------------------------

.draw_water
#_019C12: LDX.w #$13E8
#_019C15: LDA.w #$000A
#_019C18: JSR RoomDraw_Object_4xN

#_019C1B: LDA.b $B7
#_019C1D: PHA

#_019C1E: LDA.b $B8
#_019C20: PHA

#_019C21: LDA.b $BA
#_019C23: PHA

#_019C24: LDA.w #WaterOverlayData>>16
#_019C27: STA.b $B9

#_019C29: LDA.w #WaterOverlayData>>0
#_019C2C: JSR RoomTag_OperateWaterFlooring

#_019C2F: REP #$30

#_019C31: PLA
#_019C32: STA.b $BA

#_019C34: PLA
#_019C35: STA.b $B8

#_019C37: PLA
#_019C38: STA.b $B7

#_019C3A: RTS

;===================================================================================================

RoomDraw_SomariaLine_increment_count:
#_019C3B: INC.w $03F4

;===================================================================================================

RoomDraw_SomariaLine:
#_019C3E: LDA.w RoomDrawObjectData+0,X
#_019C41: STA.b [$BF],Y

#_019C43: RTS

;===================================================================================================

RoomDraw_PrisonCell:
#_019C44: TYX

#_019C45: LDA.b $BF
#_019C47: CMP.w #$4000
#_019C4A: BNE .lower_layer

#_019C4C: TXA
#_019C4D: ORA.w #$2000
#_019C50: TAX

.lower_layer
#_019C51: PHX

#_019C52: LDY.w #$1488

#_019C55: LDA.w #$0005
#_019C58: STA.b $0C

;---------------------------------------------------------------------------------------------------

.next
#_019C5A: LDA.w RoomDrawObjectData+2,Y
#_019C5D: STA.l $7E2004,X
#_019C61: STA.l $7E2012,X

#_019C65: LDA.w RoomDrawObjectData+4,Y
#_019C68: STA.l $7E2084,X

#_019C6C: ORA.w #$4000
#_019C6F: STA.l $7E2092,X

#_019C73: LDA.w RoomDrawObjectData+8,Y
#_019C76: STA.l $7E2104,X

#_019C7A: ORA.w #$4000
#_019C7D: STA.l $7E2112,X

#_019C81: LDA.w RoomDrawObjectData+10,Y
#_019C84: STA.l $7E2184,X

#_019C88: ORA.w #$4000
#_019C8B: STA.l $7E2192,X

#_019C8F: INX
#_019C90: INX

#_019C91: DEC.b $0C
#_019C93: BNE .next

;---------------------------------------------------------------------------------------------------

#_019C95: PLX

#_019C96: LDA.w RoomDrawObjectData+0,Y
#_019C99: STA.l $7E2000,X

#_019C9D: ORA.w #$4000
#_019CA0: STA.l $7E201E,X

#_019CA4: LDA.w RoomDrawObjectData+2,Y
#_019CA7: STA.l $7E2002,X
#_019CAB: STA.l $7E200E,X
#_019CAF: STA.l $7E2010,X
#_019CB3: STA.l $7E201C,X

#_019CB7: LDA.w RoomDrawObjectData+6,Y
#_019CBA: STA.l $7E2102,X

#_019CBE: ORA.w #$4000
#_019CC1: STA.l $7E211C,X

#_019CC5: RTS

;===================================================================================================

RoomDraw_RightwardsCannonHole4x3_1to16:
#_019CC6: JSR RoomDraw_GetObjectSize_1to16

#_019CC9: LDA.w #$0002
#_019CCC: JSR RoomDraw_Rightwards1x2_rightwards

#_019CCF: DEC.b $B2
#_019CD1: BEQ .skip

.next
#_019CD3: PHX

#_019CD4: LDA.w #$0002
#_019CD7: JSR RoomDraw_Rightwards1x2_rightwards

#_019CDA: PLX

#_019CDB: DEC.b $B2
#_019CDD: BNE .next

;---------------------------------------------------------------------------------------------------

.skip
#_019CDF: TXA
#_019CE0: CLC
#_019CE1: ADC.w #$000C
#_019CE4: TAX

#_019CE5: LDA.w #$0002
#_019CE8: JMP.w RoomDraw_Rightwards1x2_rightwards

;===================================================================================================

RoomDraw_DownwardsCannonHole3x4_1to16:
#_019CEB: JSR RoomDraw_GetObjectSize_1to16
#_019CEE: JSR .draw_segment

#_019CF1: DEC.b $B2
#_019CF3: BEQ .skip

.next_segment
#_019CF5: PHX

#_019CF6: JSR .draw_segment

#_019CF9: PLX

#_019CFA: DEC.b $B2
#_019CFC: BNE .next_segment

.skip
#_019CFE: TXA
#_019CFF: CLC
#_019D00: ADC.w #$000C
#_019D03: TAX

;---------------------------------------------------------------------------------------------------

.draw_segment
#_019D04: LDA.w #$0002
#_019D07: STA.b $0A

.next_segment_part
#_019D09: LDA.w RoomDrawObjectData+0,X
#_019D0C: STA.b [$BF],Y

#_019D0E: LDA.w RoomDrawObjectData+2,X
#_019D11: STA.b [$C2],Y

#_019D13: LDA.w RoomDrawObjectData+4,X
#_019D16: STA.b [$C5],Y

#_019D18: INX ; +6
#_019D19: INX
#_019D1A: INX
#_019D1B: INX
#_019D1C: INX
#_019D1D: INX

#_019D1E: TYA
#_019D1F: CLC
#_019D20: ADC.w #$0080
#_019D23: TAY

#_019D24: DEC.b $0A
#_019D26: BNE .next_segment_part

#_019D28: RTS

;===================================================================================================

RoomDraw_EmptyWaterFace:
#_019D29: LDA.b $AF
#_019D2B: AND.w #$00FF
#_019D2E: CMP.w #$001B
#_019D31: BNE .no_water_tag

#_019D33: LDA.b $A0
#_019D35: ASL A
#_019D36: TAX

#_019D37: LDA.l $7EF000,X
#_019D3B: AND.w #$0100
#_019D3E: BNE RoomDraw_SpittingWaterFace

#_019D40: LDX.w #$1614

;---------------------------------------------------------------------------------------------------

.no_water_tag
#_019D43: SEP #$20

#_019D45: LDA.b #$19
#_019D47: CMP.b $AF
#_019D49: BNE .still_no_water_tag

#_019D4B: LDA.w $0403
#_019D4E: AND.w DoorFlagMasks+1
#_019D51: BNE RoomDraw_SpittingWaterFace

.still_no_water_tag
#_019D53: REP #$20

#_019D55: STY.w $047C

#_019D58: LDA.w #$0003
#_019D5B: BRA RoomDraw_WaterHoldingObject

;===================================================================================================

RoomDraw_SpittingWaterFace:
#_019D5D: REP #$20

#_019D5F: LDX.w #$162C
#_019D62: LDA.w #$0005

#_019D65: BRA RoomDraw_WaterHoldingObject

;===================================================================================================

RoomDraw_DrenchingWaterFace:
#_019D67: LDA.w #$0007

#_019D6A: BRA RoomDraw_WaterHoldingObject

;===================================================================================================
; Bowls can hold water!
;===================================================================================================
RoomDraw_TableBowl:
#_019D6C: LDA.w #$0002

;===================================================================================================

RoomDraw_WaterHoldingObject:
#_019D6F: STA.b $0E

.next
#_019D71: LDA.w RoomDrawObjectData+0,X
#_019D74: STA.b [$BF],Y

#_019D76: LDA.w RoomDrawObjectData+2,X
#_019D79: STA.b [$C2],Y

#_019D7B: LDA.w RoomDrawObjectData+4,X
#_019D7E: STA.b [$C5],Y

#_019D80: LDA.w RoomDrawObjectData+6,X
#_019D83: STA.b [$C8],Y

#_019D85: TXA
#_019D86: CLC
#_019D87: ADC.w #$0008
#_019D8A: TAX

#_019D8B: TYA
#_019D8C: CLC
#_019D8D: ADC.w #$0080
#_019D90: TAY

#_019D91: DEC.b $0E
#_019D93: BNE .next

#_019D95: RTS

;===================================================================================================

RoomDraw_KholdstareShell:
#_019D96: LDA.w $0402
#_019D99: ASL A
#_019D9A: BCS EXIT_019DD8

#_019D9C: LDY.w #$1DFA
#_019D9F: LDA.w #$000A

;===================================================================================================

RoomDraw_SomeBigDecors:
#_019DA2: STA.b $0A

#_019DA4: LDA.b $BF
#_019DA6: CMP.w #$4000
#_019DA9: BNE .lower_layer

#_019DAB: LDA.b $08
#_019DAD: ORA.w #$2000
#_019DB0: STA.b $08

.lower_layer
#_019DB2: LDA.w #$0008
#_019DB5: STA.b $0C

;---------------------------------------------------------------------------------------------------

.next_super
#_019DB7: LDA.b $0A
#_019DB9: STA.b $0E

#_019DBB: LDX.b $08

.next
#_019DBD: LDA.w RoomDrawObjectData+0,Y
#_019DC0: STA.l $7E2000,X

#_019DC4: INY
#_019DC5: INY

#_019DC6: INX
#_019DC7: INX

#_019DC8: DEC.b $0E
#_019DCA: BNE .next

#_019DCC: LDA.b $08
#_019DCE: CLC
#_019DCF: ADC.w #$0080
#_019DD2: STA.b $08

#_019DD4: DEC.b $0C
#_019DD6: BNE .next_super

;---------------------------------------------------------------------------------------------------

#EXIT_019DD8:
#_019DD8: RTS

;===================================================================================================

RoomDraw_TrinexxShell:
#_019DD9: LDA.w $0402
#_019DDC: ASL A
#_019DDD: BCS EXIT_019DD8

#_019DDF: TXY

#_019DE0: LDA.w #$000A
#_019DE3: BRA RoomDraw_SomeBigDecors

;===================================================================================================

RoomDraw_LampCones:
#_019DE5: LDY.w #$16DC
#_019DE8: LDA.w #$0514
#_019DEB: JSR RoomDraw_SingleLampCone

#_019DEE: LDY.w #$17F6
#_019DF1: LDA.w #$0554
#_019DF4: JSR RoomDraw_SingleLampCone

#_019DF7: LDY.w #$1914
#_019DFA: LDA.w #$1514
#_019DFD: JSR RoomDraw_SingleLampCone

#_019E00: LDY.w #$1A2A
#_019E03: LDA.w #$1554

;===================================================================================================

RoomDraw_SingleLampCone:
#_019E06: STA.b $00

#_019E08: LDA.w #$000C
#_019E0B: STA.b $02

.next_super
#_019E0D: LDA.w #$000C
#_019E10: STA.b $0C

#_019E12: LDX.b $00

.next
#_019E14: LDA.w RoomDrawObjectData+0,Y
#_019E17: STA.l $7E4000,X

#_019E1B: INY
#_019E1C: INY

#_019E1D: INX
#_019E1E: INX

#_019E1F: DEC.b $0C
#_019E21: BNE .next

#_019E23: LDA.b $00
#_019E25: CLC
#_019E26: ADC.w #$0080
#_019E29: STA.b $00

#_019E2B: DEC.b $02
#_019E2D: BNE .next_super

#_019E2F: RTS

;===================================================================================================

RoomDraw_AgahnimsAltar:
#_019E30: LDA.w #$000E
#_019E33: STA.b $0E

#_019E35: LDY.w #$1B4A
#_019E38: LDX.b $08

.next
#_019E3A: LDA.w RoomDrawObjectData+0,Y
#_019E3D: STA.l $7E2000,X

#_019E41: ORA.w #$4000
#_019E44: STA.l $7E201A,X

#_019E48: LDA.w RoomDrawObjectData+28,Y
#_019E4B: STA.l $7E2002,X
#_019E4F: STA.l $7E2004,X

#_019E53: EOR.w #$4000
#_019E56: STA.l $7E2016,X
#_019E5A: STA.l $7E2018,X

#_019E5E: LDA.w RoomDrawObjectData+56,Y
#_019E61: STA.l $7E2006,X

#_019E65: EOR.w #$4000
#_019E68: STA.l $7E2014,X

#_019E6C: LDA.w RoomDrawObjectData+84,Y
#_019E6F: STA.l $7E2008,X

#_019E73: EOR.w #$4000
#_019E76: STA.l $7E2012,X

#_019E7A: LDA.w RoomDrawObjectData+112,Y
#_019E7D: STA.l $7E200A,X

#_019E81: EOR.w #$4000
#_019E84: STA.l $7E2010,X

#_019E88: LDA.w RoomDrawObjectData+140,Y
#_019E8B: STA.l $7E200C,X

#_019E8F: EOR.w #$4000
#_019E92: STA.l $7E200E,X

#_019E96: TXA
#_019E97: CLC
#_019E98: ADC.w #$0080
#_019E9B: TAX

#_019E9C: INY
#_019E9D: INY

#_019E9E: DEC.b $0E
#_019EA0: BNE .next

#_019EA2: RTS

;===================================================================================================

RoomDraw_AgahnimsWindows:
#_019EA3: LDA.w #$0006
#_019EA6: STA.b $0E

#_019EA8: LDY.w #$1BF2
#_019EAB: LDX.b $08

.next_a
#_019EAD: LDA.w RoomDrawObjectData+0,Y
#_019EB0: STA.l $7E220E,X
#_019EB4: STA.l $7E221A,X
#_019EB8: STA.l $7E2226,X

#_019EBC: LDA.w RoomDrawObjectData+2,Y
#_019EBF: STA.l $7E228E,X
#_019EC3: STA.l $7E229A,X
#_019EC7: STA.l $7E22A6,X

#_019ECB: LDA.w RoomDrawObjectData+4,Y
#_019ECE: STA.l $7E230E,X
#_019ED2: STA.l $7E231A,X
#_019ED6: STA.l $7E2326,X

#_019EDA: LDA.w RoomDrawObjectData+6,Y
#_019EDD: STA.l $7E238E,X
#_019EE1: STA.l $7E239A,X
#_019EE5: STA.l $7E23A6,X

#_019EE9: INY ; +8
#_019EEA: INY
#_019EEB: INY
#_019EEC: INY
#_019EED: INY
#_019EEE: INY
#_019EEF: INY
#_019EF0: INY

#_019EF1: INX
#_019EF2: INX

#_019EF3: DEC.b $0E
#_019EF5: BNE .next_a

;---------------------------------------------------------------------------------------------------

#_019EF7: LDA.w #$0005
#_019EFA: STA.b $0E

#_019EFC: LDY.w #$1C22
#_019EFF: LDX.b $08

.next_b
#_019F01: LDA.w RoomDrawObjectData+0,Y
#_019F04: STA.l $7E2504,X
#_019F08: STA.l $7E2486,X
#_019F0C: STA.l $7E2408,X
#_019F10: STA.l $7E238A,X
#_019F14: STA.l $7E230C,X
#_019F18: STA.l $7E228E,X
#_019F1C: STA.l $7E2210,X

#_019F20: ORA.w #$4000
#_019F23: STA.l $7E222E,X
#_019F27: STA.l $7E22B0,X
#_019F2B: STA.l $7E2332,X
#_019F2F: STA.l $7E23B4,X
#_019F33: STA.l $7E2436,X
#_019F37: STA.l $7E24B8,X
#_019F3B: STA.l $7E253A,X

#_019F3F: INY
#_019F40: INY

#_019F41: TXA
#_019F42: CLC
#_019F43: ADC.w #$0080
#_019F46: TAX

#_019F47: DEC.b $0E
#_019F49: BNE .next_b

;---------------------------------------------------------------------------------------------------

#_019F4B: LDA.w #$0006
#_019F4E: STA.b $0E

#_019F50: LDY.w #$1C2C
#_019F53: LDX.b $08

.next_c
#_019F55: LDA.w RoomDrawObjectData+0,Y
#_019F58: STA.l $7E2584,X
#_019F5C: STA.l $7E2884,X
#_019F60: STA.l $7E2B84,X

#_019F64: ORA.w #$4000
#_019F67: STA.l $7E25BA,X
#_019F6B: STA.l $7E28BA,X
#_019F6F: STA.l $7E2BBA,X

#_019F73: LDA.w RoomDrawObjectData+2,Y
#_019F76: STA.l $7E2586,X
#_019F7A: STA.l $7E2886,X
#_019F7E: STA.l $7E2B86,X

#_019F82: ORA.w #$4000
#_019F85: STA.l $7E25B8,X
#_019F89: STA.l $7E28B8,X
#_019F8D: STA.l $7E2BB8,X

#_019F91: LDA.w RoomDrawObjectData+4,Y
#_019F94: STA.l $7E2588,X
#_019F98: STA.l $7E2888,X
#_019F9C: STA.l $7E2B88,X

#_019FA0: ORA.w #$4000
#_019FA3: STA.l $7E25B6,X
#_019FA7: STA.l $7E28B6,X
#_019FAB: STA.l $7E2BB6,X

#_019FAF: LDA.w RoomDrawObjectData+6,Y
#_019FB2: STA.l $7E258A,X
#_019FB6: STA.l $7E288A,X
#_019FBA: STA.l $7E2B8A,X

#_019FBE: ORA.w #$4000
#_019FC1: STA.l $7E25B4,X
#_019FC5: STA.l $7E28B4,X
#_019FC9: STA.l $7E2BB4,X

#_019FCD: INY ; +8
#_019FCE: INY
#_019FCF: INY
#_019FD0: INY
#_019FD1: INY
#_019FD2: INY
#_019FD3: INY
#_019FD4: INY

#_019FD5: TXA
#_019FD6: CLC
#_019FD7: ADC.w #$0080
#_019FDA: TAX

#_019FDB: DEC.b $0E
#_019FDD: BEQ .done_c

#_019FDF: JMP.w .next_c

;---------------------------------------------------------------------------------------------------

.done_c
#_019FE2: LDA.w #$0006
#_019FE5: STA.b $0E

#_019FE7: LDY.w #$1C5C
#_019FEA: LDX.b $08

.next_d
#_019FEC: LDA.w RoomDrawObjectData+0,Y
#_019FEF: STA.l $7E2498,X
#_019FF3: STA.l $7E24A4,X

#_019FF7: LDA.w RoomDrawObjectData+12,Y
#_019FFA: STA.l $7E2518,X
#_019FFE: STA.l $7E2524,X

#_01A002: INY
#_01A003: INY

#_01A004: INX
#_01A005: INX

#_01A006: DEC.b $0E
#_01A008: BNE .next_d

;---------------------------------------------------------------------------------------------------

#_01A00A: LDA.w #$0006
#_01A00D: STA.b $0E

#_01A00F: LDY.w #$1C74
#_01A012: LDX.b $08

.next_e
#_01A014: LDA.w RoomDrawObjectData+0,Y
#_01A017: STA.l $7E270E,X
#_01A01B: STA.l $7E2A0E,X

#_01A01F: LDA.w RoomDrawObjectData+2,Y
#_01A022: STA.l $7E2710,X
#_01A026: STA.l $7E2A10,X

#_01A02A: INY ; +4
#_01A02B: INY
#_01A02C: INY
#_01A02D: INY

#_01A02E: TXA
#_01A02F: CLC
#_01A030: ADC.w #$0080
#_01A033: TAX

#_01A034: DEC.b $0E
#_01A036: BNE .next_e

;---------------------------------------------------------------------------------------------------

#_01A038: LDA.w #$0005
#_01A03B: STA.b $0E

#_01A03D: LDY.w #$1C8C
#_01A040: LDX.b $08

.next_f
#_01A042: LDA.w RoomDrawObjectData+0,Y
#_01A045: STA.l $7E248E,X

#_01A049: LDA.w RoomDrawObjectData+2,Y
#_01A04C: STA.l $7E250E,X

#_01A050: LDA.w RoomDrawObjectData+4,Y
#_01A053: STA.l $7E258E,X

#_01A057: LDA.w RoomDrawObjectData+6,Y
#_01A05A: STA.l $7E260E,X

#_01A05E: LDA.w RoomDrawObjectData+8,Y
#_01A061: STA.l $7E268E,X

#_01A065: TYA
#_01A066: CLC
#_01A067: ADC.w #$000A
#_01A06A: TAY

#_01A06B: INX
#_01A06C: INX

#_01A06D: DEC.b $0E
#_01A06F: BNE .next_f

;---------------------------------------------------------------------------------------------------

#_01A071: LDA.w #$0004
#_01A074: STA.b $0E

#_01A076: LDX.b $08

.next_g
#_01A078: LDA.l $7E2E1C,X
#_01A07C: ORA.w #$2000
#_01A07F: STA.l $7E2E1C,X

#_01A083: LDA.l $7E2E9C,X
#_01A087: ORA.w #$2000
#_01A08A: STA.l $7E2E9C,X

#_01A08E: INX
#_01A08F: INX

#_01A090: DEC.b $0E
#_01A092: BNE .next_g

#_01A094: RTS

;===================================================================================================

RoomDraw_FortuneTellerRoom:
#_01A095: LDA.w #$0006
#_01A098: STA.b $0E

#_01A09A: LDY.w #$202E
#_01A09D: LDX.b $08

.next_a
#_01A09F: LDA.w RoomDrawObjectData+0,Y
#_01A0A2: STA.l $7E2002,X
#_01A0A6: STA.l $7E2004,X
#_01A0AA: STA.l $7E2082,X
#_01A0AE: STA.l $7E2084,X

#_01A0B2: LDA.w RoomDrawObjectData+2,Y
#_01A0B5: STA.l $7E2102,X

#_01A0B9: ORA.w #$4000
#_01A0BC: STA.l $7E2104,X

#_01A0C0: INX ; +4
#_01A0C1: INX
#_01A0C2: INX
#_01A0C3: INX

#_01A0C4: DEC.b $0E
#_01A0C6: BNE .next_a

;---------------------------------------------------------------------------------------------------

#_01A0C8: LDA.w #$0003
#_01A0CB: STA.b $0E

#_01A0CD: LDX.b $08

.next_b
#_01A0CF: LDA.w RoomDrawObjectData+4,Y
#_01A0D2: STA.l $7E2180,X
#_01A0D6: STA.l $7E2184,X
#_01A0DA: STA.l $7E2194,X
#_01A0DE: STA.l $7E2198,X

#_01A0E2: ORA.w #$4000
#_01A0E5: STA.l $7E2182,X
#_01A0E9: STA.l $7E2186,X
#_01A0ED: STA.l $7E2196,X
#_01A0F1: STA.l $7E219A,X

#_01A0F5: LDA.w RoomDrawObjectData+10,Y
#_01A0F8: STA.l $7E2188,X
#_01A0FC: STA.l $7E218C,X
#_01A100: STA.l $7E2190,X

#_01A104: ORA.w #$4000
#_01A107: STA.l $7E218A,X
#_01A10B: STA.l $7E218E,X
#_01A10F: STA.l $7E2192,X

#_01A113: INY
#_01A114: INY

#_01A115: TXA
#_01A116: CLC
#_01A117: ADC.w #$0080
#_01A11A: TAX

#_01A11B: DEC.b $0E
#_01A11D: BNE .next_b

;---------------------------------------------------------------------------------------------------

#_01A11F: LDX.b $08

#_01A121: LDA.w RoomDrawObjectData+10,Y
#_01A124: STA.l $7E2000,X
#_01A128: STA.l $7E2080,X

#_01A12C: ORA.w #$4000
#_01A12F: STA.l $7E201A,X
#_01A133: STA.l $7E209A,X

#_01A137: LDA.w RoomDrawObjectData+12,Y
#_01A13A: STA.l $7E2100,X

#_01A13E: ORA.w #$4000
#_01A141: STA.l $7E211A,X

;---------------------------------------------------------------------------------------------------

#_01A145: LDA.w #$0004
#_01A148: STA.b $0E

#_01A14A: LDY.w #$202E
#_01A14D: LDX.b $08

.next_c
#_01A14F: LDA.w RoomDrawObjectData+20,Y
#_01A152: STA.l $7E2506,X

#_01A156: EOR.w #$4000
#_01A159: STA.l $7E2514,X

#_01A15D: LDA.w RoomDrawObjectData+28,Y
#_01A160: STA.l $7E2508,X

#_01A164: EOR.w #$4000
#_01A167: STA.l $7E2512,X

#_01A16B: LDA.w RoomDrawObjectData+36,Y
#_01A16E: STA.l $7E250A,X

#_01A172: EOR.w #$4000
#_01A175: STA.l $7E2510,X

#_01A179: LDA.w RoomDrawObjectData+44,Y
#_01A17C: STA.l $7E250C,X

#_01A180: EOR.w #$4000
#_01A183: STA.l $7E250E,X

#_01A187: INY
#_01A188: INY

#_01A189: TXA
#_01A18A: CLC
#_01A18B: ADC.w #$0080
#_01A18E: TAX

#_01A18F: DEC.b $0E
#_01A191: BNE .next_c

#_01A193: RTS

;===================================================================================================

RoomDraw_Utility3x5:
#_01A194: LDA.w #$0003
#_01A197: STA.b $0E

#_01A199: LDA.w RoomDrawObjectData+0,X
#_01A19C: STA.b [$BF],Y

#_01A19E: LDA.w RoomDrawObjectData+2,X
#_01A1A1: STA.b [$C2],Y

#_01A1A3: LDA.w RoomDrawObjectData+4,X
#_01A1A6: STA.b [$C5],Y

;---------------------------------------------------------------------------------------------------

.next
#_01A1A8: LDA.w RoomDrawObjectData+6,X
#_01A1AB: STA.b [$CB],Y

#_01A1AD: LDA.w RoomDrawObjectData+8,X
#_01A1B0: STA.b [$CE],Y

#_01A1B2: LDA.w RoomDrawObjectData+10,X
#_01A1B5: STA.b [$D1],Y

#_01A1B7: TYA
#_01A1B8: CLC
#_01A1B9: ADC.w #$0080
#_01A1BC: TAY

#_01A1BD: DEC.b $0E
#_01A1BF: BNE .next

;---------------------------------------------------------------------------------------------------

#_01A1C1: LDA.w RoomDrawObjectData+12,X
#_01A1C4: STA.b [$CB],Y

#_01A1C6: LDA.w RoomDrawObjectData+14,X
#_01A1C9: STA.b [$CE],Y

#_01A1CB: LDA.w RoomDrawObjectData+16,X
#_01A1CE: STA.b [$D1],Y

#_01A1D0: RTS

;===================================================================================================

RoomDraw_VitreousGooGraphics:
#_01A1D1: LDY.w #$20F6
#_01A1D4: LDX.b $08

#_01A1D6: LDA.w #$0016
#_01A1D9: STA.b $0E

.next_a
#_01A1DB: LDA.w RoomDrawObjectData+0,Y
#_01A1DE: STA.l $7E4000,X

#_01A1E2: LDA.w RoomDrawObjectData+2,Y
#_01A1E5: STA.l $7E4080,X

#_01A1E9: LDA.w RoomDrawObjectData+4,Y
#_01A1EC: STA.l $7E4100,X

#_01A1F0: LDA.w RoomDrawObjectData+6,Y
#_01A1F3: STA.l $7E4180,X

#_01A1F7: LDA.w RoomDrawObjectData+8,Y
#_01A1FA: STA.l $7E4200,X

#_01A1FE: LDA.w RoomDrawObjectData+10,Y
#_01A201: STA.l $7E4280,X

#_01A205: LDA.w RoomDrawObjectData+12,Y
#_01A208: STA.l $7E4300,X

#_01A20C: LDA.w RoomDrawObjectData+14,Y
#_01A20F: STA.l $7E4380,X

#_01A213: LDA.w RoomDrawObjectData+16,Y
#_01A216: STA.l $7E4400,X

#_01A21A: LDA.w RoomDrawObjectData+18,Y
#_01A21D: STA.l $7E4480,X

#_01A221: LDA.w RoomDrawObjectData+20,Y
#_01A224: STA.l $7E4500,X

#_01A228: TYA
#_01A229: CLC
#_01A22A: ADC.w #$0016
#_01A22D: TAY

#_01A22E: INX
#_01A22F: INX

#_01A230: DEC.b $0E
#_01A232: BNE .next_a

;---------------------------------------------------------------------------------------------------

#_01A234: LDY.w #$22DA
#_01A237: LDX.b $08

#_01A239: LDA.w #$0003
#_01A23C: STA.b $0E

.next_b
#_01A23E: LDA.w RoomDrawObjectData+0,Y
#_01A241: STA.l $7E4592,X

#_01A245: LDA.w RoomDrawObjectData+6,Y
#_01A248: STA.l $7E4612,X

#_01A24C: INY
#_01A24D: INY

#_01A24E: INX
#_01A24F: INX

#_01A250: DEC.b $0E
#_01A252: BNE .next_b

#_01A254: RTS

;===================================================================================================

RoomDraw_BG2MaskFull:
#_01A255: STZ.b $0C

#_01A257: LDX.w #$00E0
#_01A25A: JMP.w RoomDraw_FloorChunks

;===================================================================================================

RoomDraw_AutoStairs_North_MultiLayer_A:
#_01A25D: PHX

#_01A25E: LDX.w $043C

#_01A261: TYA
#_01A262: LSR A
#_01A263: STA.w $06B8,X

#_01A266: INX
#_01A267: INX
#_01A268: STX.w $043C

#_01A26B: BRA RoomDraw_AutoStairs_North_MultiLayer

;===================================================================================================

RoomDraw_AutoStairs_North_MultiLayer_B:
#_01A26D: PHX

#_01A26E: LDX.w $043E

#_01A271: TYA
#_01A272: LSR A
#_01A273: STA.w $06B8,X

#_01A276: INX
#_01A277: INX
#_01A278: STX.w $043E

;===================================================================================================

RoomDraw_AutoStairs_North_MultiLayer:
#_01A27B: STX.w $0446
#_01A27E: STX.w $0448

#_01A281: TYX

#_01A282: PLY

;---------------------------------------------------------------------------------------------------

#_01A283: LDA.w #$0004
#_01A286: STA.b $0E

.next
#_01A288: LDA.w RoomDrawObjectData+0,Y
#_01A28B: STA.l $7E2000,X
#_01A28F: STA.l $7E4000,X

#_01A293: LDA.w RoomDrawObjectData+2,Y
#_01A296: STA.l $7E2080,X
#_01A29A: STA.l $7E4080,X

#_01A29E: LDA.w RoomDrawObjectData+4,Y
#_01A2A1: STA.l $7E2100,X
#_01A2A5: STA.l $7E4100,X

#_01A2A9: LDA.w RoomDrawObjectData+6,Y
#_01A2AC: STA.l $7E2180,X
#_01A2B0: STA.l $7E4180,X

#_01A2B4: TYA
#_01A2B5: CLC
#_01A2B6: ADC.w #$0008
#_01A2B9: TAY

#_01A2BA: INX
#_01A2BB: INX

#_01A2BC: DEC.b $0E
#_01A2BE: BNE .next

#_01A2C0: RTS

;===================================================================================================

AutoStairsNorthMergedStart:
#_01A2C1: STZ.w $0414

#_01A2C4: LDX.w #$10C8

;===================================================================================================

RoomDraw_AutoStairs_North_MergedLayer_A:
#_01A2C7: PHX

#_01A2C8: LDX.w $0440

#_01A2CB: TYA
#_01A2CC: LSR A
#_01A2CD: STA.w $06B8,X

#_01A2D0: INX
#_01A2D1: INX

#_01A2D2: STX.w $0440
#_01A2D5: STX.w $0446
#_01A2D8: STX.w $0448

#_01A2DB: PLX

#_01A2DC: JMP.w RoomDraw_4x4Object

;===================================================================================================
; TODO WTF ARE THESE LOCKED STAIRS?
RoomDraw_AutoStairs_North_MergedLayer_B:
#_01A2DF: LDA.b $AF
#_01A2E1: AND.w #$00FF
#_01A2E4: CMP.w #$001B
#_01A2E7: BNE .dont_check_room

#_01A2E9: LDA.b $A0
#_01A2EB: ASL A
#_01A2EC: TAX

#_01A2ED: LDA.l $7EF000,X
#_01A2F1: AND.w #$0100
#_01A2F4: BEQ AutoStairsNorthMergedStart

;---------------------------------------------------------------------------------------------------

.dont_check_room
#_01A2F6: LDX.w $0442

#_01A2F9: TYA
#_01A2FA: LSR A
#_01A2FB: STA.w $06B8,X

#_01A2FE: INX
#_01A2FF: INX
#_01A300: STX.w $0442
#_01A303: STX.w $0444

#_01A306: LDX.w #$10C8
#_01A309: JMP.w RoomDraw_4x4Object

;===================================================================================================

RoomDraw_AutoStairs_South_MultiLayer_A:
#_01A30C: PHX

#_01A30D: LDX.w $049A

#_01A310: TYA
#_01A311: LSR A
#_01A312: STA.w $06B8,X

#_01A315: INX
#_01A316: INX
#_01A317: STX.w $049A

#_01A31A: BRA RoomDraw_AutoStairs_South_MultiLayer

;===================================================================================================

RoomDraw_AutoStairs_South_MultiLayer_B:
#_01A31C: PHX

#_01A31D: LDX.w $049C

#_01A320: TYA
#_01A321: LSR A
#_01A322: STA.w $06EC,X

#_01A325: INX
#_01A326: INX
#_01A327: STX.w $049C

;===================================================================================================

RoomDraw_AutoStairs_South_MultiLayer:
#_01A32A: TYX

#_01A32B: PLY

#_01A32C: LDA.w #$0004
#_01A32F: STA.b $0E

.next
#_01A331: LDA.w RoomDrawObjectData+0,Y
#_01A334: STA.l $7E2000,X
#_01A338: STA.l $7E4000,X

#_01A33C: LDA.w RoomDrawObjectData+2,Y
#_01A33F: STA.l $7E2080,X
#_01A343: STA.l $7E4080,X

#_01A347: LDA.w RoomDrawObjectData+4,Y
#_01A34A: STA.l $7E2100,X
#_01A34E: STA.l $7E4100,X

#_01A352: LDA.w RoomDrawObjectData+6,Y
#_01A355: STA.l $7E2180,X
#_01A359: STA.l $7E4180,X

#_01A35D: TYA
#_01A35E: CLC
#_01A35F: ADC.w #$0008
#_01A362: TAY

#_01A363: INX
#_01A364: INX

#_01A365: DEC.b $0E
#_01A367: BNE .next

#_01A369: RTS

;===================================================================================================

South_MergedStairs_BecomeMultiC:
#_01A36A: STZ.w $0414

#_01A36D: PLX

;===================================================================================================

RoomDraw_AutoStairs_South_MultiLayer_C:
#_01A36E: PHX

#_01A36F: LDX.w $049E

#_01A372: TYA
#_01A373: LSR A
#_01A374: STA.w $06EC,X

#_01A377: INX
#_01A378: INX
#_01A379: STX.w $049E

#_01A37C: PLX

#_01A37D: JMP.w RoomDraw_4x4Object

;===================================================================================================

RoomDraw_AutoStairs_South_MergedLayer:
#_01A380: PHX

#_01A381: LDA.b $AF
#_01A383: AND.w #$00FF
#_01A386: CMP.w #$001B
#_01A389: BNE .not_water_twin

#_01A38B: LDA.b $A0
#_01A38D: ASL A
#_01A38E: TAX

#_01A38F: LDA.l $7EF000,X
#_01A393: AND.w #$0100
#_01A396: BEQ South_MergedStairs_BecomeMultiC

#_01A398: LDA.w #$6202
#_01A39B: STA.b $99

.not_water_twin
#_01A39D: LDX.w $04AE

#_01A3A0: TYA
#_01A3A1: LSR A
#_01A3A2: STA.w $06EC,X

#_01A3A5: INX
#_01A3A6: INX
#_01A3A7: STX.w $04AE

#_01A3AA: PLX

#_01A3AB: JMP.w RoomDraw_4x4Object

;===================================================================================================

RoomDraw_WaterHopStairs_B:
#_01A3AE: LDX.w $0446

#_01A3B1: TYA
#_01A3B2: LSR A
#_01A3B3: STA.w $06B8,X

#_01A3B6: INX
#_01A3B7: INX

#_01A3B8: STX.w $0446
#_01A3BB: STX.w $0448

#_01A3BE: TYX

#_01A3BF: LDY.w #$1108

#_01A3C2: LDA.w RoomDrawObjectData+0,Y
#_01A3C5: STA.l $7E2000,X
#_01A3C9: STA.l $7E4000,X

#_01A3CD: LDA.w RoomDrawObjectData+2,Y
#_01A3D0: STA.l $7E2002,X
#_01A3D4: STA.l $7E4002,X

#_01A3D8: LDA.w RoomDrawObjectData+4,Y
#_01A3DB: STA.l $7E2004,X
#_01A3DF: STA.l $7E4004,X

#_01A3E3: LDA.w RoomDrawObjectData+6,Y
#_01A3E6: STA.l $7E2006,X
#_01A3EA: STA.l $7E4006,X

#_01A3EE: LDA.w RoomDrawObjectData+8,Y
#_01A3F1: STA.l $7E2080,X
#_01A3F5: STA.l $7E4080,X

#_01A3F9: LDA.w RoomDrawObjectData+10,Y
#_01A3FC: STA.l $7E2082,X
#_01A400: STA.l $7E4082,X

#_01A404: LDA.w RoomDrawObjectData+12,Y
#_01A407: STA.l $7E2084,X
#_01A40B: STA.l $7E4084,X

#_01A40F: LDA.w RoomDrawObjectData+14,Y
#_01A412: STA.l $7E2086,X
#_01A416: STA.l $7E4086,X

#_01A41A: RTS

;===================================================================================================

RoomDraw_InterRoomFatStairsUp:
#_01A41B: LDX.w $0438

#_01A41E: TYA
#_01A41F: LSR A
#_01A420: STA.w $06B0,X

#_01A423: LDA.b $BF
#_01A425: CMP.w #$4000
#_01A428: BNE .lower_layer

#_01A42A: TYA
#_01A42B: ORA.w #$2000
#_01A42E: LSR A
#_01A42F: STA.w $06B0,X

.lower_layer
#_01A432: INX
#_01A433: INX

#_01A434: STX.w $0438

#_01A437: STX.w $047E
#_01A43A: STX.w $0482

#_01A43D: STX.w $04A2
#_01A440: STX.w $04A4

#_01A443: STX.w $043A

#_01A446: STX.w $0480
#_01A449: STX.w $0484

#_01A44C: STX.w $04A6
#_01A44F: STX.w $04A8

#_01A452: LDX.w #$1088
#_01A455: JMP.w RoomDraw_4x4Object

;===================================================================================================

RoomDraw_InterRoomFatStairsDown_A:
#_01A458: LDX.w $043A
#_01A45B: TYA
#_01A45C: LSR A
#_01A45D: STA.w $06B0,X

#_01A460: LDA.b $BF
#_01A462: CMP.w #$4000
#_01A465: BNE .lower_layer

#_01A467: TYA
#_01A468: ORA.w #$2000
#_01A46B: LSR A
#_01A46C: STA.w $06B0,X

.lower_layer
#_01A46F: INX
#_01A470: INX

#_01A471: STX.w $043A

#_01A474: STX.w $0480
#_01A477: STX.w $0484

#_01A47A: STX.w $04A6
#_01A47D: STX.w $04A8

#_01A480: LDX.w #$10A8
#_01A483: JMP.w RoomDraw_4x4Object

;===================================================================================================

RoomDraw_InterRoomFatStairsDown_B:
#_01A486: LDX.w $043A

#_01A489: TYA
#_01A48A: LSR A
#_01A48B: STA.w $06B0,X

#_01A48E: LDA.b $BF
#_01A490: CMP.w #$4000
#_01A493: BNE .lower_layer

#_01A495: TYA
#_01A496: ORA.w #$2000
#_01A499: LSR A
#_01A49A: STA.w $06B0,X

.lower_layer
#_01A49D: INX
#_01A49E: INX

#_01A49F: STX.w $043A

#_01A4A2: STX.w $0480
#_01A4A5: STX.w $0484

#_01A4A8: STX.w $04A6
#_01A4AB: STX.w $04A8

#_01A4AE: LDX.w #$10A8
#_01A4B1: JMP.w RoomDraw_4x4Object

;===================================================================================================

RoomDraw_SpiralStairsGoingUpUpper:
#_01A4B4: LDX.w $047E

#_01A4B7: TYA
#_01A4B8: SEC
#_01A4B9: SBC.w #$0080
#_01A4BC: LSR A
#_01A4BD: STA.w $06B0,X

#_01A4C0: LDA.b $BF
#_01A4C2: CMP.w #$4000
#_01A4C5: BNE .lower_layer

#_01A4C7: TYA
#_01A4C8: SEC
#_01A4C9: SBC.w #$0080
#_01A4CC: ORA.w #$2000
#_01A4CF: LSR A
#_01A4D0: STA.w $06B0,X

.lower_layer
#_01A4D3: INX
#_01A4D4: INX

#_01A4D5: STX.w $047E
#_01A4D8: STX.w $0482

#_01A4DB: STX.w $04A2
#_01A4DE: STX.w $04A4

#_01A4E1: STX.w $043A

#_01A4E4: STX.w $0480
#_01A4E7: STX.w $0484

#_01A4EA: STX.w $04A6
#_01A4ED: STX.w $04A8

#_01A4F0: LDX.w #$1148
#_01A4F3: BRA RoomDraw_SpiralStairsUpper

;===================================================================================================

RoomDraw_SpiralStairsGoingUpLower:
#_01A4F5: LDX.w $0482
#_01A4F8: TYA
#_01A4F9: SEC
#_01A4FA: SBC.w #$0080
#_01A4FD: LSR A
#_01A4FE: STA.w $06B0,X

#_01A501: LDA.b $BF
#_01A503: CMP.w #$4000
#_01A506: BNE .lower_layer

#_01A508: TYA
#_01A509: SEC
#_01A50A: SBC.w #$0080
#_01A50D: ORA.w #$2000
#_01A510: LSR A
#_01A511: STA.w $06B0,X

.lower_layer
#_01A514: INX
#_01A515: INX

#_01A516: STX.w $0482

#_01A519: STX.w $04A2
#_01A51C: STX.w $04A4

#_01A51F: STX.w $043A

#_01A522: STX.w $0480
#_01A525: STX.w $0484

#_01A528: STX.w $04A6
#_01A52B: STX.w $04A8

#_01A52E: LDX.w #$1178
#_01A531: BRA SpiralStairsDownLower_continue

;===================================================================================================

RoomDraw_SpiralStairsGoingDownUpper:
#_01A533: LDX.w $0480

#_01A536: TYA
#_01A537: SEC
#_01A538: SBC.w #$0080
#_01A53B: LSR A
#_01A53C: STA.w $06B0,X

#_01A53F: LDA.b $BF
#_01A541: CMP.w #$4000
#_01A544: BNE .lower_layer

#_01A546: TYA
#_01A547: SEC
#_01A548: SBC.w #$0080
#_01A54B: ORA.w #$2000
#_01A54E: LSR A
#_01A54F: STA.w $06B0,X

.lower_layer
#_01A552: INX
#_01A553: INX

#_01A554: STX.w $0480
#_01A557: STX.w $0484

#_01A55A: STX.w $04A6
#_01A55D: STX.w $04A8

#_01A560: LDX.w #$1160

;===================================================================================================

RoomDraw_SpiralStairsUpper:
#_01A563: LDA.w #$0004
#_01A566: JSR RoomDraw_Rightwards1x2_rightwards

#_01A569: LDX.b $08
#_01A56B: DEX
#_01A56C: DEX

#_01A56D: LDA.l $7E2000,X
#_01A571: ORA.w #$2000
#_01A574: STA.l $7E2000,X

#_01A578: LDA.l $7E200A,X
#_01A57C: ORA.w #$2000
#_01A57F: STA.l $7E200A,X

#_01A583: RTS

;===================================================================================================

RoomDraw_SpiralStairsGoingDownLower:
#_01A584: LDX.w $0484

#_01A587: TYA
#_01A588: SEC
#_01A589: SBC.w #$0080
#_01A58C: LSR A
#_01A58D: STA.w $06B0,X

#_01A590: LDA.b $BF
#_01A592: CMP.w #$4000
#_01A595: BNE .lower_layer

#_01A597: TYA
#_01A598: SEC
#_01A599: SBC.w #$0080
#_01A59C: ORA.w #$2000
#_01A59F: LSR A
#_01A5A0: STA.w $06B0,X

.lower_layer
#_01A5A3: INX
#_01A5A4: INX

#_01A5A5: STX.w $0484

#_01A5A8: STX.w $04A6
#_01A5AB: STX.w $04A8

#_01A5AE: LDX.w #$1190

;---------------------------------------------------------------------------------------------------

#SpiralStairsDownLower_continue:
#_01A5B1: LDA.w #$0004
#_01A5B4: JSR RoomDraw_Rightwards1x2_rightwards

#_01A5B7: LDX.b $08
#_01A5B9: DEX
#_01A5BA: DEX

#_01A5BB: LDA.l $7E4000,X
#_01A5BF: ORA.w #$2000
#_01A5C2: STA.l $7E4000,X

#_01A5C6: LDA.l $7E400A,X
#_01A5CA: ORA.w #$2000
#_01A5CD: STA.l $7E400A,X

#_01A5D1: RTS

;===================================================================================================

RoomDraw_StraightInterroomStairsGoingUpNorthUpper:
#_01A5D2: PHX

#_01A5D3: LDX.w $04A2

#_01A5D6: TYA
#_01A5D7: LSR A
#_01A5D8: STA.w $06B0,X

#_01A5DB: INX
#_01A5DC: INX

#_01A5DD: STX.w $04A2
#_01A5E0: STX.w $04A4

#_01A5E3: STX.w $043A

#_01A5E6: STX.w $0480
#_01A5E9: STX.w $0484

#_01A5EC: STX.w $04A6
#_01A5EF: STX.w $04A8

#_01A5F2: BRA StraightInterroomStairsUpperMain

;===================================================================================================

RoomDraw_StraightInterroomStairsGoingDownNorthUpper:
#_01A5F4: PHX

#_01A5F5: LDX.w $04A6

#_01A5F8: TYA
#_01A5F9: LSR A
#_01A5FA: STA.w $06B0,X

#_01A5FD: INX
#_01A5FE: INX
#_01A5FF: STX.w $04A6
#_01A602: STX.w $04A8

#_01A605: BRA StraightInterroomStairsUpperMain

;===================================================================================================

RoomDraw_StraightInterroomStairsGoingUpSouthUpper:
#_01A607: PHX

#_01A608: LDX.w $04A4

#_01A60B: TYA
#_01A60C: LSR A
#_01A60D: STA.w $06B0,X

#_01A610: INX
#_01A611: INX
#_01A612: STX.w $04A4
#_01A615: STX.w $043A

#_01A618: STX.w $0480
#_01A61B: STX.w $0484

#_01A61E: STX.w $04A6
#_01A621: STX.w $04A8

#_01A624: BRA StraightInterroomStairsUpperMain

;===================================================================================================

RoomDraw_StraightInterroomStairsGoingDownSouthUpper:
#_01A626: PHX

#_01A627: LDX.w $04A8

#_01A62A: TYA
#_01A62B: LSR A
#_01A62C: STA.w $06B0,X

#_01A62F: INX
#_01A630: INX
#_01A631: STX.w $04A8

;===================================================================================================

StraightInterroomStairsUpperMain:
#_01A634: TYX

#_01A635: PLY

#_01A636: LDA.w #$0004
#_01A639: STA.b $0E

.next
#_01A63B: LDA.w RoomDrawObjectData+0,Y
#_01A63E: STA.l $7E2000,X

#_01A642: LDA.w RoomDrawObjectData+2,Y
#_01A645: STA.l $7E2080,X

#_01A649: LDA.w RoomDrawObjectData+4,Y
#_01A64C: STA.l $7E2100,X

#_01A650: LDA.w RoomDrawObjectData+6,Y
#_01A653: STA.l $7E2180,X

#_01A657: TYA
#_01A658: CLC
#_01A659: ADC.w #$0008
#_01A65C: TAY

#_01A65D: INX
#_01A65E: INX

#_01A65F: DEC.b $0E
#_01A661: BNE .next

#_01A663: RTS

;===================================================================================================

RoomDraw_StraightInterroomStairsGoingUpNorthLower:
#_01A664: PHX

#_01A665: LDX.w $04A2

#_01A668: TYA
#_01A669: LSR A
#_01A66A: STA.w $06B0,X

#_01A66D: LDA.b $BF
#_01A66F: CMP.w #$4000
#_01A672: BNE .lower_layer

#_01A674: TYA
#_01A675: ORA.w #$2000
#_01A678: LSR A
#_01A679: STA.w $06B0,X

.lower_layer
#_01A67C: INX
#_01A67D: INX

#_01A67E: STX.w $04A2
#_01A681: STX.w $04A4

#_01A684: STX.w $043A

#_01A687: STX.w $0480
#_01A68A: STX.w $0484

#_01A68D: STX.w $04A6
#_01A690: STX.w $04A8

#_01A693: BRA StraightInterroomStairsLowerMain

;===================================================================================================

RoomDraw_StraightInterroomStairsGoingDownNorthLower:
#_01A695: PHX

#_01A696: LDX.w $04A6

#_01A699: TYA
#_01A69A: LSR A
#_01A69B: STA.w $06B0,X

#_01A69E: LDA.b $BF
#_01A6A0: CMP.w #$4000
#_01A6A3: BNE .lower_layer

#_01A6A5: TYA
#_01A6A6: ORA.w #$2000
#_01A6A9: LSR A
#_01A6AA: STA.w $06B0,X

.lower_layer
#_01A6AD: INX
#_01A6AE: INX
#_01A6AF: STX.w $04A6
#_01A6B2: STX.w $04A8

;===================================================================================================

StraightInterroomStairsLowerMain:
#_01A6B5: TYX

#_01A6B6: PLY

#_01A6B7: LDA.w #$0004
#_01A6BA: STA.b $0E

.next
#_01A6BC: LDA.w RoomDrawObjectData+0,Y
#_01A6BF: STA.l $7E2000,X
#_01A6C3: STA.l $7E4000,X

#_01A6C7: LDA.w RoomDrawObjectData+2,Y
#_01A6CA: STA.l $7E4080,X

#_01A6CE: LDA.w RoomDrawObjectData+4,Y
#_01A6D1: STA.l $7E4100,X

#_01A6D5: LDA.w RoomDrawObjectData+6,Y
#_01A6D8: STA.l $7E4180,X

#_01A6DC: TYA
#_01A6DD: CLC
#_01A6DE: ADC.w #$0008
#_01A6E1: TAY

#_01A6E2: INX
#_01A6E3: INX

#_01A6E4: DEC.b $0E
#_01A6E6: BNE .next

;---------------------------------------------------------------------------------------------------

#_01A6E8: LDA.b $08
#_01A6EA: SEC
#_01A6EB: SBC.w #$0200

;===================================================================================================

StraightInterroomStairsLower_finish_up:
#_01A6EE: TAX

#_01A6EF: LDA.l $7E2000,X
#_01A6F3: ORA.w #$2000
#_01A6F6: STA.l $7E2000,X

#_01A6FA: LDA.l $7E2080,X
#_01A6FE: ORA.w #$2000
#_01A701: STA.l $7E2080,X

#_01A705: LDA.l $7E2100,X
#_01A709: ORA.w #$2000
#_01A70C: STA.l $7E2100,X

#_01A710: LDA.l $7E2180,X
#_01A714: ORA.w #$2000
#_01A717: STA.l $7E2180,X

#_01A71B: RTS

;===================================================================================================

RoomDraw_StraightInterroomStairsGoingUpSouthLower:
#_01A71C: PHX

#_01A71D: LDX.w $04A4

#_01A720: TYA
#_01A721: LSR A
#_01A722: STA.w $06B0,X

#_01A725: LDA.b $BF
#_01A727: CMP.w #$4000
#_01A72A: BNE .lower_layer

#_01A72C: TYA
#_01A72D: ORA.w #$2000
#_01A730: LSR A
#_01A731: STA.w $06B0,X

.lower_layer
#_01A734: INX
#_01A735: INX

#_01A736: STX.w $04A4

#_01A739: STX.w $043A

#_01A73C: STX.w $0480
#_01A73F: STX.w $0484

#_01A742: STX.w $04A6
#_01A745: STX.w $04A8

#_01A748: BRA StraightInterroomStairsLower_continue

;===================================================================================================

RoomDraw_StraightInterroomStairsGoingDownSouthLower:
#_01A74A: PHX

#_01A74B: LDX.w $04A8

#_01A74E: TYA
#_01A74F: LSR A
#_01A750: STA.w $06B0,X

#_01A753: LDA.b $BF
#_01A755: CMP.w #$4000
#_01A758: BNE .lower_layer

#_01A75A: TYA
#_01A75B: ORA.w #$2000
#_01A75E: LSR A
#_01A75F: STA.w $06B0,X

.lower_layer
#_01A762: INX
#_01A763: INX
#_01A764: STX.w $04A8

;===================================================================================================

StraightInterroomStairsLower_continue:
#_01A767: TYX

#_01A768: PLY

#_01A769: LDA.w #$0004
#_01A76C: STA.b $0E

.next
#_01A76E: LDA.w RoomDrawObjectData+0,Y
#_01A771: STA.l $7E4000,X

#_01A775: LDA.w RoomDrawObjectData+2,Y
#_01A778: STA.l $7E4080,X

#_01A77C: LDA.w RoomDrawObjectData+4,Y
#_01A77F: STA.l $7E4100,X

#_01A783: LDA.w RoomDrawObjectData+6,Y
#_01A786: STA.l $7E2180,X
#_01A78A: STA.l $7E4180,X

#_01A78E: TYA
#_01A78F: CLC
#_01A790: ADC.w #$0008
#_01A793: TAY

#_01A794: INX
#_01A795: INX

#_01A796: DEC.b $0E
#_01A798: BNE .next

;---------------------------------------------------------------------------------------------------

#_01A79A: LDA.b $08
#_01A79C: CLC
#_01A79D: ADC.w #$0200

#_01A7A0: JMP.w StraightInterroomStairsLower_finish_up

;===================================================================================================

RoomDraw_ArcheryGameTargetDoor:
#_01A7A3: LDA.w #$0003
#_01A7A6: JSR RoomDraw_Rightwards1x2_rightwards

#_01A7A9: LDA.b $08
#_01A7AB: CLC
#_01A7AC: ADC.w #$0180
#_01A7AF: TAY

#_01A7B0: LDA.w #$0003
#_01A7B3: JMP.w RoomDraw_Rightwards1x2_rightwards

;===================================================================================================

RoomDraw_LightBeamOnFloor:
#_01A7B6: JSR RoomDraw_4x4Object

#_01A7B9: LDA.b $08
#_01A7BB: CLC
#_01A7BC: ADC.w #$0100
#_01A7BF: TAY

#_01A7C0: LDX.w #$2376
#_01A7C3: JSR RoomDraw_4x4Object

#_01A7C6: LDA.b $08
#_01A7C8: CLC
#_01A7C9: ADC.w #$0300
#_01A7CC: TAY

#_01A7CD: LDX.w #$2396
#_01A7D0: JMP.w RoomDraw_4x4Object

;===================================================================================================

RoomDraw_BigLightBeamOnFloor:
#_01A7D3: LDA.l $7EF0CA
#_01A7D7: AND.w #$0100
#_01A7DA: BEQ EXIT_01A7EF

;===================================================================================================

RoomDraw_FloorLight:
#_01A7DC: JSR RoomDraw_4x4Object
#_01A7DF: JSR RoomDraw_4x4Object

#_01A7E2: LDA.b $08
#_01A7E4: CLC
#_01A7E5: ADC.w #$0200
#_01A7E8: TAY

#_01A7E9: JSR RoomDraw_4x4Object
#_01A7EC: JSR RoomDraw_4x4Object

;---------------------------------------------------------------------------------------------------

#EXIT_01A7EF:
#_01A7EF: RTS

;===================================================================================================

RoomDraw_GanonTriforceFloorDecor:
#_01A7F0: JSR RoomDraw_4x4Object

#_01A7F3: LDA.b $08
#_01A7F5: CLC
#_01A7F6: ADC.w #$01FC
#_01A7F9: TAY

#_01A7FA: PHX

#_01A7FB: JSR RoomDraw_4x4Object

#_01A7FE: PLX

#_01A7FF: LDA.b $08
#_01A801: CLC
#_01A802: ADC.w #$0204
#_01A805: TAY

#_01A806: JMP.w RoomDraw_4x4Object

;===================================================================================================

RoomDraw_VitreousGooDamage:
#_01A809: LDA.w #$0005
#_01A80C: JSR RoomDraw_A_Many32x32Blocks

#_01A80F: LDA.b $08
#_01A811: CLC
#_01A812: ADC.w #$0200
#_01A815: TAY

#_01A816: LDA.w #$0005
#_01A819: JMP.w RoomDraw_A_Many32x32Blocks

;===================================================================================================

RoomDraw_Door_North:
#_01A81C: LDY.w DoorTileMapPositions_NorthWall,X
#_01A81F: STY.b $08

#_01A821: CMP.w #$0030
#_01A824: BNE .not_exploding_wall

#_01A826: JMP.w RoomDraw_Door_ExplodingWall

;---------------------------------------------------------------------------------------------------

.not_exploding_wall
#_01A829: CMP.w #$0016
#_01A82C: BNE .not_to_layer2_door

#_01A82E: TYA
#_01A82F: SEC
#_01A830: SBC.w #$00FE

#_01A833: JMP.w RoomDraw_MarkLayerToggleDoor

;---------------------------------------------------------------------------------------------------

.not_to_layer2_door
#_01A836: CMP.w #$0032
#_01A839: BNE .not_curtain_door

#_01A83B: JMP.w RoomDraw_NorthCurtainDoor

;---------------------------------------------------------------------------------------------------

.not_curtain_door
#_01A83E: CMP.w #$0006
#_01A841: BNE .not_lower_layer_door_1

#_01A843: JMP.w RoomDraw_MakeDoorHighPriorityLowerLayer_North

;---------------------------------------------------------------------------------------------------

.not_lower_layer_door_1
#_01A846: CMP.w #$0014
#_01A849: BNE .not_dungeon_swap_door

#_01A84B: TYA
#_01A84C: SEC
#_01A84D: SBC.w #$00FE

#_01A850: JMP.w RoomDraw_MarkDungeonToggleDoor

;---------------------------------------------------------------------------------------------------

.not_dungeon_swap_door
#_01A853: CMP.w #$0002
#_01A856: BNE .not_lower_layer_door_2

#_01A858: TYA
#_01A859: AND.w #$F07F
#_01A85C: JSR RoomDraw_MakeDoorPartsHighPriority_Vertical

#_01A85F: JMP.w RoomDraw_NormalRangedDoors_North

;---------------------------------------------------------------------------------------------------

.not_lower_layer_door_2
#_01A862: CMP.w #$0012
#_01A865: BNE .not_exit_modifier

#_01A867: LDX.w $19E0

#_01A86A: TYA
#_01A86B: STA.w $19E2,X

#_01A86E: INX
#_01A86F: INX
#_01A870: STX.w $19E0

#_01A873: RTS

;---------------------------------------------------------------------------------------------------

.not_exit_modifier
#_01A874: CMP.w #$0008
#_01A877: BNE .not_waterfall_door

#_01A879: JSR RoomDraw_NormalRangedDoors_North
#_01A87C: BRA RoomDraw_ChangeTileMapAddressToLowerLayer

;---------------------------------------------------------------------------------------------------

.not_waterfall_door
#_01A87E: CMP.w #$0020
#_01A881: BEQ .key_door

#_01A883: CMP.w #$0022
#_01A886: BEQ .key_door

#_01A888: CMP.w #$0024
#_01A88B: BEQ .key_door

#_01A88D: CMP.w #$0026
#_01A890: BNE .not_key_door

.key_door
#_01A892: LDX.w $0460

#_01A895: LDA.w #$0000
#_01A898: STA.w $19C0,X

#_01A89B: TYA
#_01A89C: STA.w $19A0,X

#_01A89F: TXA
#_01A8A0: LSR A
#_01A8A1: XBA
#_01A8A2: ORA.b $04
#_01A8A4: STA.w $1980,X

#_01A8A7: TXA
#_01A8A8: AND.w #$000F
#_01A8AB: TAY

#_01A8AC: LDA.w DungeonMask,Y

#_01A8AF: LDY.b $08
#_01A8B1: AND.w $068C
#_01A8B4: BEQ .not_open

#_01A8B6: INX
#_01A8B7: INX
#_01A8B8: STX.w $0460

#_01A8BB: RTS

;---------------------------------------------------------------------------------------------------

.not_open
#_01A8BC: LDA.b $04
#_01A8BE: CMP.w #$0024
#_01A8C1: BCC RoomDraw_OneSidedShutters_North

#_01A8C3: STY.b $08

#_01A8C5: LDX.w $0460

#_01A8C8: LDA.w #$0000
#_01A8CB: JSR RoomDraw_FlagDoorsAndGetFinalType

#_01A8CE: LDA.w DoorGFXDataOffset_North,Y
#_01A8D1: TAY

#_01A8D2: LDX.b $08

#_01A8D4: LDA.w #$0004
#_01A8D7: STA.b $0E

.next
#_01A8D9: LDA.w RoomDrawObjectData+0,Y
#_01A8DC: STA.l $7E4000,X

#_01A8E0: LDA.w RoomDrawObjectData+2,Y
#_01A8E3: STA.l $7E4080,X

#_01A8E7: LDA.w RoomDrawObjectData+4,Y
#_01A8EA: STA.l $7E4100,X

#_01A8EE: TYA
#_01A8EF: CLC
#_01A8F0: ADC.w #$0006
#_01A8F3: TAY

#_01A8F4: INX
#_01A8F5: INX

#_01A8F6: DEC.b $0E
#_01A8F8: BNE .next

;===================================================================================================

#RoomDraw_ChangeTileMapAddressToLowerLayer:
#_01A8FA: LDX.w $0460

#_01A8FD: LDA.w $199E,X
#_01A900: ORA.w #$2000
#_01A903: STA.w $199E,X

#_01A906: RTS

;===================================================================================================

.not_key_door
#_01A907: CMP.w #$0040
#_01A90A: BCC RoomDraw_NormalRangedDoors_North

#_01A90C: JMP.w RoomDraw_HighRangeDoor_North

;===================================================================================================

RoomDraw_NormalRangedDoors_North:
#_01A90F: LDX.b $02
#_01A911: CPX.w #$000C
#_01A914: BCC RoomDraw_OneSidedShutters_North

#_01A916: PHY

#_01A917: LDA.w $0460
#_01A91A: PHA

#_01A91B: ORA.w #$0010
#_01A91E: STA.w $0460

#_01A921: LDY.w DoorTileMapPositions_NorthMiddle,X

#_01A924: LDA.b $04
#_01A926: JSR RoomDraw_CheckIfLowerLayerDoors_Vertical

#_01A929: PLA
#_01A92A: STA.w $0460

#_01A92D: PLY

#_01A92E: LDA.b $04
#_01A930: STA.b $0A

;---------------------------------------------------------------------------------------------------

RoomDraw_OneSidedShutters_North:
#_01A932: STY.b $08

#_01A934: LDX.w $0460
#_01A937: LDA.w #$0000
#_01A93A: JSR RoomDraw_FlagDoorsAndGetFinalType
#_01A93D: BCC .exit

#_01A93F: LDA.w #$0018
#_01A942: CPY.w #$0036
#_01A945: BEQ .onesided_shutter

#_01A947: LDA.w #$0000
#_01A94A: CPY.w #$0038
#_01A94D: BNE .not_onesided_shutter

.onesided_shutter
#_01A94F: STA.b $0E

#_01A951: LDA.w $197E,X
#_01A954: AND.w #$FF00
#_01A957: ORA.b $0E
#_01A959: STA.w $197E,X

#_01A95C: LDY.b $0E

;---------------------------------------------------------------------------------------------------

.not_onesided_shutter
#_01A95E: LDX.w DoorGFXDataOffset_North,Y

#_01A961: LDY.b $08

#_01A963: LDA.w #$0004
#_01A966: STA.b $0E

.next
#_01A968: LDA.w RoomDrawObjectData+0,X
#_01A96B: STA.b [$BF],Y

#_01A96D: LDA.w RoomDrawObjectData+2,X
#_01A970: STA.b [$CB],Y

#_01A972: LDA.w RoomDrawObjectData+4,X
#_01A975: STA.b [$D7],Y

#_01A977: TXA
#_01A978: CLC
#_01A979: ADC.w #$0006
#_01A97C: TAX

#_01A97D: INY
#_01A97E: INY

#_01A97F: DEC.b $0E
#_01A981: BNE .next

.exit
#_01A983: RTS

;===================================================================================================

RoomDraw_Door_South:
#_01A984: LDY.w DoorTileMapPositions_SouthMiddle,X
#_01A987: STY.b $08

#_01A989: CMP.w #$0016
#_01A98C: BNE .not_to_layer2_door

#_01A98E: TYA
#_01A98F: CLC
#_01A990: ADC.w #$0202

#_01A993: JMP.w RoomDraw_MarkLayerToggleDoor

;---------------------------------------------------------------------------------------------------

.not_to_layer2_door
#_01A996: CMP.w #$0006
#_01A999: BNE .not_lower_layer_door_1

#_01A99B: JMP.w RoomDraw_MakeDoorHighPriorityLowerLayer_South

;---------------------------------------------------------------------------------------------------

.not_lower_layer_door_1
#_01A99E: CMP.w #$0014
#_01A9A1: BNE .not_dungeon_swap_door

#_01A9A3: TYA
#_01A9A4: CLC
#_01A9A5: ADC.w #$0202

#_01A9A8: JMP.w RoomDraw_MarkDungeonToggleDoor

;---------------------------------------------------------------------------------------------------

.not_dungeon_swap_door
#_01A9AB: CMP.w #$0012
#_01A9AE: BNE .not_exit_modifier

#_01A9B0: LDX.w $19E0

#_01A9B3: TYA
#_01A9B4: STA.w $19E2,X

#_01A9B7: INX
#_01A9B8: INX

#_01A9B9: STX.w $19E0

#_01A9BC: RTS

;---------------------------------------------------------------------------------------------------

.not_exit_modifier
#_01A9BD: CMP.w #$0040
#_01A9C0: BCC RoomDraw_NormalRangedDoors_South

#_01A9C2: JMP.w RoomDraw_OneSidedLowerShutters_South

;---------------------------------------------------------------------------------------------------

RoomDraw_NormalRangedDoors_South:
#_01A9C5: CMP.w #$000A
#_01A9C8: BNE .not_fancy_dungeon_exit

#_01A9CA: LDX.w $0460
#_01A9CD: LDA.w #$0001
#_01A9D0: JSR RoomDraw_FlagDoorsAndGetFinalType

#_01A9D3: LDA.b $08
#_01A9D5: SEC
#_01A9D6: SBC.w #$0206
#_01A9D9: STA.b $08

#_01A9DB: LDY.w #$2656
#_01A9DE: LDA.w #$000A
#_01A9E1: JMP.w RoomDraw_SomeBigDecors

;---------------------------------------------------------------------------------------------------

.not_fancy_dungeon_exit
#_01A9E4: CMP.w #$000C
#_01A9E7: BNE .not_lower_layer_fancy_dungeon_exit

#_01A9E9: TYA
#_01A9EA: ORA.w #$2000
#_01A9ED: STA.b $08

#_01A9EF: TAY

#_01A9F0: LDX.w $0460
#_01A9F3: LDA.w #$0001
#_01A9F6: JSR RoomDraw_FlagDoorsAndGetFinalType

#_01A9F9: LDA.b $08
#_01A9FB: SEC
#_01A9FC: SBC.w #$0206
#_01A9FF: STA.b $08

#_01AA01: LDY.w #$2656
#_01AA04: LDA.w #$000A
#_01AA07: JSR RoomDraw_SomeBigDecors

#_01AA0A: LDA.b $08
#_01AA0C: SEC
#_01AA0D: SBC.w #$2080
#_01AA10: TAX

;---------------------------------------------------------------------------------------------------

#_01AA11: LDY.w #$000A

.next
#_01AA14: LDA.l $7E4000,X
#_01AA18: ORA.w #$2000
#_01AA1B: STA.l $7E2000,X

#_01AA1F: INX
#_01AA20: INX

#_01AA21: DEY
#_01AA22: BNE .next

#_01AA24: RTS

;---------------------------------------------------------------------------------------------------

.not_lower_layer_fancy_dungeon_exit
#_01AA25: CMP.w #$000E
#_01AA28: BEQ RoomDraw_CaveExitLight

#_01AA2A: CMP.w #$0010
#_01AA2D: BNE RoomDraw_CheckIfExitDoor

;===================================================================================================

RoomDraw_HighPriorityExitLight:
#_01AA2F: TYA
#_01AA30: CLC
#_01AA31: ADC.w #$0200
#_01AA34: JSR RoomDraw_MakeDoorPartsHighPriority_Vertical

;===================================================================================================

RoomDraw_CaveExitLight:
#_01AA37: LDX.w $0460
#_01AA3A: LDA.w #$0001
#_01AA3D: JSR RoomDraw_FlagDoorsAndGetFinalType

#_01AA40: LDY.b $08

#_01AA42: LDX.w #$26F6
#_01AA45: LDA.w #$000A
#_01AA48: JMP.w RoomDraw_4x4Object

;===================================================================================================

RoomDraw_CheckIfExitDoor:
#_01AA4B: CMP.w #$0004
#_01AA4E: BNE RoomDraw_CheckIfLowerLayerDoors_Vertical

#_01AA50: TYA
#_01AA51: PHY

#_01AA52: ORA.w #$2000
#_01AA55: STA.b $08

#_01AA57: TAY

#_01AA58: JSR RoomDraw_HighPriorityExitLight

#_01AA5B: PLA
#_01AA5C: CLC
#_01AA5D: ADC.w #$0180
#_01AA60: TAX

#_01AA61: LDY.w #$0004

#_01AA64: BRA RoomDraw_NormalRangedDoors_South_next

;===================================================================================================

RoomDraw_CheckIfLowerLayerDoors_Vertical:
#_01AA66: CMP.w #$0002
#_01AA69: BNE .not_lower_layer

#_01AA6B: TYA
#_01AA6C: CLC
#_01AA6D: ADC.w #$0200
#_01AA70: JSR RoomDraw_MakeDoorPartsHighPriority_Vertical

#_01AA73: BRA RoomDraw_OneSidedShutters_South

;---------------------------------------------------------------------------------------------------

.not_lower_layer
#_01AA75: CMP.w #$0008
#_01AA78: BNE RoomDraw_OneSidedShutters_South

#_01AA7A: JSR RoomDraw_OneSidedShutters_South
#_01AA7D: JMP.w RoomDraw_ChangeTileMapAddressToLowerLayer

;===================================================================================================

RoomDraw_OneSidedShutters_South:
#_01AA80: STY.b $08

#_01AA82: LDX.w $0460

#_01AA85: LDA.w #$0001
#_01AA88: JSR RoomDraw_FlagDoorsAndGetFinalType
#_01AA8B: BCC .exit

#_01AA8D: LDA.w #$0000
#_01AA90: CPY.w #$001E
#_01AA93: BEQ .onesided_shutter_or_big_key_door

#_01AA95: CPY.w #$0036
#_01AA98: BEQ .onesided_shutter_or_big_key_door

#_01AA9A: LDA.w #$0018
#_01AA9D: CPY.w #$0038
#_01AAA0: BNE .not_onesided_shutter

.onesided_shutter_or_big_key_door
#_01AAA2: STA.b $0E

#_01AAA4: LDA.w $197E,X
#_01AAA7: AND.w #$FF00
#_01AAAA: ORA.b $0E
#_01AAAC: STA.w $197E,X

#_01AAAF: LDY.b $0E

.not_onesided_shutter
#_01AAB1: LDX.w DoorGFXDataOffset_South,Y
#_01AAB4: LDY.b $08

#_01AAB6: LDA.w #$0004
#_01AAB9: STA.b $0E

.next
#_01AABB: LDA.w RoomDrawObjectData+0,X
#_01AABE: STA.b [$CB],Y

#_01AAC0: LDA.w RoomDrawObjectData+2,X
#_01AAC3: STA.b [$D7],Y

#_01AAC5: LDA.w RoomDrawObjectData+4,X
#_01AAC8: STA.b [$DA],Y

#_01AACA: TXA
#_01AACB: CLC
#_01AACC: ADC.w #$0006
#_01AACF: TAX

#_01AAD0: INY
#_01AAD1: INY

#_01AAD2: DEC.b $0E
#_01AAD4: BNE .next

.exit
#_01AAD6: RTS

;===================================================================================================

RoomDraw_Door_West:
#_01AAD7: LDY.w DoorTileMapPositions_WestWall,X
#_01AADA: STY.b $08

#_01AADC: CMP.w #$0016
#_01AADF: BNE .not_to_layer2_door

#_01AAE1: TYA
#_01AAE2: CLC
#_01AAE3: ADC.w #$007C

#_01AAE6: JMP.w RoomDraw_MarkLayerToggleDoor

;---------------------------------------------------------------------------------------------------

.not_to_layer2_door
#_01AAE9: CMP.w #$0006
#_01AAEC: BNE .not_lower_layer_door_1

#_01AAEE: JMP.w RoomDraw_MakeDoorHighPriorityLowerLayer_West

;---------------------------------------------------------------------------------------------------

.not_lower_layer_door_1
#_01AAF1: CMP.w #$0014
#_01AAF4: BNE .not_dungeon_swap_door

#_01AAF6: TYA
#_01AAF7: CLC
#_01AAF8: ADC.w #$007C

#_01AAFB: JMP.w RoomDraw_MarkDungeonToggleDoor

;---------------------------------------------------------------------------------------------------

.not_dungeon_swap_door
#_01AAFE: CMP.w #$0002
#_01AB01: BNE .not_lower_layer_door_2

#_01AB03: TYA
#_01AB04: AND.w #$FFC0
#_01AB07: JSR RoomDraw_MakeDoorPartsHighPriority_Horizontal
#_01AB0A: BRA RoomDraw_NormalRangedDoors_West

;---------------------------------------------------------------------------------------------------

.not_lower_layer_door_2
#_01AB0C: CMP.w #$0008
#_01AB0F: BNE .not_waterfall_door

#_01AB11: JSR RoomDraw_NormalRangedDoors_West

#_01AB14: JMP.w RoomDraw_ChangeTileMapAddressToLowerLayer

;---------------------------------------------------------------------------------------------------

.not_waterfall_door
#_01AB17: CMP.w #$0040
#_01AB1A: BCC RoomDraw_NormalRangedDoors_West

#_01AB1C: JMP.w RoomDraw_HighRangeDoor_West

;===================================================================================================

RoomDraw_NormalRangedDoors_West:
#_01AB1F: LDX.b $02
#_01AB21: CPX.w #$000C
#_01AB24: BCC .is_a_cooler_type_of_door

#_01AB26: PHY

#_01AB27: LDA.w $0460
#_01AB2A: PHA

#_01AB2B: ORA.w #$0010
#_01AB2E: STA.w $0460

#_01AB31: LDY.w DoorTileMapPositions_WestMiddle,X

#_01AB34: LDA.b $04
#_01AB36: JSR RoomDraw_NormalRangedDoors_East

#_01AB39: PLA
#_01AB3A: STA.w $0460

#_01AB3D: PLY

#_01AB3E: LDA.b $04
#_01AB40: STA.b $0A

;===================================================================================================

.is_a_cooler_type_of_door
#_01AB42: STY.b $08

#_01AB44: LDX.w $0460
#_01AB47: LDA.w #$0002
#_01AB4A: JSR RoomDraw_FlagDoorsAndGetFinalType
#_01AB4D: BCC .exit

#_01AB4F: LDA.w #$0018
#_01AB52: CPY.w #$0036
#_01AB55: BEQ .onesided_shutter

#_01AB57: LDA.w #$0000
#_01AB5A: CPY.w #$0038
#_01AB5D: BNE .not_onesided_shutter

.onesided_shutter
#_01AB5F: STA.b $0E

#_01AB61: LDA.w $197E,X
#_01AB64: AND.w #$FF00
#_01AB67: ORA.b $0E
#_01AB69: STA.w $197E,X

#_01AB6C: LDY.b $0E

;---------------------------------------------------------------------------------------------------

.not_onesided_shutter
#_01AB6E: LDX.w DoorGFXDataOffset_West,Y
#_01AB71: LDY.b $08

#_01AB73: LDA.w #$0003
#_01AB76: STA.b $0E

;===================================================================================================

#RoomDraw_DrawUnreachableDoorSwitcher:
.next
#_01AB78: LDA.w RoomDrawObjectData+0,X
#_01AB7B: STA.b [$BF],Y

#_01AB7D: LDA.w RoomDrawObjectData+2,X
#_01AB80: STA.b [$CB],Y

#_01AB82: LDA.w RoomDrawObjectData+4,X
#_01AB85: STA.b [$D7],Y

#_01AB87: LDA.w RoomDrawObjectData+6,X
#_01AB8A: STA.b [$DA],Y

#_01AB8C: TXA
#_01AB8D: CLC
#_01AB8E: ADC.w #$0008
#_01AB91: TAX

#_01AB92: INY
#_01AB93: INY

#_01AB94: DEC.b $0E
#_01AB96: BNE .next

.exit
#_01AB98: RTS

;===================================================================================================

RoomDraw_Door_East:
#_01AB99: LDY.w DoorTileMapPositions_EastMiddle,X
#_01AB9C: STY.b $08

#_01AB9E: CMP.w #$0016
#_01ABA1: BNE .not_to_layer2_door

#_01ABA3: TYA
#_01ABA4: CLC
#_01ABA5: ADC.w #$0088

#_01ABA8: JMP.w RoomDraw_MarkLayerToggleDoor

;---------------------------------------------------------------------------------------------------

.not_to_layer2_door
#_01ABAB: CMP.w #$0006
#_01ABAE: BNE .not_lower_layer_door_1

#_01ABB0: JMP.w RoomDraw_MakeDoorHighPriorityLowerLayer_East

;---------------------------------------------------------------------------------------------------

.not_lower_layer_door_1
#_01ABB3: CMP.w #$0014
#_01ABB6: BNE .not_dungeon_swap_door

#_01ABB8: TYA
#_01ABB9: CLC
#_01ABBA: ADC.w #$0088

#_01ABBD: JMP.w RoomDraw_MarkDungeonToggleDoor

;---------------------------------------------------------------------------------------------------

.not_dungeon_swap_door
#_01ABC0: CMP.w #$0040
#_01ABC3: BCC RoomDraw_NormalRangedDoors_East

#_01ABC5: JMP.w RoomDraw_OneSidedLowerShutters_East

;===================================================================================================

RoomDraw_NormalRangedDoors_East:
#_01ABC8: CMP.w #$0002
#_01ABCB: BNE .not_lower_layer_door_2

#_01ABCD: TYA
#_01ABCE: CLC
#_01ABCF: ADC.w #$0008
#_01ABD2: JSR RoomDraw_MakeDoorPartsHighPriority_Horizontal

#_01ABD5: BRA .not_lower_layer_door_2 ; !USELESS

;---------------------------------------------------------------------------------------------------

.not_lower_layer_door_2
#_01ABD7: CMP.w #$0008
#_01ABDA: BNE RoomDraw_OneSidedShutters_East

#_01ABDC: JSR RoomDraw_OneSidedShutters_East

#_01ABDF: JMP.w RoomDraw_ChangeTileMapAddressToLowerLayer

;===================================================================================================

RoomDraw_OneSidedShutters_East:
#_01ABE2: STY.b $08

#_01ABE4: LDX.w $0460
#_01ABE7: LDA.w #$0003
#_01ABEA: JSR RoomDraw_FlagDoorsAndGetFinalType
#_01ABED: BCC EXIT_01AC3A

#_01ABEF: LDA.w #$0000
#_01ABF2: CPY.w #$0036
#_01ABF5: BEQ .onesided_shutter

#_01ABF7: LDA.w #$0018
#_01ABFA: CPY.w #$0038
#_01ABFD: BNE .not_onesided_shutter

.onesided_shutter
#_01ABFF: STA.b $0E

#_01AC01: LDA.w $197E,X
#_01AC04: AND.w #$FF00
#_01AC07: ORA.b $0E
#_01AC09: STA.w $197E,X

#_01AC0C: LDY.b $0E

.not_onesided_shutter
#_01AC0E: LDX.w DoorGFXDataOffset_East,Y

#_01AC11: LDY.b $08
#_01AC13: INY
#_01AC14: INY

#_01AC15: LDA.w #$0003
#_01AC18: STA.b $0E

;===================================================================================================

DrawUnusedDoorSwitchObject:
.next
#_01AC1A: LDA.w RoomDrawObjectData+0,X
#_01AC1D: STA.b [$BF],Y

#_01AC1F: LDA.w RoomDrawObjectData+2,X
#_01AC22: STA.b [$CB],Y

#_01AC24: LDA.w RoomDrawObjectData+4,X
#_01AC27: STA.b [$D7],Y

#_01AC29: LDA.w RoomDrawObjectData+6,X
#_01AC2C: STA.b [$DA],Y

#_01AC2E: TXA
#_01AC2F: CLC
#_01AC30: ADC.w #$0008
#_01AC33: TAX

#_01AC34: INY
#_01AC35: INY

#_01AC36: DEC.b $0E
#_01AC38: BNE .next

;---------------------------------------------------------------------------------------------------

#EXIT_01AC3A:
#_01AC3A: RTS

;---------------------------------------------------------------------------------------------------

RoomDraw_NorthCurtainDoor:
#_01AC3B: STY.b $08

#_01AC3D: LDX.w $0460

#_01AC40: LDA.w #$0000
#_01AC43: JSR RoomDraw_FlagDoorsAndGetFinalType
#_01AC46: BCC .not_open

#_01AC48: LDX.w DoorGFXDataOffset_North,Y

#_01AC4B: BRA .draw_open

.not_open
#_01AC4D: LDY.b $08
#_01AC4F: LDX.w #$078A

#_01AC52: JMP.w RoomDraw_4x4Object

.draw_open
#_01AC55: LDY.b $08
#_01AC57: JSR RoomDraw_4x4Object

#_01AC5A: RTS

;===================================================================================================

ExplodingWallNotOpen:
#_01AC5B: LDX.w $0460

#_01AC5E: STZ.w $19C0,X

#_01AC61: TXA
#_01AC62: LSR A
#_01AC63: XBA
#_01AC64: ORA.w #$0030
#_01AC67: STA.w $1980,X

#_01AC6A: INX
#_01AC6B: INX
#_01AC6C: STX.w $0460

#_01AC6F: RTS

;===================================================================================================

RoomDraw_Door_ExplodingWall:
#_01AC70: LDY.w ExplodingWallTileMapPosition,X
#_01AC73: STY.b $08

#_01AC75: LDX.w $0460

#_01AC78: LDA.b $08
#_01AC7A: CLC
#_01AC7B: ADC.w #$0014
#_01AC7E: STA.w $19A0,X

#_01AC81: TXA
#_01AC82: LSR A
#_01AC83: XBA
#_01AC84: ORA.w #$0030
#_01AC87: STA.w $1980,X

#_01AC8A: TXA
#_01AC8B: AND.w #$000F
#_01AC8E: TAY

#_01AC8F: LDA.w $068C
#_01AC92: AND.w DungeonMask,Y
#_01AC95: BEQ ExplodingWallNotOpen

#_01AC97: SEP #$30

#_01AC99: LDX.b #$00

#_01AC9B: LDA.b $AE
#_01AC9D: CMP.b #$20
#_01AC9F: BEQ .delete_tag

#_01ACA1: CMP.b #$25
#_01ACA3: BEQ .delete_tag

#_01ACA5: CMP.b #$28
#_01ACA7: BEQ .delete_tag

#_01ACA9: INX

.delete_tag
#_01ACAA: STZ.b $AE,X

;---------------------------------------------------------------------------------------------------

#_01ACAC: REP #$30

#_01ACAE: LDA.b $08
#_01ACB0: PHA

#_01ACB1: LDA.b $A7
#_01ACB3: ORA.w #$0002
#_01ACB6: STA.b $A7

#_01ACB8: LDA.w $0452
#_01ACBB: ORA.w #$0100
#_01ACBE: STA.w $0452

#_01ACC1: LDY.w #$0054
#_01ACC4: LDX.w DoorGFXDataOffset_South,Y
#_01ACC7: JSR RoomDraw_ExplodingWallSegment

#_01ACCA: PLA
#_01ACCB: CLC
#_01ACCC: ADC.w #$0300
#_01ACCF: STA.b $08

#_01ACD1: INC.w $0460
#_01ACD4: INC.w $0460

#_01ACD7: LDA.b $FC
#_01ACD9: ORA.w #$0200
#_01ACDC: STA.b $FC

#_01ACDE: LDY.w #$0054
#_01ACE1: LDX.w DoorGFXDataOffset_North,Y

;===================================================================================================

RoomDraw_ExplodingWallSegment:
#_01ACE4: LDA.w #$0012
#_01ACE7: STA.b $B2

#_01ACE9: LDY.b $08
#_01ACEB: JSR RoomDraw_ExplodingWallColumn

#_01ACEE: LDA.b $08
#_01ACF0: CLC
#_01ACF1: ADC.w #$0004
#_01ACF4: STA.b $08

#_01ACF6: TXA
#_01ACF7: CLC
#_01ACF8: ADC.w #$000C
#_01ACFB: TAX

#_01ACFC: PHX

#_01ACFD: TXY

;---------------------------------------------------------------------------------------------------

#_01ACFE: LDX.b $08

#_01AD00: LDA.w RoomDrawObjectData+0,Y

.next
#_01AD03: STA.l $7E2000,X
#_01AD07: STA.l $7E2080,X
#_01AD0B: STA.l $7E2100,X
#_01AD0F: STA.l $7E2180,X
#_01AD13: STA.l $7E2200,X
#_01AD17: STA.l $7E2280,X

#_01AD1B: INX
#_01AD1C: INX

#_01AD1D: DEC.b $B2
#_01AD1F: BNE .next

;---------------------------------------------------------------------------------------------------

#_01AD21: TXY

#_01AD22: PLX
#_01AD23: INX
#_01AD24: INX

;===================================================================================================

RoomDraw_ExplodingWallColumn:
#_01AD25: LDA.w #$0006
#_01AD28: STA.b $0A

.next
#_01AD2A: LDA.w RoomDrawObjectData+0,X
#_01AD2D: STA.b [$BF],Y

#_01AD2F: LDA.w RoomDrawObjectData+12,X
#_01AD32: STA.b [$C2],Y

#_01AD34: INX
#_01AD35: INX

#_01AD36: TYA
#_01AD37: CLC
#_01AD38: ADC.w #$0080
#_01AD3B: TAY

#_01AD3C: DEC.b $0A
#_01AD3E: BNE .next

#_01AD40: RTS

;===================================================================================================

RoomDraw_HighRangeDoor_North:
#_01AD41: LDX.b $02
#_01AD43: CPX.w #$000C
#_01AD46: BCC RoomDraw_OneSidedLowerShutters_North

#_01AD48: LDA.b $04
#_01AD4A: CMP.w #$0046
#_01AD4D: BEQ RoomDraw_OneSidedLowerShutters_North

#_01AD4F: PHY

#_01AD50: LDA.w $0460
#_01AD53: PHA

#_01AD54: ORA.w #$0010
#_01AD57: STA.w $0460

#_01AD5A: LDY.w DoorTileMapPositions_NorthMiddle,X
#_01AD5D: JSR RoomDraw_OneSidedLowerShutters_South

#_01AD60: PLA
#_01AD61: STA.w $0460

#_01AD64: PLY

;===================================================================================================

RoomDraw_OneSidedLowerShutters_North:
#_01AD65: STY.b $08

#_01AD67: LDX.w $0460

#_01AD6A: LDA.w #$0000
#_01AD6D: JSR RoomDraw_FlagDoorsAndGetFinalType

#_01AD70: LDA.w #$0044
#_01AD73: CPY.w #$0048
#_01AD76: BEQ .lower_layer_onesided_shutter

#_01AD78: LDA.w #$0040
#_01AD7B: CPY.w #$004A
#_01AD7E: BNE .not_lower_layer_onesided_shutter

.lower_layer_onesided_shutter
#_01AD80: STA.b $0E

#_01AD82: LDA.w $197E,X
#_01AD85: AND.w #$FF00
#_01AD88: ORA.b $0E
#_01AD8A: STA.w $197E,X

#_01AD8D: LDY.b $0E

.not_lower_layer_onesided_shutter
#_01AD8F: LDA.w DoorGFXDataOffset_North,Y
#_01AD92: TAY

;---------------------------------------------------------------------------------------------------

#_01AD93: LDX.b $08

#_01AD95: LDA.w #$0004
#_01AD98: STA.b $0E

.next
#_01AD9A: LDA.w RoomDrawObjectData+0,Y
#_01AD9D: STA.l $7E2000,X

#_01ADA1: LDA.w RoomDrawObjectData+2,Y
#_01ADA4: STA.l $7E4080,X

#_01ADA8: LDA.w RoomDrawObjectData+4,Y
#_01ADAB: STA.l $7E4100,X

#_01ADAF: TYA
#_01ADB0: CLC
#_01ADB1: ADC.w #$0006
#_01ADB4: TAY

#_01ADB5: INX
#_01ADB6: INX

#_01ADB7: DEC.b $0E
#_01ADB9: BNE .next

;---------------------------------------------------------------------------------------------------

#_01ADBB: LDA.b $04
#_01ADBD: CMP.w #$0046
#_01ADC0: BEQ .is_teleport_door

#_01ADC2: LDA.b $08
#_01ADC4: JSR RoomDraw_MakeDoorHighPriority_North

.is_teleport_door
#_01ADC7: LDX.w $0460

#_01ADCA: LDA.w $199E,X
#_01ADCD: ORA.w #$2000
#_01ADD0: STA.w $199E,X

#_01ADD3: RTS

;===================================================================================================

RoomDraw_OneSidedLowerShutters_South:
#_01ADD4: STY.b $08

#_01ADD6: LDX.w $0460
#_01ADD9: LDA.w #$0001
#_01ADDC: JSR RoomDraw_FlagDoorsAndGetFinalType

#_01ADDF: LDA.w #$0040
#_01ADE2: CPY.w #$0048
#_01ADE5: BEQ .lower_layer_onesided_shutter

#_01ADE7: LDA.w #$0044
#_01ADEA: CPY.w #$004A
#_01ADED: BNE .not_lower_layer_onesided_shutter

.lower_layer_onesided_shutter
#_01ADEF: STA.b $0E

#_01ADF1: LDA.w $197E,X
#_01ADF4: AND.w #$FF00
#_01ADF7: ORA.b $0E
#_01ADF9: STA.w $197E,X

#_01ADFC: LDY.b $0E

.not_lower_layer_onesided_shutter
#_01ADFE: LDA.w DoorGFXDataOffset_South,Y
#_01AE01: TAY

;---------------------------------------------------------------------------------------------------

#_01AE02: LDX.b $08

#_01AE04: LDA.w #$0004
#_01AE07: STA.b $0E

.next
#_01AE09: LDA.w RoomDrawObjectData+0,Y
#_01AE0C: STA.l $7E4080,X

#_01AE10: LDA.w RoomDrawObjectData+2,Y
#_01AE13: STA.l $7E4100,X

#_01AE17: LDA.w RoomDrawObjectData+4,Y
#_01AE1A: STA.l $7E2180,X

#_01AE1E: TYA
#_01AE1F: CLC
#_01AE20: ADC.w #$0006
#_01AE23: TAY

#_01AE24: INX
#_01AE25: INX

#_01AE26: DEC.b $0E
#_01AE28: BNE .next

;---------------------------------------------------------------------------------------------------

#_01AE2A: LDA.b $08
#_01AE2C: CLC
#_01AE2D: ADC.w #$0200
#_01AE30: JSR RoomDraw_MakeDoorHighPriority_South

#_01AE33: LDX.w $0460

#_01AE36: LDA.w $199E,X
#_01AE39: ORA.w #$2000
#_01AE3C: STA.w $199E,X

#_01AE3F: RTS

;===================================================================================================

RoomDraw_HighRangeDoor_West:
#_01AE40: LDX.b $02
#_01AE42: CPX.w #$000C
#_01AE45: BCC RoomDraw_OneSidedLowerShutters_West

#_01AE47: PHY

#_01AE48: LDA.w $0460
#_01AE4B: PHA

#_01AE4C: ORA.w #$0010
#_01AE4F: STA.w $0460

#_01AE52: LDY.w DoorTileMapPositions_WestMiddle,X
#_01AE55: JSR RoomDraw_OneSidedLowerShutters_East

#_01AE58: PLA
#_01AE59: STA.w $0460

#_01AE5C: PLY

;===================================================================================================

RoomDraw_OneSidedLowerShutters_West:
#_01AE5D: STY.b $08

#_01AE5F: LDX.w $0460

#_01AE62: LDA.w #$0002
#_01AE65: JSR RoomDraw_FlagDoorsAndGetFinalType

#_01AE68: LDA.w #$0044
#_01AE6B: CPY.w #$0048
#_01AE6E: BEQ .lower_layer_onesided_shutter

#_01AE70: LDA.w #$0040
#_01AE73: CPY.w #$004A
#_01AE76: BNE .not_lower_layer_onesided_shutter

.lower_layer_onesided_shutter
#_01AE78: STA.b $0E

#_01AE7A: LDA.w $197E,X
#_01AE7D: AND.w #$FF00
#_01AE80: ORA.b $0E
#_01AE82: STA.w $197E,X

#_01AE85: LDY.b $0E

;---------------------------------------------------------------------------------------------------

.not_lower_layer_onesided_shutter
#_01AE87: LDA.w DoorGFXDataOffset_West,Y
#_01AE8A: TAY

#_01AE8B: LDX.b $08

#_01AE8D: LDA.w RoomDrawObjectData+0,Y
#_01AE90: STA.l $7E2000,X

#_01AE94: LDA.w RoomDrawObjectData+2,Y
#_01AE97: STA.l $7E2080,X

#_01AE9B: LDA.w RoomDrawObjectData+4,Y
#_01AE9E: STA.l $7E2100,X

#_01AEA2: LDA.w RoomDrawObjectData+6,Y
#_01AEA5: STA.l $7E2180,X

#_01AEA9: TYA
#_01AEAA: CLC
#_01AEAB: ADC.w #$0008
#_01AEAE: TAY

#_01AEAF: INX
#_01AEB0: INX

;---------------------------------------------------------------------------------------------------

#_01AEB1: LDA.w #$0002
#_01AEB4: STA.b $0E

.next
#_01AEB6: LDA.w RoomDrawObjectData+0,Y
#_01AEB9: STA.l $7E4000,X

#_01AEBD: LDA.w RoomDrawObjectData+2,Y
#_01AEC0: STA.l $7E4080,X

#_01AEC4: LDA.w RoomDrawObjectData+4,Y
#_01AEC7: STA.l $7E4100,X

#_01AECB: LDA.w RoomDrawObjectData+6,Y
#_01AECE: STA.l $7E4180,X

#_01AED2: TYA
#_01AED3: CLC
#_01AED4: ADC.w #$0008
#_01AED7: TAY

#_01AED8: INX
#_01AED9: INX

#_01AEDA: DEC.b $0E
#_01AEDC: BNE .next

;---------------------------------------------------------------------------------------------------

#_01AEDE: LDA.b $08
#_01AEE0: JSR RoomDraw_MakeDoorHighPriority_West

#_01AEE3: LDX.w $0460

#_01AEE6: LDA.w $199E,X
#_01AEE9: ORA.w #$2000
#_01AEEC: STA.w $199E,X

#_01AEEF: RTS

;===================================================================================================

RoomDraw_OneSidedLowerShutters_East:
#_01AEF0: STY.b $08

#_01AEF2: LDX.w $0460

#_01AEF5: LDA.w #$0003
#_01AEF8: JSR RoomDraw_FlagDoorsAndGetFinalType

#_01AEFB: LDA.w #$0040

#_01AEFE: CPY.w #$0048
#_01AF01: BEQ .lower_layer_onesided_shutter

#_01AF03: LDA.w #$0044
#_01AF06: CPY.w #$004A
#_01AF09: BNE .not_lower_layer_onesided_shutter

.lower_layer_onesided_shutter
#_01AF0B: STA.b $0E

#_01AF0D: LDA.w $197E,X
#_01AF10: AND.w #$FF00
#_01AF13: ORA.b $0E
#_01AF15: STA.w $197E,X

#_01AF18: LDY.b $0E

.not_lower_layer_onesided_shutter
#_01AF1A: LDA.w DoorGFXDataOffset_East,Y
#_01AF1D: TAY

#_01AF1E: LDX.b $08

#_01AF20: LDA.w #$0002
#_01AF23: STA.b $0E

.next
#_01AF25: LDA.w RoomDrawObjectData+0,Y
#_01AF28: STA.l $7E4002,X

#_01AF2C: LDA.w RoomDrawObjectData+2,Y
#_01AF2F: STA.l $7E4082,X

#_01AF33: LDA.w RoomDrawObjectData+4,Y
#_01AF36: STA.l $7E4102,X

#_01AF3A: LDA.w RoomDrawObjectData+6,Y
#_01AF3D: STA.l $7E4182,X

#_01AF41: TYA
#_01AF42: CLC
#_01AF43: ADC.w #$0008
#_01AF46: TAY

#_01AF47: INX
#_01AF48: INX

#_01AF49: DEC.b $0E
#_01AF4B: BNE .next

;---------------------------------------------------------------------------------------------------

#_01AF4D: LDA.w RoomDrawObjectData+0,Y
#_01AF50: STA.l $7E2002,X

#_01AF54: LDA.w RoomDrawObjectData+2,Y
#_01AF57: STA.l $7E2082,X

#_01AF5B: LDA.w RoomDrawObjectData+4,Y
#_01AF5E: STA.l $7E2102,X

#_01AF62: LDA.w RoomDrawObjectData+6,Y
#_01AF65: STA.l $7E2182,X

#_01AF69: LDA.b $08
#_01AF6B: CLC
#_01AF6C: ADC.w #$0008
#_01AF6F: JSR RoomDraw_MakeDoorHighPriority_East

#_01AF72: LDX.w $0460

#_01AF75: LDA.w $199E,X
#_01AF78: ORA.w #$2000
#_01AF7B: STA.w $199E,X

#_01AF7E: RTS

;===================================================================================================

RoomDraw_MakeDoorHighPriorityLowerLayer_North:
#_01AF7F: LDA.w #$0000
#_01AF82: JSR RoomDraw_FlagDoorsAndGetFinalType

#_01AF85: LDA.b $08
#_01AF87: CLC
#_01AF88: ADC.w #$0080

;===================================================================================================

RoomDraw_MakeDoorHighPriority_North:
#_01AF8B: STA.b $02

#_01AF8D: AND.w #$F07F
#_01AF90: TAX

.next
#_01AF91: LDA.l $7E2000,X
#_01AF95: ORA.w #$2000
#_01AF98: STA.l $7E2000,X

#_01AF9C: LDA.l $7E2002,X
#_01AFA0: ORA.w #$2000
#_01AFA3: STA.l $7E2002,X

#_01AFA7: LDA.l $7E2004,X
#_01AFAB: ORA.w #$2000
#_01AFAE: STA.l $7E2004,X

#_01AFB2: LDA.l $7E2006,X
#_01AFB6: ORA.w #$2000
#_01AFB9: STA.l $7E2006,X

#_01AFBD: TXA
#_01AFBE: CLC
#_01AFBF: ADC.w #$0080
#_01AFC2: TAX

#_01AFC3: CPX.b $02
#_01AFC5: BNE .next

#_01AFC7: RTS

;===================================================================================================

RoomDraw_MakeDoorHighPriorityLowerLayer_South:
#_01AFC8: LDA.w #$0001
#_01AFCB: JSR RoomDraw_FlagDoorsAndGetFinalType

#_01AFCE: LDA.b $08
#_01AFD0: CLC
#_01AFD1: ADC.w #$0100

;===================================================================================================

RoomDraw_MakeDoorHighPriority_South:
#_01AFD4: TAX

.next
#_01AFD5: LDA.l $7E2000,X
#_01AFD9: ORA.w #$2000
#_01AFDC: STA.l $7E2000,X

#_01AFE0: LDA.l $7E2002,X
#_01AFE4: ORA.w #$2000
#_01AFE7: STA.l $7E2002,X

#_01AFEB: LDA.l $7E2004,X
#_01AFEF: ORA.w #$2000
#_01AFF2: STA.l $7E2004,X

#_01AFF6: LDA.l $7E2006,X
#_01AFFA: ORA.w #$2000
#_01AFFD: STA.l $7E2006,X

#_01B001: TXA
#_01B002: CLC
#_01B003: ADC.w #$0080
#_01B006: TAX

#_01B007: AND.w #$0F80
#_01B00A: BNE .next

#_01B00C: RTS

;===================================================================================================

RoomDraw_MakeDoorHighPriorityLowerLayer_West:
#_01B00D: LDA.w #$0002
#_01B010: JSR RoomDraw_FlagDoorsAndGetFinalType

#_01B013: LDA.b $08
#_01B015: INC A
#_01B016: INC A

;===================================================================================================

RoomDraw_MakeDoorHighPriority_West:
#_01B017: STA.b $02

#_01B019: AND.w #$FFC0
#_01B01C: TAX

.next
#_01B01D: LDA.l $7E2000,X
#_01B021: ORA.w #$2000
#_01B024: STA.l $7E2000,X

#_01B028: LDA.l $7E2080,X
#_01B02C: ORA.w #$2000
#_01B02F: STA.l $7E2080,X

#_01B033: LDA.l $7E2100,X
#_01B037: ORA.w #$2000
#_01B03A: STA.l $7E2100,X

#_01B03E: LDA.l $7E2180,X
#_01B042: ORA.w #$2000
#_01B045: STA.l $7E2180,X

#_01B049: INX
#_01B04A: INX
#_01B04B: CPX.b $02
#_01B04D: BNE .next

#_01B04F: RTS

;===================================================================================================

RoomDraw_MakeDoorHighPriorityLowerLayer_East:
#_01B050: LDA.w #$0003
#_01B053: JSR RoomDraw_FlagDoorsAndGetFinalType

#_01B056: LDA.b $08
#_01B058: CLC
#_01B059: ADC.w #$0004

;===================================================================================================

RoomDraw_MakeDoorHighPriority_East:
#_01B05C: TAX

.next
#_01B05D: LDA.l $7E2000,X
#_01B061: ORA.w #$2000
#_01B064: STA.l $7E2000,X

#_01B068: LDA.l $7E2080,X
#_01B06C: ORA.w #$2000
#_01B06F: STA.l $7E2080,X

#_01B073: LDA.l $7E2100,X
#_01B077: ORA.w #$2000
#_01B07A: STA.l $7E2100,X

#_01B07E: LDA.l $7E2180,X
#_01B082: ORA.w #$2000
#_01B085: STA.l $7E2180,X

#_01B089: INX
#_01B08A: INX

#_01B08B: TXA
#_01B08C: AND.w #$003F
#_01B08F: BNE .next

#_01B091: RTS

;===================================================================================================

RoomDraw_MarkDungeonToggleDoor:
#_01B092: LDX.w $0450

#_01B095: LSR A
#_01B096: STA.w $06D0,X

#_01B099: INX
#_01B09A: INX
#_01B09B: STX.w $0450

#_01B09E: RTS

;===================================================================================================

RoomDraw_MarkLayerToggleDoor:
#_01B09F: LDX.w $044E

#_01B0A2: LSR A
#_01B0A3: STA.w $06C0,X

#_01B0A6: INX
#_01B0A7: INX
#_01B0A8: STX.w $044E

#_01B0AB: RTS

;===================================================================================================

RoomDraw_GetObjectSize_1to16:
#_01B0AC: LDA.w #$0001

;===================================================================================================

RoomDraw_GetObjectSize_1to16_timesA:
#_01B0AF: STA.b $0E

#_01B0B1: LDA.b $B2
#_01B0B3: ASL A
#_01B0B4: ASL A

#_01B0B5: ORA.b $B4
#_01B0B7: ADC.b $0E
#_01B0B9: STA.b $B2

#_01B0BB: STZ.b $B4

#_01B0BD: RTS

;===================================================================================================

RoomDraw_GetObjectSize_1to15or26:
#_01B0BE: LDA.b $B2
#_01B0C0: ASL A
#_01B0C1: ASL A
#_01B0C2: ORA.b $B4
#_01B0C4: BNE .nonzero

#_01B0C6: LDA.w #$001A

.nonzero
#_01B0C9: STA.b $B2

#_01B0CB: RTS

;===================================================================================================

RoomDraw_GetObjectSize_1to15or32:
#_01B0CC: LDA.b $B2
#_01B0CE: ASL A
#_01B0CF: ASL A
#_01B0D0: ORA.b $B4
#_01B0D2: BNE .nonzero

#_01B0D4: LDA.w #$0020

.nonzero
#_01B0D7: STA.b $B2

#_01B0D9: RTS

;===================================================================================================

RoomDraw_FlagDoorsAndGetFinalType:
#_01B0DA: STA.w $19C0,X

#_01B0DD: TYA
#_01B0DE: STA.w $19A0,X

#_01B0E1: TXA
#_01B0E2: LSR A
#_01B0E3: XBA

#_01B0E4: ORA.b $04
#_01B0E6: STA.w $1980,X

#_01B0E9: TXA
#_01B0EA: AND.w #$000F
#_01B0ED: TAY

#_01B0EE: CPY.w #$0008
#_01B0F1: BCS .dont_flag_door_open

#_01B0F3: LDA.w $068C
#_01B0F6: AND.w DungeonMask,Y
#_01B0F9: BEQ .dont_flag_door_open

#_01B0FB: LDA.w $1980,X
#_01B0FE: AND.w #$00FF
#_01B101: CMP.w #$0018
#_01B104: BEQ .is_shutter_door

#_01B106: CMP.w #$0044
#_01B109: BNE .not_shutter_door

.is_shutter_door
#_01B10B: LDA.w $0468
#_01B10E: BNE .dont_flag_door_open

.not_shutter_door
#_01B110: PHX

#_01B111: LDX.b $04

#_01B113: LDA.w DoorwayReplacementDoorGFX,X
#_01B116: STA.b $0A

#_01B118: PLX

#_01B119: LDA.w $1980,X
#_01B11C: AND.w #$00FF
#_01B11F: CMP.w #$0018
#_01B122: BEQ .dont_flag_door_open

#_01B124: CMP.w #$0044
#_01B127: BEQ .dont_flag_door_open

#_01B129: CMP.w #$001A
#_01B12C: BCC .dont_flag_door_open

#_01B12E: CMP.w #$0040
#_01B131: BEQ .dont_flag_door_open

#_01B133: CMP.w #$0046
#_01B136: BEQ .dont_flag_door_open

#_01B138: LDA.w $0400
#_01B13B: ORA.w DungeonMask,X
#_01B13E: STA.w $0400

.dont_flag_door_open
#_01B141: LDY.b $0A

#_01B143: INX
#_01B144: INX
#_01B145: STX.w $0460

#_01B148: CPY.w #$0032
#_01B14B: BEQ CLC_and_EXIT

#_01B14D: CPY.w #$0008
#_01B150: BEQ CLC_and_EXIT

#_01B152: LDA.b $04
#_01B154: CMP.w #$001A
#_01B157: BNE .no_extra_flagging_needed

#_01B159: LDA.b $2F
#_01B15B: AND.w #$00FF
#_01B15E: STA.b $0A

#_01B160: DEX
#_01B161: DEX

#_01B162: TXA
#_01B163: XBA
#_01B164: STA.w $0436

#_01B167: LDA.b $00
#_01B169: AND.w #$0003
#_01B16C: ASL A
#_01B16D: ORA.w $0436
#_01B170: STA.w $0436

#_01B173: AND.w #$00FF
#_01B176: CMP.b $0A
#_01B178: BNE .flag_shutter_door

#_01B17A: EOR.w #$0002
#_01B17D: CMP.b $0A
#_01B17F: BEQ CLC_and_EXIT

.flag_shutter_door
#_01B181: LDA.w $068C
#_01B184: ORA.w DungeonMask,X
#_01B187: STA.w $068C

#_01B18A: LDY.w #$0000

;---------------------------------------------------------------------------------------------------

.no_extra_flagging_needed
#_01B18D: SEC

#_01B18E: RTS

;---------------------------------------------------------------------------------------------------

CLC_and_EXIT:
#_01B18F: CLC

#_01B190: RTS

;===================================================================================================

RoomDraw_SmallRailCorner:
#_01B191: STA.b $0E

#_01B193: LDA.b [$BF],Y
#_01B195: AND.w #$03FF
#_01B198: CMP.b $0E
#_01B19A: BEQ CLC_and_EXIT

#_01B19C: SEC

#_01B19D: RTS

;===================================================================================================

UNREACHABLE_01B19E:
#_01B19E: TAX

#_01B19F: LDA.w #$0007

#_01B1A2: BRA RoomDraw_MakeDoorPartsHighPriority_Vertical_set_size

;===================================================================================================
; TODO better names
RoomDraw_MakeDoorPartsHighPriority_Vertical:
#_01B1A4: TAX

#_01B1A5: LDA.w #$0007

.set_size
#_01B1A8: STA.b $0E

.next
#_01B1AA: LDA.l $7E2000,X
#_01B1AE: ORA.w #$2000
#_01B1B1: STA.l $7E2000,X

#_01B1B5: LDA.l $7E2002,X
#_01B1B9: ORA.w #$2000
#_01B1BC: STA.l $7E2002,X

#_01B1C0: LDA.l $7E2004,X
#_01B1C4: ORA.w #$2000
#_01B1C7: STA.l $7E2004,X

#_01B1CB: LDA.l $7E2006,X
#_01B1CF: ORA.w #$2000
#_01B1D2: STA.l $7E2006,X

#_01B1D6: TXA
#_01B1D7: CLC
#_01B1D8: ADC.w #$0080
#_01B1DB: TAX

#_01B1DC: DEC.b $0E
#_01B1DE: BNE .next

#_01B1E0: RTS

;===================================================================================================

UNREACHABLE_01B1E1:
#_01B1E1: TAX

#_01B1E2: LDA.w #$0007

#_01B1E5: BRA RoomDraw_MakeDoorPartsHighPriority_Horizontal_continue

;===================================================================================================

RoomDraw_MakeDoorPartsHighPriority_Horizontal:
#_01B1E7: TAX

#_01B1E8: LDA.w #$0005

.continue
#_01B1EB: STA.b $0E

.next
#_01B1ED: LDA.l $7E2000,X
#_01B1F1: ORA.w #$2000
#_01B1F4: STA.l $7E2000,X

#_01B1F8: LDA.l $7E2080,X
#_01B1FC: ORA.w #$2000
#_01B1FF: STA.l $7E2080,X

#_01B203: LDA.l $7E2100,X
#_01B207: ORA.w #$2000
#_01B20A: STA.l $7E2100,X

#_01B20E: LDA.l $7E2180,X
#_01B212: ORA.w #$2000
#_01B215: STA.l $7E2180,X

#_01B219: INX
#_01B21A: INX

#_01B21B: DEC.b $0E
#_01B21D: BNE .next

#_01B21F: RTS

;===================================================================================================

RoomDraw_Downwards4x2VariableSpacing:
#_01B220: STA.b $0E

.next
#_01B222: LDA.w RoomDrawObjectData+0,X
#_01B225: STA.b [$BF],Y

#_01B227: LDA.w RoomDrawObjectData+2,X
#_01B22A: STA.b [$C2],Y

#_01B22C: LDA.w RoomDrawObjectData+4,X
#_01B22F: STA.b [$C5],Y

#_01B231: LDA.w RoomDrawObjectData+6,X
#_01B234: STA.b [$C8],Y

#_01B236: LDA.w RoomDrawObjectData+8,X
#_01B239: STA.b [$CB],Y

#_01B23B: LDA.w RoomDrawObjectData+10,X
#_01B23E: STA.b [$CE],Y

#_01B240: LDA.w RoomDrawObjectData+12,X
#_01B243: STA.b [$D1],Y

#_01B245: LDA.w RoomDrawObjectData+14,X
#_01B248: STA.b [$D4],Y

#_01B24A: TYA
#_01B24B: CLC
#_01B24C: ADC.b $0E
#_01B24E: TAY

#_01B24F: DEC.b $B2
#_01B251: BNE .next

#_01B253: RTS

;===================================================================================================

UNREACHABLE_01B254:
#_01B254: STA.b $0E

.next
#_01B256: JSR RoomDraw_Object_2x2_downwards

#_01B259: TXA
#_01B25A: CLC
#_01B25B: ADC.w #$0008
#_01B25E: TAX

#_01B25F: DEC.b $0E
#_01B261: BNE .next

#_01B263: RTS

;===================================================================================================

UNREACHABLE_01B264:
#_01B264: LDA.b $B2
#_01B266: BEQ .exit

.next
#_01B268: LDA.w #$0002
#_01B26B: JSR RoomDraw_Object_4xN

#_01B26E: TXA
#_01B26F: SEC
#_01B270: SBC.w #$0010
#_01B273: TAX

#_01B274: DEC.b $B2
#_01B276: BNE .next

.exit
#_01B278: RTS

;===================================================================================================

RoomDraw_DrawObject2x2and1:
#_01B279: LDA.w RoomDrawObjectData+0,X
#_01B27C: STA.b [$BF],Y

#_01B27E: LDA.w RoomDrawObjectData+2,X
#_01B281: STA.b [$CB],Y

#_01B283: LDA.w RoomDrawObjectData+4,X
#_01B286: STA.b [$D7],Y

#_01B288: LDA.w RoomDrawObjectData+6,X
#_01B28B: STA.b [$DA],Y

#_01B28D: LDA.w RoomDrawObjectData+8,X
#_01B290: STA.b [$DD],Y

#_01B292: RTS

;===================================================================================================

RoomDraw_DrawDiagonalGrave:
.next
#_01B293: JSR RoomDraw_DrawObject2x2and1

#_01B296: TYA
#_01B297: CLC
#_01B298: ADC.w #$0082
#_01B29B: TAY

;---------------------------------------------------------------------------------------------------

#RoomDraw_DrawDiagonalGrave_start:
#_01B29C: DEC.b $B2
#_01B29E: BNE .next

#_01B2A0: RTS

;===================================================================================================

RoomDraw_DrawDiagonalAcute:
.next
#_01B2A1: JSR RoomDraw_DrawObject2x2and1

#_01B2A4: TYA
#_01B2A5: SEC
#_01B2A6: SBC.w #$007E
#_01B2A9: TAY

;---------------------------------------------------------------------------------------------------

#RoomDraw_DrawDiagonalAcute_start:
#_01B2AA: DEC.b $B2
#_01B2AC: BNE .next

#_01B2AE: RTS

;===================================================================================================

RoomDraw_Object_2x2_downwards:
#_01B2AF: LDA.w RoomDrawObjectData+0,X
#_01B2B2: STA.b [$BF],Y

#_01B2B4: LDA.w RoomDrawObjectData+2,X
#_01B2B7: STA.b [$CB],Y

#_01B2B9: LDA.w RoomDrawObjectData+4,X
#_01B2BC: STA.b [$C2],Y

#_01B2BE: LDA.w RoomDrawObjectData+6,X
#_01B2C1: STA.b [$CE],Y

#_01B2C3: TYA
#_01B2C4: CLC
#_01B2C5: ADC.w #$0100
#_01B2C8: TAY

#_01B2C9: RTS

;===================================================================================================

RoomDraw_LineOf8x8_advance_and_use_B2_for_count:
#_01B2CA: INX
#_01B2CB: INX

#_01B2CC: INY
#_01B2CD: INY

;===================================================================================================

RoomDraw_LineOf8x8_use_B2_for_count:
#_01B2CE: LDA.b $B2

;===================================================================================================

RoomDraw_LineOf8x8:
#_01B2D0: STA.b $0A

#_01B2D2: LDA.w RoomDrawObjectData+0,X

.next
#_01B2D5: STA.b [$BF],Y
#_01B2D7: INY
#_01B2D8: INY

#_01B2D9: DEC.b $0A
#_01B2DB: BNE .next

#_01B2DD: LDA.b $08
#_01B2DF: CLC

#_01B2E0: RTS

;===================================================================================================

RoomDraw_RightwardShelfEnd:
#_01B2E1: LDA.w RoomDrawObjectData+0,X
#_01B2E4: STA.b [$BF],Y

#_01B2E6: LDA.w RoomDrawObjectData+2,X
#_01B2E9: STA.b [$CB],Y

#_01B2EB: LDA.w RoomDrawObjectData+4,X
#_01B2EE: STA.b [$D7],Y

#_01B2F0: LDA.w RoomDrawObjectData+6,X
#_01B2F3: STA.b [$DA],Y

#_01B2F5: RTS

;===================================================================================================

RoomDraw_RightwardBarSegment:
#_01B2F6: LDA.w RoomDrawObjectData+0,X
#_01B2F9: STA.b [$BF],Y

#_01B2FB: LDA.w RoomDrawObjectData+2,X
#_01B2FE: STA.b [$CB],Y

#_01B300: LDA.w RoomDrawObjectData+4,X
#_01B303: STA.b [$D7],Y

#_01B305: RTS

;===================================================================================================

RoomDraw_WeirdGloveRequiredPot:
#_01B306: LDA.w #$1010
#_01B309: BRA DrawBigGraySegment

;===================================================================================================

RoomDraw_WeirdUglyPot:
#_01B30B: LDA.w #$1212
#_01B30E: BRA DrawBigGraySegment

;===================================================================================================

RoomDraw_BigGrayRock:
#_01B310: STY.b $08

#_01B312: LDX.w #$0E62
#_01B315: LDA.w #$2020
#_01B318: JSR DrawBigGraySegment

#_01B31B: LDX.w #$0E6A
#_01B31E: LDA.w #$2121
#_01B321: JSR DrawBigGraySegment

#_01B324: LDA.b $08
#_01B326: CLC
#_01B327: ADC.w #$0100
#_01B32A: TAY

#_01B32B: LDX.w #$0E72
#_01B32E: LDA.w #$2222
#_01B331: JSR DrawBigGraySegment

#_01B334: LDX.w #$0E7A
#_01B337: LDA.w #$2323

;===================================================================================================

DrawBigGraySegment:
#_01B33A: PHX

#_01B33B: LDX.w $042C

#_01B33E: STA.w $0500,X

#_01B341: INC.w $042C
#_01B344: INC.w $042C

#_01B347: LDA.b $BA
#_01B349: STA.w $0520,X

#_01B34C: TYA
#_01B34D: STA.w $0540,X

#_01B350: LDA.b $BF
#_01B352: CMP.w #$4000
#_01B355: BNE .lower_layer

#_01B357: TYA
#_01B358: ORA.w #$2000
#_01B35B: STA.w $0540,X

.lower_layer
#_01B35E: LDA.b [$BF],Y
#_01B360: STA.w $0560,X

#_01B363: LDA.b [$CB],Y
#_01B365: STA.w $0580,X

#_01B368: LDA.b [$C2],Y
#_01B36A: STA.w $05A0,X

#_01B36D: LDA.b [$CE],Y
#_01B36F: STA.w $05C0,X

#_01B372: PLX

#_01B373: JMP.w RoomDraw_Object_2x2_rightwards

;===================================================================================================

RoomDraw_RightwardsFakePots2x2_1to16:
#_01B376: JSR RoomDraw_GetObjectSize_1to16

.next
#_01B379: JSR RoomDraw_SinglePot
#_01B37C: DEC.b $B2
#_01B37E: BNE .next

#_01B380: RTS

;===================================================================================================

RoomDraw_DownwardsFakePots2x2_1to16:
#_01B381: JSR RoomDraw_GetObjectSize_1to16

.next
#_01B384: JSR RoomDraw_SinglePot

#_01B387: LDA.b $08
#_01B389: CLC
#_01B38A: ADC.w #$0100
#_01B38D: STA.b $08

#_01B38F: TAY

#_01B390: DEC.b $B2
#_01B392: BNE .next

#_01B394: RTS

;===================================================================================================

RoomDraw_SinglePot:
#_01B395: PHX

#_01B396: LDX.w $042C

#_01B399: INC.w $042C
#_01B39C: INC.w $042C

#_01B39F: LDA.w #$1111
#_01B3A2: STA.w $0500,X

#_01B3A5: LDA.b $BA
#_01B3A7: STA.w $0520,X

#_01B3AA: TYA
#_01B3AB: STA.w $0540,X

#_01B3AE: LDA.b $BF
#_01B3B0: CMP.w #$4000
#_01B3B3: BNE .lower_layer

#_01B3B5: TYA
#_01B3B6: ORA.w #$2000
#_01B3B9: STA.w $0540,X

.lower_layer
#_01B3BC: LDA.w #$0D0E
#_01B3BF: STA.w $0560,X

#_01B3C2: LDA.w #$0D1E
#_01B3C5: STA.w $0580,X

#_01B3C8: LDA.w #$4D0E
#_01B3CB: STA.w $05A0,X

#_01B3CE: LDA.w #$4D1E
#_01B3D1: STA.w $05C0,X

#_01B3D4: PLX

#_01B3D5: LDA.l $7EF3CA
#_01B3D9: BEQ .light_world

#_01B3DB: LDX.w #$0E92

.light_world
#_01B3DE: JMP.w RoomDraw_Object_2x2_rightwards

;===================================================================================================

RoomDraw_BombableFloor:
#_01B3E1: LDA.b $A0
#_01B3E3: CMP.w #$0065
#_01B3E6: BNE .not_open_tt_attic

#_01B3E8: LDA.w $0402
#_01B3EB: AND.w #$1000
#_01B3EE: BEQ .not_open_tt_attic

#_01B3F0: STZ.b $B2
#_01B3F2: STZ.b $B4

#_01B3F4: LDX.w #$05AA
#_01B3F7: JMP.w RoomDraw_BigHole4x4_1to16

;---------------------------------------------------------------------------------------------------

.not_open_tt_attic
#_01B3FA: STY.b $08

#_01B3FC: LDA.w #$05BA
#_01B3FF: STA.b $0E

#_01B401: LDX.w #$0220
#_01B404: LDA.w #$3030
#_01B407: JSR .draw_segment

#_01B40A: LDX.w #$0228
#_01B40D: LDA.w #$3131
#_01B410: JSR .draw_segment

#_01B413: LDA.b $08
#_01B415: CLC
#_01B416: ADC.w #$0100
#_01B419: TAY

#_01B41A: LDX.w #$0230
#_01B41D: LDA.w #$3232
#_01B420: JSR .draw_segment

#_01B423: LDX.w #$0238
#_01B426: LDA.w #$3333

;---------------------------------------------------------------------------------------------------

.draw_segment
#_01B429: PHX

#_01B42A: LDX.w $042C

#_01B42D: STA.w $0500,X

#_01B430: INC.w $042C
#_01B433: INC.w $042C

#_01B436: LDA.b $BA
#_01B438: STA.w $0520,X

#_01B43B: TYA
#_01B43C: STA.w $0540,X

#_01B43F: LDA.b $BF
#_01B441: CMP.w #$4000
#_01B444: BNE .lower_layer

#_01B446: TYA
#_01B447: ORA.w #$2000
#_01B44A: STA.w $0540,X

.lower_layer
#_01B44D: PHY

#_01B44E: LDY.b $0E

#_01B450: LDA.w RoomDrawObjectData+0,Y
#_01B453: STA.w $0560,X

#_01B456: LDA.w RoomDrawObjectData+2,Y
#_01B459: STA.w $0580,X

#_01B45C: LDA.w RoomDrawObjectData+4,Y
#_01B45F: STA.w $05A0,X

#_01B462: LDA.w RoomDrawObjectData+6,Y
#_01B465: STA.w $05C0,X

#_01B468: TYA
#_01B469: CLC
#_01B46A: ADC.w #$0008
#_01B46D: STA.b $0E

#_01B46F: PLY
#_01B470: PLX

#_01B471: JMP.w RoomDraw_Object_2x2_rightwards

;===================================================================================================

RoomDraw_RightwardsHammerPegs2x2_1to16:
#_01B474: JSR RoomDraw_GetObjectSize_1to16

.next
#_01B477: JSR RoomDraw_HammerPegSingle

#_01B47A: DEC.b $B2
#_01B47C: BNE .next

#_01B47E: RTS

;===================================================================================================

RoomDraw_DownwardsHammerPegs2x2_1to16:
#_01B47F: JSR RoomDraw_GetObjectSize_1to16

.next
#_01B482: JSR RoomDraw_HammerPegSingle

#_01B485: LDA.b $08
#_01B487: CLC
#_01B488: ADC.w #$0100
#_01B48B: STA.b $08

#_01B48D: TAY

#_01B48E: DEC.b $B2
#_01B490: BNE .next

#_01B492: RTS

;===================================================================================================

RoomDraw_HammerPegSingle:
#_01B493: PHX

#_01B494: LDX.w $042C

#_01B497: INC.w $042C
#_01B49A: INC.w $042C

#_01B49D: LDA.w #$4040
#_01B4A0: STA.w $0500,X

#_01B4A3: LDA.b $BA
#_01B4A5: STA.w $0520,X

#_01B4A8: TYA
#_01B4A9: STA.w $0540,X

#_01B4AC: LDA.b $BF
#_01B4AE: CMP.w #$4000
#_01B4B1: BNE .lower_layer

#_01B4B3: TYA
#_01B4B4: ORA.w #$2000
#_01B4B7: STA.w $0540,X

.lower_layer
#_01B4BA: LDA.w #$19D8
#_01B4BD: STA.w $0560,X

#_01B4C0: LDA.w #$19D9
#_01B4C3: STA.w $0580,X

#_01B4C6: LDA.w #$59D8
#_01B4C9: STA.w $05A0,X

#_01B4CC: LDA.w #$59D9
#_01B4CF: STA.w $05C0,X

#_01B4D2: PLX

#_01B4D3: JMP.w RoomDraw_Object_2x2_rightwards

;===================================================================================================

DrawObjects_PushableBlock:
#_01B4D6: LDX.w $042C

#_01B4D9: INC.w $042C
#_01B4DC: INC.w $042C

#_01B4DF: STZ.w $0500,X

#_01B4E2: LDA.b $BA
#_01B4E4: STA.w $0520,X

#_01B4E7: TYA
#_01B4E8: STA.w $0540,X

#_01B4EB: AND.w #$3FFF
#_01B4EE: TAY

#_01B4EF: LDA.b [$BF],Y
#_01B4F1: STA.w $0560,X

#_01B4F4: LDA.b [$CB],Y
#_01B4F6: STA.w $0580,X

#_01B4F9: LDA.b [$C2],Y
#_01B4FB: STA.w $05A0,X

#_01B4FE: LDA.b [$CE],Y
#_01B500: STA.w $05C0,X

#_01B503: LDX.w #$0E52

#_01B506: JMP.w RoomDraw_Object_2x2_rightwards

;===================================================================================================

DrawObjects_LightableTorch:
#_01B509: LDY.w $042E

#_01B50C: STA.w $0540,Y

#_01B50F: DEX
#_01B510: DEX

#_01B511: TXA
#_01B512: STA.w $0520,Y

#_01B515: INC.w $042E
#_01B518: INC.w $042E

#_01B51B: LDX.w #$0EC2

#_01B51E: LDA.b $08
#_01B520: ASL A
#_01B521: BCC .dont_tally

#_01B523: LDX.w #$0ECA

#_01B526: LDA.w $045A
#_01B529: CMP.w #$0003
#_01B52C: BCS .dont_tally

#_01B52E: INC.w $045A

.dont_tally
#_01B531: STX.b $0C

#_01B533: LDA.b $08
#_01B535: AND.w #$3FFF
#_01B538: TAY

#_01B539: JMP.w RoomDraw_Object_2x2_rightwards

;===================================================================================================
; FREE ROM: 0x24
;===================================================================================================
NULL_01B53C:
#_01B53C: db $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF
#_01B544: db $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF
#_01B54C: db $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF
#_01B554: db $FF, $FF, $FF, $FF, $FF, $FF, $FF, $FF
#_01B55C: db $FF, $FF, $FF, $FF

;===================================================================================================

pool Underworld_LoadHeader

.camera_offset
#_01B560: dw  256
#_01B562: dw -256

pool off

;---------------------------------------------------------------------------------------------------

Underworld_LoadHeader:
#_01B564: STZ.w $0642
#_01B567: STZ.w $0646
#_01B56A: STZ.w $0641

#_01B56D: REP #$30

#_01B56F: LDA.b $11
#_01B571: AND.w #$00FF
#_01B574: BNE .nonzero_submodule

#_01B576: LDA.b $E2
#_01B578: AND.w #$FE00
#_01B57B: STA.w $062C

#_01B57E: LDA.b $E8
#_01B580: BRA .set_lower_bound_y

;---------------------------------------------------------------------------------------------------

.nonzero_submodule
#_01B582: CMP.w #$0015
#_01B585: BEQ .adjust_camera_x

#_01B587: CMP.w #$0012
#_01B58A: BCS .dont_adjust_camera_x

#_01B58C: CMP.w #$0006
#_01B58F: BCC .dont_adjust_camera_x

.adjust_camera_x
#_01B591: LDA.b $E2
#_01B593: CLC
#_01B594: ADC.w #$0020

#_01B597: BRA .set_lower_bound_x

.dont_adjust_camera_x
#_01B599: LDA.b $67
#_01B59B: AND.w #$000F
#_01B59E: LSR A
#_01B59F: CMP.w #$0002
#_01B5A2: BCS .walking_vertically

#_01B5A4: ASL A
#_01B5A5: TAX

#_01B5A6: LDA.b $E2
#_01B5A8: CLC
#_01B5A9: ADC.l .camera_offset,X

.set_lower_bound_x
#_01B5AD: AND.w #$FE00
#_01B5B0: STA.w $062C

#_01B5B3: LDA.b $E8
#_01B5B5: CLC
#_01B5B6: ADC.w #$0020

#_01B5B9: BRA .set_lower_bound_y

.walking_vertically
#_01B5BB: LSR A
#_01B5BC: LSR A
#_01B5BD: ASL A
#_01B5BE: TAX

#_01B5BF: LDA.b $E2
#_01B5C1: CLC
#_01B5C2: ADC.w #$0020
#_01B5C5: AND.w #$FE00
#_01B5C8: STA.w $062C

#_01B5CB: LDA.b $E8
#_01B5CD: CLC
#_01B5CE: ADC.l .camera_offset,X

.set_lower_bound_y
#_01B5D2: AND.w #$FE00
#_01B5D5: STA.w $062E

#_01B5D8: LDA.b $A0
#_01B5DA: ASL A
#_01B5DB: TAX

#_01B5DC: LDA.l RoomHeader_RoomToPointer,X
#_01B5E0: STA.b $0D

;---------------------------------------------------------------------------------------------------

#_01B5E2: SEP #$20
#_01B5E4: REP #$10

#_01B5E6: LDA.b #$04
#_01B5E8: STA.b $0F

#_01B5EA: LDA.w $0414
#_01B5ED: STA.l $7EC208

#_01B5F1: LDY.w #$0000

#_01B5F4: LDA.b [$0D],Y
#_01B5F6: AND.b #$E0
#_01B5F8: ASL A
#_01B5F9: ROL A
#_01B5FA: ROL A
#_01B5FB: ROL A
#_01B5FC: STA.w $0414

#_01B5FF: LDA.b [$0D],Y
#_01B601: AND.b #$1C
#_01B603: LSR A
#_01B604: LSR A
#_01B605: STA.w $046C

#_01B608: LDA.l $7EC005
#_01B60C: STA.l $7EC006

#_01B610: LDA.b [$0D],Y
#_01B612: AND.b #$01
#_01B614: STA.l $7EC005

;---------------------------------------------------------------------------------------------------
; TODO annotate
#_01B618: REP #$20

#_01B61A: INY

#_01B61B: LDA.b [$0D],Y
#_01B61D: AND.w #$00FF
#_01B620: ASL A
#_01B621: ASL A
#_01B622: TAX

#_01B623: SEP #$20

#_01B625: LDA.l UnderworldPaletteSets+0,X
#_01B629: STA.w $0AB6

#_01B62C: LDA.l UnderworldPaletteSets+1,X
#_01B630: STA.w $0AAC

#_01B633: LDA.l UnderworldPaletteSets+2,X
#_01B637: STA.w $0AAD

#_01B63A: LDA.l UnderworldPaletteSets+3,X
#_01B63E: STA.w $0AAE

#_01B641: INY
#_01B642: LDA.b [$0D],Y
#_01B644: STA.w $0AA2

#_01B647: INY
#_01B648: LDA.b [$0D],Y
#_01B64A: CLC
#_01B64B: ADC.b #$40
#_01B64D: STA.w $0AA3

#_01B650: INY
#_01B651: LDA.b [$0D],Y
#_01B653: STA.b $AD

#_01B655: INY
#_01B656: LDA.b [$0D],Y
#_01B658: STA.b $AE

#_01B65A: INY
#_01B65B: LDA.b [$0D],Y
#_01B65D: STA.b $AF

#_01B65F: INY
#_01B660: LDA.b [$0D],Y
#_01B662: AND.b #$03
#_01B664: STA.w $063C

#_01B667: LDA.b [$0D],Y
#_01B669: AND.b #$0C
#_01B66B: LSR A
#_01B66C: LSR A
#_01B66D: STA.w $063D

#_01B670: LDA.b [$0D],Y
#_01B672: AND.b #$30
#_01B674: LSR A
#_01B675: LSR A
#_01B676: LSR A
#_01B677: LSR A
#_01B678: STA.w $063E

#_01B67B: LDA.b [$0D],Y
#_01B67D: AND.b #$C0
#_01B67F: ASL A
#_01B680: ROL A
#_01B681: ROL A
#_01B682: STA.w $063F

#_01B685: INY
#_01B686: LDA.b [$0D],Y
#_01B688: AND.b #$03
#_01B68A: STA.w $0640

#_01B68D: INY
#_01B68E: LDA.b [$0D],Y
#_01B690: STA.l $7EC000

#_01B694: INY
#_01B695: LDA.b [$0D],Y
#_01B697: STA.l $7EC001

#_01B69B: INY
#_01B69C: LDA.b [$0D],Y
#_01B69E: STA.l $7EC002

#_01B6A2: INY
#_01B6A3: LDA.b [$0D],Y
#_01B6A5: STA.l $7EC003

#_01B6A9: INY
#_01B6AA: LDA.b [$0D],Y
#_01B6AC: STA.l $7EC004

;---------------------------------------------------------------------------------------------------

#_01B6B0: REP #$30

#_01B6B2: LDA.w #$0001
#_01B6B5: STA.w $0468

#_01B6B8: STZ.w $04BA

#_01B6BB: LDA.b $A0
#_01B6BD: ASL A
#_01B6BE: CLC
#_01B6BF: ADC.b $A0
#_01B6C1: STA.w $0110

#_01B6C4: TAX

#_01B6C5: LDA.l RoomData_DoorDataPointers+1,X
#_01B6C9: STA.b $B8

#_01B6CB: LDA.l RoomData_DoorDataPointers+0,X
#_01B6CF: STA.b $B7

#_01B6D1: LDA.b $A0
#_01B6D3: ASL A
#_01B6D4: TAX

#_01B6D5: LDA.l $7EF000,X
#_01B6D9: AND.w #$F000
#_01B6DC: STA.w $0400

#_01B6DF: ORA.w #$0F00
#_01B6E2: STA.w $068C

#_01B6E5: LDA.l $7EF000,X
#_01B6E9: AND.w #$0FF0
#_01B6EC: ASL A ; x16
#_01B6ED: ASL A
#_01B6EE: ASL A
#_01B6EF: ASL A
#_01B6F0: STA.w $0402

#_01B6F3: LDA.l $7EF000,X
#_01B6F7: AND.w #$000F
#_01B6FA: STA.w $0408

#_01B6FD: LDX.w #$0000
#_01B700: TXY

;---------------------------------------------------------------------------------------------------

.next_door
#_01B701: STZ.w $19A0,X

#_01B704: LDA.b [$B7],Y
#_01B706: CMP.w #$FFFF
#_01B709: BEQ .doors_done

#_01B70B: STA.w $19A0,X

#_01B70E: INY
#_01B70F: INY

#_01B710: INX
#_01B711: INX

#_01B712: BRA .next_door

;---------------------------------------------------------------------------------------------------

.doors_done
#_01B714: LDA.b $A0
#_01B716: DEC A
#_01B717: TAX

#_01B718: AND.w #$000F
#_01B71B: CMP.w #$000F
#_01B71E: BEQ .room_id_X0

#_01B720: LDA.w #$0024
#_01B723: JSR Underworld_CheckAdjacentRoomsForOpenDoors

;---------------------------------------------------------------------------------------------------

.room_id_X0
#_01B726: LDA.b $A0
#_01B728: INC A
#_01B729: TAX

#_01B72A: AND.w #$000F
#_01B72D: BEQ .room_id_XF

#_01B72F: LDA.w #$0018
#_01B732: JSR Underworld_CheckAdjacentRoomsForOpenDoors

;---------------------------------------------------------------------------------------------------

.room_id_XF
#_01B735: LDA.b $A0
#_01B737: SEC
#_01B738: SBC.w #$0010
#_01B73B: TAX
#_01B73C: BMI .room_id_0X

#_01B73E: LDA.w #$000C
#_01B741: JSR Underworld_CheckAdjacentRoomsForOpenDoors

;---------------------------------------------------------------------------------------------------

.room_id_0X
#_01B744: LDA.b $A0
#_01B746: CLC
#_01B747: ADC.w #$0010
#_01B74A: TAX

#_01B74B: CMP.w #$0140
#_01B74E: BCS .room_id_FX

#_01B750: LDA.w #$0000
#_01B753: JSR Underworld_CheckAdjacentRoomsForOpenDoors

.room_id_FX
#_01B756: SEP #$30

;---------------------------------------------------------------------------------------------------

#EXIT_01B758:
#_01B758: RTS

;===================================================================================================

Underworld_CheckAdjacentRoomsForOpenDoors:
#_01B759: STA.b $04

#_01B75B: JSR Underworld_LoadAdjacentRoomDoors

#_01B75E: LDY.w #$0000

.next_door
#_01B761: LDA.w $1110,Y
#_01B764: CMP.w #$FFFF
#_01B767: BEQ EXIT_01B758

#_01B769: STA.b $02

#_01B76B: LDX.b $04

#_01B76D: AND.w #$00FF
#_01B770: CMP.w RoomDraw_DoorPartnerSelfLocation,X
#_01B773: BEQ .match

#_01B775: INX
#_01B776: INX
#_01B777: CMP.w RoomDraw_DoorPartnerSelfLocation,X
#_01B77A: BEQ .match

#_01B77C: INX
#_01B77D: INX
#_01B77E: CMP.w RoomDraw_DoorPartnerSelfLocation,X
#_01B781: BEQ .match

#_01B783: INX
#_01B784: INX
#_01B785: CMP.w RoomDraw_DoorPartnerSelfLocation,X
#_01B788: BEQ .match

#_01B78A: INX
#_01B78B: INX
#_01B78C: CMP.w RoomDraw_DoorPartnerSelfLocation,X
#_01B78F: BEQ .match

#_01B791: INX
#_01B792: INX
#_01B793: CMP.w RoomDraw_DoorPartnerSelfLocation,X
#_01B796: BNE .no_match

;---------------------------------------------------------------------------------------------------

.match
#_01B798: LDA.w RoomDraw_DoorPartnerLocation,X
#_01B79B: STA.b $00

#_01B79D: LDX.w #$0000

.try_next
#_01B7A0: LDA.w $19A0,X
#_01B7A3: AND.w #$00FF
#_01B7A6: CMP.b $00
#_01B7A8: BEQ .matching_partner

#_01B7AA: INX
#_01B7AB: INX
#_01B7AC: CPX.w #$0010
#_01B7AF: BNE .try_next

#_01B7B1: BRA .no_match

;---------------------------------------------------------------------------------------------------

.matching_partner
#_01B7B3: LDA.w $19A0,X
#_01B7B6: AND.w #$FF00
#_01B7B9: CMP.w #$3000
#_01B7BC: BEQ .no_match

#_01B7BE: CMP.w #$4400
#_01B7C1: BEQ .shutter

#_01B7C3: CMP.w #$1800
#_01B7C6: BNE .not_shutter

.shutter
#_01B7C8: LDA.b $0E
#_01B7CA: CMP.b $A2
#_01B7CC: BNE .no_match

#_01B7CE: STZ.w $0468

#_01B7D1: BRA .open_door

.not_shutter
#_01B7D3: LDA.w $1100
#_01B7D6: AND.w DungeonMask,Y
#_01B7D9: BEQ .no_match

.open_door
#_01B7DB: LDA.w $068C
#_01B7DE: ORA.w DungeonMask,X
#_01B7E1: STA.w $068C

.no_match
#_01B7E4: INY
#_01B7E5: INY
#_01B7E6: CPY.w #$0010
#_01B7E9: BEQ EXIT_01B7EE

#_01B7EB: JMP.w .next_door

;---------------------------------------------------------------------------------------------------

#EXIT_01B7EE:
#_01B7EE: RTS

;===================================================================================================

Underworld_LoadAdjacentRoomDoors:
#_01B7EF: STX.b $0E

#_01B7F1: TXA
#_01B7F2: ASL A
#_01B7F3: CLC
#_01B7F4: ADC.b $0E
#_01B7F6: TAX

#_01B7F7: LDA.l RoomData_DoorDataPointers+1,X
#_01B7FB: STA.b $B8

#_01B7FD: LDA.l RoomData_DoorDataPointers+0,X
#_01B801: STA.b $B7

#_01B803: LDA.b $0E
#_01B805: ASL A
#_01B806: TAX

#_01B807: LDA.l $7EF000,X
#_01B80B: AND.w #$F000
#_01B80E: ORA.w #$0F00
#_01B811: STA.w $1100

;---------------------------------------------------------------------------------------------------

#_01B814: LDX.w #$0000
#_01B817: TXY

.next_door
#_01B818: LDA.b [$B7],Y
#_01B81A: STA.w $1110,X

#_01B81D: CMP.w #$FFFF
#_01B820: BEQ EXIT_01B7EE

#_01B822: AND.w #$FF00
#_01B825: CMP.w #$4000
#_01B828: BEQ .default

#_01B82A: CMP.w #$0200
#_01B82D: BCS .not_default

.default
#_01B82F: LDA.w $1100
#_01B832: ORA.w DungeonMask,X
#_01B835: STA.w $1100

.not_default
#_01B838: INY
#_01B839: INY

#_01B83A: INX
#_01B83B: INX

#_01B83C: BRA .next_door

;===================================================================================================

Underworld_ApplyRoomOverlay:
#_01B83E: REP #$30

#_01B840: LDA.b $BA
#_01B842: BNE .pointer_is_set

#_01B844: STZ.w $045E

#_01B847: LDA.w $04BA
#_01B84A: ASL A
#_01B84B: CLC
#_01B84C: ADC.w $04BA
#_01B84F: TAX

#_01B850: LDA.l OverlayDataPointers+1,X
#_01B854: STA.b $B8

#_01B856: LDA.l OverlayDataPointers+0,X
#_01B85A: STA.b $B7

#_01B85C: JSR Underworld_DrawRoomOverlay

#_01B85F: REP #$30

#_01B861: STZ.b $BA
#_01B863: STZ.w $045E

;---------------------------------------------------------------------------------------------------

.pointer_is_set
#_01B866: STZ.b $0C

.next
#_01B868: LDY.b $BA

#_01B86A: LDA.b [$B7],Y
#_01B86C: CMP.w #$FFFF
#_01B86F: BEQ .end

#_01B871: STA.b $00

#_01B873: SEP #$20

#_01B875: LDA.b [$B7],Y
#_01B877: AND.b #$FC
#_01B879: STA.b $08

#_01B87B: INY
#_01B87C: INY

#_01B87D: LDA.b $01
#_01B87F: LSR A
#_01B880: LSR A
#_01B881: LSR A
#_01B882: ROR.b $08
#_01B884: STA.b $09

#_01B886: INY
#_01B887: STY.b $BA

#_01B889: REP #$20

#_01B88B: LDA.b $08
#_01B88D: PHA

#_01B88E: JSR Underworld_PrepNextTileMapUpdateDMA

#_01B891: PLA
#_01B892: JSR Underworld_DrawRoomOverlay_Apply

#_01B895: BRA .next

;---------------------------------------------------------------------------------------------------

.end
#_01B897: LDY.b $0C

#_01B899: LDA.w #$FFFF
#_01B89C: STA.w $1100,Y

#_01B89F: SEP #$30

#_01B8A1: LDA.b #$01
#_01B8A3: STA.b $18

#_01B8A5: STZ.b $11

#_01B8A7: RTL

;===================================================================================================

pool Underworld_LoadAttribute_Selectable

.vectors
#_01B8A8: dw Underworld_LoadBasicAttribute
#_01B8AA: dw Underworld_LoadBasicAttribute_partial
#_01B8AC: dw Underworld_LoadObjectAttribute
#_01B8AE: dw Underworld_LoadDoorAttribute
#_01B8B0: dw Underworld_InitializePegAttribute
#_01B8B2: dw EXIT_01B966

pool off

;---------------------------------------------------------------------------------------------------
; TODO better name
Underworld_LoadAttribute_Selectable:
#_01B8B4: LDA.w $0200
#_01B8B7: ASL A
#_01B8B8: TAX

#_01B8B9: JSR (.vectors,X)

#_01B8BC: SEP #$30

#_01B8BE: RTL

;===================================================================================================

Underworld_LoadAttributeTable:
#_01B8BF: REP #$20

#_01B8C1: STZ.b $B2
#_01B8C3: STZ.b $B4

#_01B8C5: LDA.w #$1000
#_01B8C8: STA.b $00

#_01B8CA: JSR Underworld_LoadBasicAttribute_full

#_01B8CD: SEP #$30

#_01B8CF: JSR Underworld_LoadObjectAttribute
#_01B8D2: JSR Underworld_LoadDoorAttribute

#_01B8D5: LDA.l $7EC172
#_01B8D9: BEQ .dont_flip

#_01B8DB: JSL Underworld_FlipCrystalPegAttribute

.dont_flip
#_01B8DF: STZ.w $0200

#_01B8E2: RTL

;===================================================================================================

Underworld_LoadBasicAttribute:
#_01B8E3: REP #$20

#_01B8E5: INC.w $0200

#_01B8E8: STZ.b $B2
#_01B8EA: STZ.b $B4

;===================================================================================================

Underworld_LoadBasicAttribute_partial:
#_01B8EC: REP #$20

#_01B8EE: LDA.w #$0040
#_01B8F1: STA.b $00

;===================================================================================================

Underworld_LoadBasicAttribute_full:
#_01B8F3: PHB

#_01B8F4: LDX.b #$7E
#_01B8F6: PHX
#_01B8F7: PLB

#_01B8F8: REP #$10

;---------------------------------------------------------------------------------------------------

.next
#_01B8FA: LDX.b $B2

#_01B8FC: LDA.l $7E2002,X
#_01B900: AND.w #$03FF
#_01B903: TAY

#_01B904: LDA.w $7EFE00,Y
#_01B907: STA.b $04

#_01B909: LDA.l $7E2000,X
#_01B90D: AND.w #$03FF
#_01B910: TAY

#_01B911: SEP #$20

;---------------------------------------------------------------------------------------------------

#_01B913: LDA.w $7EFE00,Y
#_01B916: CMP.b #$10
#_01B918: BCC .dont_flip_a

#_01B91A: CMP.b #$1C
#_01B91C: BCS .dont_flip_a

#_01B91E: LDA.l $7E2001,X
#_01B922: ASL A
#_01B923: ROL A
#_01B924: ROL A
#_01B925: AND.b #$03
#_01B927: ORA.w $7EFE00,Y

.dont_flip_a
#_01B92A: STA.b $02

#_01B92C: LDA.b $04
#_01B92E: CMP.b #$10
#_01B930: BCC .dont_flip_b

#_01B932: CMP.b #$1C
#_01B934: BCS .dont_flip_b

#_01B936: LDA.l $7E2003,X
#_01B93A: ASL A
#_01B93B: ROL A
#_01B93C: ROL A
#_01B93D: AND.b #$03
#_01B93F: ORA.b $04

.dont_flip_b
#_01B941: XBA
#_01B942: LDA.b $02

#_01B944: REP #$21

#_01B946: LDX.b $B4

#_01B948: STA.l $7F2000,X

#_01B94C: INX
#_01B94D: INX
#_01B94E: STX.b $B4

#_01B950: LDA.b $B2
#_01B952: ADC.w #$0004
#_01B955: STA.b $B2

#_01B957: DEC.b $00
#_01B959: BNE .next

;---------------------------------------------------------------------------------------------------

#_01B95B: LDA.b $B4
#_01B95D: CMP.w #$2000
#_01B960: BNE .more_to_go

#_01B962: INC.w $7E0200

.more_to_go
#_01B965: PLB

;---------------------------------------------------------------------------------------------------

#EXIT_01B966:
#_01B966: RTS

;===================================================================================================
; TODO verify all
Underworld_LoadObjectAttribute:
#_01B967: REP #$30

#_01B969: LDX.w $0432
#_01B96C: BEQ .no_star_tiles

#_01B96E: LDY.w #$0000
#_01B971: LDA.w #$3B3B

.next_star_tile
#_01B974: LDX.w $06A0,Y

#_01B977: STA.l $7F2000,X
#_01B97B: STA.l $7F2040,X

#_01B97F: INY
#_01B980: INY
#_01B981: CPY.w $0432
#_01B984: BNE .next_star_tile

;---------------------------------------------------------------------------------------------------

.no_star_tiles
#_01B986: LDA.w #$3030
#_01B989: STA.b $00

#_01B98B: LDY.w #$0000

#_01B98E: LDX.w $0438
#_01B991: BEQ .no_intraroom_stairs_up

.next_intraroom_stairs_up
#_01B993: LDX.w $06B0,Y

#_01B996: LDA.w #$0000
#_01B999: STA.l $7F2081,X

#_01B99D: LDA.w #$2626
#_01B9A0: STA.l $7F2001,X

#_01B9A4: LDA.b $00
#_01B9A6: STA.l $7F2041,X

#_01B9AA: CLC
#_01B9AB: ADC.w #$0101
#_01B9AE: STA.b $00

#_01B9B0: INY
#_01B9B1: INY
#_01B9B2: CPY.w $0438
#_01B9B5: BNE .next_intraroom_stairs_up

;---------------------------------------------------------------------------------------------------

.no_intraroom_stairs_up
#_01B9B7: CPY.w $047E
#_01B9BA: BEQ .no_spiral_stairs_up_a

.next_spiral_stairs_up_a
#_01B9BC: LDX.w $06B0,Y

#_01B9BF: LDA.w #$5E5E
#_01B9C2: STA.l $7F2001,X
#_01B9C6: STA.l $7F2081,X
#_01B9CA: STA.l $7F20C1,X

#_01B9CE: LDA.b $00
#_01B9D0: STA.l $7F2041,X

#_01B9D4: CLC
#_01B9D5: ADC.w #$0101
#_01B9D8: STA.b $00

#_01B9DA: INY
#_01B9DB: INY
#_01B9DC: CPY.w $047E
#_01B9DF: BNE .next_spiral_stairs_up_a

;---------------------------------------------------------------------------------------------------

.no_spiral_stairs_up_a
#_01B9E1: CPY.w $0482
#_01B9E4: BEQ .no_spiral_stairs_up_b

.next_spiral_stairs_up_b
#_01B9E6: LDX.w $06B0,Y

#_01B9E9: LDA.w #$5F5F
#_01B9EC: STA.l $7F2001,X
#_01B9F0: STA.l $7F2081,X
#_01B9F4: STA.l $7F20C1,X

#_01B9F8: LDA.b $00
#_01B9FA: STA.l $7F2041,X

#_01B9FE: CLC
#_01B9FF: ADC.w #$0101
#_01BA02: STA.b $00

#_01BA04: INY
#_01BA05: INY
#_01BA06: CPY.w $0482
#_01BA09: BNE .next_spiral_stairs_up_b

;---------------------------------------------------------------------------------------------------

.no_spiral_stairs_up_b
#_01BA0B: CPY.w $04A2
#_01BA0E: BEQ .no_straight_stairs_up_north

.next_straight_stairs_up_north
#_01BA10: LDX.w $06B0,Y

#_01BA13: LDA.w #$0000
#_01BA16: STA.l $7F2081,X
#_01BA1A: STA.l $7F20C1,X

#_01BA1E: LDA.w #$3838
#_01BA21: STA.l $7F2001,X

#_01BA25: LDA.b $00
#_01BA27: STA.l $7F2041,X

#_01BA2B: CLC
#_01BA2C: ADC.w #$0101
#_01BA2F: STA.b $00

#_01BA31: INY
#_01BA32: INY
#_01BA33: CPY.w $04A2
#_01BA36: BNE .next_straight_stairs_up_north

;---------------------------------------------------------------------------------------------------

.no_straight_stairs_up_north
#_01BA38: CPY.w $04A4
#_01BA3B: BEQ .no_straight_stairs_up_south

.next_straight_stairs_up_south
#_01BA3D: LDX.w $06B0,Y

#_01BA40: LDA.w #$0000
#_01BA43: STA.l $7F2001,X
#_01BA47: STA.l $7F2041,X

#_01BA4B: LDA.w #$3939
#_01BA4E: STA.l $7F20C1,X

#_01BA52: LDA.b $00
#_01BA54: STA.l $7F2081,X

#_01BA58: CLC
#_01BA59: ADC.w #$0101
#_01BA5C: STA.b $00

#_01BA5E: INY
#_01BA5F: INY
#_01BA60: CPY.w $04A4
#_01BA63: BNE .next_straight_stairs_up_south

;---------------------------------------------------------------------------------------------------

.no_straight_stairs_up_south
#_01BA65: LDA.b $00
#_01BA67: AND.w #$0707
#_01BA6A: ORA.w #$3434
#_01BA6D: STA.b $00

#_01BA6F: CPY.w $043A
#_01BA72: BEQ .no_intra_stairs_south

.next_intra_stairs_south
#_01BA74: LDX.w $06B0,Y

#_01BA77: LDA.w #$2626
#_01BA7A: STA.l $7F20C1,X

#_01BA7E: LDA.b $00
#_01BA80: STA.l $7F2081,X

#_01BA84: CLC
#_01BA85: ADC.w #$0101
#_01BA88: STA.b $00

#_01BA8A: INY
#_01BA8B: INY
#_01BA8C: CPY.w $043A
#_01BA8F: BNE .next_intra_stairs_south

;---------------------------------------------------------------------------------------------------

.no_intra_stairs_south
#_01BA91: CPY.w $0480
#_01BA94: BEQ .no_spiral_stairs_down_north_a

.next_spiral_stairs_down_north_a
#_01BA96: LDX.w $06B0,Y

#_01BA99: LDA.w #$5E5E
#_01BA9C: STA.l $7F2001,X
#_01BAA0: STA.l $7F2081,X
#_01BAA4: STA.l $7F20C1,X

#_01BAA8: LDA.b $00
#_01BAAA: STA.l $7F2041,X

#_01BAAE: CLC
#_01BAAF: ADC.w #$0101
#_01BAB2: STA.b $00

#_01BAB4: INY
#_01BAB5: INY
#_01BAB6: CPY.w $0480
#_01BAB9: BNE .next_spiral_stairs_down_north_a

;---------------------------------------------------------------------------------------------------

.no_spiral_stairs_down_north_a
#_01BABB: CPY.w $0484
#_01BABE: BEQ .no_spiral_stairs_down_north_b

.next_spiral_stairs_down_north_b
#_01BAC0: LDX.w $06B0,Y

#_01BAC3: LDA.w #$5F5F
#_01BAC6: STA.l $7F2001,X
#_01BACA: STA.l $7F2081,X
#_01BACE: STA.l $7F20C1,X

#_01BAD2: LDA.b $00
#_01BAD4: STA.l $7F2041,X

#_01BAD8: CLC
#_01BAD9: ADC.w #$0101
#_01BADC: STA.b $00

#_01BADE: INY
#_01BADF: INY
#_01BAE0: CPY.w $0484
#_01BAE3: BNE .next_spiral_stairs_down_north_b

;---------------------------------------------------------------------------------------------------

.no_spiral_stairs_down_north_b
#_01BAE5: CPY.w $04A6
#_01BAE8: BEQ .no_straight_stairs_down_north

.next_straight_stairs_down_north
#_01BAEA: LDX.w $06B0,Y

#_01BAED: LDA.w #$0000
#_01BAF0: STA.l $7F2081,X
#_01BAF4: STA.l $7F20C1,X

#_01BAF8: LDA.w #$3838
#_01BAFB: STA.l $7F2001,X

#_01BAFF: LDA.b $00
#_01BB01: STA.l $7F2041,X

#_01BB05: CLC
#_01BB06: ADC.w #$0101
#_01BB09: STA.b $00

#_01BB0B: INY
#_01BB0C: INY
#_01BB0D: CPY.w $04A6
#_01BB10: BNE .next_straight_stairs_down_north

;---------------------------------------------------------------------------------------------------

.no_straight_stairs_down_north
#_01BB12: CPY.w $04A8
#_01BB15: BEQ .no_straight_stairs_down_south

.next_straight_stairs_down_south
#_01BB17: LDX.w $06B0,Y

#_01BB1A: LDA.w #$0000
#_01BB1D: STA.l $7F2001,X
#_01BB21: STA.l $7F2041,X

#_01BB25: LDA.w #$3939
#_01BB28: STA.l $7F20C1,X

#_01BB2C: LDA.b $00
#_01BB2E: STA.l $7F2081,X

#_01BB32: CLC
#_01BB33: ADC.w #$0101
#_01BB36: STA.b $00

#_01BB38: INY
#_01BB39: INY
#_01BB3A: CPY.w $04A8
#_01BB3D: BNE .next_straight_stairs_down_south

;---------------------------------------------------------------------------------------------------

.no_straight_stairs_down_south
#_01BB3F: LDY.w #$0000
#_01BB42: STY.b $02

#_01BB44: LDA.w #$1F1F
#_01BB47: LDX.w $043C
#_01BB4A: BNE .some_auto_north_multilayer_stairs

#_01BB4C: INC.b $02

#_01BB4E: LDA.w #$1E1E
#_01BB51: LDX.w $043E
#_01BB54: BNE .some_auto_north_multilayer_stairs

#_01BB56: LDX.w $0440
#_01BB59: BEQ .none_of_these_water_stairs

#_01BB5B: INC.b $02

#_01BB5D: LDA.w #$1D1D

.some_auto_north_multilayer_stairs
#_01BB60: STA.b $00

#_01BB62: LDA.b $02
#_01BB64: STA.w $044A

#_01BB67: STX.b $02

;---------------------------------------------------------------------------------------------------

.next_of_these_water_stairs
#_01BB69: LDX.w $06B8,Y

#_01BB6C: LDA.w #$0002
#_01BB6F: STA.l $7F2000,X
#_01BB73: STA.l $7F30C0,X

#_01BB77: XBA
#_01BB78: STA.l $7F2002,X
#_01BB7C: STA.l $7F30C2,X

#_01BB80: LDA.w #$0001
#_01BB83: STA.l $7F2040,X
#_01BB87: STA.l $7F3080,X

#_01BB8B: XBA
#_01BB8C: STA.l $7F2042,X
#_01BB90: STA.l $7F3082,X

#_01BB94: LDA.b $00
#_01BB96: STA.l $7F2041,X
#_01BB9A: STA.l $7F3041,X
#_01BB9E: STA.l $7F2081,X
#_01BBA2: STA.l $7F3081,X

#_01BBA6: INY
#_01BBA7: INY
#_01BBA8: CPY.b $02
#_01BBAA: BNE .next_of_these_water_stairs

;---------------------------------------------------------------------------------------------------

.none_of_these_water_stairs
#_01BBAC: CPY.w $0448
#_01BBAF: BEQ .no_water_overlay_a

#_01BBB1: LDA.w #$0002
#_01BBB4: STA.w $044A

.next_water_overlay_a
#_01BBB7: LDX.w $06B8,Y

#_01BBBA: LDA.w #$0A03
#_01BBBD: STA.l $7F2000,X
#_01BBC1: STA.l $7F3000,X

#_01BBC5: XBA
#_01BBC6: STA.l $7F2002,X
#_01BBCA: STA.l $7F3002,X

#_01BBCE: LDA.w #$0803
#_01BBD1: STA.l $7F2040,X

#_01BBD5: XBA
#_01BBD6: STA.l $7F2042,X

#_01BBDA: INY
#_01BBDB: INY
#_01BBDC: CPY.w $0448
#_01BBDF: BNE .next_water_overlay_a

;---------------------------------------------------------------------------------------------------

.no_water_overlay_a
#_01BBE1: LDY.w #$0000
#_01BBE4: LDX.w $0442
#_01BBE7: BEQ .no_water_overlay_a2

#_01BBE9: LDA.w #$0002
#_01BBEC: STA.w $044A

.next_water_overlay_a2
#_01BBEF: LDX.w $06B8,Y

#_01BBF2: LDA.w #$0003
#_01BBF5: STA.l $7F2000,X

#_01BBF9: XBA
#_01BBFA: STA.l $7F2002,X

#_01BBFE: LDA.w #$0A03
#_01BC01: STA.l $7F3000,X

#_01BC05: XBA
#_01BC06: STA.l $7F3002,X

#_01BC0A: LDA.w #$0808
#_01BC0D: STA.l $7F2040,X
#_01BC11: STA.l $7F2042,X

#_01BC15: INY
#_01BC16: INY
#_01BC17: CPY.w $0442
#_01BC1A: BNE .next_water_overlay_a2

;---------------------------------------------------------------------------------------------------

.no_water_overlay_a2
#_01BC1C: CPY.w $0444
#_01BC1F: BEQ .no_water_ladders

#_01BC21: LDA.w #$0002
#_01BC24: STA.w $044A

.next_water_ladder
#_01BC27: LDX.w $06B8,Y

#_01BC2A: LDA.w #$0003
#_01BC2D: STA.l $7F2000,X

#_01BC31: XBA
#_01BC32: STA.l $7F2002,X

#_01BC36: LDA.w #$0A03
#_01BC39: STA.l $7F3000,X

#_01BC3D: XBA
#_01BC3E: STA.l $7F3002,X

#_01BC42: INY
#_01BC43: INY
#_01BC44: CPY.w $0444
#_01BC47: BNE .next_water_ladder

;---------------------------------------------------------------------------------------------------

.no_water_ladders
#_01BC49: LDY.w #$0000

#_01BC4C: LDX.w $042C
#_01BC4F: BEQ .no_manipulables

#_01BC51: LDA.w #$7070
#_01BC54: STA.b $00

.next_manipulable
#_01BC56: LDA.w $0500,Y
#_01BC59: AND.w #$00F0
#_01BC5C: CMP.w #$0030
#_01BC5F: BEQ .skip_manip

#_01BC61: LDA.w $0540,Y
#_01BC64: AND.w #$3FFF
#_01BC67: LSR A
#_01BC68: TAX

#_01BC69: LDA.b $00
#_01BC6B: STA.l $7F2000,X
#_01BC6F: STA.l $7F2040,X

.skip_manip
#_01BC73: LDA.b $00
#_01BC75: CLC
#_01BC76: ADC.w #$0101
#_01BC79: STA.b $00

#_01BC7B: INY
#_01BC7C: INY
#_01BC7D: CPY.w $042C
#_01BC80: BNE .next_manipulable

;---------------------------------------------------------------------------------------------------

.no_manipulables
#_01BC82: CPY.w $042E
#_01BC85: BEQ .no_torches

#_01BC87: STZ.b $04

#_01BC89: LDA.w #$C0C0
#_01BC8C: STA.b $00

.next_torch
#_01BC8E: LDA.w $0540,Y
#_01BC91: AND.w #$3FFF
#_01BC94: LSR A
#_01BC95: TAX

#_01BC96: LDA.b $00
#_01BC98: STA.l $7F2000,X
#_01BC9C: STA.l $7F2040,X

#_01BCA0: AND.w #$EFEF
#_01BCA3: CLC
#_01BCA4: ADC.w #$0101
#_01BCA7: STA.b $00

#_01BCA9: INY
#_01BCAA: INY
#_01BCAB: CPY.w $042E
#_01BCAE: BNE .next_torch

#_01BCB0: LDA.b $04
#_01BCB2: STA.w $042E

;---------------------------------------------------------------------------------------------------

.no_torches
#_01BCB5: LDA.w #$5858
#_01BCB8: STA.b $00

#_01BCBA: LDY.w #$0000

#_01BCBD: LDX.w $0496
#_01BCC0: BEQ .no_chest

;---------------------------------------------------------------------------------------------------

#_01BCC2: LDA.b $AE
#_01BCC4: AND.w #$00FF
#_01BCC7: CMP.w #$0027
#_01BCCA: BEQ .hidden_chests

#_01BCCC: CMP.w #$003C
#_01BCCF: BEQ .hidden_chests

#_01BCD1: CMP.w #$003E
#_01BCD4: BEQ .hidden_chests

#_01BCD6: CMP.w #$0029
#_01BCD9: BCC .check_tag_2

#_01BCDB: CMP.w #$0033
#_01BCDE: BCC .hidden_chests

;---------------------------------------------------------------------------------------------------

.check_tag_2
#_01BCE0: LDA.b $AF
#_01BCE2: AND.w #$00FF
#_01BCE5: CMP.w #$0027
#_01BCE8: BEQ .hidden_chests

#_01BCEA: CMP.w #$003C
#_01BCED: BEQ .hidden_chests

#_01BCEF: CMP.w #$003E
#_01BCF2: BEQ .hidden_chests

#_01BCF4: CMP.w #$0029
#_01BCF7: BCC .no_hidden_chests

#_01BCF9: CMP.w #$0033
#_01BCFC: BCC .hidden_chests

.no_hidden_chests
#_01BCFE: JSR Underworld_SetChestAttributes

;---------------------------------------------------------------------------------------------------

.no_chest
#_01BD01: CPY.w $0498
#_01BD04: BEQ .hidden_chests

.next_big_key_lock
#_01BD06: LDA.w $06E0,Y
#_01BD09: ORA.w #$8000
#_01BD0C: STA.w $06E0,Y

#_01BD0F: AND.w #$7FFF
#_01BD12: LSR A
#_01BD13: TAX

#_01BD14: LDA.b $00
#_01BD16: STA.l $7F2000,X
#_01BD1A: STA.l $7F2040,X

#_01BD1E: CLC
#_01BD1F: ADC.w #$0101
#_01BD22: STA.b $00

#_01BD24: INY
#_01BD25: INY
#_01BD26: CPY.w $0498
#_01BD29: BNE .next_big_key_lock

;---------------------------------------------------------------------------------------------------

.hidden_chests
#_01BD2B: LDY.w #$0000
#_01BD2E: STY.b $02

#_01BD30: LDA.w #$3F3F
#_01BD33: LDX.w $049A
#_01BD36: BNE .some_auto_south_stairs

#_01BD38: INC.b $02

#_01BD3A: LDA.w #$3E3E
#_01BD3D: LDX.w $049C
#_01BD40: BNE .some_auto_south_stairs

#_01BD42: LDX.w $049E
#_01BD45: BEQ .no_auto_south_stairs

#_01BD47: INC.b $02

#_01BD49: LDA.w #$3D3D

.some_auto_south_stairs
#_01BD4C: STA.b $00

#_01BD4E: LDA.b $02
#_01BD50: STA.w $044A

#_01BD53: STX.b $02

.next_auto_south_stairs
#_01BD55: LDX.w $06EC,Y

#_01BD58: LDA.w #$0002
#_01BD5B: STA.l $7F3000,X
#_01BD5F: STA.l $7F20C0,X

#_01BD63: LDA.w #$0001
#_01BD66: STA.l $7F3040,X
#_01BD6A: STA.l $7F2080,X

#_01BD6E: LDA.w #$0200
#_01BD71: STA.l $7F3002,X
#_01BD75: STA.l $7F20C2,X

#_01BD79: LDA.w #$0100
#_01BD7C: STA.l $7F3042,X
#_01BD80: STA.l $7F2082,X

#_01BD84: LDA.b $00
#_01BD86: STA.l $7F2041,X
#_01BD8A: STA.l $7F3041,X
#_01BD8E: STA.l $7F2081,X
#_01BD92: STA.l $7F3081,X

#_01BD96: INY
#_01BD97: INY
#_01BD98: CPY.b $02
#_01BD9A: BNE .next_auto_south_stairs

;---------------------------------------------------------------------------------------------------

.no_auto_south_stairs
#_01BD9C: LDY.w #$0000

#_01BD9F: LDX.w $04AE
#_01BDA2: BEQ .no_south_merged_auto_stairs

#_01BDA4: LDA.w #$0002
#_01BDA7: STA.w $044A

.next_south_merged_auto_stairs
#_01BDAA: LDX.w $06EC,Y

#_01BDAD: LDA.w #$0A03
#_01BDB0: STA.l $7F30C0,X

#_01BDB4: XBA
#_01BDB5: STA.l $7F30C2,X

#_01BDB9: LDA.w #$0003
#_01BDBC: STA.l $7F20C0,X

#_01BDC0: XBA
#_01BDC1: STA.l $7F20C2,X

#_01BDC5: LDA.w #$0808
#_01BDC8: STA.l $7F2080,X
#_01BDCC: STA.l $7F2082,X

#_01BDD0: INY
#_01BDD1: INY
#_01BDD2: CPY.w $04AE
#_01BDD5: BNE .next_south_merged_auto_stairs

;---------------------------------------------------------------------------------------------------

.no_south_merged_auto_stairs
#_01BDD7: INC.w $0200

#_01BDDA: RTS

;===================================================================================================

Underworld_SetChestAttributes:
.next
#_01BDDB: LDA.w $06E0,Y
#_01BDDE: BEQ .to_next

#_01BDE0: AND.w #$7FFF
#_01BDE3: LSR A
#_01BDE4: TAX

#_01BDE5: LDA.b $00
#_01BDE7: STA.l $7F2000,X
#_01BDEB: STA.l $7F2040,X

#_01BDEF: LDA.w $06E0,Y
#_01BDF2: ASL A
#_01BDF3: BCC .to_next

#_01BDF5: LSR A
#_01BDF6: STA.w $06E0,Y

#_01BDF9: LDA.b $00
#_01BDFB: STA.l $7F2042,X
#_01BDFF: STA.l $7F2080,X
#_01BE03: STA.l $7F2082,X

.to_next
#_01BE07: LDA.b $00
#_01BE09: CLC
#_01BE0A: ADC.w #$0101
#_01BE0D: STA.b $00

#_01BE0F: INY
#_01BE10: INY
#_01BE11: CPY.w $0496
#_01BE14: BNE .next

#_01BE16: RTS

;===================================================================================================

Underworld_LoadDoorAttribute:
#_01BE17: REP #$30

#_01BE19: LDY.w #$0000

.next
#_01BE1C: LDA.w $19A0,Y
#_01BE1F: BEQ .skip

#_01BE21: JSR Underworld_LoadSingleDoorAttribute

.skip
#_01BE24: INY
#_01BE25: INY
#_01BE26: CPY.w #$0020
#_01BE29: BNE .next

;---------------------------------------------------------------------------------------------------

#_01BE2B: JSR Underworld_LoadSingleDoorTileAttribute
#_01BE2E: JSR ChangeDoorToSwitch

#_01BE31: INC.w $0200

#_01BE34: RTS

;===================================================================================================

Underworld_LoadSingleDoorAttribute:
#_01BE35: LDA.w $1980,Y
#_01BE38: AND.w #$00FE
#_01BE3B: STA.b $02

#_01BE3D: BEQ .apply_doorway

#_01BE3F: CMP.w #$0006
#_01BE42: BEQ .apply_doorway

#_01BE44: CMP.w #$0012
#_01BE47: BEQ .apply_doorway

#_01BE49: CMP.w #$000A
#_01BE4C: BEQ .apply_doorway

#_01BE4E: CMP.w #$000C
#_01BE51: BEQ .exit_or_lower_layer

#_01BE53: CMP.w #$000E
#_01BE56: BEQ .apply_doorway

#_01BE58: CMP.w #$0010
#_01BE5B: BEQ .exit_or_lower_layer

#_01BE5D: CMP.w #$0004
#_01BE60: BEQ .exit_or_lower_layer

#_01BE62: CMP.w #$0002
#_01BE65: BEQ .exit_or_lower_layer

#_01BE67: CMP.w #$0008
#_01BE6A: BNE .not_exit_or_lower_layer

.exit_or_lower_layer
#_01BE6C: JMP.w AddFullLongDoorDoorwayProps

.not_exit_or_lower_layer
#_01BE6F: CMP.w #$0030
#_01BE72: BNE .not_exploding_wall

#_01BE74: JMP.w EXIT_01BFB2

.not_exploding_wall
#_01BE77: CMP.w #$0040
#_01BE7A: BCC .not_normalish_doors

#_01BE7C: JMP.w AddDoorwayPropsForWeirdos

.not_normalish_doors
#_01BE7F: CMP.w #$0018
#_01BE82: BEQ .shutter_door

#_01BE84: CMP.w #$0044
#_01BE87: BEQ .shutter_door

#_01BE89: TYA
#_01BE8A: AND.w #$000F

#_01BE8D: BRA .check_door_mask

.shutter_door
#_01BE8F: TYA
#_01BE90: AND.w #$00FF

.check_door_mask
#_01BE93: TAX

#_01BE94: LDA.w $068C
#_01BE97: AND.w DungeonMask,X
#_01BE9A: BNE .apply_doorway

#_01BE9C: SEP #$20

#_01BE9E: TYA
#_01BE9F: LSR A
#_01BEA0: ORA.b #$F0
#_01BEA2: STA.b $00
#_01BEA4: STA.b $01

#_01BEA6: REP #$20

#_01BEA8: LDA.w $19A0,Y
#_01BEAB: LSR A
#_01BEAC: TAX

#_01BEAD: LDA.b $00
#_01BEAF: STA.l $7F2041,X
#_01BEB3: STA.l $7F2081,X

;---------------------------------------------------------------------------------------------------

#EXIT_01BEB7:
#_01BEB7: RTS

;---------------------------------------------------------------------------------------------------

.apply_doorway
#_01BEB8: LDX.b $02
#_01BEBA: CPX.w #$0020
#_01BEBD: BCC .has_doorway

#_01BEBF: CPX.w #$0028
#_01BEC2: BCC EXIT_01BEB7

.has_doorway
#_01BEC4: LDA.w DoorwayTileProperties,X
#_01BEC7: STA.b $00

#_01BEC9: LDA.w $19C0,Y
#_01BECC: AND.w #$0003
#_01BECF: BNE .not_north_door

#_01BED1: LDA.w $19A0,Y
#_01BED4: CMP.w $19E2
#_01BED7: BEQ .is_entrance

#_01BED9: CMP.w $19E4
#_01BEDC: BEQ .is_entrance

#_01BEDE: CMP.w $19E6
#_01BEE1: BEQ .is_entrance

#_01BEE3: CMP.w $19E8
#_01BEE6: BNE .not_entrance

.is_entrance
#_01BEE8: LDX.w #$8E8E
#_01BEEB: STX.b $00

.not_entrance
#_01BEED: LSR A
#_01BEEE: AND.w #$783F
#_01BEF1: TAX

#_01BEF2: LDA.b $00
#_01BEF4: STA.l $7F2001,X
#_01BEF8: STA.l $7F2041,X
#_01BEFC: STA.l $7F2081,X
#_01BF00: STA.l $7F20C1,X
#_01BF04: STA.l $7F2101,X
#_01BF08: STA.l $7F2141,X
#_01BF0C: STA.l $7F2181,X

#_01BF10: LDA.w #$0000
#_01BF13: STA.l $7F21C1,X

#_01BF17: RTS

;---------------------------------------------------------------------------------------------------

.not_north_door
#_01BF18: CMP.w #$0001
#_01BF1B: BNE .not_south_door

#_01BF1D: LDA.w $19A0,Y
#_01BF20: CPX.w #$000A
#_01BF23: BEQ .is_entrance_b

#_01BF25: CPX.w #$000E
#_01BF28: BEQ .is_entrance_b

#_01BF2A: CMP.w $19E2
#_01BF2D: BEQ .is_entrance_b

#_01BF2F: CMP.w $19E4
#_01BF32: BEQ .is_entrance_b

#_01BF34: CMP.w $19E6
#_01BF37: BEQ .is_entrance_b

#_01BF39: CMP.w $19E8
#_01BF3C: BNE .not_entrance_b

.is_entrance_b
#_01BF3E: LDX.w #$8E8E
#_01BF41: STX.b $00

.not_entrance_b
#_01BF43: LSR A
#_01BF44: TAX

#_01BF45: LDA.b $00
#_01BF47: STA.l $7F2041,X
#_01BF4B: STA.l $7F2081,X
#_01BF4F: STA.l $7F20C1,X
#_01BF53: STA.l $7F2101,X
#_01BF57: STA.l $7F2141,X

#_01BF5B: RTS

;---------------------------------------------------------------------------------------------------

.not_south_door
#_01BF5C: CMP.w #$0002
#_01BF5F: BNE .not_west_door

#_01BF61: LDA.w $19A0,Y
#_01BF64: LSR A
#_01BF65: AND.w #$FFE0
#_01BF68: TAX

#_01BF69: LDA.b $00
#_01BF6B: CLC
#_01BF6C: ADC.w #$0101
#_01BF6F: STA.l $7F2040,X
#_01BF73: STA.l $7F2042,X
#_01BF77: STA.l $7F2080,X
#_01BF7B: STA.l $7F2082,X

#_01BF7F: AND.w #$00FF
#_01BF82: STA.l $7F2044,X
#_01BF86: STA.l $7F2084,X

#_01BF8A: RTS

;---------------------------------------------------------------------------------------------------

.not_west_door
#_01BF8B: LDA.w $19A0,Y
#_01BF8E: LSR A

#_01BF8F: TAX
#_01BF90: LDA.b $00
#_01BF92: CLC
#_01BF93: ADC.w #$0101
#_01BF96: STA.l $7F2042,X
#_01BF9A: STA.l $7F2044,X
#_01BF9E: STA.l $7F2082,X
#_01BFA2: STA.l $7F2084,X

#_01BFA6: AND.w #$FF00
#_01BFA9: STA.l $7F2040,X
#_01BFAD: STA.l $7F2080,X

#_01BFB1: RTS

;---------------------------------------------------------------------------------------------------

#EXIT_01BFB2:
#_01BFB2: RTS

;===================================================================================================

UNREACHABLE_01BFB3:
#_01BFB3: TYA
#_01BFB4: AND.w #$000F
#_01BFB7: TAX

#_01BFB8: LDA.w $068C
#_01BFBB: AND.w DungeonMask,X
#_01BFBE: BNE Underworld_DoorLoadBlastWallAttribute

#_01BFC0: RTS

;===================================================================================================

Underworld_DoorLoadBlastWallAttribute:
#_01BFC1: LDA.w $19C0,Y
#_01BFC4: AND.w #$0002
#_01BFC7: BNE .horizontal

;---------------------------------------------------------------------------------------------------

.vertical
#_01BFC9: LDA.w $19A0,Y
#_01BFCC: LSR A
#_01BFCD: TAX

#_01BFCE: LDA.w #$000C
#_01BFD1: STA.b $00

.vertical_next
#_01BFD3: LDA.w #$0102
#_01BFD6: STA.l $7F2000,X

#_01BFDA: LDA.w #$0000
#_01BFDD: STA.l $7F2002,X
#_01BFE1: STA.l $7F2004,X
#_01BFE5: STA.l $7F2006,X

#_01BFE9: STA.l $7F2008,X
#_01BFED: STA.l $7F200A,X
#_01BFF1: STA.l $7F200C,X

#_01BFF5: STA.l $7F200E,X
#_01BFF9: STA.l $7F2010,X
#_01BFFD: STA.l $7F2012,X

#_01C001: LDA.w #$0201
#_01C004: STA.l $7F2014,X

#_01C008: TXA
#_01C009: CLC
#_01C00A: ADC.w #$0040
#_01C00D: TAX

#_01C00E: DEC.b $00
#_01C010: BNE .vertical_next

#_01C012: RTS

;---------------------------------------------------------------------------------------------------

.horizontal
#_01C013: LDA.w $19A0,Y
#_01C016: LSR A
#_01C017: TAX

#_01C018: LDA.w #$0005
#_01C01B: STA.b $00

.horizontal_next
#_01C01D: LDA.w #$0101
#_01C020: STA.l $7F2000,X
#_01C024: STA.l $7F2540,X

#_01C028: LDA.w #$0202
#_01C02B: STA.l $7F2040,X
#_01C02F: STA.l $7F2500,X

#_01C033: LDA.w #$0000
#_01C036: STA.l $7F2080,X
#_01C03A: STA.l $7F20C0,X
#_01C03E: STA.l $7F2100,X

#_01C042: STA.l $7F2140,X
#_01C046: STA.l $7F2180,X
#_01C04A: STA.l $7F21C0,X

#_01C04E: STA.l $7F2200,X
#_01C052: STA.l $7F2240,X
#_01C056: STA.l $7F2280,X

#_01C05A: STA.l $7F22C0,X
#_01C05E: STA.l $7F2300,X
#_01C062: STA.l $7F2340,X

#_01C066: STA.l $7F2380,X
#_01C06A: STA.l $7F23C0,X
#_01C06E: STA.l $7F2400,X

#_01C072: STA.l $7F2440,X
#_01C076: STA.l $7F2480,X
#_01C07A: STA.l $7F24C0,X

#_01C07E: INX
#_01C07F: INX
#_01C080: DEC.b $00
#_01C082: BNE .horizontal_next

#_01C084: RTS

;===================================================================================================
; TODO better name
AddDoorwayPropsForWeirdos:
#_01C085: CMP.w #$0040
#_01C088: BEQ AddFullLongDoorDoorwayProps

#_01C08A: CMP.w #$0046
#_01C08D: BEQ AddFullLongDoorDoorwayProps

#_01C08F: TYA
#_01C090: AND.w #$00FF
#_01C093: TAX

#_01C094: LDA.w $068C
#_01C097: AND.w DungeonMask,X
#_01C09A: BNE AddFullLongDoorDoorwayProps

#_01C09C: SEP #$20

#_01C09E: TYA
#_01C09F: LSR A
#_01C0A0: ORA.b #$F0
#_01C0A2: STA.b $00
#_01C0A4: STA.b $01

#_01C0A6: REP #$20

#_01C0A8: LDA.w $19A0,Y
#_01C0AB: LSR A
#_01C0AC: TAX

#_01C0AD: LDA.b $00
#_01C0AF: STA.l $7F2041,X
#_01C0B3: STA.l $7F2081,X

#_01C0B7: RTS

;===================================================================================================
; TODO better name?
AddFullLongDoorDoorwayProps:
#_01C0B8: LDX.b $02

#_01C0BA: LDA.w DoorwayTileProperties,X
#_01C0BD: STA.b $00

#_01C0BF: LDA.w $19C0,Y
#_01C0C2: AND.w #$0003
#_01C0C5: BNE .not_north_door

#_01C0C7: LDA.w $19A0,Y
#_01C0CA: LSR A
#_01C0CB: AND.w #$783F
#_01C0CE: TAX

#_01C0CF: LDA.b $00
#_01C0D1: STA.l $7F2001,X
#_01C0D5: STA.l $7F2041,X
#_01C0D9: STA.l $7F2081,X
#_01C0DD: STA.l $7F20C1,X

#_01C0E1: STA.l $7F2101,X
#_01C0E5: STA.l $7F2141,X
#_01C0E9: STA.l $7F2181,X
#_01C0ED: STA.l $7F21C1,X

#_01C0F1: STA.l $7F2201,X
#_01C0F5: STA.l $7F2241,X

#_01C0F9: RTS

;---------------------------------------------------------------------------------------------------

.not_north_door
#_01C0FA: CMP.w #$0001
#_01C0FD: BNE .not_south_door

#_01C0FF: CPX.w #$000C
#_01C102: BEQ .is_entrance

#_01C104: CPX.w #$0010
#_01C107: BEQ .is_entrance

#_01C109: CPX.w #$0004
#_01C10C: BEQ .is_entrance

#_01C10E: LDA.w $19A0,Y
#_01C111: AND.w #$1FFF
#_01C114: CMP.w $19E2
#_01C117: BEQ .is_entrance

#_01C119: CMP.w $19E4
#_01C11C: BEQ .is_entrance

#_01C11E: CMP.w $19E6
#_01C121: BEQ .is_entrance

#_01C123: CMP.w $19E8
#_01C126: BNE .not_entrance

.is_entrance
#_01C128: LDX.w #$8E8E
#_01C12B: STX.b $00

.not_entrance
#_01C12D: LDA.w $19A0,Y
#_01C130: LSR A
#_01C131: CLC
#_01C132: ADC.w #$0040
#_01C135: TAX

#_01C136: LDA.b $00
#_01C138: STA.l $7F2001,X
#_01C13C: STA.l $7F2041,X
#_01C140: STA.l $7F2081,X
#_01C144: STA.l $7F20C1,X

#_01C148: STA.l $7F2101,X
#_01C14C: STA.l $7F2141,X
#_01C150: STA.l $7F2181,X
#_01C154: STA.l $7F21C1,X

#_01C158: RTS

;---------------------------------------------------------------------------------------------------

.not_south_door
#_01C159: CMP.w #$0002
#_01C15C: BNE .not_west_door

#_01C15E: LDA.w $19A0,Y
#_01C161: LSR A
#_01C162: AND.w #$FFE0
#_01C165: TAX

#_01C166: LDA.b $00
#_01C168: CLC
#_01C169: ADC.w #$0101
#_01C16C: STA.l $7F2040,X
#_01C170: STA.l $7F2042,X
#_01C174: STA.l $7F2044,X
#_01C178: STA.l $7F2046,X

#_01C17C: STA.l $7F2080,X
#_01C180: STA.l $7F2082,X
#_01C184: STA.l $7F2084,X
#_01C188: STA.l $7F2086,X

#_01C18C: RTS

;---------------------------------------------------------------------------------------------------

.not_west_door
#_01C18D: LDA.w $19A0,Y
#_01C190: LSR A
#_01C191: INC A
#_01C192: TAX

#_01C193: LDA.b $00
#_01C195: CLC
#_01C196: ADC.w #$0101
#_01C199: STA.l $7F2040,X
#_01C19D: STA.l $7F2042,X
#_01C1A1: STA.l $7F2044,X
#_01C1A5: STA.l $7F2046,X

#_01C1A9: STA.l $7F2080,X
#_01C1AD: STA.l $7F2082,X
#_01C1B1: STA.l $7F2084,X
#_01C1B5: STA.l $7F2086,X

#_01C1B9: RTS

;===================================================================================================
; !WTF????
ChangeDoorToSwitch:
#_01C1BA: REP #$30

#_01C1BC: LDA.w $04B0
#_01C1BF: BEQ .exit

#_01C1C1: LDA.w $04B0
#_01C1C4: AND.w #$3FFF
#_01C1C7: LSR A
#_01C1C8: TAX

#_01C1C9: LDY.w #$0004

#_01C1CC: LDA.w $04B0
#_01C1CF: ASL A
#_01C1D0: BCC .draw_5

#_01C1D2: INY

.draw_5
#_01C1D3: LDA.w $0402
#_01C1D6: AND.w #$1000
#_01C1D9: BEQ .next_b

;---------------------------------------------------------------------------------------------------

.next_a
#_01C1DB: LDA.w #$0101
#_01C1DE: STA.l $7F2000,X
#_01C1E2: STA.l $7F2280,X

#_01C1E6: LDA.w #$0000
#_01C1E9: STA.l $7F2080,X
#_01C1ED: STA.l $7F2100,X
#_01C1F1: STA.l $7F2180,X
#_01C1F5: STA.l $7F2200,X

#_01C1F9: INX
#_01C1FA: INX

#_01C1FB: DEY
#_01C1FC: BPL .next_a

#_01C1FE: SEP #$30

#_01C200: RTS

;---------------------------------------------------------------------------------------------------

.next_b
#_01C201: LDA.w #$2323
#_01C204: STA.l $7F2080,X
#_01C208: STA.l $7F2100,X
#_01C20C: STA.l $7F2180,X
#_01C210: STA.l $7F2200,X

#_01C214: INX
#_01C215: INX

#_01C216: DEY
#_01C217: BPL .next_b

.exit
#_01C219: SEP #$30

#_01C21B: RTS

;===================================================================================================

Underworld_InitializePegAttribute:
#_01C21C: INC.w $0200

#_01C21F: LDA.l $7EC172
#_01C223: BEQ .exit

#_01C225: JSL Underworld_FlipCrystalPegAttribute

.exit
#_01C229: RTS

;===================================================================================================

Underworld_FlipCrystalPegAttribute:
#_01C22A: REP #$10

#_01C22C: LDX.w #$07FF

.next_super
#_01C22F: LDA.l $7F2000,X
#_01C233: CMP.b #$66
#_01C235: BEQ .do_toggle_a

#_01C237: CMP.b #$67
#_01C239: BNE .no_toggle_a

.do_toggle_a
#_01C23B: EOR.b #$01
#_01C23D: STA.l $7F2000,X

;---------------------------------------------------------------------------------------------------

.no_toggle_a
#_01C241: LDA.l $7F2800,X
#_01C245: CMP.b #$66
#_01C247: BEQ .do_toggle_b

#_01C249: CMP.b #$67
#_01C24B: BNE .no_toggle_b

.do_toggle_b
#_01C24D: EOR.b #$01
#_01C24F: STA.l $7F2800,X

;---------------------------------------------------------------------------------------------------

.no_toggle_b
#_01C253: LDA.l $7F3000,X
#_01C257: CMP.b #$66
#_01C259: BEQ .do_toggle_c

#_01C25B: CMP.b #$67
#_01C25D: BNE .no_toggle_c

.do_toggle_c
#_01C25F: EOR.b #$01
#_01C261: STA.l $7F3000,X

;---------------------------------------------------------------------------------------------------

.no_toggle_c
#_01C265: LDA.l $7F3800,X
#_01C269: CMP.b #$66
#_01C26B: BEQ .do_toggle_d

#_01C26D: CMP.b #$67
#_01C26F: BNE .no_toggle_d

.do_toggle_d
#_01C271: EOR.b #$01
#_01C273: STA.l $7F3800,X

;---------------------------------------------------------------------------------------------------

.no_toggle_d
#_01C277: DEX
#_01C278: BPL .next_super

#_01C27A: SEP #$10

#_01C27C: RTL

;===================================================================================================

pool Underworld_HandleRoomTags

.vectors
#_01C27D: dw RoomTag_Nothing                    ; 0x00
#_01C27F: dw RoomTag_NorthWestTrigger           ; 0x01
#_01C281: dw RoomTag_NorthEastTrigger           ; 0x02
#_01C283: dw RoomTag_SouthWestTrigger           ; 0x03
#_01C285: dw RoomTag_SouthEastTrigger           ; 0x04
#_01C287: dw RoomTag_WestTrigger                ; 0x05
#_01C289: dw RoomTag_EastTrigger                ; 0x06
#_01C28B: dw RoomTag_NorthTrigger               ; 0x07
#_01C28D: dw RoomTag_SouthTrigger               ; 0x08
#_01C28F: dw RoomTag_QuadrantTrigger            ; 0x09
#_01C291: dw RoomTag_RoomTrigger                ; 0x0A
#_01C293: dw RoomTag_NorthWestTrigger           ; 0x0B
#_01C295: dw RoomTag_NorthEastTrigger           ; 0x0C
#_01C297: dw RoomTag_SouthWestTrigger           ; 0x0D
#_01C299: dw RoomTag_SouthEastTrigger           ; 0x0E
#_01C29B: dw RoomTag_WestTrigger                ; 0x0F
#_01C29D: dw RoomTag_EastTrigger                ; 0x10
#_01C29F: dw RoomTag_NorthTrigger               ; 0x11
#_01C2A1: dw RoomTag_SouthTrigger               ; 0x12
#_01C2A3: dw RoomTag_QuadrantTrigger            ; 0x13
#_01C2A5: dw RoomTag_RoomTrigger_BlockDoor      ; 0x14
#_01C2A7: dw RoomTag_RoomTrigger_KillDoor       ; 0x15
#_01C2A9: dw RoomTag_SwitchTrigger_HoldDoor     ; 0x16
#_01C2AB: dw RoomTag_SwitchTrigger_ToggleDoor   ; 0x17
#_01C2AD: dw RoomTag_WaterOff                   ; 0x18
#_01C2AF: dw RoomTag_WaterOn                    ; 0x19
#_01C2B1: dw RoomTag_WaterGate                  ; 0x1A
#_01C2B3: dw RoomTag_WaterTwin                  ; 0x1B
#_01C2B5: dw RoomTag_MovingWall_West            ; 0x1C
#_01C2B7: dw RoomTag_MovingWall_East            ; 0x1D
#_01C2B9: dw RoomTag_MovingWallTorchesCheck     ; 0x1E
#_01C2BB: dw RoomTag_MovingWallTorchesCheck     ; 0x1F
#_01C2BD: dw RoomTag_Switch_ExplodingWall       ; 0x20
#_01C2BF: dw RoomTag_Holes0                     ; 0x21
#_01C2C1: dw RoomTag_ChestHoles0                ; 0x22
#_01C2C3: dw RoomTag_Holes1                     ; 0x23
#_01C2C5: dw RoomTag_Holes2                     ; 0x24
#_01C2C7: dw RoomTag_KillRoomForPrize           ; 0x25
#_01C2C9: dw RoomTag_KillRoomBlock              ; 0x26
#_01C2CB: dw RoomTag_TriggerChest               ; 0x27
#_01C2CD: dw RoomTag_PullSwitchExplodingWall    ; 0x28
#_01C2CF: dw RoomTag_NorthWestTrigger           ; 0x29
#_01C2D1: dw RoomTag_NorthEastTrigger           ; 0x2A
#_01C2D3: dw RoomTag_SouthWestTrigger           ; 0x2B
#_01C2D5: dw RoomTag_SouthEastTrigger           ; 0x2C
#_01C2D7: dw RoomTag_WestTrigger                ; 0x2D
#_01C2D9: dw RoomTag_EastTrigger                ; 0x2E
#_01C2DB: dw RoomTag_NorthTrigger               ; 0x2F
#_01C2DD: dw RoomTag_SouthTrigger               ; 0x30
#_01C2DF: dw RoomTag_QuadrantTrigger            ; 0x31
#_01C2E1: dw RoomTag_RoomTrigger                ; 0x32
#_01C2E3: dw RoomTag_TorchPuzzleDoor            ; 0x33
#_01C2E5: dw RoomTag_Holes3                     ; 0x34
#_01C2E7: dw RoomTag_Holes4                     ; 0x35
#_01C2E9: dw RoomTag_Holes5                     ; 0x36
#_01C2EB: dw RoomTag_Holes6                     ; 0x37
#_01C2ED: dw RoomTag_Agahnim                    ; 0x38
#_01C2EF: dw RoomTag_Holes7                     ; 0x39
#_01C2F1: dw RoomTag_Holes8                     ; 0x3A
#_01C2F3: dw RoomTag_ChestHoles8                ; 0x3B
#_01C2F5: dw RoomTag_BlockForChest              ; 0x3C
#_01C2F7: dw RoomTag_GanonDoor                  ; 0x3D
#_01C2F9: dw RoomTag_TorchPuzzleChest           ; 0x3E
#_01C2FB: dw RoomTag_RekillableBoss             ; 0x3F

pool off

;---------------------------------------------------------------------------------------------------

Underworld_HandleRoomTags:
#_01C2FD: LDA.w $04C7
#_01C300: BNE .ignore_tags

#_01C302: SEP #$30

#_01C304: JSR Underworld_DetectStaircase

; tag 1
#_01C307: STZ.b $0E

#_01C309: LDA.b $AE
#_01C30B: ASL A
#_01C30C: TAX

#_01C30D: JSR (.vectors,X)

; tag 2
#_01C310: LDA.b #$01
#_01C312: STA.b $0E

#_01C314: LDA.b $AF
#_01C316: ASL A
#_01C317: TAX

#_01C318: JSR (.vectors,X)

.ignore_tags
#_01C31B: STZ.w $04C7

#_01C31E: RTL

;===================================================================================================
; Based on $063C
;===================================================================================================
LayerOfDestination:
.for_0476
#_01C31F: db $00, $01, $01

.for_EE
#_01C322: db $00, $00, $01

;===================================================================================================

RoomTag_DirtyExit:
#_01C325: PLA

;===================================================================================================

RoomTag_FastExit:
#_01C326: SEP #$30

;===================================================================================================

RoomTag_Nothing:
#_01C328: RTS

;===================================================================================================

Underworld_DetectStaircase:
#_01C329: REP #$20

#_01C32B: LDA.b $67
#_01C32D: AND.w #$000C
#_01C330: BEQ RoomTag_FastExit

#_01C332: STA.b $02

#_01C334: TAY

#_01C335: LDA.b $20
#_01C337: CLC
#_01C338: ADC.w DetectStaircase_offset_y,Y
#_01C33B: AND.w #$01F8

#_01C33E: ASL A
#_01C33F: ASL A
#_01C340: ASL A
#_01C341: STA.b $00

#_01C343: LDA.b $22
#_01C345: AND.w #$01F8
#_01C348: LSR A
#_01C349: LSR A
#_01C34A: LSR A
#_01C34B: ORA.b $00

#_01C34D: LDX.b $EE
#_01C34F: BEQ .upper_layer

#_01C351: ORA.w #$1000

.upper_layer
#_01C354: REP #$10

#_01C356: TAX

;---------------------------------------------------------------------------------------------------

#_01C357: PHX

#_01C358: LDY.b $02
#_01C35A: CPY.w #$0004
#_01C35D: BNE .going_up

#_01C35F: CLC
#_01C360: ADC.w #$0080
#_01C363: TAX

.going_up
#_01C364: SEP #$20

#_01C366: LDA.l $7F2000,X

#_01C36A: PLX

#_01C36B: CMP.b #$26
#_01C36D: BEQ .stairs_edge

#_01C36F: CMP.b #$38
#_01C371: BEQ .stairs_edge

#_01C373: CMP.b #$39
#_01C375: BEQ .stairs_edge

#_01C377: CMP.b #$5E
#_01C379: BEQ .stairs_edge

#_01C37B: CMP.b #$5F
#_01C37D: BNE RoomTag_FastExit

;---------------------------------------------------------------------------------------------------

.stairs_edge
#_01C37F: PHA

#_01C380: STA.b $0E

#_01C382: LDA.l $7F2040,X
#_01C386: TAY

#_01C387: AND.b #$F8
#_01C389: CMP.b #$30
#_01C38B: BNE RoomTag_DirtyExit

#_01C38D: LDA.w $0308
#_01C390: BPL .not_carrying

#_01C392: PLA

#_01C393: REP #$20

#_01C395: LDA.w $0FC4
#_01C398: STA.b $20

#_01C39A: BRA RoomTag_FastExit

;---------------------------------------------------------------------------------------------------

.not_carrying
#_01C39C: REP #$20

#_01C39E: STY.w $0462

#_01C3A1: LDA.b $A0
#_01C3A3: STA.b $A2

#_01C3A5: SEP #$30

#_01C3A7: JSL Underworld_FlagRoomData_Quadrants

#_01C3AB: SEP #$30

#_01C3AD: LDA.b $0E
#_01C3AF: CMP.b #$38
#_01C3B1: BEQ .is_edge

#_01C3B3: CMP.b #$39
#_01C3B5: BNE .continue

.is_edge
#_01C3B7: LDX.b #$20
#_01C3B9: STX.w $0464

; TODO see if this is north or south, something like that
#_01C3BC: CMP.b #$38
#_01C3BE: BNE .not_edge38

#_01C3C0: JSL HandleEdgeTransitionMovementNorth
#_01C3C4: BRA .continue

.not_edge38
#_01C3C6: JSL HandleEdgeTransitionMovementSouth

;---------------------------------------------------------------------------------------------------

.continue
#_01C3CA: LDA.w $0462
#_01C3CD: AND.b #$03
#_01C3CF: TAX

#_01C3D0: LDA.l $7EC001,X
#_01C3D4: STA.b $A0

#_01C3D6: LDA.w $063D,X
#_01C3D9: STA.w $048A

#_01C3DC: LDX.b #$02

#_01C3DE: LDA.b $EE
#_01C3E0: BNE .set_layer

#_01C3E2: LDX.b #$00

#_01C3E4: LDA.w $0476
#_01C3E7: BEQ .set_layer

#_01C3E9: LDX.b #$02

.set_layer
#_01C3EB: STX.w $0492

#_01C3EE: STZ.b $B0

#_01C3F0: STZ.b $48

#_01C3F2: STZ.b $3D
#_01C3F4: STZ.b $3A
#_01C3F6: STZ.b $3C

;---------------------------------------------------------------------------------------------------

#_01C3F8: LDA.b $50
#_01C3FA: AND.b #$FE
#_01C3FC: STA.b $50

#_01C3FE: LDX.b #$06

#_01C400: PLA

#_01C401: CMP.b #$26
#_01C403: BEQ .set_submodule_and_sfx

#_01C405: LDX.b #$12
#_01C407: CMP.b #$38
#_01C409: BEQ .set_submodule_only

#_01C40B: LDX.b #$13
#_01C40D: CMP.b #$39
#_01C40F: BEQ .set_submodule_only

;---------------------------------------------------------------------------------------------------

#_01C411: JSL Link_AnimateIntraStairClimbAndSFX

#_01C415: LDX.b #$0E
#_01C417: STX.b $11

#_01C419: RTS

;---------------------------------------------------------------------------------------------------

.set_submodule_only
#_01C41A: STX.b $11

#_01C41C: JSL LinkResetPushTimer

#_01C420: RTS

;---------------------------------------------------------------------------------------------------

.set_submodule_and_sfx
#_01C421: STX.b $11

#_01C423: LDY.b #!SFX2_16

#_01C425: LDA.w $048A
#_01C428: CMP.b #$34
#_01C42A: BCC .use_sfx16

#_01C42C: LDY.b #!SFX2_18

.use_sfx16
#_01C42E: STY.w $012E

#_01C431: RTS

;===================================================================================================

RoomTag_NorthWestTrigger:
#_01C432: LDA.b $23
#_01C434: LSR A
#_01C435: BCC RoomTag_NorthTrigger

#_01C437: RTS

;===================================================================================================

RoomTag_NorthEastTrigger:
#_01C438: LDA.b $23
#_01C43A: LSR A
#_01C43B: BCS RoomTag_NorthTrigger

#_01C43D: RTS

;===================================================================================================

RoomTag_SouthWestTrigger:
#_01C43E: LDA.b $23
#_01C440: LSR A
#_01C441: BCC RoomTag_SouthTrigger

#_01C443: RTS

;===================================================================================================

RoomTag_SouthEastTrigger:
#_01C444: LDA.b $23
#_01C446: LSR A
#_01C447: BCS RoomTag_SouthTrigger

#_01C449: RTS

;===================================================================================================

RoomTag_WestTrigger:
#_01C44A: LDA.b $23
#_01C44C: LSR A
#_01C44D: BCC RoomTag_QuadrantTrigger

#_01C44F: RTS

;===================================================================================================

RoomTag_EastTrigger:
#_01C450: LDA.b $23
#_01C452: LSR A
#_01C453: BCS RoomTag_QuadrantTrigger

#_01C455: RTS

;===================================================================================================

RoomTag_NorthTrigger:
#_01C456: LDA.b $21
#_01C458: LSR A
#_01C459: BCC RoomTag_QuadrantTrigger

;---------------------------------------------------------------------------------------------------

#EXIT_01C45B:
#_01C45B: RTS

;===================================================================================================

RoomTag_SouthTrigger:
#_01C45C: LDA.b $21
#_01C45E: LSR A
#_01C45F: BCC EXIT_01C45B

;===================================================================================================

RoomTag_QuadrantTrigger:
#_01C461: LDX.b $0E

#_01C463: LDA.b $AE,X
#_01C465: CMP.b #$0B
#_01C467: BCC RoomTag_OperateKillDoor

#_01C469: CMP.b #$29
#_01C46B: BCC RoomTag_OperateBlockDoor

;===================================================================================================

RoomTag_OperateKillChest:
#_01C46D: JSL CheckIfRoomIsClear
#_01C471: BCC .exit

#_01C473: JSR RoomTag_OperateChestReveal

.exit
#_01C476: RTS

;===================================================================================================

RoomTag_OperateBlockDoor:
#_01C477: LDA.w $0641
#_01C47A: EOR.b #$01
#_01C47C: CMP.w $0468
#_01C47F: BEQ .exit

#_01C481: STA.w $0468

#_01C484: LDA.b #!SFX3_25
#_01C486: STA.w $012F

#_01C489: LDA.b #$05
#_01C48B: STA.b $11

#_01C48D: REP #$20

#_01C48F: STZ.w $068E
#_01C492: STZ.w $0690

.exit
#_01C495: SEP #$30

#_01C497: RTS

;===================================================================================================

RoomTag_OperateKillDoor:
#_01C498: JSL CheckIfRoomIsClear
#_01C49C: BCC .exit

;===================================================================================================

#RoomTag_OperateShutters:
#_01C49E: REP #$30

#_01C4A0: LDX.w #$0000
#_01C4A3: CPX.w $0468
#_01C4A6: BEQ .exit

#_01C4A8: STZ.w $0468

#_01C4AB: STZ.w $068E
#_01C4AE: STZ.w $0690

#_01C4B1: SEP #$30

#_01C4B3: LDA.b #!SFX3_1B
#_01C4B5: STA.w $012F

#_01C4B8: LDA.b #$05
#_01C4BA: STA.b $11

.exit
#_01C4BC: SEP #$30

#_01C4BE: RTS

;===================================================================================================

RoomTag_RoomTrigger:
#_01C4BF: LDX.b $0E

#_01C4C1: LDA.b $AE,X
#_01C4C3: CMP.b #$0A
#_01C4C5: BEQ RoomTag_FullRoomKillCheck

#_01C4C7: JSL CheckIfQuadrantIsClear
#_01C4CB: BCC EXIT_01C4D0

#_01C4CD: JSR RoomTag_OperateChestReveal

;---------------------------------------------------------------------------------------------------

#EXIT_01C4D0:
#_01C4D0: SEP #$30

#_01C4D2: RTS

;---------------------------------------------------------------------------------------------------

RoomTag_FullRoomKillCheck:
#_01C4D3: JSL CheckIfQuadrantIsClear
#_01C4D7: BCC EXIT_01C4D0
#_01C4D9: BCS RoomTag_OperateShutters

;===================================================================================================

RoomTag_RekillableBoss:
#_01C4DB: JSL CheckIfQuadrantIsClear
#_01C4DF: BCC EXIT_01C4D0

#_01C4E1: STZ.w $0FFC

#_01C4E4: STZ.b $AF

#_01C4E6: RTS

;===================================================================================================

RoomTag_RoomTrigger_BlockDoor:
#_01C4E7: LDA.w $0642
#_01C4EA: BEQ .exit

#_01C4EC: REP #$30

#_01C4EE: LDX.w #$0000
#_01C4F1: CPX.w $0468
#_01C4F4: BEQ .exit

#_01C4F6: STX.w $0468

#_01C4F9: STZ.w $068E
#_01C4FC: STZ.w $0690

#_01C4FF: SEP #$30

#_01C501: LDA.b #$05
#_01C503: STA.b $11

.exit
#_01C505: SEP #$30

#_01C507: RTS

;===================================================================================================

RoomTag_RoomTrigger_KillDoor:
#_01C508: LDA.w $040C
#_01C50B: LSR A
#_01C50C: TAX

#_01C50D: LDA.l $7EF3CA
#_01C511: BNE .dark_world

#_01C513: LDA.l $7EF374
#_01C517: AND.l RoomTagPrizeChecks,X
#_01C51B: BEQ .exit
#_01C51D: BRA .open_door

.dark_world
#_01C51F: LDA.l $7EF37A
#_01C523: AND.l RoomTagPrizeChecks,X
#_01C527: BEQ .exit

.open_door
#_01C529: REP #$30

#_01C52B: STZ.w $0468
#_01C52E: STZ.w $068E
#_01C531: STZ.w $0690

#_01C534: SEP #$30

#_01C536: LDA.b #$05
#_01C538: STA.b $11

#_01C53A: LDX.b $0E
#_01C53C: STZ.b $AE,X

.exit
#_01C53E: SEP #$30

#_01C540: RTS

;===================================================================================================
; TODO analyze and verify
RoomTag_SwitchTrigger_HoldDoor:
#_01C541: REP #$30

#_01C543: LDA.w #$0005
#_01C546: LDX.w #$FFFE

.next_check
#_01C549: INX
#_01C54A: INX
#_01C54B: CPX.w $0478
#_01C54E: BEQ .match

#_01C550: CMP.w $0500,X
#_01C553: BNE .next_check

#_01C555: LDX.w $0466
#_01C558: CPX.w #$FFFF
#_01C55B: BNE .fail

.match
#_01C55D: LDX.w #$0000

#_01C560: LDA.w $0646
#_01C563: AND.w #$00FF
#_01C566: BNE .fail

#_01C568: LDA.w $0642
#_01C56B: AND.w #$00FF
#_01C56E: BNE .fail

#_01C570: JSR RoomTag_CheckForPressedSwitch

#_01C573: LDX.w #$0000
#_01C576: BCS .fail

#_01C578: INX

.fail
#_01C579: CPX.w $0468
#_01C57C: BEQ .exit

#_01C57E: STX.w $0468

#_01C581: STZ.w $068E
#_01C584: STZ.w $0690

#_01C587: SEP #$30

#_01C589: CPX.b #$00
#_01C58B: BNE .no_sfx

#_01C58D: LDA.b #!SFX3_25
#_01C58F: STA.w $012F

.no_sfx
#_01C592: LDA.b #$05
#_01C594: STA.b $11

.exit
#_01C596: SEP #$30

#_01C598: RTS

;===================================================================================================

RoomTag_SwitchTrigger_ToggleDoor:
#_01C599: REP #$30

#_01C59B: LDA.w $0430
#_01C59E: BNE .close

#_01C5A0: JSR RoomTag_MaybeCheckShutters
#_01C5A3: BCC .exit

#_01C5A5: STZ.w $068E
#_01C5A8: STZ.w $0690

#_01C5AB: SEP #$30

#_01C5AD: LDA.b #!SFX3_25
#_01C5AF: STA.w $012F

#_01C5B2: LDA.b #$05
#_01C5B4: JSR RoomTag_SwitchTrigger_ToggleDoor_trigger_shutters

#_01C5B7: LDA.w $0468
#_01C5BA: EOR.b #$01
#_01C5BC: STA.w $0468

#_01C5BF: INC.w $0430
#_01C5C2: BRA .exit

.close
#_01C5C4: JSR RoomTag_MaybeCheckShutters
#_01C5C7: BCS .exit

#_01C5C9: STZ.w $0430

.exit
#_01C5CC: SEP #$30

#_01C5CE: RTS

;===================================================================================================

RoomTag_SwitchTrigger_ToggleDoor_trigger_shutters:
#_01C5CF: STA.b $11

#_01C5D1: LDX.b $0C
#_01C5D3: CPX.b #$23
#_01C5D5: BEQ .exit

#_01C5D7: LDA.w $04B6
#_01C5DA: ORA.w $04B7
#_01C5DD: BEQ .exit

#_01C5DF: LDA.b $11
#_01C5E1: STA.w $010C

; Pressure plate switch?
#_01C5E4: LDA.b #$17
#_01C5E6: STA.b $11

#_01C5E8: LDA.b #$20
#_01C5EA: STA.b $B0

;---------------------------------------------------------------------------------------------------

#_01C5EC: REP #$30

#_01C5EE: LDA.b $20
#_01C5F0: CLC
#_01C5F1: ADC.w #$0002
#_01C5F4: STA.b $20

#_01C5F6: LDX.w $04B6

#_01C5F9: LDA.l $7F2000,X
#_01C5FD: AND.w #$FE00
#_01C600: CMP.w #$2400
#_01C603: BEQ .not_switch

#_01C605: INX

.not_switch
#_01C606: STX.w $04B6

#_01C609: TXA
#_01C60A: STA.b $00

#_01C60C: LSR A
#_01C60D: LSR A
#_01C60E: LSR A

#_01C60F: AND.w #$01F8
#_01C612: STA.b $02

#_01C614: LDA.b $00
#_01C616: AND.w #$003F

#_01C619: ASL A
#_01C61A: ASL A
#_01C61B: ASL A

#_01C61C: STA.b $00

#_01C61E: SEP #$30

; pressure switch down
#_01C620: LDY.b #$10
#_01C622: JSL Underworld_UpdateTileMapWithCommonTile

.exit
#_01C626: SEP #$30

#_01C628: RTS

;===================================================================================================

RoomTag_TorchPuzzleDoor:
#_01C629: REP #$30

#_01C62B: LDX.w #$0000
#_01C62E: STX.b $00

.next
#_01C630: LDA.w $0540,X
#_01C633: ASL A
#_01C634: BCC .skip

#_01C636: INC.b $00

.skip
#_01C638: INX
#_01C639: INX
#_01C63A: CPX.w #$0020
#_01C63D: BNE .next

;===================================================================================================

#_01C63F: LDX.w #$0001

#_01C642: LDA.b $00
#_01C644: CMP.w #$0004
#_01C647: BCC .not_enough_torches

#_01C649: DEX

.not_enough_torches
#_01C64A: CPX.w $0468
#_01C64D: BEQ .fail

#_01C64F: STX.w $0468

#_01C652: STZ.w $068E
#_01C655: STZ.w $0690

#_01C658: SEP #$30

#_01C65A: LDA.b #!SFX3_1B
#_01C65C: STA.w $012F

#_01C65F: LDA.b #$05
#_01C661: STA.b $11

.fail
#_01C663: SEP #$30

#_01C665: RTS

;===================================================================================================

ExplodingWallExplosionMovement:
#_01C666: dw $0004, $0006, $0000, $0000
#_01C66E: dw $0002

ExplodingWallTilemapOffset:
#_01C670: dw $0000, $000A, $0000, $0000
#_01C678: dw $0280

;===================================================================================================

RoomTag_Switch_ExplodingWall:
#_01C67A: REP #$30

#_01C67C: JSR RoomTag_MaybeCheckShutters
#_01C67F: BCC EXIT_01C6F9

#_01C681: REP #$30

#_01C683: BRA RoomTag_RunExplodingWall

;===================================================================================================

RoomTag_PullSwitchExplodingWall:
#_01C685: LDA.w $0642
#_01C688: BEQ EXIT_01C6F9

#_01C68A: REP #$30

;===================================================================================================

RoomTag_RunExplodingWall:
#_01C68C: LDY.w #$FFFE

.next
#_01C68F: INY
#_01C690: INY

#_01C691: LDA.w $1980,Y
#_01C694: AND.w #$00FE

#_01C697: CMP.w #$0030
#_01C69A: BNE .next

;---------------------------------------------------------------------------------------------------

#_01C69C: STY.w $0456

#_01C69F: LDA.b $21
#_01C6A1: AND.w #$0001
#_01C6A4: INC A

#_01C6A5: ASL A
#_01C6A6: ASL A
#_01C6A7: TAX

#_01C6A8: LDA.w $19C0,Y
#_01C6AB: AND.w #$0002
#_01C6AE: BEQ .run_check

#_01C6B0: LDA.b $23
#_01C6B2: AND.w #$0001
#_01C6B5: ASL A
#_01C6B6: TAX

.run_check
#_01C6B7: LDA.l ExplodingWallExplosionMovement,X
#_01C6BB: STA.l $7F001C

#_01C6BF: LDA.w $19A0,Y
#_01C6C2: CLC
#_01C6C3: ADC.l ExplodingWallTilemapOffset,X
#_01C6C7: TAY

#_01C6C8: AND.w #$007E
#_01C6CB: ASL A
#_01C6CC: ASL A
#_01C6CD: CLC
#_01C6CE: ADC.w $062C
#_01C6D1: STA.l $7F001A

#_01C6D5: TYA
#_01C6D6: AND.w #$1F80

#_01C6D9: LSR A
#_01C6DA: LSR A
#_01C6DB: LSR A
#_01C6DC: LSR A

#_01C6DD: CLC
#_01C6DE: ADC.w $062E
#_01C6E1: STA.l $7F0018

#_01C6E5: SEP #$30

#_01C6E7: LDA.b #!SFX3_1B
#_01C6E9: STA.w $012F

#_01C6EC: LDA.b #$01
#_01C6EE: STA.w $0454

#_01C6F1: LDX.b $0E

#_01C6F3: STZ.b $AE,X

#_01C6F5: JSL AncillaAdd_BlastWall

;---------------------------------------------------------------------------------------------------

#EXIT_01C6F9:
#_01C6F9: SEP #$30

#_01C6FB: RTS

;===================================================================================================

pool RoomTag_KillRoomForPrize

.prizes
#_01C6FC: db $00 ; Sewers
#_01C6FD: db $00 ; Hyrule Castle
#_01C6FE: db $01 ; Eastern Palace
#_01C6FF: db $02 ; Desert Palace
#_01C700: db $00 ; Agahnim's Tower
#_01C701: db $06 ; Swamp Palace
#_01C702: db $06 ; Palace of Darkness
#_01C703: db $06 ; Misery Mire
#_01C704: db $06 ; Skull Woods
#_01C705: db $06 ; Ice Palace
#_01C706: db $03 ; Tower of Hera
#_01C707: db $06 ; Thieves' Town
#_01C708: db $06 ; Turtle Rock

pool off

;---------------------------------------------------------------------------------------------------

RoomTag_KillRoomForPrize:
#_01C709: LDA.w $0403
#_01C70C: AND.b #$80
#_01C70E: BEQ .exit

#_01C710: LDA.w $040C
#_01C713: LSR A
#_01C714: TAX
#_01C715: LDA.l $7EF3CA
#_01C719: BNE .dark_world

#_01C71B: LDA.l $7EF374
#_01C71F: AND.l RoomTagPrizeChecks,X
#_01C723: BNE .delete_tag
#_01C725: BRA .spawn_prize

.dark_world
#_01C727: LDA.l $7EF37A
#_01C72B: AND.l RoomTagPrizeChecks,X
#_01C72F: BNE .delete_tag

.spawn_prize
#_01C731: LDA.b #$80
#_01C733: STA.w $04C2

#_01C736: LDA.b $0E
#_01C738: PHA

#_01C739: LDA.w $040C
#_01C73C: LSR A
#_01C73D: TAX

#_01C73E: LDA.l .prizes,X
#_01C742: JSL Ancilla_SpawnFallingPrize

#_01C746: PLA
#_01C747: STA.b $0E

.delete_tag
#_01C749: LDX.b $0E
#_01C74B: STZ.b $AE,X

.exit
#_01C74D: RTS

;===================================================================================================

RoomTag_Agahnim:
#_01C74E: LDA.l $7EF2DB
#_01C752: AND.b #$20
#_01C754: BNE .exit

#_01C756: LDA.w $0403
#_01C759: ASL A
#_01C75A: BCC .exit

#_01C75C: JSL Palette_RevertTranslucencySwap

#_01C760: STZ.b $AE

#_01C762: JSL PrepareDungeonExitFromBossFight

.exit
#_01C766: RTS

;===================================================================================================

RoomTag_GanonDoor:
#_01C767: LDX.b #$0F

.next_sprite
#_01C769: LDA.w $0DD0,X
#_01C76C: CMP.b #$04
#_01C76E: BEQ .exit

#_01C770: LDA.w $0F60,X
#_01C773: AND.b #$40
#_01C775: BNE .skip

#_01C777: LDA.w $0DD0,X
#_01C77A: BNE .exit

.skip
#_01C77C: DEX
#_01C77D: BPL .next_sprite

;---------------------------------------------------------------------------------------------------

#_01C77F: LDA.b $5D
#_01C781: CMP.b #!LINKSTATE_01
#_01C783: BEQ .exit

#_01C785: LDA.b #$1A
#_01C787: STA.w $02E4
#_01C78A: STA.b $11

#_01C78C: STZ.b $B0
#_01C78E: STZ.b $AE

#_01C790: LDA.b #$01
#_01C792: STA.w $03EF

#_01C795: STZ.b $3A
#_01C797: STZ.b $3C

#_01C799: LDA.b #$64
#_01C79B: STA.b $C8

#_01C79D: LDA.b #$03
#_01C79F: STA.b $C9

.exit
#_01C7A1: RTS

;===================================================================================================

RoomTag_KillRoomBlock:
#_01C7A2: LDA.b $23
#_01C7A4: LSR A
#_01C7A5: BCC EXIT_01C7C1

#_01C7A7: LDA.b $21
#_01C7A9: LSR A
#_01C7AA: BCC EXIT_01C7C1

#_01C7AC: LDA.b $0E
#_01C7AE: PHA

#_01C7AF: JSL CheckIfRoomIsClear
#_01C7B3: BCC .fail

#_01C7B5: LDA.b #!SFX3_1B
#_01C7B7: STA.w $012F

#_01C7BA: PLX
#_01C7BB: STZ.b $AE,X

#_01C7BD: RTS

.fail
#_01C7BE: PLA

;---------------------------------------------------------------------------------------------------

#EXIT_01C7BF:
#_01C7BF: SEP #$30

;---------------------------------------------------------------------------------------------------

#EXIT_01C7C1:
#_01C7C1: RTS

;===================================================================================================

RoomTag_BlockForChest:
#_01C7C2: LDA.b $14
#_01C7C4: BNE .exit

#_01C7C6: LDA.w $0641
#_01C7C9: BNE RoomTag_OperateChestReveal

.exit
#_01C7CB: RTS

;===================================================================================================

RoomTag_TriggerChest:
#_01C7CC: LDA.w $031F
#_01C7CF: BNE EXIT_01C7C1

#_01C7D1: REP #$30

#_01C7D3: JSR RoomTag_MaybeCheckShutters
#_01C7D6: BCC EXIT_01C7BF

;===================================================================================================

RoomTag_OperateChestReveal:
#_01C7D8: SEP #$30

#_01C7DA: LDX.b $0E
#_01C7DC: STZ.b $AE,X

#_01C7DE: REP #$30

#_01C7E0: STZ.w $1000
#_01C7E3: STZ.w $0200

#_01C7E6: LDA.w #$5858
#_01C7E9: STA.b $0C

;---------------------------------------------------------------------------------------------------

.next_tile
#_01C7EB: LDX.w $0200

#_01C7EE: LDA.w $06E0,X
#_01C7F1: AND.w #$3FFF
#_01C7F4: TAX

;---------------------------------------------------------------------------------------------------

#_01C7F5: LDY.w #$149C

#_01C7F8: LDA.w RoomDrawObjectData+0,Y
#_01C7FB: STA.l $7E2000,X
#_01C7FF: STA.b $02

#_01C801: LDA.w RoomDrawObjectData+2,Y
#_01C804: STA.l $7E2080,X
#_01C808: STA.b $04

#_01C80A: LDA.w RoomDrawObjectData+4,Y
#_01C80D: STA.l $7E2002,X
#_01C811: STA.b $06

#_01C813: LDA.w RoomDrawObjectData+6,Y
#_01C816: STA.l $7E2082,X
#_01C81A: STA.b $08

;---------------------------------------------------------------------------------------------------

#_01C81C: LDY.w $0200

#_01C81F: LDA.w $06E0,Y
#_01C822: AND.w #$3FFF
#_01C825: LSR A
#_01C826: TAX

#_01C827: LDA.b $0C
#_01C829: STA.l $7F2000,X
#_01C82D: STA.l $7F2040,X

#_01C831: CLC
#_01C832: ADC.w #$0101
#_01C835: STA.b $0C

;---------------------------------------------------------------------------------------------------

#_01C837: LDX.w $1000

#_01C83A: LDA.w #$0000
#_01C83D: JSR RoomTag_BuildChestStripes
#_01C840: STA.w $1002,X

#_01C843: LDA.w #$0080
#_01C846: JSR RoomTag_BuildChestStripes
#_01C849: STA.w $1008,X

#_01C84C: LDA.w #$0002
#_01C84F: JSR RoomTag_BuildChestStripes
#_01C852: STA.w $100E,X

#_01C855: LDA.w #$0082
#_01C858: JSR RoomTag_BuildChestStripes
#_01C85B: STA.w $1014,X

;---------------------------------------------------------------------------------------------------

#_01C85E: LDA.b $02
#_01C860: STA.w $1006,X

#_01C863: LDA.b $04
#_01C865: STA.w $100C,X

#_01C868: LDA.b $06
#_01C86A: STA.w $1012,X

#_01C86D: LDA.b $08
#_01C86F: STA.w $1018,X

#_01C872: LDA.w #$0100
#_01C875: STA.w $1004,X
#_01C878: STA.w $100A,X
#_01C87B: STA.w $1010,X
#_01C87E: STA.w $1016,X

#_01C881: LDA.w #$FFFF
#_01C884: STA.w $101A,X

;---------------------------------------------------------------------------------------------------

#_01C887: TXA
#_01C888: CLC
#_01C889: ADC.w #$0018
#_01C88C: STA.w $1000

#_01C88F: LDA.w $0200
#_01C892: INC A
#_01C893: INC A
#_01C894: STA.w $0200

#_01C897: CMP.w $0496
#_01C89A: BEQ .done

#_01C89C: JMP.w .next_tile

;---------------------------------------------------------------------------------------------------

.done
#_01C89F: STZ.w $0200

#_01C8A2: SEP #$30

#_01C8A4: LDA.b #!SFX3_1A
#_01C8A6: STA.w $012F

#_01C8A9: LDA.b #$01
#_01C8AB: STA.b $14

#_01C8AD: RTS

;===================================================================================================

RoomTag_TorchPuzzleChest:
#_01C8AE: REP #$30

#_01C8B0: LDX.w #$0000
#_01C8B3: STX.b $00

.next
#_01C8B5: LDA.w $0540,X
#_01C8B8: ASL A
#_01C8B9: BCC .skip

#_01C8BB: INC.b $00

.skip
#_01C8BD: INX
#_01C8BE: INX
#_01C8BF: CPX.w #$0020
#_01C8C2: BNE .next

#_01C8C4: LDX.w #$0001

#_01C8C7: LDA.b $00
#_01C8C9: CMP.w #$0004
#_01C8CC: BCC .exit

#_01C8CE: JSR RoomTag_OperateChestReveal

.exit
#_01C8D1: SEP #$30

#_01C8D3: RTS

;===================================================================================================

RoomTag_MovingWall_West:
#_01C8D4: REP #$20

#_01C8D6: LDA.w $041A
#_01C8D9: BNE .move_wall

#_01C8DB: JSR RoomTag_MovingWallTorchesCheck
#_01C8DE: BRA .continue

.move_wall
#_01C8E0: LDY.b #$01
#_01C8E2: STY.w $0FC1

#_01C8E5: JSR RoomTag_MovingWallShakeItUp

#_01C8E8: LDA.w #$FFFF
#_01C8EB: JSR MovingWall_MoveALittle

.continue
#_01C8EE: STA.w $0312

#_01C8F1: LDA.w $0422
#_01C8F4: SEC
#_01C8F5: SBC.w $0312
#_01C8F8: STA.w $0422

#_01C8FB: CLC
#_01C8FC: ADC.b $E2
#_01C8FE: STA.b $E0

#_01C900: LDA.w $0312
#_01C903: BEQ .exit

;---------------------------------------------------------------------------------------------------

#_01C905: LDX.w $041E

#_01C908: LDA.w $0422
#_01C90B: CMP.w MovingWallWestBoundaries,X
#_01C90E: BCS .dont_advance

#_01C910: JSR RoomTag_AdvanceGiganticWall

#_01C913: LDA.w $0422
#_01C916: CMP.w MovingWallWestBoundaries,X
#_01C919: BCS .dont_advance

;---------------------------------------------------------------------------------------------------

#_01C91B: LDX.b #!SFX3_1B
#_01C91D: STX.w $012F

#_01C920: LDX.b #!SFX1_05
#_01C922: STX.w $012D

#_01C925: LDX.b $0E

#_01C927: LDY.b #$00
#_01C929: STY.b $AE,X

#_01C92B: STY.w $02E4
#_01C92E: STY.w $0FC1

#_01C931: STZ.w $011A
#_01C934: STZ.w $011B
#_01C937: STZ.w $011C
#_01C93A: STZ.w $011D

;---------------------------------------------------------------------------------------------------

.dont_advance
#_01C93D: LDX.b #$05
#_01C93F: STX.b $17

#_01C941: LDA.w #$0000
#_01C944: SEC
#_01C945: SBC.w $0422
#_01C948: STA.b $00

#_01C94A: AND.w #$01F8
#_01C94D: LSR A
#_01C94E: LSR A
#_01C94F: LSR A
#_01C950: STA.b $00

#_01C952: LDA.w $042A
#_01C955: SEC
#_01C956: SBC.b $00
#_01C958: AND.w #$141F
#_01C95B: STA.w $0116

.exit
#_01C95E: SEP #$20

#_01C960: RTS

;===================================================================================================
; Shake offsets of some sort
;===================================================================================================
OverworldShake_Offsets_Y:
#_01C961: db   1
#_01C962: db   0
#_01C963: db  -1
#_01C964: db  -1

;---------------------------------------------------------------------------------------------------

OverworldShake_Offsets_X:
#_01C965: db  -1
#_01C966: db  -1
#_01C967: db   1
#_01C968: db   0

;===================================================================================================

RoomTag_MovingWallShakeItUp:
#_01C969: LDA.b $1A
#_01C96B: AND.w #$0001
#_01C96E: ASL A
#_01C96F: TAX

#_01C970: LDA.l OverworldShake_Offsets_Y,X
#_01C974: STA.w $011A

#_01C977: LDA.l OverworldShake_Offsets_X,X
#_01C97B: STA.w $011C

#_01C97E: LDX.b $0E

#_01C980: LDY.b $AE,X
#_01C982: BNE .exit

#_01C984: STZ.w $011A
#_01C987: STZ.w $011C

.exit
#_01C98A: RTS

;===================================================================================================

RoomTag_MovingWall_East:
#_01C98B: REP #$20

#_01C98D: LDA.w $041A
#_01C990: BNE .move_wall

#_01C992: JSR RoomTag_MovingWallTorchesCheck
#_01C995: BRA .continue

.move_wall
#_01C997: LDY.b #$01
#_01C999: STY.w $0FC1

#_01C99C: JSR RoomTag_MovingWallShakeItUp

#_01C99F: LDA.w #$0001
#_01C9A2: JSR MovingWall_MoveALittle

.continue
#_01C9A5: STA.w $0312
#_01C9A8: CLC
#_01C9A9: ADC.w $0422
#_01C9AC: STA.w $0422

#_01C9AF: CLC
#_01C9B0: ADC.b $E2
#_01C9B2: STA.b $E0

#_01C9B4: LDA.w $0312
#_01C9B7: BEQ .exit

;---------------------------------------------------------------------------------------------------

#_01C9B9: LDX.w $041E

#_01C9BC: LDA.w $0422
#_01C9BF: CMP.w MovingWallEastBoundaries,X
#_01C9C2: BCC .dont_advance

#_01C9C4: JSR RoomTag_AdvanceGiganticWall

#_01C9C7: LDA.w $0422
#_01C9CA: CMP.w MovingWallEastBoundaries,X
#_01C9CD: BCC .dont_advance

;---------------------------------------------------------------------------------------------------

#_01C9CF: LDX.b #!SFX3_1B
#_01C9D1: STX.w $012F

#_01C9D4: LDX.b #!SFX1_05
#_01C9D6: STX.w $012D

#_01C9D9: LDX.b $0E

#_01C9DB: LDY.b #$00
#_01C9DD: STY.b $AE,X
#_01C9DF: STY.w $02E4
#_01C9E2: STY.w $0FC1

#_01C9E5: STZ.w $011A
#_01C9E8: STZ.w $011B
#_01C9EB: STZ.w $011C
#_01C9EE: STZ.w $011D

;---------------------------------------------------------------------------------------------------

.dont_advance
#_01C9F1: LDX.b #$05
#_01C9F3: STX.b $17

#_01C9F5: LDA.w $0422
#_01C9F8: AND.w #$01F8

#_01C9FB: LSR A
#_01C9FC: LSR A
#_01C9FD: LSR A

#_01C9FE: STA.b $00

#_01CA00: LDA.w $042A
#_01CA03: CLC
#_01CA04: ADC.b $00
#_01CA06: STA.w $0116

#_01CA09: AND.w #$1020
#_01CA0C: BEQ .exit

#_01CA0E: EOR.w #$0420
#_01CA11: STA.w $0116

.exit
#_01CA14: SEP #$20

#_01CA16: RTS

;===================================================================================================

RoomTag_MovingWallTorchesCheck:
#_01CA17: REP #$10

#_01CA19: LDA.w $0642
#_01CA1C: AND.w #$00FF
#_01CA1F: BNE .succeed

#_01CA21: LDX.w #$0000
#_01CA24: STX.b $00

.next
#_01CA26: LDA.w $0540,X
#_01CA29: ASL A
#_01CA2A: BCC .skip

#_01CA2C: INC.b $00

.skip
#_01CA2E: INX
#_01CA2F: INX
#_01CA30: CPX.w #$0020
#_01CA33: BNE .next

;---------------------------------------------------------------------------------------------------

#_01CA35: LDA.b $00
#_01CA37: CMP.w #$0004
#_01CA3A: BCC .fail

.succeed
#_01CA3C: INC.w $041A

#_01CA3F: STZ.w $0642

#_01CA42: SEP #$20

#_01CA44: LDA.b $0E
#_01CA46: ASL A
#_01CA47: TAX

#_01CA48: LDA.w $0403
#_01CA4B: ORA.w DoorFlagMasks-1,X
#_01CA4E: STA.w $0403

#_01CA51: LDA.b #!SFX1_07
#_01CA53: STA.w $012D

#_01CA56: LDA.b #$01
#_01CA58: STA.w $02E4
#_01CA5B: STA.w $0FC1

#_01CA5E: REP #$20

.fail
#_01CA60: LDA.w #$0000

#_01CA63: SEP #$10

#_01CA65: RTS

;===================================================================================================

MovingWall_MoveALittle:
#_01CA66: LDA.w #$2200
#_01CA69: CLC
#_01CA6A: ADC.w $041C
#_01CA6D: STA.w $041C

#_01CA70: ROL A
#_01CA71: AND.w #$0001

#_01CA74: RTS

;===================================================================================================

RoomTag_AdvanceGiganticWall:
#_01CA75: LDX.b $0E

#_01CA77: LDY.b $AE,X
#_01CA79: CPY.b #$20
#_01CA7B: BCS .bomb_wall

#_01CA7D: LDX.b #$00
#_01CA7F: STX.w $046C

#_01CA82: LDX.b #$16
#_01CA84: STX.b $1C

.bomb_wall
#_01CA86: LDX.w $041E

#_01CA89: CPY.b #$20
#_01CA8B: BCS EXIT_01CA93

#_01CA8D: TXA
#_01CA8E: CLC
#_01CA8F: ADC.w #$0008
#_01CA92: TAX

;---------------------------------------------------------------------------------------------------

#EXIT_01CA93:
#_01CA93: RTS

;===================================================================================================

RoomTag_WaterOff:
#_01CA94: LDA.w $0642
#_01CA97: BEQ EXIT_01CA93

#_01CA99: LDA.b #$03
#_01CA9B: STA.b $96

#_01CA9D: STZ.b $97
#_01CA9F: STZ.b $98

#_01CAA1: LDA.b #$16
#_01CAA3: STA.b $1E

#_01CAA5: LDA.b #$01
#_01CAA7: STA.b $1F

#_01CAA9: LDA.b #$01
#_01CAAB: STA.w $0424

#_01CAAE: JSL AdjustWaterHDMAWindow

#_01CAB2: LDA.b #$0B
#_01CAB4: STA.b $11

#_01CAB6: LDA.b #$00
#_01CAB8: STA.l $7EC007
#_01CABC: STA.l $7EC009

#_01CAC0: LDA.b #$1F
#_01CAC2: STA.l $7EC00B

#_01CAC6: INC.b $15

;---------------------------------------------------------------------------------------------------

#_01CAC8: LDA.b #$00
#_01CACA: STA.b $AF

#_01CACC: LDA.w $0403
#_01CACF: ORA.l DoorFlagMasks+1
#_01CAD3: STA.w $0403

#_01CAD6: STZ.w $0642

#_01CAD9: REP #$30

#_01CADB: LDA.w $0682
#_01CADE: AND.w #$01FF
#_01CAE1: SEC
#_01CAE2: SBC.w #$0010

#_01CAE5: ASL A
#_01CAE6: ASL A
#_01CAE7: ASL A
#_01CAE8: ASL A

#_01CAE9: STA.b $08

#_01CAEB: LDA.w $0680
#_01CAEE: AND.w #$01FF
#_01CAF1: SEC
#_01CAF2: SBC.w #$0010

#_01CAF5: LSR A
#_01CAF6: LSR A
#_01CAF7: TSB.b $08

#_01CAF9: LDX.b $08

#_01CAFB: JSR RoomTag_WaterOff_AdjustWater
#_01CAFE: JSR RoomTag_WaterOff_AdjustOverlay

#_01CB01: LDY.b $0C

#_01CB03: LDA.w #$FFFF
#_01CB06: STA.w $1100,Y

#_01CB09: SEP #$30

#_01CB0B: LDA.b #!SFX3_1B
#_01CB0D: STA.w $012F

#_01CB10: LDA.b #!SFX2_2E
#_01CB12: STA.w $012E

#_01CB15: LDA.b #$01
#_01CB17: STA.b $18

;---------------------------------------------------------------------------------------------------

#EXIT_01CB19:
#_01CB19: RTS

;===================================================================================================

RoomTag_WaterOn:
#_01CB1A: LDA.w $0642
#_01CB1D: BEQ EXIT_01CB19

#_01CB1F: LDA.b #!SFX3_1B
#_01CB21: STA.w $012F

#_01CB24: LDA.b #!SFX2_2F
#_01CB26: STA.w $012E

#_01CB29: LDA.b #$0C
#_01CB2B: STA.b $11

#_01CB2D: STZ.b $B0

#_01CB2F: LDA.b #$01
#_01CB31: STA.w $0424

#_01CB34: LDA.b #$00
#_01CB36: STA.b $AF

#_01CB38: LDA.w $0403
#_01CB3B: ORA.l DoorFlagMasks+1
#_01CB3F: STA.w $0403

#_01CB42: STZ.w $0642
#_01CB45: STZ.w $045C

;---------------------------------------------------------------------------------------------------

#EXIT_01CB48:
#_01CB48: RTS

;===================================================================================================

RoomTag_WaterGate:
#_01CB49: LDA.w $0403
#_01CB4C: AND.l DoorFlagMasks+1
#_01CB50: BNE EXIT_01CB48

#_01CB52: LDA.w $0642
#_01CB55: BEQ EXIT_01CB48

;===================================================================================================

#_01CB57: LDA.b #$0D
#_01CB59: STA.b $11

#_01CB5B: STZ.b $B0

#_01CB5D: LDA.b #$00
#_01CB5F: STA.b $AF

#_01CB61: LDA.w $0403
#_01CB64: ORA.l DoorFlagMasks+1
#_01CB68: STA.w $0403

#_01CB6B: STZ.w $0642
#_01CB6E: STZ.w $0684
#_01CB71: STZ.w $067A

;---------------------------------------------------------------------------------------------------

#_01CB74: LDA.b #$03
#_01CB76: STA.b $96

#_01CB78: STZ.b $97
#_01CB7A: STZ.b $98

#_01CB7C: LDA.b #$16
#_01CB7E: STA.b $1E

#_01CB80: LDA.b #$01
#_01CB82: STA.b $1F

#_01CB84: LDA.b #$02
#_01CB86: STA.b $99

#_01CB88: LDA.b #$62
#_01CB8A: STA.b $9A

;---------------------------------------------------------------------------------------------------
; Dam overlay
#_01CB8C: LDA.l $7EF2BB
#_01CB90: ORA.b #$20
#_01CB92: STA.l $7EF2BB

; Swamp overlay
#_01CB96: LDA.l $7EF2FB
#_01CB9A: ORA.b #$20
#_01CB9C: STA.l $7EF2FB

; Swamp entrance water
#_01CBA0: LDA.l $7EF051
#_01CBA4: ORA.b #$01
#_01CBA6: STA.l $7EF051

;---------------------------------------------------------------------------------------------------

#_01CBAA: REP #$30

#_01CBAC: LDA.w #WaterOverlayData>>16
#_01CBAF: STA.b $B9

#_01CBB1: LDA.w #WaterOverlayData>>0
#_01CBB4: JSR RoomTag_OperateWaterFlooring

#_01CBB7: REP #$30

#_01CBB9: LDA.w $0472
#_01CBBC: AND.w #$007E
#_01CBBF: ASL A
#_01CBC0: ASL A
#_01CBC1: STA.w $0680

;---------------------------------------------------------------------------------------------------

#_01CBC4: LDA.b $B2

#_01CBC6: ASL A ; x16
#_01CBC7: ASL A
#_01CBC8: ASL A
#_01CBC9: ASL A

#_01CBCA: CLC
#_01CBCB: ADC.w $062C

#_01CBCE: CLC
#_01CBCF: ADC.w $0680

#_01CBD2: CLC
#_01CBD3: ADC.w #$0028
#_01CBD6: STA.w $0680

#_01CBD9: LDA.w $0472
#_01CBDC: AND.w #$1F80
#_01CBDF: LSR A ; /16
#_01CBE0: LSR A
#_01CBE1: LSR A
#_01CBE2: LSR A
#_01CBE3: STA.w $0676
#_01CBE6: STA.w $0678

#_01CBE9: CLC
#_01CBEA: ADC.w $062E
#_01CBED: STA.w $0682

#_01CBF0: STZ.w $0686

#_01CBF3: SEP #$30

#_01CBF5: LDA.b #!SFX3_1B
#_01CBF7: STA.w $012F

#_01CBFA: LDA.b #!SFX2_2F
#_01CBFC: STA.w $012E

;===================================================================================================

RoomTag_WaterTwin:
#_01CBFF: RTS

;===================================================================================================

RoomTag_Holes0:
#_01CC00: LDA.b #$01
#_01CC02: BRA RoomTag_TriggerHoles

;===================================================================================================

RoomTag_Holes1:
#_01CC04: LDA.b #$03
#_01CC06: BRA RoomTag_TriggerHoles

;===================================================================================================

RoomTag_Holes3:
#_01CC08: LDA.b #$06
#_01CC0A: BRA RoomTag_TriggerHoles

;===================================================================================================

RoomTag_Holes4:
#_01CC0C: LDA.b #$08
#_01CC0E: BRA RoomTag_TriggerHoles

;===================================================================================================

RoomTag_Holes5:
#_01CC10: LDA.b #$0A
#_01CC12: BRA RoomTag_TriggerHoles

;===================================================================================================

RoomTag_Holes6:
#_01CC14: LDA.b #$0C
#_01CC16: BRA RoomTag_TriggerHoles

;===================================================================================================

RoomTag_Holes7:
#_01CC18: LDA.b #$0E
#_01CC1A: BRA RoomTag_TriggerHoles

;===================================================================================================

RoomTag_Holes8:
#_01CC1C: LDA.b #$10

;===================================================================================================

RoomTag_TriggerHoles:
#_01CC1E: STA.b $0A

#_01CC20: LDY.w $04BA
#_01CC23: BNE .dont_copy

#_01CC25: STA.w $04BA

.dont_copy
#_01CC28: REP #$30

#_01CC2A: JSR RoomTag_CheckForPressedSwitch
#_01CC2D: BCC .exit

#_01CC2F: SEP #$30

#_01CC31: TYA
#_01CC32: CLC
#_01CC33: ADC.b $0A
#_01CC35: CMP.w $04BA
#_01CC38: BEQ .exit

#_01CC3A: STA.w $04BA

#_01CC3D: STZ.b $BA
#_01CC3F: STZ.b $BB
#_01CC41: STZ.b $B0

#_01CC43: LDA.b #!SFX3_1B
#_01CC45: STA.w $012F

#_01CC48: LDA.b #$03
#_01CC4A: STA.b $11

#_01CC4C: LDA.w $04BC
#_01CC4F: EOR.b #$01
#_01CC51: STA.w $04BC

#_01CC54: JSL ToggleStarTileGraphics

.exit
#_01CC58: SEP #$30

#_01CC5A: RTS

;===================================================================================================

RoomTag_ChestHoles0:
#_01CC5B: REP #$10

#_01CC5D: LDY.w #$0000
#_01CC60: BRA RoomTag_OperateChestHoles

;===================================================================================================

RoomTag_ChestHoles8:
#_01CC62: REP #$10

#_01CC64: LDY.w #$0012

;===================================================================================================

RoomTag_OperateChestHoles:
#_01CC67: LDA.w $0403
#_01CC6A: AND.b #$01
#_01CC6C: BEQ EXIT_01CC86

;===================================================================================================

RoomTag_TriggerChestHoles:
#_01CC6E: STY.w $04BA

#_01CC71: SEP #$30

#_01CC73: STZ.b $BA
#_01CC75: STZ.b $BB
#_01CC77: STZ.b $B0

#_01CC79: LDA.b #!SFX3_1B
#_01CC7B: STA.w $012F

#_01CC7E: LDA.b #$03
#_01CC80: STA.b $11

#_01CC82: LDX.b $0E
#_01CC84: STZ.b $AE,X

;---------------------------------------------------------------------------------------------------

#EXIT_01CC86:
#_01CC86: SEP #$30

#_01CC88: RTS

;===================================================================================================

RoomTag_Holes2:
#_01CC89: REP #$30

#_01CC8B: JSR RoomTag_CheckForPressedSwitch
#_01CC8E: BCC EXIT_01CC86

#_01CC90: LDY.w #$0005
#_01CC93: BRA RoomTag_TriggerChestHoles

;===================================================================================================

RoomTag_OperateWaterFlooring:
#_01CC95: STA.b $B7

#_01CC97: STZ.b $BA

.next_object
#_01CC99: STZ.b $B2
#_01CC9B: STZ.b $B4

#_01CC9D: LDY.b $BA
#_01CC9F: LDA.b [$B7],Y

#_01CCA1: CMP.w #$FFFF
#_01CCA4: BNE .continue

#_01CCA6: SEP #$30

#_01CCA8: RTS

;---------------------------------------------------------------------------------------------------

.continue
#_01CCA9: STA.b $00

#_01CCAB: SEP #$20

#_01CCAD: AND.b #$FC
#_01CCAF: STA.b $08

#_01CCB1: LDA.b $00
#_01CCB3: AND.b #$03
#_01CCB5: INC A
#_01CCB6: STA.b $B2

#_01CCB8: LDA.b $01
#_01CCBA: AND.b #$03
#_01CCBC: INC A
#_01CCBD: STA.b $B4

;---------------------------------------------------------------------------------------------------

#_01CCBF: INY
#_01CCC0: INY
#_01CCC1: INY

#_01CCC2: STY.b $BA

#_01CCC4: LDA.b $01
#_01CCC6: LSR A
#_01CCC7: LSR A
#_01CCC8: LSR A
#_01CCC9: ROR.b $08
#_01CCCB: STA.b $09

#_01CCCD: REP #$20

#_01CCCF: LDX.b $08
#_01CCD1: LDY.w #$0110

;---------------------------------------------------------------------------------------------------

.next_tile_group
#_01CCD4: LDA.b $B2
#_01CCD6: STA.b $0A

.next_tile_row
#_01CCD8: LDA.w #$0002
#_01CCDB: STA.b $04

.next_tile
#_01CCDD: LDA.w RoomDrawObjectData+0,Y
#_01CCE0: STA.l $7E4000,X

#_01CCE4: LDA.w RoomDrawObjectData+2,Y
#_01CCE7: STA.l $7E4002,X

#_01CCEB: LDA.w RoomDrawObjectData+4,Y
#_01CCEE: STA.l $7E4004,X

#_01CCF2: LDA.w RoomDrawObjectData+6,Y
#_01CCF5: STA.l $7E4006,X

#_01CCF9: LDA.w RoomDrawObjectData+8,Y
#_01CCFC: STA.l $7E4080,X

#_01CD00: LDA.w RoomDrawObjectData+10,Y
#_01CD03: STA.l $7E4082,X

#_01CD07: LDA.w RoomDrawObjectData+12,Y
#_01CD0A: STA.l $7E4084,X

#_01CD0E: LDA.w RoomDrawObjectData+14,Y
#_01CD11: STA.l $7E4086,X

#_01CD15: TXA
#_01CD16: CLC
#_01CD17: ADC.w #$0100
#_01CD1A: TAX

#_01CD1B: DEC.b $04
#_01CD1D: BNE .next_tile

#_01CD1F: TXA
#_01CD20: SEC
#_01CD21: SBC.w #$01F8
#_01CD24: TAX

#_01CD25: DEC.b $0A
#_01CD27: BNE .next_tile_row

#_01CD29: LDA.b $08
#_01CD2B: CLC
#_01CD2C: ADC.w #$0200
#_01CD2F: STA.b $08

#_01CD31: TAX

#_01CD32: DEC.b $B4
#_01CD34: BNE .next_tile_group

#_01CD36: JMP.w .next_object

;===================================================================================================
; TODO VERIFY
;===================================================================================================
RoomTag_MaybeCheckShutters:
#_01CD39: LDA.w $02E4
#_01CD3C: AND.w #$00FF
#_01CD3F: BNE RoomTagFail

#_01CD41: LDA.b $4D
#_01CD43: AND.w #$00FF
#_01CD46: BNE RoomTagFail

#_01CD48: JSR RoomTag_GetTilemapCoords

#_01CD4B: LDA.l $7F2000,X
#_01CD4F: CMP.w #$2323
#_01CD52: BEQ .check_tile

#_01CD54: CMP.w #$2424
#_01CD57: BEQ .check_tile

#_01CD59: TXA
#_01CD5A: CLC
#_01CD5B: ADC.w #$0040
#_01CD5E: TAX

#_01CD5F: LDA.l $7F2000,X
#_01CD63: CMP.w #$2323
#_01CD66: BEQ .check_tile

#_01CD68: CMP.w #$2424
#_01CD6B: BEQ .check_tile

#_01CD6D: INC.b $00

#_01CD6F: LDX.b $00

#_01CD71: LDA.l $7F2000,X
#_01CD75: CMP.w #$2323
#_01CD78: BEQ .check_tile

#_01CD7A: CMP.w #$2424
#_01CD7D: BEQ .check_tile

#_01CD7F: TXA
#_01CD80: CLC
#_01CD81: ADC.w #$0040
#_01CD84: TAX

#_01CD85: LDA.l $7F2000,X
#_01CD89: CMP.w #$2323
#_01CD8C: BEQ .check_tile

#_01CD8E: CMP.w #$2424
#_01CD91: BNE RoomTagFail

.check_tile
#_01CD93: CMP.l $7F2040,X
#_01CD97: BNE RoomTagFail

#_01CD99: STA.b $0C

#_01CD9B: STX.w $04B6

.succeed
#_01CD9E: SEC

#_01CD9F: RTS

;---------------------------------------------------------------------------------------------------

RoomTagFail:
#_01CDA0: STZ.w $04B6

#_01CDA3: CLC

#_01CDA4: RTS

;===================================================================================================

RoomTag_GetTilemapCoords:
#_01CDA5: LDA.b $22
#_01CDA7: CLC
#_01CDA8: ADC.w #$FFFF
#_01CDAB: AND.w #$01F8

#_01CDAE: LSR A
#_01CDAF: LSR A
#_01CDB0: LSR A

#_01CDB1: STA.b $00

#_01CDB3: LDA.b $20
#_01CDB5: CLC
#_01CDB6: ADC.w #$000E
#_01CDB9: AND.w #$01F8

#_01CDBC: ASL A
#_01CDBD: ASL A
#_01CDBE: ASL A

#_01CDBF: ORA.b $00

#_01CDC1: LDX.b $EE
#_01CDC3: BEQ .upper_layer

#_01CDC5: ORA.w #$1000

.upper_layer
#_01CDC8: STA.b $00

#_01CDCA: TAX

#_01CDCB: RTS

;===================================================================================================
; TODO analyze
RoomTag_CheckForPressedSwitch:
#_01CDCC: LDA.w $02E4
#_01CDCF: AND.w #$00FF
#_01CDD2: BNE RoomTagFail

#_01CDD4: LDA.b $4D
#_01CDD6: AND.w #$00FF
#_01CDD9: BNE RoomTagFail

#_01CDDB: JSR RoomTag_GetTilemapCoords

#_01CDDE: LDY.w #$0000

#_01CDE1: LDA.l $7F2000,X
#_01CDE5: CMP.w #$2323
#_01CDE8: BEQ .check_tile

#_01CDEA: CMP.w #$3A3A
#_01CDED: BEQ .check_tile

#_01CDEF: INY

#_01CDF0: CMP.w #$3B3B
#_01CDF3: BEQ .check_tile

;---------------------------------------------------------------------------------------------------

#_01CDF5: TXA
#_01CDF6: CLC
#_01CDF7: ADC.w #$0040
#_01CDFA: TAX

#_01CDFB: LDY.w #$0000

#_01CDFE: LDA.l $7F2000,X
#_01CE02: CMP.w #$2323
#_01CE05: BEQ .check_tile

#_01CE07: CMP.w #$3A3A
#_01CE0A: BEQ .check_tile

#_01CE0C: INY
#_01CE0D: CMP.w #$3B3B
#_01CE10: BEQ .check_tile

;---------------------------------------------------------------------------------------------------

#_01CE12: INC.b $00

#_01CE14: LDX.b $00

#_01CE16: LDY.w #$0000

#_01CE19: LDA.l $7F2000,X
#_01CE1D: CMP.w #$2323
#_01CE20: BEQ .check_tile

#_01CE22: CMP.w #$3A3A
#_01CE25: BEQ .check_tile

#_01CE27: INY

#_01CE28: CMP.w #$3B3B
#_01CE2B: BEQ .check_tile

;---------------------------------------------------------------------------------------------------

#_01CE2D: TXA
#_01CE2E: CLC
#_01CE2F: ADC.w #$0040
#_01CE32: TAX

#_01CE33: LDY.w #$0000

#_01CE36: LDA.l $7F2000,X
#_01CE3A: CMP.w #$2323
#_01CE3D: BEQ .check_tile

#_01CE3F: CMP.w #$3A3A
#_01CE42: BEQ .check_tile

#_01CE44: CMP.w #$3B3B
#_01CE47: BNE .fail

#_01CE49: INY

;---------------------------------------------------------------------------------------------------

.check_tile
#_01CE4A: CMP.l $7F2040,X
#_01CE4E: BNE .fail

#_01CE50: STA.b $0C

#_01CE52: STX.w $04B6

#_01CE55: SEC

#_01CE56: RTS

;---------------------------------------------------------------------------------------------------

.fail
#_01CE57: STZ.w $04B6

#_01CE5A: CLC

#_01CE5B: RTS

;===================================================================================================

CorrespondingDoorOpeningDirection:
#_01CE5C: dw $0002
#_01CE5E: dw $0000
#_01CE60: dw $0006
#_01CE62: dw $0004

;===================================================================================================

VineDoorGFXOffset:
#_01CE64: dw $07EA
#_01CE66: dw $080A
#_01CE68: dw $080A
#_01CE6A: dw $082A

;===================================================================================================

DoorOpenSFXPan:
#_01CE6C: db $00
#_01CE6D: db $00
#_01CE6E: db $80
#_01CE6F: db $40

;===================================================================================================

Underworld_ProcessTorchesAndDoors:
#_01CE70: LDA.b $1A
#_01CE72: AND.b #$03
#_01CE74: BNE .ignore_checks

#_01CE76: LDA.w $0112
#_01CE79: BNE .ignore_checks

#_01CE7B: LDX.b #$00

.next
#_01CE7D: LDA.w $04F0,X
#_01CE80: BEQ .skip

#_01CE82: DEC.w $04F0,X
#_01CE85: BNE .skip

#_01CE87: PHX

#_01CE88: TXA
#_01CE89: ORA.b #$C0
#_01CE8B: STA.w $0333

#_01CE8E: JSL Underworld_ExtinguishTorch

#_01CE92: PLX

.skip
#_01CE93: INX
#_01CE94: CPX.b #$10
#_01CE96: BNE .next

;---------------------------------------------------------------------------------------------------

.ignore_checks
#_01CE98: LDA.w $02E4
#_01CE9B: BEQ .not_cutscene

#_01CE9D: JMP.w DontOpenDoor

;---------------------------------------------------------------------------------------------------

.not_cutscene
#_01CEA0: REP #$21

#_01CEA2: LDA.b $2F
#_01CEA4: AND.w #$00FF
#_01CEA7: STA.b $08

#_01CEA9: TAY

#_01CEAA: LDA.b $20
#_01CEAC: ADC.w DetectStaircase_offset_y,Y
#_01CEAF: AND.w #$01F8
#_01CEB2: ASL A
#_01CEB3: ASL A
#_01CEB4: ASL A
#_01CEB5: STA.b $00

#_01CEB7: LDA.b $22
#_01CEB9: CLC
#_01CEBA: ADC.w DetectStaircase_offset_x,Y
#_01CEBD: AND.w #$01F8
#_01CEC0: LSR A
#_01CEC1: LSR A
#_01CEC2: LSR A
#_01CEC3: ORA.b $00

#_01CEC5: LDX.b $EE
#_01CEC7: BEQ .upper_layer

#_01CEC9: ORA.w #$1000

;---------------------------------------------------------------------------------------------------

.upper_layer
#_01CECC: REP #$10

#_01CECE: TAX

#_01CECF: LDA.l $7F2000,X
#_01CED3: AND.w #$00F0
#_01CED6: CMP.w #$00F0
#_01CED9: BEQ .some_sorta_door

#_01CEDB: TXA
#_01CEDC: CLC
#_01CEDD: ADC.w DetectStaircase_index_offset,Y
#_01CEE0: TAX

#_01CEE1: LDA.l $7F2000,X
#_01CEE5: AND.w #$00F0
#_01CEE8: CMP.w #$00F0
#_01CEEB: BNE .reset_missing_key_message_flag

;---------------------------------------------------------------------------------------------------
; TODO good for door variables
.some_sorta_door
#_01CEED: LDA.l $7F2000,X
#_01CEF1: AND.w #$000F
#_01CEF4: ASL A
#_01CEF5: TAY
#_01CEF6: STY.w $0694

#_01CEF9: LDA.w $19C0,Y
#_01CEFC: AND.w #$0003
#_01CEFF: ASL A
#_01CF00: CMP.b $08
#_01CF02: BNE .reset_missing_key_message_flag

#_01CF04: LDA.w $1980,Y
#_01CF07: AND.w #$00FE
#_01CF0A: CMP.w #$0028
#_01CF0D: BEQ OperateDashBashWall

#_01CF0F: CMP.w #$001C
#_01CF12: BEQ .is_key_door

#_01CF14: CMP.w #$001E
#_01CF17: BNE .not_big_key_door

;---------------------------------------------------------------------------------------------------

#_01CF19: STZ.w $0690

#_01CF1C: STX.w $068E

#_01CF1F: LDY.w $040C

#_01CF22: LDA.l $7EF366
#_01CF26: AND.w DungeonMask,Y
#_01CF29: BNE .have_big_key

#_01CF2B: LDA.w $04B8
#_01CF2E: BNE .proceed_to_not_open_door

#_01CF30: INC.w $04B8

; Message 0078
#_01CF33: LDA.w #$0078
#_01CF36: STA.w $1CF0

#_01CF39: SEP #$30

#_01CF3B: JSL Interface_PrepAndDisplayMessage

#_01CF3F: REP #$30

;---------------------------------------------------------------------------------------------------

.proceed_to_not_open_door
#_01CF41: JMP.w DontOpenDoor

;---------------------------------------------------------------------------------------------------

.reset_missing_key_message_flag
#_01CF44: STZ.w $04B8

#_01CF47: JMP.w DontOpenDoor

;---------------------------------------------------------------------------------------------------

.not_big_key_door
#_01CF4A: CMP.w #$001C
#_01CF4D: BCC .proceed_to_not_open_door

#_01CF4F: CMP.w #$002C
#_01CF52: BCS .proceed_to_not_open_door

#_01CF54: CMP.w #$002A
#_01CF57: BEQ .proceed_to_not_open_door

;---------------------------------------------------------------------------------------------------

.is_key_door
#_01CF59: LDA.l $7EF36F
#_01CF5D: AND.w #$00FF
#_01CF60: BEQ .proceed_to_not_open_door

#_01CF62: LDA.l $7EF36F
#_01CF66: DEC A
#_01CF67: STA.l $7EF36F

;---------------------------------------------------------------------------------------------------

.have_big_key
#_01CF6B: STZ.w $0690

#_01CF6E: STX.w $068E

#_01CF71: SEP #$30

#_01CF73: LDA.b #$04
#_01CF75: STA.b $11

#_01CF77: LDA.b #!SFX3_14
#_01CF79: STA.b $00

#_01CF7B: LDX.w $0694

#_01CF7E: LDA.w $19C0,X
#_01CF81: AND.b #$03
#_01CF83: TAX

#_01CF84: LDA.l DoorOpenSFXPan,X
#_01CF88: ORA.b $00
#_01CF8A: STA.w $012F

#_01CF8D: RTL

;===================================================================================================

OperateDashBashWall:
#_01CF8E: LDA.w $0372
#_01CF91: AND.w #$00FF
#_01CF94: BEQ DontOpenDoor

#_01CF96: LDA.w $02F1
#_01CF99: CMP.w #$003F
#_01CF9C: BCS DontOpenDoor

;---------------------------------------------------------------------------------------------------

#_01CF9E: STX.w $068E

#_01CFA1: SEP #$30

#_01CFA3: STY.b $00

#_01CFA5: JSL AncillaAdd_DoorDebris
#_01CFA9: BCS .skip_ancilla

#_01CFAB: LDY.b $00

#_01CFAD: LDA.w $19C0,Y
#_01CFB0: AND.b #$03
#_01CFB2: STA.w $03BE,X

#_01CFB5: TXA
#_01CFB6: ASL A
#_01CFB7: TAX

;---------------------------------------------------------------------------------------------------

#_01CFB8: REP #$20

#_01CFBA: LDA.w $19A0,Y
#_01CFBD: AND.w #$007E

#_01CFC0: ASL A ; x4
#_01CFC1: ASL A

#_01CFC2: CLC ; !USELESS it's already clear
#_01CFC3: ADC.w $062C
#_01CFC6: STA.w $03B6,X

#_01CFC9: LDA.w $19A0,Y
#_01CFCC: AND.w #$1F80
#_01CFCF: LSR A ; /16
#_01CFD0: LSR A
#_01CFD1: LSR A
#_01CFD2: LSR A
#_01CFD3: CLC ; !USELESS it's already clear
#_01CFD4: ADC.w $062E
#_01CFD7: STA.w $03BA,X

.skip_ancilla
#_01CFDA: SEP #$30

#_01CFDC: LDA.b #!SFX3_1B
#_01CFDE: STA.w $012F

#_01CFE1: LDA.b #$09
#_01CFE3: STA.b $11

#_01CFE5: JSL Sprite_RepelDash_long

;---------------------------------------------------------------------------------------------------

#EXIT_01CFE9:
#_01CFE9: RTL

;===================================================================================================

DontOpenDoor:
#_01CFEA: SEP #$30

; eye door for tr compass
#_01CFEC: LDA.w $0436
#_01CFEF: BMI .no_door_draw

#_01CFF1: LDA.b $6C
#_01CFF3: BNE .no_door_draw

#_01CFF5: LDA.b $23
#_01CFF7: CMP.b #$0C
#_01CFF9: BNE .no_door_draw

#_01CFFB: LDY.w $0437

#_01CFFE: LDX.w $0436
#_01D001: CPX.b $2F
#_01D003: BEQ .direction_mismatch

#_01D005: LDA.b $2F
#_01D007: CMP.l CorrespondingDoorOpeningDirection,X
#_01D00B: BNE .direction_mismatch

#_01D00D: REP #$20

#_01D00F: LDA.w $068C
#_01D012: ORA.w DungeonMask,Y
#_01D015: BRA .continue

.direction_mismatch
#_01D017: REP #$20

#_01D019: LDA.w $068C
#_01D01C: AND.w DungeonMaskInverted,Y

.continue
#_01D01F: CMP.w $068C
#_01D022: BEQ .no_door_draw

#_01D024: STA.w $068C

#_01D027: STZ.b $0C

#_01D029: REP #$10

#_01D02B: LDA.w $0437
#_01D02E: AND.w #$00FF
#_01D031: TAY

#_01D032: JSR DrawEyeWatchDoor
#_01D035: JSR Underworld_PrepNextTileMapUpdateDMA

#_01D038: LDY.w $0460
#_01D03B: JSR Underworld_LoadSingleDoorTileAttribute_from_parameter

#_01D03E: LDY.b $0C

#_01D040: LDA.w #$FFFF
#_01D043: STA.w $1100,Y

#_01D046: SEP #$30

#_01D048: LDA.b #$01
#_01D04A: STA.b $18

#_01D04C: LDA.b #!SFX3_15
#_01D04E: STA.w $012F

#_01D051: RTL

;---------------------------------------------------------------------------------------------------

.no_door_draw
#_01D052: SEP #$30

#_01D054: LDA.b $3A
#_01D056: ASL A
#_01D057: BCC EXIT_01CFE9

#_01D059: LDA.b $3C
#_01D05B: CMP.b #$04
#_01D05D: BNE EXIT_01CFE9

;---------------------------------------------------------------------------------------------------

#_01D05F: REP #$31

#_01D061: LDA.b $44
#_01D063: AND.w #$00FF
#_01D066: CMP.w #$0080
#_01D069: BCC .positive_y

#_01D06B: ORA.w #$FF00

.positive_y
#_01D06E: CLC
#_01D06F: ADC.b $20
#_01D071: AND.w #$01F8

#_01D074: ASL A
#_01D075: ASL A
#_01D076: ASL A

#_01D077: STA.b $00

;---------------------------------------------------------------------------------------------------

#_01D079: LDA.b $45
#_01D07B: AND.w #$00FF
#_01D07E: CMP.w #$0080
#_01D081: BCC .positive_x

#_01D083: ORA.w #$FF00

.positive_x
#_01D086: CLC
#_01D087: ADC.b $22

#_01D089: AND.w #$01F8
#_01D08C: LSR A
#_01D08D: LSR A
#_01D08E: LSR A

#_01D08F: ORA.b $00
#_01D091: TAX

;---------------------------------------------------------------------------------------------------

#_01D092: LDY.w #$0041

#_01D095: LDA.l $7F2000,X
#_01D099: AND.w #$00FC
#_01D09C: CMP.w #$006C
#_01D09F: BEQ SlashSwordAgainstVinesAndDoors

#_01D0A1: AND.w #$00F0
#_01D0A4: CMP.w #$00F0
#_01D0A7: BEQ SlashSwordAgainstVinesAndDoors

#_01D0A9: INX

#_01D0AA: DEY

#_01D0AB: LDA.l $7F2000,X
#_01D0AF: AND.w #$00FC
#_01D0B2: CMP.w #$006C
#_01D0B5: BEQ SlashSwordAgainstVinesAndDoors

#_01D0B7: AND.w #$00F0
#_01D0BA: CMP.w #$00F0
#_01D0BD: BEQ SlashSwordAgainstVinesAndDoors

;---------------------------------------------------------------------------------------------------

#_01D0BF: TXA
#_01D0C0: CLC
#_01D0C1: ADC.w #$003F
#_01D0C4: TAX

#_01D0C5: LDY.w #$0001
#_01D0C8: LDA.l $7F2000,X
#_01D0CC: AND.w #$00FC
#_01D0CF: CMP.w #$006C
#_01D0D2: BEQ SlashSwordAgainstVinesAndDoors

#_01D0D4: AND.w #$00F0
#_01D0D7: CMP.w #$00F0
#_01D0DA: BEQ SlashSwordAgainstVinesAndDoors

#_01D0DC: INX

#_01D0DD: DEY

#_01D0DE: LDA.l $7F2000,X
#_01D0E2: AND.w #$00FC
#_01D0E5: CMP.w #$006C
#_01D0E8: BEQ SlashSwordAgainstVinesAndDoors

#_01D0EA: AND.w #$00F0
#_01D0ED: CMP.w #$00F0
#_01D0F0: BEQ SlashSwordAgainstVinesAndDoors

#_01D0F2: SEP #$30

#_01D0F4: RTL

;===================================================================================================

SlashSwordAgainstVinesAndDoors:
#_01D0F5: STZ.b $0C

#_01D0F7: CMP.w #$006C
#_01D0FA: BEQ .is_vines

#_01D0FC: JMP.w .not_vines

.is_vines
#_01D0FF: STY.b $0E

#_01D101: CPY.w #$0040
#_01D104: BCC .vertical_fine

#_01D106: TYA
#_01D107: AND.w #$000F
#_01D10A: STA.b $0E
#_01D10C: TXA

#_01D10D: SEC
#_01D10E: SBC.w #$0040
#_01D111: TAX

#_01D112: LDA.l $7F2000,X
#_01D116: AND.w #$00FC
#_01D119: CMP.w #$006C
#_01D11C: BEQ .vertical_fine

#_01D11E: TXA
#_01D11F: CLC
#_01D120: ADC.w #$0040
#_01D123: TAX

.vertical_fine
#_01D124: LDY.b $0E
#_01D126: BEQ .horizontal_fine

#_01D128: DEX

#_01D129: LDA.l $7F2000,X
#_01D12D: AND.w #$00FC
#_01D130: CMP.w #$006C
#_01D133: BEQ .horizontal_fine

#_01D135: INX

.horizontal_fine
#_01D136: TXA
#_01D137: SEC
#_01D138: SBC.w #$0041
#_01D13B: ASL A
#_01D13C: STA.b $08

#_01D13E: LDA.l $7F2000,X
#_01D142: PHA

#_01D143: LDA.w #$0202
#_01D146: STA.l $7F2000,X
#_01D14A: STA.l $7F2040,X

#_01D14E: PLA
#_01D14F: AND.w #$0003
#_01D152: ASL A
#_01D153: TAX

#_01D154: LDA.l VineDoorGFXOffset,X
#_01D158: TAY

#_01D159: LDX.b $08

#_01D15B: LDA.w #$0004
#_01D15E: STA.b $0E

;---------------------------------------------------------------------------------------------------

.next
#_01D160: LDA.w RoomDrawObjectData+0,Y
#_01D163: STA.l $7E2000,X

#_01D167: LDA.w RoomDrawObjectData+2,Y
#_01D16A: STA.l $7E2080,X

#_01D16E: LDA.w RoomDrawObjectData+4,Y
#_01D171: STA.l $7E2100,X

#_01D175: LDA.w RoomDrawObjectData+6,Y
#_01D178: STA.l $7E2180,X

#_01D17C: TYA
#_01D17D: CLC
#_01D17E: ADC.w #$0008
#_01D181: TAY

#_01D182: INX
#_01D183: INX

#_01D184: DEC.b $0E
#_01D186: BNE .next

#_01D188: BRA .run_dma_and_sfx

;---------------------------------------------------------------------------------------------------
; Check if vine door
.not_vines
#_01D18A: LDA.l $7F2000,X
#_01D18E: AND.w #$000F
#_01D191: ASL A
#_01D192: TAY

#_01D193: STX.w $068E

#_01D196: LDA.w $1980,Y
#_01D199: AND.w #$00FE
#_01D19C: CMP.w #$0032
#_01D19F: BNE .run_dma_and_sfx

#_01D1A1: SEP #$20

#_01D1A3: LDA.b #!SFX3_1B
#_01D1A5: STA.w $012F

#_01D1A8: REP #$20

#_01D1AA: LDA.w $19A0,Y
#_01D1AD: STA.b $08

#_01D1AF: TYX

#_01D1B0: LDA.w $068C
#_01D1B3: ORA.w DungeonMask,X
#_01D1B6: STA.w $068C

#_01D1B9: LDA.w $0400
#_01D1BC: ORA.w DungeonMask,X
#_01D1BF: STA.w $0400

#_01D1C2: STZ.w $0692

#_01D1C5: JSR IndexAndClearCurtainDoor

#_01D1C8: LDY.w $0460
#_01D1CB: JSR Underworld_LoadSingleDoorTileAttribute_from_parameter

;---------------------------------------------------------------------------------------------------

.run_dma_and_sfx
#_01D1CE: JSR Underworld_PrepNextTileMapUpdateDMA

#_01D1D1: SEP #$30

#_01D1D3: LDA.b $08
#_01D1D5: AND.b #$7F
#_01D1D7: ASL A
#_01D1D8: JSL CalculateSFXPan_Arbitrary

#_01D1DC: ORA.b #!SFX2_1E
#_01D1DE: STA.w $012E

#_01D1E1: REP #$30

;===================================================================================================

RoomDraw_CloseStripes:
#_01D1E3: LDY.b $0C

#_01D1E5: LDA.w #$FFFF
#_01D1E8: STA.w $1100,Y

#_01D1EB: SEP #$30

#_01D1ED: LDA.b #$01
#_01D1EF: STA.b $18

#_01D1F1: RTL

;===================================================================================================

Bomb_CheckForDestructibles:
#_01D1F2: LDA.b $10
#_01D1F4: CMP.b #$07
#_01D1F6: BEQ Bomb_CheckForUWDestructibles

#_01D1F8: JML Overworld_BombTiles32x32

;---------------------------------------------------------------------------------------------------

Bomb_CheckForUWDestructibles:
#_01D1FC: STZ.b $0F

#_01D1FE: REP #$30

#_01D200: LDA.b $00
#_01D202: AND.w #$01F8
#_01D205: ASL A
#_01D206: ASL A
#_01D207: ASL A
#_01D208: STA.b $04

#_01D20A: LDA.b $02
#_01D20C: AND.w #$01F8
#_01D20F: LSR A
#_01D210: LSR A
#_01D211: LSR A
#_01D212: ORA.b $04
#_01D214: SEC
#_01D215: SBC.w #$0082
#_01D218: TAX

#_01D219: LDY.w #$0002

;---------------------------------------------------------------------------------------------------

.next_check
#_01D21C: LDA.l $7F2000,X
#_01D220: AND.w #$00FF
#_01D223: CMP.w #$0062
#_01D226: BEQ .bombable_floor

#_01D228: AND.w #$00F0
#_01D22B: CMP.w #$00F0
#_01D22E: BEQ .is_door

#_01D230: INX
#_01D231: INX

#_01D232: LDA.l $7F2000,X
#_01D236: AND.w #$00FF
#_01D239: CMP.w #$0062
#_01D23C: BEQ .bombable_floor

#_01D23E: AND.w #$00F0
#_01D241: CMP.w #$00F0
#_01D244: BEQ .is_door

#_01D246: INX
#_01D247: INX

#_01D248: LDA.l $7F2000,X
#_01D24C: AND.w #$00FF
#_01D24F: CMP.w #$0062
#_01D252: BEQ .bombable_floor

#_01D254: AND.w #$00F0
#_01D257: CMP.w #$00F0
#_01D25A: BEQ .is_door

#_01D25C: TXA
#_01D25D: CLC
#_01D25E: ADC.w #$007C
#_01D261: TAX

#_01D262: DEY
#_01D263: BPL .next_check

#_01D265: BMI .exit

.bombable_floor
#_01D267: JMP.w BlowOpenBombableFloor

;---------------------------------------------------------------------------------------------------

.is_door
#_01D26A: LDA.l $7F2000,X
#_01D26E: AND.w #$000F
#_01D271: ASL A
#_01D272: TAY

#_01D273: LDA.w $1980,Y
#_01D276: AND.w #$00FE
#_01D279: CMP.w #$0028
#_01D27C: BEQ .bombable_door

#_01D27E: CMP.w #$002A
#_01D281: BEQ .bombable_door

#_01D283: CMP.w #$002E
#_01D286: BNE .exit

;---------------------------------------------------------------------------------------------------

.bombable_door
#_01D288: STX.w $068E

#_01D28B: LDA.b $0E
#_01D28D: ASL A
#_01D28E: TAX

#_01D28F: LDA.w $19A0,Y
#_01D292: AND.w #$007E
#_01D295: ASL A
#_01D296: ASL A
#_01D297: CLC
#_01D298: ADC.w $062C
#_01D29B: STA.w $03B6,X

#_01D29E: LDA.w $19A0,Y
#_01D2A1: AND.w #$1F80
#_01D2A4: LSR A
#_01D2A5: LSR A
#_01D2A6: LSR A
#_01D2A7: LSR A
#_01D2A8: CLC
#_01D2A9: ADC.w $062E
#_01D2AC: STA.w $03BA,X

#_01D2AF: SEP #$20

#_01D2B1: LDX.b $0E

#_01D2B3: LDA.w $19C0,Y
#_01D2B6: AND.b #$03
#_01D2B8: STA.w $03BE,X

#_01D2BB: LDA.b #!SFX3_1B
#_01D2BD: STA.w $012F

#_01D2C0: LDA.b #$09
#_01D2C2: STA.b $11

.exit
#_01D2C4: SEP #$30

#_01D2C6: RTL

;===================================================================================================

BlowOpenBombableFloor:
#_01D2C7: LDA.b $A0
#_01D2C9: CMP.w #$0065
#_01D2CC: BNE .not_tt_attic

#_01D2CE: LDA.w $0402
#_01D2D1: ORA.w #$1000
#_01D2D4: STA.w $0402

.not_tt_attic
#_01D2D7: LDA.w #$0000
#_01D2DA: JSL ThievesAttic_DrawLightenedHole

#_01D2DE: SEP #$30

#_01D2E0: LDA.b #!SFX3_1B
#_01D2E2: STA.w $012F

#_01D2E5: RTL

;===================================================================================================

DrawDoorOpening_Step1:
#_01D2E6: LDX.w $19A0,Y
#_01D2E9: STX.b $08

#_01D2EB: STY.w $0460
#_01D2EE: STY.w $0694

#_01D2F1: LDA.w $19C0,Y
#_01D2F4: AND.w #$0003
#_01D2F7: BNE .not_north_door

#_01D2F9: JMP.w DoorDoorStep1_North

.not_north_door
#_01D2FC: CMP.w #$0001
#_01D2FF: BNE .not_south_door

#_01D301: JMP.w DoorDoorStep1_South

.not_south_door
#_01D304: CMP.w #$0002
#_01D307: BNE .not_west_door

#_01D309: JMP.w DoorDoorStep1_West

.not_west_door
#_01D30C: JMP.w DoorDoorStep1_East

;===================================================================================================
; TODO possibly rename routines
DrawShutterDoorSteps:
#_01D30F: LDX.w $19A0,Y
#_01D312: STX.b $08

#_01D314: STY.w $0460
#_01D317: STY.w $0694

#_01D31A: LDA.w $19C0,Y
#_01D31D: AND.w #$0003
#_01D320: BNE .not_north_door

#_01D322: JMP.w GetDoorDrawDataIndex_North_clean_door_index

.not_north_door
#_01D325: CMP.w #$0001
#_01D328: BNE .not_south_door

#_01D32A: JMP.w GetDoorDrawDataIndex_South_clean_door_index

.not_south_door
#_01D32D: CMP.w #$0002
#_01D330: BNE .not_west_door

#_01D332: JMP.w GetDoorDrawDataIndex_West_clean_door_index

.not_west_door
#_01D335: JMP.w GetDoorDrawDataIndex_East_clean_door_index

;===================================================================================================

DrawEyeWatchDoor:
#_01D338: LDX.w $19A0,Y
#_01D33B: STX.b $08

#_01D33D: STY.w $0460
#_01D340: STY.b $04
#_01D342: STY.w $0694

#_01D345: LDA.w $19C0,Y
#_01D348: AND.w #$0003
#_01D34B: BNE .not_north_door

#_01D34D: JMP.w DrawDoorToTileMap_North

.not_north_door
#_01D350: CMP.w #$0001
#_01D353: BNE .not_south_door

#_01D355: JMP.w DrawDoorToTileMap_South

.not_south_door
#_01D358: CMP.w #$0002
#_01D35B: BNE .not_west_door

#_01D35D: JMP.w DrawDoorToTileMap_West

.not_west_door
#_01D360: JMP.w DrawDoorToTileMap_East

;===================================================================================================

IndexAndClearCurtainDoor:
#_01D363: LDX.w $19A0,Y
#_01D366: STX.b $08

#_01D368: STY.w $0460
#_01D36B: STY.w $0694

#_01D36E: JMP.w ClearDoorCurtainsFromTileMap

;===================================================================================================

IndexAndClearExplodingWall:
#_01D371: STZ.w $045E
#_01D374: STZ.b $0C
#_01D376: STZ.w $0690

#_01D379: LDY.w $0456
#_01D37C: STY.w $0460

#_01D37F: LDX.w $19A0,Y
#_01D382: DEX
#_01D383: DEX
#_01D384: STX.b $08

#_01D386: TXA
#_01D387: STA.w $19A0,Y

#_01D38A: JMP.w ClearExplodingWallFromTileMap

;===================================================================================================

OperateShutterDoors:
#_01D38D: REP #$30

#_01D38F: STZ.b $0C

#_01D391: INC.w $0690

#_01D394: LDA.w $0690

#_01D397: LDY.w $0468
#_01D39A: BNE .shutters_down

#_01D39C: INY
#_01D39D: INY

#_01D39E: CMP.w #$0004
#_01D3A1: BEQ .advance_animation

#_01D3A3: INY
#_01D3A4: INY

#_01D3A5: CMP.w #$0008
#_01D3A8: BEQ .advance_animation

.dont_advance_animation
#_01D3AA: JMP.w .finalize_timer

.shutters_down
#_01D3AD: LDY.w #$0002

#_01D3B0: CMP.w #$0004
#_01D3B3: BEQ .advance_animation

#_01D3B5: DEY
#_01D3B6: DEY

#_01D3B7: CMP.w #$0008
#_01D3BA: BNE .dont_advance_animation

.advance_animation
#_01D3BC: STY.w $0692

#_01D3BF: LDY.w #$0000

;---------------------------------------------------------------------------------------------------

.next_door
#_01D3C2: STY.w $068E

#_01D3C5: LDA.w $1980,Y
#_01D3C8: AND.w #$00FE
#_01D3CB: CMP.w #$0044
#_01D3CE: BEQ .is_shutter

#_01D3D0: CMP.w #$0018
#_01D3D3: BNE .skip_this_door

.is_shutter
#_01D3D5: LDA.w $0468
#_01D3D8: BNE .closing

#_01D3DA: LDA.w $068C
#_01D3DD: AND.w DungeonMask,Y
#_01D3E0: BNE .skip_this_door

#_01D3E2: LDA.w $0690
#_01D3E5: CMP.w #$0008
#_01D3E8: BNE .skip_sfx

#_01D3EA: PHY

#_01D3EB: SEP #$30

#_01D3ED: LDA.b #!SFX3_15
#_01D3EF: STA.w $012F

#_01D3F2: REP #$30

#_01D3F4: PLY

#_01D3F5: LDA.w $068C
#_01D3F8: ORA.w DungeonMask,Y
#_01D3FB: BRA .flag_door

;---------------------------------------------------------------------------------------------------

.closing
#_01D3FD: LDA.w $068C
#_01D400: AND.w DungeonMask,Y
#_01D403: BEQ .skip_this_door

#_01D405: LDA.w $0690
#_01D408: CMP.w #$0008
#_01D40B: BNE .skip_sfx

#_01D40D: PHY

#_01D40E: SEP #$30

#_01D410: LDA.b #!SFX3_16
#_01D412: STA.w $012F

#_01D415: REP #$30

#_01D417: PLY

#_01D418: LDA.w $068C
#_01D41B: AND.w DungeonMaskInverted,Y

;---------------------------------------------------------------------------------------------------

.flag_door
#_01D41E: STA.w $068C

.skip_sfx
#_01D421: JSR DrawShutterDoorSteps
#_01D424: JSR Underworld_PrepNextTileMapUpdateDMA

#_01D427: LDA.w $0690
#_01D42A: CMP.w #$0008
#_01D42D: BNE .skip_this_door

#_01D42F: LDY.w $068E
#_01D432: JSR Underworld_LoadSingleDoorTileAttribute_from_parameter

.skip_this_door
#_01D435: LDY.w $068E
#_01D438: INY
#_01D439: INY
#_01D43A: CPY.w #$0018
#_01D43D: BEQ .done

#_01D43F: JMP.w .next_door

;---------------------------------------------------------------------------------------------------

.done
#_01D442: LDY.b $0C
#_01D444: BEQ .no_stripes

#_01D446: LDA.w #$FFFF
#_01D449: STA.w $1100,Y

#_01D44C: SEP #$30

#_01D44E: LDA.b #$01
#_01D450: STA.b $18
#_01D452: STA.w $0710

.finalize_timer
#_01D455: SEP #$20

#_01D457: LDA.w $0690
#_01D45A: CMP.b #$10
#_01D45C: BNE .exit

.no_stripes
#_01D45E: SEP #$20

#_01D460: STZ.b $11
#_01D462: STZ.b $18

.exit
#_01D464: SEP #$30

#_01D466: RTL

;===================================================================================================

OpenCrackedDoor:
#_01D467: REP #$30

#_01D469: LDA.w #$0010
#_01D46C: STA.w $0690

#_01D46F: LDY.w #$0004
#_01D472: BRA .continue

;===================================================================================================

#UnlockKeyDoor_Main:
#_01D474: REP #$30

#_01D476: LDY.w #$0002

#_01D479: INC.w $0690

#_01D47C: LDA.w $0690
#_01D47F: CMP.w #$0004
#_01D482: BEQ .draw_part_1

#_01D484: INY
#_01D485: INY

#_01D486: CMP.w #$000C
#_01D489: BNE .no_drawing

;---------------------------------------------------------------------------------------------------

.continue
#_01D48B: LDX.w $068E

#_01D48E: LDA.l $7F2000,X
#_01D492: AND.w #$0007
#_01D495: ASL A
#_01D496: TAX

#_01D497: LDA.w $068C
#_01D49A: ORA.w DungeonMask,X
#_01D49D: STA.w $068C

#_01D4A0: LDA.w $0400
#_01D4A3: ORA.w DungeonMask,X
#_01D4A6: STA.w $0400

;---------------------------------------------------------------------------------------------------

.draw_part_1
#_01D4A9: STY.w $0692

#_01D4AC: STZ.b $0C

#_01D4AE: LDX.w $068E

#_01D4B1: LDA.l $7F2000,X
#_01D4B5: AND.w #$000F
#_01D4B8: ASL A
#_01D4B9: TAY

#_01D4BA: JSR DrawDoorOpening_Step1
#_01D4BD: JSR Underworld_PrepNextTileMapUpdateDMA

#_01D4C0: LDY.b $0C

#_01D4C2: LDA.w #$FFFF
#_01D4C5: STA.w $1100,Y

#_01D4C8: SEP #$30

#_01D4CA: LDA.b #!SFX3_15
#_01D4CC: STA.w $012F

#_01D4CF: LDA.b #$01
#_01D4D1: STA.b $18

#_01D4D3: REP #$30

;---------------------------------------------------------------------------------------------------

.no_drawing
#_01D4D5: LDA.w $0690
#_01D4D8: CMP.w #$0010
#_01D4DB: BNE .exit

#_01D4DD: JSR Underworld_LoadSingleDoorTileAttribute_from_wram_index

#_01D4E0: LDX.w $068E

#_01D4E3: LDA.l $7F2000,X
#_01D4E7: AND.w #$00FF
#_01D4EA: CMP.w #$00F0
#_01D4ED: BCC .reset_submodule

#_01D4EF: AND.w #$000F
#_01D4F2: ASL A
#_01D4F3: TAY

#_01D4F4: LDA.w $1980,Y
#_01D4F7: AND.w #$00FF
#_01D4FA: CMP.w #$0020
#_01D4FD: BCC .reset_submodule

#_01D4FF: CMP.w #$0028
#_01D502: BCS .reset_submodule

#_01D504: JSR DrawCompletelyOpenDoor

.reset_submodule
#_01D507: SEP #$20

#_01D509: STZ.b $11

.exit
#_01D50B: SEP #$30

#_01D50D: RTL

;===================================================================================================

Underworld_LoadSingleDoorTileAttribute_from_wram_index:
#_01D50E: LDX.w $068E

#_01D511: LDA.l $7F2000,X
#_01D515: AND.w #$000F
#_01D518: ASL A
#_01D519: TAY

;===================================================================================================

Underworld_LoadSingleDoorTileAttribute_from_parameter:
#_01D51A: JSR Underworld_LoadSingleDoorAttribute

;===================================================================================================

Underworld_LoadSingleDoorTileAttribute:
#_01D51D: LDX.w $044E
#_01D520: BEQ .next_loop

;---------------------------------------------------------------------------------------------------

#_01D522: LDY.w #$0000

.next_a
#_01D525: LDX.w $06C0,Y

#_01D528: LDA.l $7F2000,X
#_01D52C: AND.w #$00F0
#_01D52F: CMP.w #$0080
#_01D532: BNE .skip_a

#_01D534: LDA.l $7F2000,X
#_01D538: ORA.w #$1010
#_01D53B: STA.l $7F2000,X
#_01D53F: STA.l $7F2040,X

#_01D543: INY
#_01D544: INY
#_01D545: CPY.w $044E
#_01D548: BNE .next_a

#_01D54A: BRA .next_loop

.skip_a
#_01D54C: LDA.l $7F3000,X
#_01D550: ORA.w #$1010
#_01D553: STA.l $7F3000,X
#_01D557: STA.l $7F3040,X

#_01D55B: INY
#_01D55C: INY
#_01D55D: CPY.w $044E
#_01D560: BNE .next_a

;---------------------------------------------------------------------------------------------------

.next_loop
#_01D562: LDX.w $0450
#_01D565: BEQ .exit

#_01D567: LDY.w #$0000

.next_b
#_01D56A: LDX.w $06D0,Y

#_01D56D: LDA.l $7F2000,X
#_01D571: AND.w #$00F0
#_01D574: CMP.w #$0080
#_01D577: BNE .skip_b

#_01D579: LDA.l $7F2000,X
#_01D57D: ORA.w #$2020
#_01D580: STA.l $7F2000,X
#_01D584: STA.l $7F2040,X

#_01D588: INY
#_01D589: INY
#_01D58A: CPY.w $0450
#_01D58D: BNE .next_b

#_01D58F: BRA .exit

.skip_b
#_01D591: LDA.l $7F3000,X
#_01D595: ORA.w #$2020
#_01D598: STA.l $7F3000,X
#_01D59C: STA.l $7F3040,X

#_01D5A0: INY
#_01D5A1: INY
#_01D5A2: CPY.w $0450
#_01D5A5: BNE .next_b

.exit
#_01D5A7: RTS

;===================================================================================================

DrawCompletelyOpenDoor:
#_01D5A8: LDA.w #$3030
#_01D5AB: STA.b $00

#_01D5AD: LDY.w #$0000

#_01D5B0: LDX.w $0438
#_01D5B3: BEQ .skip_a

.next_a
#_01D5B5: LDA.b $00
#_01D5B7: CLC
#_01D5B8: ADC.w #$0101
#_01D5BB: STA.b $00

#_01D5BD: INY
#_01D5BE: INY
#_01D5BF: CPY.w $0438
#_01D5C2: BNE .next_a

;---------------------------------------------------------------------------------------------------

.skip_a
#_01D5C4: CPY.w $047E
#_01D5C7: BEQ .skip_b

.next_b
#_01D5C9: LDX.w $06B0,Y

#_01D5CC: LDA.w #$5E5E
#_01D5CF: STA.l $7F2001,X

#_01D5D3: LDA.b $00
#_01D5D5: STA.l $7F2041,X

#_01D5D9: CLC
#_01D5DA: ADC.w #$0101
#_01D5DD: STA.b $00

#_01D5DF: LDA.w #$0000
#_01D5E2: STA.l $7F2081,X
#_01D5E6: STA.l $7F20C1,X

#_01D5EA: INY
#_01D5EB: INY
#_01D5EC: CPY.w $047E
#_01D5EF: BNE .next_b

;---------------------------------------------------------------------------------------------------

.skip_b
#_01D5F1: CPY.w $0482
#_01D5F4: BEQ .skip_c

.next_c
#_01D5F6: LDX.w $06B0,Y

#_01D5F9: LDA.w #$5F5F
#_01D5FC: STA.l $7F2001,X

#_01D600: LDA.b $00
#_01D602: STA.l $7F2041,X

#_01D606: CLC
#_01D607: ADC.w #$0101
#_01D60A: STA.b $00

#_01D60C: LDA.w #$0000
#_01D60F: STA.l $7F2081,X
#_01D613: STA.l $7F20C1,X

#_01D617: INY
#_01D618: INY
#_01D619: CPY.w $0482
#_01D61C: BNE .next_c

;---------------------------------------------------------------------------------------------------

.skip_c
#_01D61E: CPY.w $04A2
#_01D621: BEQ .skip_d

.next_d
#_01D623: LDA.b $00
#_01D625: CLC
#_01D626: ADC.w #$0101
#_01D629: STA.b $00

#_01D62B: INY
#_01D62C: INY
#_01D62D: CPY.w $04A2
#_01D630: BNE .next_d

;---------------------------------------------------------------------------------------------------

.skip_d
#_01D632: CPY.w $04A4
#_01D635: BEQ .skip_e

.next_e
#_01D637: LDA.b $00
#_01D639: CLC
#_01D63A: ADC.w #$0101
#_01D63D: STA.b $00

#_01D63F: INY
#_01D640: INY
#_01D641: CPY.w $04A4
#_01D644: BNE .next_e

;---------------------------------------------------------------------------------------------------

.skip_e
#_01D646: LDA.b $00
#_01D648: AND.w #$0707
#_01D64B: ORA.w #$3434
#_01D64E: STA.b $00

#_01D650: CPY.w $043A
#_01D653: BEQ .skip_f

.next_f
#_01D655: LDA.b $00
#_01D657: CLC
#_01D658: ADC.w #$0101
#_01D65B: STA.b $00

#_01D65D: INY
#_01D65E: INY
#_01D65F: CPY.w $043A
#_01D662: BNE .next_f

;---------------------------------------------------------------------------------------------------

.skip_f
#_01D664: CPY.w $0480
#_01D667: BEQ .skip_g

.next_g
#_01D669: LDX.w $06B0,Y

#_01D66C: LDA.w #$5E5E
#_01D66F: STA.l $7F2001,X

#_01D673: LDA.b $00
#_01D675: STA.l $7F2041,X

#_01D679: CLC
#_01D67A: ADC.w #$0101
#_01D67D: STA.b $00

#_01D67F: LDA.w #$0000
#_01D682: STA.l $7F2081,X
#_01D686: STA.l $7F20C1,X

#_01D68A: INY
#_01D68B: INY
#_01D68C: CPY.w $0480
#_01D68F: BNE .next_g

;---------------------------------------------------------------------------------------------------

.skip_g
#_01D691: CPY.w $0484
#_01D694: BEQ .exit

.next_h
#_01D696: LDX.w $06B0,Y

#_01D699: LDA.w #$5F5F
#_01D69C: STA.l $7F2001,X

#_01D6A0: LDA.b $00
#_01D6A2: STA.l $7F2041,X

#_01D6A6: CLC
#_01D6A7: ADC.w #$0101
#_01D6AA: STA.b $00

#_01D6AC: LDA.w #$0000
#_01D6AF: STA.l $7F2081,X
#_01D6B3: STA.l $7F20C1,X

#_01D6B7: INY
#_01D6B8: INY
#_01D6B9: CPY.w $0484
#_01D6BC: BNE .next_h

.exit
#_01D6BE: RTS

;===================================================================================================

Underworld_ClearAwayExplodingWall:
#_01D6BF: LDA.b #$06
#_01D6C1: STA.w $02E4
#_01D6C4: STA.w $0FC1

#_01D6C7: CMP.l $7F0000
#_01D6CB: BNE .exit

#_01D6CD: REP #$30

#_01D6CF: JSR IndexAndClearExplodingWall
#_01D6D2: JSR ClearAndStripeExplodingWall

#_01D6D5: LDA.w #$FFFF
#_01D6D8: STA.w $1100,Y
#_01D6DB: STA.w $0710

#_01D6DE: INC.w $0454
#_01D6E1: INC.w $0454

#_01D6E4: LDA.w $0454
#_01D6E7: CMP.w #$0015
#_01D6EA: BNE .trigger_transfer

#_01D6EC: LDY.w $0456

#_01D6EF: LDA.w $068C
#_01D6F2: ORA.w DungeonMask,Y
#_01D6F5: STA.w $068C

#_01D6F8: LDA.w $0400
#_01D6FB: ORA.w DungeonMask,Y
#_01D6FE: STA.w $0400

;---------------------------------------------------------------------------------------------------

#_01D701: LDX.w #$0001

#_01D704: LDA.w $19C0,Y

#_01D707: LDY.w #$0100
#_01D70A: AND.w #$0002
#_01D70D: BEQ .not_horizontal_door

#_01D70F: LDY.w #$0001
#_01D712: DEX

.not_horizontal_door
#_01D713: TYA
#_01D714: ORA.w $0452
#_01D717: STA.w $0452

#_01D71A: LDA.b $A6,X
#_01D71C: ORA.w #$0002
#_01D71F: STA.b $A6,X

#_01D721: LDA.b $A6
#_01D723: STA.l $7EC19C

#_01D727: LDY.w $0456
#_01D72A: JSR Underworld_DoorLoadBlastWallAttribute

#_01D72D: STZ.w $0454
#_01D730: STZ.w $0456

#_01D733: SEP #$30

#_01D735: JSL Underworld_FlagRoomData_Quadrants

#_01D739: STZ.w $02E4
#_01D73C: STZ.w $0FC1

;---------------------------------------------------------------------------------------------------

.trigger_transfer
#_01D73F: SEP #$30

#_01D741: LDA.b #$03
#_01D743: STA.b $18

.exit
#_01D745: RTL

;===================================================================================================

Underworld_CheckForAndIDLiftableTile:
#_01D746: REP #$30

#_01D748: LDA.b $2F
#_01D74A: AND.w #$00FF
#_01D74D: TAX

#_01D74E: LDA.b $20
#_01D750: CLC
#_01D751: ADC.l .offset_y,X
#_01D755: AND.w #$01F8
#_01D758: ASL A
#_01D759: ASL A
#_01D75A: ASL A
#_01D75B: STA.b $06

#_01D75D: LDA.b $22
#_01D75F: CLC
#_01D760: ADC.l .offset_x,X
#_01D764: AND.w #$01F8
#_01D767: LSR A
#_01D768: LSR A
#_01D769: LSR A
#_01D76A: ORA.b $06
#_01D76C: STA.b $06

;---------------------------------------------------------------------------------------------------

#_01D76E: LDA.b $EE
#_01D770: AND.w #$00FF
#_01D773: BEQ .upper_layer

#_01D775: LDA.b $06
#_01D777: ORA.w #$1000
#_01D77A: STA.b $06

.upper_layer
#_01D77C: LDX.b $06

#_01D77E: LDA.l $7F2000,X
#_01D782: AND.w #$00F0
#_01D785: CMP.w #$0070
#_01D788: BNE .use_tile_here

#_01D78A: LDA.l $7F2000,X
#_01D78E: AND.w #$000F
#_01D791: ASL A
#_01D792: TAX

#_01D793: LDA.w $0500,X
#_01D796: BEQ .use_tile_here

#_01D798: LDY.w #$0055

#_01D79B: AND.w #$F0F0
#_01D79E: CMP.w #$2020
#_01D7A1: BEQ .is_pot

#_01D7A3: LDA.w $0500,X
#_01D7A6: AND.w #$000F
#_01D7A9: ASL A
#_01D7AA: TAX

#_01D7AB: LDA.l .tile_01d9e0,X
#_01D7AF: TAY

.is_pot
#_01D7B0: TYA

#_01D7B1: SEP #$31

#_01D7B3: RTL

;---------------------------------------------------------------------------------------------------

.use_tile_here
#_01D7B4: LDX.b $06

#_01D7B6: LDA.l $7F2000,X

#_01D7BA: SEP #$30
#_01D7BC: CLC

#_01D7BD: RTL

;===================================================================================================

pool PushBlock_Main

.offset
#_01D7BE: dw $FF00
#_01D7C0: dw $0100
#_01D7C2: dw $FFFC
#_01D7C4: dw $0004

pool off

;---------------------------------------------------------------------------------------------------

PushBlock_Main:
#_01D7C6: LDA.w $0500,Y
#_01D7C9: BEQ .to_next

#_01D7CB: CMP.w #$0001
#_01D7CE: BNE .no_hole

#_01D7D0: JSR RoomDraw_16x16Single

#_01D7D3: LDX.w $0474

#_01D7D6: LDA.w $0540,Y
#_01D7D9: CLC
#_01D7DA: ADC.l .offset,X
#_01D7DE: STA.w $0540,Y

#_01D7E1: BRA .advance_block_ai

;---------------------------------------------------------------------------------------------------

.no_hole
#_01D7E3: CMP.w #$0002
#_01D7E6: BNE .skip_interaction

#_01D7E8: SEP #$30

#_01D7EA: JSL PushBlock_Slide

#_01D7EE: REP #$30

#_01D7F0: LDY.w $042C

#_01D7F3: LDA.w $0500,Y
#_01D7F6: CMP.w #$0003
#_01D7F9: BNE .to_next

#_01D7FB: JSR PushBlock_CheckForPit

#_01D7FE: BRA .advance_block_ai

;---------------------------------------------------------------------------------------------------

.skip_interaction
#_01D800: CMP.w #$0004
#_01D803: BNE .to_next

#_01D805: SEP #$30

#_01D807: JSL PushBlock_HandleFalling

#_01D80B: BRA .to_next

;---------------------------------------------------------------------------------------------------

.advance_block_ai
#_01D80D: LDX.w $042C

#_01D810: INC.w $0500,X

.to_next
#_01D813: INC.w $042C
#_01D816: INC.w $042C

;===================================================================================================

PushBlock_Handler:
#_01D819: REP #$30

#_01D81B: LDY.w $042C
#_01D81E: CPY.w $0478
#_01D821: BNE PushBlock_Main

#_01D823: SEP #$30

#_01D825: RTL

;===================================================================================================

RoomDraw_16x16Single:
#_01D826: LDX.w $1000

#_01D829: LDA.w $0560,Y
#_01D82C: STA.w $1006,X

#_01D82F: LDA.w $0580,Y
#_01D832: STA.w $100C,X

#_01D835: LDA.w $05A0,Y
#_01D838: STA.w $1012,X

#_01D83B: LDA.w $05C0,Y
#_01D83E: STA.w $1018,X

#_01D841: LDA.w $0540,Y
#_01D844: AND.w #$3FFF
#_01D847: TAX

#_01D848: LDA.w $0560,Y
#_01D84B: STA.l $7E2000,X

#_01D84F: LDA.w $0580,Y
#_01D852: STA.l $7E2080,X

#_01D856: LDA.w $05A0,Y
#_01D859: STA.l $7E2002,X

#_01D85D: LDA.w $05C0,Y
#_01D860: STA.l $7E2082,X

#_01D864: AND.w #$03FF
#_01D867: TAX

#_01D868: LDA.l $7EFE00,X
#_01D86C: AND.w #$00FF
#_01D86F: STA.b $00
#_01D871: STA.b $01

#_01D873: LDA.w $0540,Y
#_01D876: AND.w #$3FFF
#_01D879: LSR A
#_01D87A: TAX

#_01D87B: LDA.b $00

;===================================================================================================

RoomDraw_16x16Single_stripe_inited:
#_01D87D: STA.l $7F2000,X
#_01D881: STA.l $7F2040,X

;---------------------------------------------------------------------------------------------------

#_01D885: LDX.w $1000

#_01D888: LDA.w #$0000
#_01D88B: JSR RoomDraw_16x16SingleSingleTileStripe
#_01D88E: STA.w $1002,X

#_01D891: LDA.w #$0080
#_01D894: JSR RoomDraw_16x16SingleSingleTileStripe
#_01D897: STA.w $1008,X

#_01D89A: LDA.w #$0002
#_01D89D: JSR RoomDraw_16x16SingleSingleTileStripe
#_01D8A0: STA.w $100E,X

#_01D8A3: LDA.w #$0082
#_01D8A6: JSR RoomDraw_16x16SingleSingleTileStripe
#_01D8A9: STA.w $1014,X

;---------------------------------------------------------------------------------------------------

#_01D8AC: LDA.w #$0100
#_01D8AF: STA.w $1004,X
#_01D8B2: STA.w $100A,X
#_01D8B5: STA.w $1010,X
#_01D8B8: STA.w $1016,X

#_01D8BB: LDA.w #$FFFF
#_01D8BE: STA.w $101A,X

#_01D8C1: TXA
#_01D8C2: CLC
#_01D8C3: ADC.w #$0018
#_01D8C6: STA.w $1000

#_01D8C9: SEP #$20

#_01D8CB: LDA.b #$01
#_01D8CD: STA.b $14

#_01D8CF: REP #$30

#_01D8D1: RTS

;===================================================================================================

PushBlock_CheckForPit:
#_01D8D2: LDA.w $0540,Y
#_01D8D5: AND.w #$4000
#_01D8D8: BNE .lower_layer

#_01D8DA: LDA.w $0641
#_01D8DD: EOR.w #$0001
#_01D8E0: STA.w $0641

.lower_layer
#_01D8E3: LDA.w $0540,Y
#_01D8E6: AND.w #$3FFF
#_01D8E9: LSR A
#_01D8EA: TAX

#_01D8EB: LDA.l $7F2000,X
#_01D8EF: AND.w #$00FF
#_01D8F2: CMP.w #$0020
#_01D8F5: BEQ .play_sfx_and_done

;---------------------------------------------------------------------------------------------------

#_01D8F7: PHA
#_01D8F8: PHY
#_01D8F9: PHX

#_01D8FA: LDX.w $1000

#_01D8FD: LDA.w #$0922
#_01D900: STA.w $1006,X

#_01D903: INC A
#_01D904: STA.w $1012,X

#_01D907: LDA.w #$0932
#_01D90A: STA.w $100C,X

#_01D90D: INC A
#_01D90E: STA.w $1018,X

#_01D911: LDA.w $0540,Y
#_01D914: AND.w #$3FFF
#_01D917: TAX

#_01D918: LDA.w #$0922
#_01D91B: STA.l $7E2000,X

#_01D91F: INC A
#_01D920: STA.l $7E2002,X

#_01D924: LDA.w #$0932
#_01D927: STA.l $7E2080,X

#_01D92B: INC A
#_01D92C: STA.l $7E2082,X

;---------------------------------------------------------------------------------------------------

#_01D930: SEP #$20

#_01D932: STY.b $72

; !DUMB CODE
#_01D934: LDX.w #$0001

#_01D937: LDA.w $05FC,X
#_01D93A: DEC A
#_01D93B: ASL A
#_01D93C: CMP.b $72
#_01D93E: BEQ .this_block

#_01D940: LDX.w #$0000

.this_block
#_01D943: STZ.w $05FC,X

;---------------------------------------------------------------------------------------------------

#_01D946: REP #$20

#_01D948: PLX
#_01D949: PLY
#_01D94A: PLA

#_01D94B: CMP.w #$0023
#_01D94E: BNE .go_negative

#_01D950: LDA.w $0468
#_01D953: EOR.w #$0001
#_01D956: STA.w $0466

#_01D959: LDA.w #$0004
#_01D95C: BRA .proceed

;---------------------------------------------------------------------------------------------------

.go_negative
#_01D95E: LDA.w #$FFFF

.proceed
#_01D961: STA.w $0500,Y

#_01D964: LDA.w #$2727
#_01D967: JMP.w RoomDraw_16x16Single_stripe_inited

;---------------------------------------------------------------------------------------------------

.play_sfx_and_done
#_01D96A: SEP #$20

#_01D96C: LDA.b #!SFX2_20
#_01D96E: STA.w $012E

#_01D971: REP #$20

#_01D973: LDY.w $042C
#_01D976: LDX.w $0520,Y

#_01D979: LDA.l $7EC000
#_01D97D: AND.w #$00FF
#_01D980: STA.l $7EF940,X

#_01D984: LDA.w $0540,Y
#_01D987: STA.l $7EF942,X

#_01D98B: RTS

;===================================================================================================

RoomDraw_16x16SingleSingleTileStripe:
#_01D98C: STA.b $0E

#_01D98E: LDA.w $0540,Y
#_01D991: AND.w #$3FFF
#_01D994: CLC
#_01D995: ADC.b $0E
#_01D997: STA.b $0E

#_01D999: AND.w #$0040
#_01D99C: LSR A ; /16
#_01D99D: LSR A
#_01D99E: LSR A
#_01D99F: LSR A
#_01D9A0: XBA
#_01D9A1: STA.b $00

#_01D9A3: LDA.b $0E
#_01D9A5: AND.w #$303F
#_01D9A8: LSR A
#_01D9A9: ORA.b $00
#_01D9AB: STA.b $00

#_01D9AD: LDA.b $0E
#_01D9AF: AND.w #$0F80
#_01D9B2: LSR A
#_01D9B3: LSR A
#_01D9B4: ORA.b $00
#_01D9B6: XBA

#_01D9B7: RTS

;===================================================================================================
; TODO something pots
;===================================================================================================
pool Underworld_LiftAndReplaceLiftable Underworld_CheckForAndIDLiftableTile

.offset_y
#_01D9B8: dw   3 ; up
#_01D9BA: dw  24 ; down
#_01D9BC: dw  14 ; left
#_01D9BE: dw  14 ; right

.offset_x
#_01D9C0: dw   7 ; up
#_01D9C2: dw   7 ; down
#_01D9C4: dw  -3 ; left
#_01D9C6: dw  16 ; right

;---------------------------------------------------------------------------------------------------

.unused
#_01D9C8: dw $0000, $FFFE, $FF80, $FF7E
#_01D9D0: dw $0000, $0000, $FF80, $FF80
#_01D9D8: dw $0000, $FFFE, $0000, $FFFE

;---------------------------------------------------------------------------------------------------

; TODO VERIFY
.tile_01d9e0
#_01D9E0: dw $5252 ; hammer pegs
#_01D9E2: dw $5050 ; pots
#_01D9E4: dw $5454
#_01D9E6: dw $0000
#_01D9E8: dw $2323

pool off

;---------------------------------------------------------------------------------------------------

Underworld_LiftAndReplaceLiftable:
#_01D9EA: REP #$30

#_01D9EC: LDA.b $2F
#_01D9EE: AND.w #$00FF
#_01D9F1: TAX

#_01D9F2: LDA.b $20
#_01D9F4: CLC
#_01D9F5: ADC.l .offset_y,X
#_01D9F9: STA.b $00
#_01D9FB: STA.b $C8

#_01D9FD: AND.w #$01F8
#_01DA00: ASL A
#_01DA01: ASL A
#_01DA02: ASL A
#_01DA03: STA.b $06

#_01DA05: LDA.b $22
#_01DA07: CLC
#_01DA08: ADC.l .offset_x,X
#_01DA0C: STA.b $02
#_01DA0E: STA.b $CA

#_01DA10: AND.w #$01F8
#_01DA13: LSR A
#_01DA14: LSR A
#_01DA15: LSR A
#_01DA16: TSB.b $06

#_01DA18: LDA.b $EE
#_01DA1A: AND.w #$00FF
#_01DA1D: BEQ .upper_layer

#_01DA1F: LDA.b $06
#_01DA21: ORA.w #$1000
#_01DA24: STA.b $06

;---------------------------------------------------------------------------------------------------

.upper_layer
#_01DA26: LDX.b $06

#_01DA28: LDA.l $7F2000,X
#_01DA2C: AND.w #$000F
#_01DA2F: ASL A
#_01DA30: TAY

#_01DA31: LDA.w $0500,Y
#_01DA34: AND.w #$F0F0
#_01DA37: CMP.w #$1010
#_01DA3A: BNE .check_if_hole

#_01DA3C: LDA.w $0500,Y
#_01DA3F: PHA

#_01DA40: STY.w $042C

#_01DA43: LDA.w $0540,Y
#_01DA46: JSR RevealPotItem

#_01DA49: LDY.w $042C
#_01DA4C: JSR RoomDraw_16x16Single

#_01DA4F: PLA
#_01DA50: AND.w #$000F
#_01DA53: ASL A
#_01DA54: TAX

#_01DA55: LDA.l .tile_01d9e0,X
#_01DA59: STA.b $06

#_01DA5B: BRA .finish_up

;---------------------------------------------------------------------------------------------------

.check_if_hole
#_01DA5D: CMP.w #$2020
#_01DA60: BNE FAIL_01DAB4

#_01DA62: LDA.w $0500,Y
#_01DA65: AND.w #$000F
#_01DA68: ASL A
#_01DA69: STA.b $00

#_01DA6B: TYA
#_01DA6C: SEC
#_01DA6D: SBC.b $00

;===================================================================================================

#ThievesAttic_DrawLightenedHole:
#_01DA6F: STA.w $042C

#_01DA72: PHA

#_01DA73: TAY
#_01DA74: PHY

#_01DA75: LDA.w $0540,Y
#_01DA78: JSR RevealPotItem

#_01DA7B: PLY
#_01DA7C: JSR RoomDraw_16x16Single

#_01DA7F: INC.w $042C
#_01DA82: INC.w $042C

#_01DA85: LDY.w $042C
#_01DA88: JSR RoomDraw_16x16Single

#_01DA8B: INC.w $042C
#_01DA8E: INC.w $042C

#_01DA91: LDY.w $042C
#_01DA94: JSR RoomDraw_16x16Single

#_01DA97: INC.w $042C
#_01DA9A: INC.w $042C

#_01DA9D: LDY.w $042C
#_01DAA0: JSR RoomDraw_16x16Single

#_01DAA3: LDA.w #$5555
#_01DAA6: STA.b $06

#_01DAA8: PLA
#_01DAA9: STA.w $042C

;---------------------------------------------------------------------------------------------------

.finish_up
#_01DAAC: JSR ManipBlock_Something

#_01DAAF: LDA.b $06

#_01DAB1: SEP #$30

#_01DAB3: RTL

;---------------------------------------------------------------------------------------------------

FAIL_01DAB4:
#_01DAB4: SEP #$30

#_01DAB6: LDA.b #$00

#_01DAB8: RTL

;===================================================================================================

HandleItemTileAction_Underworld:
#_01DAB9: REP #$30

#_01DABB: LDA.w $0301
#_01DABE: AND.w #$0002
#_01DAC1: BEQ FAIL_01DAB4

#_01DAC3: LDA.b $00
#_01DAC5: AND.w #$01F8
#_01DAC8: ASL A ; x8
#_01DAC9: ASL A
#_01DACA: ASL A
#_01DACB: ADC.b $02
#_01DACD: STA.b $06

#_01DACF: LDA.b $EE
#_01DAD1: AND.w #$00FF
#_01DAD4: BEQ .upper_layer

#_01DAD6: LDA.b $06
#_01DAD8: ORA.w #$1000
#_01DADB: STA.b $06

.upper_layer
#_01DADD: LDX.b $06

#_01DADF: LDA.l $7F2000,X
#_01DAE3: AND.w #$00F0
#_01DAE6: CMP.w #$0070
#_01DAE9: BNE FAIL_01DAB4

#_01DAEB: LDA.l $7F2000,X
#_01DAEF: AND.w #$000F
#_01DAF2: ASL A
#_01DAF3: TAY

#_01DAF4: LDA.w $0500,Y
#_01DAF7: AND.w #$F0F0
#_01DAFA: CMP.w #$4040
#_01DAFD: BNE .not_hammer_pegs

#_01DAFF: LDA.w $0500,Y
#_01DB02: PHA ; !USELESS

#_01DB03: STY.w $042C

#_01DB06: JSR RoomDraw_16x16Single

#_01DB09: PLA ; What's the point if you just LDA?
#_01DB0A: SEP #$30

#_01DB0C: LDA.b #!SFX2_11
#_01DB0E: STA.w $012E

#_01DB11: LDA.b #$00

#_01DB13: RTL

;===================================================================================================

.not_hammer_pegs
#_01DB14: CMP.w #$1010
#_01DB17: BNE FAIL_01DAB4

#_01DB19: STY.w $042C

#_01DB1C: LDA.w $0540,Y
#_01DB1F: JSR RevealPotItem

#_01DB22: LDY.w $042C

#_01DB25: JSR RoomDraw_16x16Single
#_01DB28: JSR ManipBlock_Something

#_01DB2B: SEP #$30

#_01DB2D: LDA.w $0B9C
#_01DB30: ORA.b #$80
#_01DB32: STA.w $0B9C

#_01DB35: LDA.b #!SPRITE_01
#_01DB37: JSL Sprite_SpawnImmediatelySmashedTerrain

#_01DB3B: JML AncillaAdd_BushPoof

;===================================================================================================
; TODO what
ManipBlock_Something:
#_01DB3F: LDY.w $042C

#_01DB42: LDA.w $0540,Y
#_01DB45: PHA

#_01DB46: AND.w #$007E
#_01DB49: ASL A
#_01DB4A: ASL A
#_01DB4B: STA.b $00

#_01DB4D: LDA.b $22
#_01DB4F: AND.w #$FE00
#_01DB52: TSB.b $00

#_01DB54: PLA
#_01DB55: AND.w #$1F80
#_01DB58: ASL A
#_01DB59: XBA
#_01DB5A: ASL A
#_01DB5B: ASL A
#_01DB5C: ASL A
#_01DB5D: STA.b $02

#_01DB5F: LDA.b $20
#_01DB61: AND.w #$FE00
#_01DB64: TSB.b $02

#_01DB66: RTS

;===================================================================================================

RoomData_PotItems_Pointers:
#_01DB67: dw RoomData_PotItems_Room_0000
#_01DB69: dw RoomData_PotItems_Room_0001
#_01DB6B: dw RoomData_PotItems_Room_0002
#_01DB6D: dw RoomData_PotItems_Room_0003
#_01DB6F: dw RoomData_PotItems_Room_0004
#_01DB71: dw RoomData_PotItems_Room_0005
#_01DB73: dw RoomData_PotItems_Room_0006
#_01DB75: dw RoomData_PotItems_Room_0007
#_01DB77: dw RoomData_PotItems_Room_0008
#_01DB79: dw RoomData_PotItems_Room_0009
#_01DB7B: dw RoomData_PotItems_Room_000A
#_01DB7D: dw RoomData_PotItems_Room_000B
#_01DB7F: dw RoomData_PotItems_Room_000C
#_01DB81: dw RoomData_PotItems_Room_000D
#_01DB83: dw RoomData_PotItems_Room_000E
#_01DB85: dw RoomData_PotItems_Room_000F
#_01DB87: dw RoomData_PotItems_Room_0010
#_01DB89: dw RoomData_PotItems_Room_0011
#_01DB8B: dw RoomData_PotItems_Room_0012
#_01DB8D: dw RoomData_PotItems_Room_0013
#_01DB8F: dw RoomData_PotItems_Room_0014
#_01DB91: dw RoomData_PotItems_Room_0015
#_01DB93: dw RoomData_PotItems_Room_0016
#_01DB95: dw RoomData_PotItems_Room_0017
#_01DB97: dw RoomData_PotItems_Room_0018
#_01DB99: dw RoomData_PotItems_Room_0019
#_01DB9B: dw RoomData_PotItems_Room_001A
#_01DB9D: dw RoomData_PotItems_Room_001B
#_01DB9F: dw RoomData_PotItems_Room_001C
#_01DBA1: dw RoomData_PotItems_Room_001D
#_01DBA3: dw RoomData_PotItems_Room_001E
#_01DBA5: dw RoomData_PotItems_Room_001F
#_01DBA7: dw RoomData_PotItems_Room_0020
#_01DBA9: dw RoomData_PotItems_Room_0021
#_01DBAB: dw RoomData_PotItems_Room_0022
#_01DBAD: dw RoomData_PotItems_Room_0023
#_01DBAF: dw RoomData_PotItems_Room_0024
#_01DBB1: dw RoomData_PotItems_Room_0025
#_01DBB3: dw RoomData_PotItems_Room_0026
#_01DBB5: dw RoomData_PotItems_Room_0027
#_01DBB7: dw RoomData_PotItems_Room_0028
#_01DBB9: dw RoomData_PotItems_Room_0029
#_01DBBB: dw RoomData_PotItems_Room_002A
#_01DBBD: dw RoomData_PotItems_Room_002B
#_01DBBF: dw RoomData_PotItems_Room_002C
#_01DBC1: dw RoomData_PotItems_Room_002D
#_01DBC3: dw RoomData_PotItems_Room_002E
#_01DBC5: dw RoomData_PotItems_Room_002F
#_01DBC7: dw RoomData_PotItems_Room_0030
#_01DBC9: dw RoomData_PotItems_Room_0031
#_01DBCB: dw RoomData_PotItems_Room_0032
#_01DBCD: dw RoomData_PotItems_Room_0033
#_01DBCF: dw RoomData_PotItems_Room_0034
#_01DBD1: dw RoomData_PotItems_Room_0035
#_01DBD3: dw RoomData_PotItems_Room_0036
#_01DBD5: dw RoomData_PotItems_Room_0037
#_01DBD7: dw RoomData_PotItems_Room_0038
#_01DBD9: dw RoomData_PotItems_Room_0039
#_01DBDB: dw RoomData_PotItems_Room_003A
#_01DBDD: dw RoomData_PotItems_Room_003B
#_01DBDF: dw RoomData_PotItems_Room_003C
#_01DBE1: dw RoomData_PotItems_Room_003D
#_01DBE3: dw RoomData_PotItems_Room_003E
#_01DBE5: dw RoomData_PotItems_Room_003F
#_01DBE7: dw RoomData_PotItems_Room_0040
#_01DBE9: dw RoomData_PotItems_Room_0041
#_01DBEB: dw RoomData_PotItems_Room_0042
#_01DBED: dw RoomData_PotItems_Room_0043
#_01DBEF: dw RoomData_PotItems_Room_0044
#_01DBF1: dw RoomData_PotItems_Room_0045
#_01DBF3: dw RoomData_PotItems_Room_0046
#_01DBF5: dw RoomData_PotItems_Room_0047
#_01DBF7: dw RoomData_PotItems_Room_0048
#_01DBF9: dw RoomData_PotItems_Room_0049
#_01DBFB: dw RoomData_PotItems_Room_004A
#_01DBFD: dw RoomData_PotItems_Room_004B
#_01DBFF: dw RoomData_PotItems_Room_004C
#_01DC01: dw RoomData_PotItems_Room_004D
#_01DC03: dw RoomData_PotItems_Room_004E
#_01DC05: dw RoomData_PotItems_Room_004F
#_01DC07: dw RoomData_PotItems_Room_0050
#_01DC09: dw RoomData_PotItems_Room_0051
#_01DC0B: dw RoomData_PotItems_Room_0052
#_01DC0D: dw RoomData_PotItems_Room_0053
#_01DC0F: dw RoomData_PotItems_Room_0054
#_01DC11: dw RoomData_PotItems_Room_0055
#_01DC13: dw RoomData_PotItems_Room_0056
#_01DC15: dw RoomData_PotItems_Room_0057
#_01DC17: dw RoomData_PotItems_Room_0058
#_01DC19: dw RoomData_PotItems_Room_0059
#_01DC1B: dw RoomData_PotItems_Room_005A
#_01DC1D: dw RoomData_PotItems_Room_005B
#_01DC1F: dw RoomData_PotItems_Room_005C
#_01DC21: dw RoomData_PotItems_Room_005D
#_01DC23: dw RoomData_PotItems_Room_005E
#_01DC25: dw RoomData_PotItems_Room_005F
#_01DC27: dw RoomData_PotItems_Room_0060
#_01DC29: dw RoomData_PotItems_Room_0061
#_01DC2B: dw RoomData_PotItems_Room_0062
#_01DC2D: dw RoomData_PotItems_Room_0063
#_01DC2F: dw RoomData_PotItems_Room_0064
#_01DC31: dw RoomData_PotItems_Room_0065
#_01DC33: dw RoomData_PotItems_Room_0066
#_01DC35: dw RoomData_PotItems_Room_0067
#_01DC37: dw RoomData_PotItems_Room_0068
#_01DC39: dw RoomData_PotItems_Room_0069
#_01DC3B: dw RoomData_PotItems_Room_006A
#_01DC3D: dw RoomData_PotItems_Room_006B
#_01DC3F: dw RoomData_PotItems_Room_006C
#_01DC41: dw RoomData_PotItems_Room_006D
#_01DC43: dw RoomData_PotItems_Room_006E
#_01DC45: dw RoomData_PotItems_Room_006F
#_01DC47: dw RoomData_PotItems_Room_0070
#_01DC49: dw RoomData_PotItems_Room_0071
#_01DC4B: dw RoomData_PotItems_Room_0072
#_01DC4D: dw RoomData_PotItems_Room_0073
#_01DC4F: dw RoomData_PotItems_Room_0074
#_01DC51: dw RoomData_PotItems_Room_0075
#_01DC53: dw RoomData_PotItems_Room_0076
#_01DC55: dw RoomData_PotItems_Room_0077
#_01DC57: dw RoomData_PotItems_Room_0078
#_01DC59: dw RoomData_PotItems_Room_0079
#_01DC5B: dw RoomData_PotItems_Room_007A
#_01DC5D: dw RoomData_PotItems_Room_007B
#_01DC5F: dw RoomData_PotItems_Room_007C
#_01DC61: dw RoomData_PotItems_Room_007D
#_01DC63: dw RoomData_PotItems_Room_007E
#_01DC65: dw RoomData_PotItems_Room_007F
#_01DC67: dw RoomData_PotItems_Room_0080
#_01DC69: dw RoomData_PotItems_Room_0081
#_01DC6B: dw RoomData_PotItems_Room_0082
#_01DC6D: dw RoomData_PotItems_Room_0083
#_01DC6F: dw RoomData_PotItems_Room_0084
#_01DC71: dw RoomData_PotItems_Room_0085
#_01DC73: dw RoomData_PotItems_Room_0086
#_01DC75: dw RoomData_PotItems_Room_0087
#_01DC77: dw RoomData_PotItems_Room_0088
#_01DC79: dw RoomData_PotItems_Room_0089
#_01DC7B: dw RoomData_PotItems_Room_008A
#_01DC7D: dw RoomData_PotItems_Room_008B
#_01DC7F: dw RoomData_PotItems_Room_008C
#_01DC81: dw RoomData_PotItems_Room_008D
#_01DC83: dw RoomData_PotItems_Room_008E
#_01DC85: dw RoomData_PotItems_Room_008F
#_01DC87: dw RoomData_PotItems_Room_0090
#_01DC89: dw RoomData_PotItems_Room_0091
#_01DC8B: dw RoomData_PotItems_Room_0092
#_01DC8D: dw RoomData_PotItems_Room_0093
#_01DC8F: dw RoomData_PotItems_Room_0094
#_01DC91: dw RoomData_PotItems_Room_0095
#_01DC93: dw RoomData_PotItems_Room_0096
#_01DC95: dw RoomData_PotItems_Room_0097
#_01DC97: dw RoomData_PotItems_Room_0098
#_01DC99: dw RoomData_PotItems_Room_0099
#_01DC9B: dw RoomData_PotItems_Room_009A
#_01DC9D: dw RoomData_PotItems_Room_009B
#_01DC9F: dw RoomData_PotItems_Room_009C
#_01DCA1: dw RoomData_PotItems_Room_009D
#_01DCA3: dw RoomData_PotItems_Room_009E
#_01DCA5: dw RoomData_PotItems_Room_009F
#_01DCA7: dw RoomData_PotItems_Room_00A0
#_01DCA9: dw RoomData_PotItems_Room_00A1
#_01DCAB: dw RoomData_PotItems_Room_00A2
#_01DCAD: dw RoomData_PotItems_Room_00A3
#_01DCAF: dw RoomData_PotItems_Room_00A4
#_01DCB1: dw RoomData_PotItems_Room_00A5
#_01DCB3: dw RoomData_PotItems_Room_00A6
#_01DCB5: dw RoomData_PotItems_Room_00A7
#_01DCB7: dw RoomData_PotItems_Room_00A8
#_01DCB9: dw RoomData_PotItems_Room_00A9
#_01DCBB: dw RoomData_PotItems_Room_00AA
#_01DCBD: dw RoomData_PotItems_Room_00AB
#_01DCBF: dw RoomData_PotItems_Room_00AC
#_01DCC1: dw RoomData_PotItems_Room_00AD
#_01DCC3: dw RoomData_PotItems_Room_00AE
#_01DCC5: dw RoomData_PotItems_Room_00AF
#_01DCC7: dw RoomData_PotItems_Room_00B0
#_01DCC9: dw RoomData_PotItems_Room_00B1
#_01DCCB: dw RoomData_PotItems_Room_00B2
#_01DCCD: dw RoomData_PotItems_Room_00B3
#_01DCCF: dw RoomData_PotItems_Room_00B4
#_01DCD1: dw RoomData_PotItems_Room_00B5
#_01DCD3: dw RoomData_PotItems_Room_00B6
#_01DCD5: dw RoomData_PotItems_Room_00B7
#_01DCD7: dw RoomData_PotItems_Room_00B8
#_01DCD9: dw RoomData_PotItems_Room_00B9
#_01DCDB: dw RoomData_PotItems_Room_00BA
#_01DCDD: dw RoomData_PotItems_Room_00BB
#_01DCDF: dw RoomData_PotItems_Room_00BC
#_01DCE1: dw RoomData_PotItems_Room_00BD
#_01DCE3: dw RoomData_PotItems_Room_00BE
#_01DCE5: dw RoomData_PotItems_Room_00BF
#_01DCE7: dw RoomData_PotItems_Room_00C0
#_01DCE9: dw RoomData_PotItems_Room_00C1
#_01DCEB: dw RoomData_PotItems_Room_00C2
#_01DCED: dw RoomData_PotItems_Room_00C3
#_01DCEF: dw RoomData_PotItems_Room_00C4
#_01DCF1: dw RoomData_PotItems_Room_00C5
#_01DCF3: dw RoomData_PotItems_Room_00C6
#_01DCF5: dw RoomData_PotItems_Room_00C7
#_01DCF7: dw RoomData_PotItems_Room_00C8
#_01DCF9: dw RoomData_PotItems_Room_00C9
#_01DCFB: dw RoomData_PotItems_Room_00CA
#_01DCFD: dw RoomData_PotItems_Room_00CB
#_01DCFF: dw RoomData_PotItems_Room_00CC
#_01DD01: dw RoomData_PotItems_Room_00CD
#_01DD03: dw RoomData_PotItems_Room_00CE
#_01DD05: dw RoomData_PotItems_Room_00CF
#_01DD07: dw RoomData_PotItems_Room_00D0
#_01DD09: dw RoomData_PotItems_Room_00D1
#_01DD0B: dw RoomData_PotItems_Room_00D2
#_01DD0D: dw RoomData_PotItems_Room_00D3
#_01DD0F: dw RoomData_PotItems_Room_00D4
#_01DD11: dw RoomData_PotItems_Room_00D5
#_01DD13: dw RoomData_PotItems_Room_00D6
#_01DD15: dw RoomData_PotItems_Room_00D7
#_01DD17: dw RoomData_PotItems_Room_00D8
#_01DD19: dw RoomData_PotItems_Room_00D9
#_01DD1B: dw RoomData_PotItems_Room_00DA
#_01DD1D: dw RoomData_PotItems_Room_00DB
#_01DD1F: dw RoomData_PotItems_Room_00DC
#_01DD21: dw RoomData_PotItems_Room_00DD
#_01DD23: dw RoomData_PotItems_Room_00DE
#_01DD25: dw RoomData_PotItems_Room_00DF
#_01DD27: dw RoomData_PotItems_Room_00E0
#_01DD29: dw RoomData_PotItems_Room_00E1
#_01DD2B: dw RoomData_PotItems_Room_00E2
#_01DD2D: dw RoomData_PotItems_Room_00E3
#_01DD2F: dw RoomData_PotItems_Room_00E4
#_01DD31: dw RoomData_PotItems_Room_00E5
#_01DD33: dw RoomData_PotItems_Room_00E6
#_01DD35: dw RoomData_PotItems_Room_00E7
#_01DD37: dw RoomData_PotItems_Room_00E8
#_01DD39: dw RoomData_PotItems_Room_00E9
#_01DD3B: dw RoomData_PotItems_Room_00EA
#_01DD3D: dw RoomData_PotItems_Room_00EB
#_01DD3F: dw RoomData_PotItems_Room_00EC
#_01DD41: dw RoomData_PotItems_Room_00ED
#_01DD43: dw RoomData_PotItems_Room_00EE
#_01DD45: dw RoomData_PotItems_Room_00EF
#_01DD47: dw RoomData_PotItems_Room_00F0
#_01DD49: dw RoomData_PotItems_Room_00F1
#_01DD4B: dw RoomData_PotItems_Room_00F2
#_01DD4D: dw RoomData_PotItems_Room_00F3
#_01DD4F: dw RoomData_PotItems_Room_00F4
#_01DD51: dw RoomData_PotItems_Room_00F5
#_01DD53: dw RoomData_PotItems_Room_00F6
#_01DD55: dw RoomData_PotItems_Room_00F7
#_01DD57: dw RoomData_PotItems_Room_00F8
#_01DD59: dw RoomData_PotItems_Room_00F9
#_01DD5B: dw RoomData_PotItems_Room_00FA
#_01DD5D: dw RoomData_PotItems_Room_00FB
#_01DD5F: dw RoomData_PotItems_Room_00FC
#_01DD61: dw RoomData_PotItems_Room_00FD
#_01DD63: dw RoomData_PotItems_Room_00FE
#_01DD65: dw RoomData_PotItems_Room_00FF
#_01DD67: dw RoomData_PotItems_Room_0100
#_01DD69: dw RoomData_PotItems_Room_0101
#_01DD6B: dw RoomData_PotItems_Room_0102
#_01DD6D: dw RoomData_PotItems_Room_0103
#_01DD6F: dw RoomData_PotItems_Room_0104
#_01DD71: dw RoomData_PotItems_Room_0105
#_01DD73: dw RoomData_PotItems_Room_0106
#_01DD75: dw RoomData_PotItems_Room_0107
#_01DD77: dw RoomData_PotItems_Room_0108
#_01DD79: dw RoomData_PotItems_Room_0109
#_01DD7B: dw RoomData_PotItems_Room_010A
#_01DD7D: dw RoomData_PotItems_Room_010B
#_01DD7F: dw RoomData_PotItems_Room_010C
#_01DD81: dw RoomData_PotItems_Room_010D
#_01DD83: dw RoomData_PotItems_Room_010E
#_01DD85: dw RoomData_PotItems_Room_010F
#_01DD87: dw RoomData_PotItems_Room_0110
#_01DD89: dw RoomData_PotItems_Room_0111
#_01DD8B: dw RoomData_PotItems_Room_0112
#_01DD8D: dw RoomData_PotItems_Room_0113
#_01DD8F: dw RoomData_PotItems_Room_0114
#_01DD91: dw RoomData_PotItems_Room_0115
#_01DD93: dw RoomData_PotItems_Room_0116
#_01DD95: dw RoomData_PotItems_Room_0117
#_01DD97: dw RoomData_PotItems_Room_0118
#_01DD99: dw RoomData_PotItems_Room_0119
#_01DD9B: dw RoomData_PotItems_Room_011A
#_01DD9D: dw RoomData_PotItems_Room_011B
#_01DD9F: dw RoomData_PotItems_Room_011C
#_01DDA1: dw RoomData_PotItems_Room_011D
#_01DDA3: dw RoomData_PotItems_Room_011E
#_01DDA5: dw RoomData_PotItems_Room_011F
#_01DDA7: dw RoomData_PotItems_Room_0120
#_01DDA9: dw RoomData_PotItems_Room_0121
#_01DDAB: dw RoomData_PotItems_Room_0122
#_01DDAD: dw RoomData_PotItems_Room_0123
#_01DDAF: dw RoomData_PotItems_Room_0124
#_01DDB1: dw RoomData_PotItems_Room_0125
#_01DDB3: dw RoomData_PotItems_Room_0126
#_01DDB5: dw RoomData_PotItems_Room_0127
#_01DDB7: dw RoomData_PotItems_Room_0128
#_01DDB9: dw RoomData_PotItems_Room_0129
#_01DDBB: dw RoomData_PotItems_Room_012A
#_01DDBD: dw RoomData_PotItems_Room_012B
#_01DDBF: dw RoomData_PotItems_Room_012C
#_01DDC1: dw RoomData_PotItems_Room_012D
#_01DDC3: dw RoomData_PotItems_Room_012E
#_01DDC5: dw RoomData_PotItems_Room_012F
#_01DDC7: dw RoomData_PotItems_Room_0130
#_01DDC9: dw RoomData_PotItems_Room_0131
#_01DDCB: dw RoomData_PotItems_Room_0132
#_01DDCD: dw RoomData_PotItems_Room_0133
#_01DDCF: dw RoomData_PotItems_Room_0134
#_01DDD1: dw RoomData_PotItems_Room_0135
#_01DDD3: dw RoomData_PotItems_Room_0136
#_01DDD5: dw RoomData_PotItems_Room_0137
#_01DDD7: dw RoomData_PotItems_Room_0138
#_01DDD9: dw RoomData_PotItems_Room_0139
#_01DDDB: dw RoomData_PotItems_Room_013A
#_01DDDD: dw RoomData_PotItems_Room_013B
#_01DDDF: dw RoomData_PotItems_Room_013C
#_01DDE1: dw RoomData_PotItems_Room_013D
#_01DDE3: dw RoomData_PotItems_Room_013E
#_01DDE5: dw RoomData_PotItems_Room_013F

;===================================================================================================

RoomData_PotItems_Room_0000:
RoomData_PotItems_Room_0001:
RoomData_PotItems_Room_0002:
RoomData_PotItems_Room_0003:
#_01DDE7: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0004:
#_01DDE9: db $CC, $13, $0A ; 1 Bomb       xyz:{ 0x130, 0x130, U }
#_01DDEC: db $F0, $13, $0A ; 1 Bomb       xyz:{ 0x1C0, 0x130, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0005:
RoomData_PotItems_Room_0006:
RoomData_PotItems_Room_0007:
RoomData_PotItems_Room_0008:
#_01DDEF: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0009:
#_01DDF1: db $0C, $04, $01 ; Green rupee  xyz:{ 0x030, 0x040, U }
#_01DDF4: db $30, $04, $0B ; Heart        xyz:{ 0x0C0, 0x040, U }
#_01DDF7: db $0C, $0C, $88 ; Switch       xyz:{ 0x030, 0x0C0, U }
#_01DDFA: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_000A:
#_01DDFC: db $60, $08, $0B ; Heart        xyz:{ 0x180, 0x080, U }
#_01DDFF: db $68, $08, $0B ; Heart        xyz:{ 0x1A0, 0x080, U }
#_01DE02: db $CC, $0B, $88 ; Switch       xyz:{ 0x130, 0x0B0, U }
#_01DE05: db $9C, $11, $0A ; 1 Bomb       xyz:{ 0x070, 0x110, U }
#_01DE08: db $A0, $11, $09 ; 5 arrows     xyz:{ 0x080, 0x110, U }
#_01DE0B: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_000B:
#_01DE0D: db $CA, $03, $0A ; 1 Bomb       xyz:{ 0x128, 0x030, U }
#_01DE10: db $CA, $0C, $0A ; 1 Bomb       xyz:{ 0x128, 0x0C0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_000C:
RoomData_PotItems_Room_000D:
RoomData_PotItems_Room_000E:
RoomData_PotItems_Room_000F:
RoomData_PotItems_Room_0010:
#_01DE13: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0011:
#_01DE15: db $90, $0F, $0B ; Heart        xyz:{ 0x040, 0x0F0, U }
#_01DE18: db $A0, $0F, $0B ; Heart        xyz:{ 0x080, 0x0F0, U }
#_01DE1B: db $90, $13, $0B ; Heart        xyz:{ 0x040, 0x130, U }
#_01DE1E: db $A0, $13, $0B ; Heart        xyz:{ 0x080, 0x130, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0012:
RoomData_PotItems_Room_0013:
RoomData_PotItems_Room_0014:
#_01DE21: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0015:
#_01DE23: db $60, $04, $0A ; 1 Bomb       xyz:{ 0x180, 0x040, U }
#_01DE26: db $64, $04, $0C ; Small magic  xyz:{ 0x190, 0x040, U }
#_01DE29: db $68, $04, $0B ; Heart        xyz:{ 0x1A0, 0x040, U }
#_01DE2C: db $6C, $04, $0C ; Small magic  xyz:{ 0x1B0, 0x040, U }
#_01DE2F: db $70, $04, $09 ; 5 arrows     xyz:{ 0x1C0, 0x040, U }
#_01DE32: db $0C, $06, $01 ; Green rupee  xyz:{ 0x030, 0x060, U }
#_01DE35: db $10, $06, $09 ; 5 arrows     xyz:{ 0x040, 0x060, U }
#_01DE38: db $14, $06, $07 ; Blue rupee   xyz:{ 0x050, 0x060, U }
#_01DE3B: db $46, $0B, $0D ; Full magic   xyz:{ 0x118, 0x0B0, U }
#_01DE3E: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0016:
#_01DE40: db $BC, $03, $0B ; Heart        xyz:{ 0x0F0, 0x030, U }
#_01DE43: db $C0, $03, $0B ; Heart        xyz:{ 0x100, 0x030, U }
#_01DE46: db $BC, $04, $0C ; Small magic  xyz:{ 0x0F0, 0x040, U }
#_01DE49: db $C0, $04, $0C ; Small magic  xyz:{ 0x100, 0x040, U }
#_01DE4C: db $BC, $05, $09 ; 5 arrows     xyz:{ 0x0F0, 0x050, U }
#_01DE4F: db $C0, $05, $09 ; 5 arrows     xyz:{ 0x100, 0x050, U }
#_01DE52: db $BC, $06, $0A ; 1 Bomb       xyz:{ 0x0F0, 0x060, U }
#_01DE55: db $C0, $06, $0A ; 1 Bomb       xyz:{ 0x100, 0x060, U }
#_01DE58: db $F0, $13, $08 ; Small key    xyz:{ 0x1C0, 0x130, U }
#_01DE5B: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0017:
#_01DE5D: db $64, $0D, $0B ; Heart        xyz:{ 0x190, 0x0D0, U }
#_01DE60: db $64, $0E, $0B ; Heart        xyz:{ 0x190, 0x0E0, U }
#_01DE63: db $64, $0F, $0B ; Heart        xyz:{ 0x190, 0x0F0, U }
#_01DE66: db $64, $10, $0B ; Heart        xyz:{ 0x190, 0x100, U }
#_01DE69: db $64, $11, $0B ; Heart        xyz:{ 0x190, 0x110, U }
#_01DE6C: db $64, $12, $0B ; Heart        xyz:{ 0x190, 0x120, U }
#_01DE6F: db $68, $0D, $0B ; Heart        xyz:{ 0x1A0, 0x0D0, U }
#_01DE72: db $68, $0E, $0B ; Heart        xyz:{ 0x1A0, 0x0E0, U }
#_01DE75: db $68, $0F, $0B ; Heart        xyz:{ 0x1A0, 0x0F0, U }
#_01DE78: db $68, $10, $0B ; Heart        xyz:{ 0x1A0, 0x100, U }
#_01DE7B: db $68, $11, $0B ; Heart        xyz:{ 0x1A0, 0x110, U }
#_01DE7E: db $68, $12, $0B ; Heart        xyz:{ 0x1A0, 0x120, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0018:
RoomData_PotItems_Room_0019:
#_01DE81: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_001A:
#_01DE83: db $1C, $05, $0A ; 1 Bomb       xyz:{ 0x070, 0x050, U }
#_01DE86: db $20, $05, $0A ; 1 Bomb       xyz:{ 0x080, 0x050, U }
#_01DE89: db $1C, $1B, $0A ; 1 Bomb       xyz:{ 0x070, 0x1B0, U }
#_01DE8C: db $20, $1B, $0A ; 1 Bomb       xyz:{ 0x080, 0x1B0, U }
#_01DE8F: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_001B:
#_01DE91: db $14, $17, $09 ; 5 arrows     xyz:{ 0x050, 0x170, U }
#_01DE94: db $28, $17, $09 ; 5 arrows     xyz:{ 0x0A0, 0x170, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_001C:
RoomData_PotItems_Room_001D:
#_01DE97: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_001E:
#_01DE99: db $54, $09, $0A ; 1 Bomb       xyz:{ 0x150, 0x090, U }
#_01DE9C: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_001F:
#_01DE9E: db $1C, $19, $88 ; Switch       xyz:{ 0x070, 0x190, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0020:
#_01DEA1: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0021:
#_01DEA3: db $A8, $18, $0C ; Small magic  xyz:{ 0x0A0, 0x180, U }
#_01DEA6: db $30, $1C, $0B ; Heart        xyz:{ 0x0C0, 0x1C0, U }
#_01DEA9: db $52, $1C, $0C ; Small magic  xyz:{ 0x148, 0x1C0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0022:
#_01DEAC: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0023:
#_01DEAE: db $56, $1A, $01 ; Green rupee  xyz:{ 0x158, 0x1A0, U }
#_01DEB1: db $5A, $1A, $0B ; Heart        xyz:{ 0x168, 0x1A0, U }
#_01DEB4: db $5E, $1A, $01 ; Green rupee  xyz:{ 0x178, 0x1A0, U }
#_01DEB7: db $62, $1A, $0A ; 1 Bomb       xyz:{ 0x188, 0x1A0, U }
#_01DEBA: db $66, $1A, $01 ; Green rupee  xyz:{ 0x198, 0x1A0, U }
#_01DEBD: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0024:
#_01DEBF: db $0C, $04, $07 ; Blue rupee   xyz:{ 0x030, 0x040, U }
#_01DEC2: db $30, $04, $0B ; Heart        xyz:{ 0x0C0, 0x040, U }
#_01DEC5: db $0C, $0C, $0C ; Small magic  xyz:{ 0x030, 0x0C0, U }
#_01DEC8: db $30, $0C, $01 ; Green rupee  xyz:{ 0x0C0, 0x0C0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0025:
#_01DECB: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0026:
#_01DECD: db $1C, $04, $0A ; 1 Bomb       xyz:{ 0x070, 0x040, U }
#_01DED0: db $0C, $08, $0C ; Small magic  xyz:{ 0x030, 0x080, U }
#_01DED3: db $96, $13, $88 ; Switch       xyz:{ 0x058, 0x130, U }
#_01DED6: db $16, $1A, $07 ; Blue rupee   xyz:{ 0x058, 0x1A0, U }
#_01DED9: db $DC, $1A, $09 ; 5 arrows     xyz:{ 0x170, 0x1A0, U }
#_01DEDC: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0027:
#_01DEDE: db $A6, $14, $0A ; 1 Bomb       xyz:{ 0x098, 0x140, U }
#_01DEE1: db $D6, $15, $0B ; Heart        xyz:{ 0x158, 0x150, U }
#_01DEE4: db $28, $1C, $01 ; Green rupee  xyz:{ 0x0A0, 0x1C0, U }
#_01DEE7: db $2C, $1C, $01 ; Green rupee  xyz:{ 0x0B0, 0x1C0, U }
#_01DEEA: db $50, $1C, $07 ; Blue rupee   xyz:{ 0x140, 0x1C0, U }
#_01DEED: db $54, $1C, $07 ; Blue rupee   xyz:{ 0x150, 0x1C0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0028:
RoomData_PotItems_Room_0029:
#_01DEF0: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_002A:
#_01DEF2: db $50, $0C, $01 ; Green rupee  xyz:{ 0x140, 0x0C0, U }
#_01DEF5: db $50, $13, $0B ; Heart        xyz:{ 0x140, 0x130, U }
#_01DEF8: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_002B:
#_01DEFA: db $10, $05, $0B ; Heart        xyz:{ 0x040, 0x050, U }
#_01DEFD: db $2C, $05, $88 ; Switch       xyz:{ 0x0B0, 0x050, U }
#_01DF00: db $10, $06, $0B ; Heart        xyz:{ 0x040, 0x060, U }
#_01DF03: db $2C, $06, $0A ; 1 Bomb       xyz:{ 0x0B0, 0x060, U }
#_01DF06: db $10, $07, $0B ; Heart        xyz:{ 0x040, 0x070, U }
#_01DF09: db $2C, $07, $0A ; 1 Bomb       xyz:{ 0x0B0, 0x070, U }
#_01DF0C: db $92, $15, $0A ; 1 Bomb       xyz:{ 0x048, 0x150, U }
#_01DF0F: db $AA, $15, $09 ; 5 arrows     xyz:{ 0x0A8, 0x150, U }
#_01DF12: db $92, $16, $0A ; 1 Bomb       xyz:{ 0x048, 0x160, U }
#_01DF15: db $AA, $16, $09 ; 5 arrows     xyz:{ 0x0A8, 0x160, U }
#_01DF18: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_002C:
#_01DF1A: db $6C, $18, $0B ; Heart        xyz:{ 0x1B0, 0x180, U }
#_01DF1D: db $70, $18, $0B ; Heart        xyz:{ 0x1C0, 0x180, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_002D:
RoomData_PotItems_Room_002E:
#_01DF20: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_002F:
#_01DF22: db $1C, $07, $0B ; Heart        xyz:{ 0x070, 0x070, U }
#_01DF25: db $20, $07, $0B ; Heart        xyz:{ 0x080, 0x070, U }
#_01DF28: db $1C, $09, $07 ; Blue rupee   xyz:{ 0x070, 0x090, U }
#_01DF2B: db $20, $09, $07 ; Blue rupee   xyz:{ 0x080, 0x090, U }
#_01DF2E: db $AC, $13, $07 ; Blue rupee   xyz:{ 0x0B0, 0x130, U }
#_01DF31: db $B4, $13, $07 ; Blue rupee   xyz:{ 0x0D0, 0x130, U }
#_01DF34: db $68, $1B, $0B ; Heart        xyz:{ 0x1A0, 0x1B0, U }
#_01DF37: db $68, $1C, $0B ; Heart        xyz:{ 0x1A0, 0x1C0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0030:
#_01DF3A: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0031:
#_01DF3C: db $5C, $1C, $0A ; 1 Bomb       xyz:{ 0x170, 0x1C0, U }
#_01DF3F: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0032:
#_01DF41: db $1C, $0D, $0C ; Small magic  xyz:{ 0x070, 0x0D0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0033:
#_01DF44: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0034:
#_01DF46: db $4E, $08, $07 ; Blue rupee   xyz:{ 0x138, 0x080, U }
#_01DF49: db $5C, $08, $07 ; Blue rupee   xyz:{ 0x170, 0x080, U }
#_01DF4C: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0035:
#_01DF4E: db $3C, $06, $08 ; Small key    xyz:{ 0x0F0, 0x060, U }
#_01DF51: db $14, $08, $07 ; Blue rupee   xyz:{ 0x050, 0x080, U }
#_01DF54: db $18, $08, $07 ; Blue rupee   xyz:{ 0x060, 0x080, U }
#_01DF57: db $1C, $08, $07 ; Blue rupee   xyz:{ 0x070, 0x080, U }
#_01DF5A: db $20, $08, $07 ; Blue rupee   xyz:{ 0x080, 0x080, U }
#_01DF5D: db $24, $08, $07 ; Blue rupee   xyz:{ 0x090, 0x080, U }
#_01DF60: db $30, $14, $0B ; Heart        xyz:{ 0x0C0, 0x140, U }
#_01DF63: db $70, $17, $0B ; Heart        xyz:{ 0x1C0, 0x170, U }
#_01DF66: db $4C, $1C, $0B ; Heart        xyz:{ 0x130, 0x1C0, U }
#_01DF69: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0036:
#_01DF6B: db $6C, $04, $0A ; 1 Bomb       xyz:{ 0x1B0, 0x040, U }
#_01DF6E: db $70, $04, $07 ; Blue rupee   xyz:{ 0x1C0, 0x040, U }
#_01DF71: db $0A, $10, $0B ; Heart        xyz:{ 0x028, 0x100, U }
#_01DF74: db $72, $10, $08 ; Small key    xyz:{ 0x1C8, 0x100, U }
#_01DF77: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0037:
#_01DF79: db $3C, $06, $08 ; Small key    xyz:{ 0x0F0, 0x060, U }
#_01DF7C: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0038:
#_01DF7E: db $A4, $0C, $0A ; 1 Bomb       xyz:{ 0x090, 0x0C0, U }
#_01DF81: db $A4, $0D, $07 ; Blue rupee   xyz:{ 0x090, 0x0D0, U }
#_01DF84: db $A4, $12, $0A ; 1 Bomb       xyz:{ 0x090, 0x120, U }
#_01DF87: db $A4, $13, $08 ; Small key    xyz:{ 0x090, 0x130, U }
#_01DF8A: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0039:
#_01DF8C: db $0C, $14, $0B ; Heart        xyz:{ 0x030, 0x140, U }
#_01DF8F: db $64, $16, $0C ; Small magic  xyz:{ 0x190, 0x160, U }
#_01DF92: db $64, $1A, $09 ; 5 arrows     xyz:{ 0x190, 0x1A0, U }
#_01DF95: db $30, $1C, $09 ; 5 arrows     xyz:{ 0x0C0, 0x1C0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_003A:
RoomData_PotItems_Room_003B:
#_01DF98: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_003C:
#_01DF9A: db $18, $08, $0C ; Small magic  xyz:{ 0x060, 0x080, U }
#_01DF9D: db $40, $0C, $07 ; Blue rupee   xyz:{ 0x100, 0x0C0, U }
#_01DFA0: db $14, $0E, $01 ; Green rupee  xyz:{ 0x050, 0x0E0, U }
#_01DFA3: db $44, $12, $07 ; Blue rupee   xyz:{ 0x110, 0x120, U }
#_01DFA6: db $60, $13, $0B ; Heart        xyz:{ 0x180, 0x130, U }
#_01DFA9: db $40, $14, $07 ; Blue rupee   xyz:{ 0x100, 0x140, U }
#_01DFAC: db $40, $1A, $07 ; Blue rupee   xyz:{ 0x100, 0x1A0, U }
#_01DFAF: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_003D:
#_01DFB1: db $4C, $0C, $0A ; 1 Bomb       xyz:{ 0x130, 0x0C0, U }
#_01DFB4: db $70, $0C, $0A ; 1 Bomb       xyz:{ 0x1C0, 0x0C0, U }
#_01DFB7: db $18, $16, $0B ; Heart        xyz:{ 0x060, 0x160, U }
#_01DFBA: db $28, $16, $09 ; 5 arrows     xyz:{ 0x0A0, 0x160, U }
#_01DFBD: db $20, $18, $0B ; Heart        xyz:{ 0x080, 0x180, U }
#_01DFC0: db $14, $1A, $07 ; Blue rupee   xyz:{ 0x050, 0x1A0, U }
#_01DFC3: db $24, $1A, $0D ; Full magic   xyz:{ 0x090, 0x1A0, U }
#_01DFC6: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_003E:
#_01DFC8: db $60, $06, $0A ; 1 Bomb       xyz:{ 0x180, 0x060, U }
#_01DFCB: db $64, $06, $0C ; Small magic  xyz:{ 0x190, 0x060, U }
#_01DFCE: db $58, $0A, $0B ; Heart        xyz:{ 0x160, 0x0A0, U }
#_01DFD1: db $5C, $0A, $0C ; Small magic  xyz:{ 0x170, 0x0A0, U }
#_01DFD4: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_003F:
#_01DFD6: db $0C, $19, $01 ; Green rupee  xyz:{ 0x030, 0x190, U }
#_01DFD9: db $14, $19, $01 ; Green rupee  xyz:{ 0x050, 0x190, U }
#_01DFDC: db $0C, $1A, $0A ; 1 Bomb       xyz:{ 0x030, 0x1A0, U }
#_01DFDF: db $14, $1A, $0A ; 1 Bomb       xyz:{ 0x050, 0x1A0, U }
#_01DFE2: db $0C, $1B, $88 ; Switch       xyz:{ 0x030, 0x1B0, U }
#_01DFE5: db $14, $1B, $0B ; Heart        xyz:{ 0x050, 0x1B0, U }
#_01DFE8: db $1C, $17, $08 ; Small key    xyz:{ 0x070, 0x170, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0040:
#_01DFEB: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0041:
#_01DFED: db $64, $0A, $0B ; Heart        xyz:{ 0x190, 0x0A0, U }
#_01DFF0: db $34, $0F, $01 ; Green rupee  xyz:{ 0x0D0, 0x0F0, U }
#_01DFF3: db $34, $10, $0C ; Small magic  xyz:{ 0x0D0, 0x100, U }
#_01DFF6: db $94, $16, $0C ; Small magic  xyz:{ 0x050, 0x160, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0042:
#_01DFF9: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0043:
#_01DFFB: db $42, $04, $09 ; 5 arrows     xyz:{ 0x108, 0x040, U }
#_01DFFE: db $4E, $04, $0C ; Small magic  xyz:{ 0x138, 0x040, U }
#_01E001: db $42, $09, $0B ; Heart        xyz:{ 0x108, 0x090, U }
#_01E004: db $4E, $09, $0B ; Heart        xyz:{ 0x138, 0x090, U }
#_01E007: db $70, $14, $08 ; Small key    xyz:{ 0x1C0, 0x140, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0044:
#_01E00A: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0045:
#_01E00C: db $0C, $04, $09 ; 5 arrows     xyz:{ 0x030, 0x040, U }
#_01E00F: db $6C, $0B, $0B ; Heart        xyz:{ 0x1B0, 0x0B0, U }
#_01E012: db $30, $0C, $09 ; 5 arrows     xyz:{ 0x0C0, 0x0C0, U }
#_01E015: db $DC, $10, $0C ; Small magic  xyz:{ 0x170, 0x100, U }
#_01E018: db $EC, $10, $0B ; Heart        xyz:{ 0x1B0, 0x100, U }
#_01E01B: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0046:
#_01E01D: db $60, $05, $0B ; Heart        xyz:{ 0x180, 0x050, U }
#_01E020: db $1C, $1B, $0B ; Heart        xyz:{ 0x070, 0x1B0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0047:
RoomData_PotItems_Room_0048:
#_01E023: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0049:
#_01E025: db $68, $0F, $0C ; Small magic  xyz:{ 0x1A0, 0x0F0, U }
#_01E028: db $68, $10, $0C ; Small magic  xyz:{ 0x1A0, 0x100, U }
#_01E02B: db $90, $13, $0C ; Small magic  xyz:{ 0x040, 0x130, U }
#_01E02E: db $AC, $14, $0B ; Heart        xyz:{ 0x0B0, 0x140, U }
#_01E031: db $90, $1B, $0B ; Heart        xyz:{ 0x040, 0x1B0, U }
#_01E034: db $AC, $1C, $0C ; Small magic  xyz:{ 0x0B0, 0x1C0, U }
#_01E037: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_004A:
#_01E039: db $0E, $05, $88 ; Switch       xyz:{ 0x038, 0x050, U }
#_01E03C: db $20, $05, $0A ; 1 Bomb       xyz:{ 0x080, 0x050, U }
#_01E03F: db $5C, $05, $0A ; 1 Bomb       xyz:{ 0x170, 0x050, U }
#_01E042: db $6E, $05, $88 ; Switch       xyz:{ 0x1B8, 0x050, U }
#_01E045: db $38, $08, $0A ; 1 Bomb       xyz:{ 0x0E0, 0x080, U }
#_01E048: db $44, $08, $0A ; 1 Bomb       xyz:{ 0x110, 0x080, U }
#_01E04B: db $0E, $0B, $0B ; Heart        xyz:{ 0x038, 0x0B0, U }
#_01E04E: db $20, $0B, $01 ; Green rupee  xyz:{ 0x080, 0x0B0, U }
#_01E051: db $5C, $0B, $01 ; Green rupee  xyz:{ 0x170, 0x0B0, U }
#_01E054: db $6E, $0B, $0B ; Heart        xyz:{ 0x1B8, 0x0B0, U }
#_01E057: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_004B:
#_01E059: db $14, $06, $09 ; 5 arrows     xyz:{ 0x050, 0x060, U }
#_01E05C: db $28, $06, $0B ; Heart        xyz:{ 0x0A0, 0x060, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_004C:
RoomData_PotItems_Room_004D:
#_01E05F: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_004E:
#_01E061: db $8C, $0B, $88 ; Switch       xyz:{ 0x030, 0x0B0, U }
#_01E064: db $1C, $0C, $0B ; Heart        xyz:{ 0x070, 0x0C0, U }
#_01E067: db $70, $0C, $0C ; Small magic  xyz:{ 0x1C0, 0x0C0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_004F:
#_01E06A: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0050:
#_01E06C: db $60, $26, $0B ; Heart        xyz:{ 0x180, 0x060, L }
#_01E06F: db $64, $26, $0B ; Heart        xyz:{ 0x190, 0x060, L }

RoomData_PotItems_Room_0051:
#_01E072: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0052:
#_01E074: db $8A, $03, $0B ; Heart        xyz:{ 0x028, 0x030, U }
#_01E077: db $C2, $1A, $0B ; Heart        xyz:{ 0x108, 0x1A0, U }
#_01E07A: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0053:
#_01E07C: db $5C, $0B, $0B ; Heart        xyz:{ 0x170, 0x0B0, U }
#_01E07F: db $60, $0B, $0C ; Small magic  xyz:{ 0x180, 0x0B0, U }
#_01E082: db $64, $0B, $08 ; Small key    xyz:{ 0x190, 0x0B0, U }
#_01E085: db $68, $0B, $0B ; Heart        xyz:{ 0x1A0, 0x0B0, U }
#_01E088: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0054:
#_01E08A: db $BA, $19, $07 ; Blue rupee   xyz:{ 0x0E8, 0x190, U }
#_01E08D: db $BA, $1A, $0B ; Heart        xyz:{ 0x0E8, 0x1A0, U }
#_01E090: db $BA, $1B, $0B ; Heart        xyz:{ 0x0E8, 0x1B0, U }
#_01E093: db $BA, $1C, $0B ; Heart        xyz:{ 0x0E8, 0x1C0, U }
#_01E096: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0055:
#_01E098: db $E6, $18, $0C ; Small magic  xyz:{ 0x198, 0x180, U }
#_01E09B: db $E6, $19, $0C ; Small magic  xyz:{ 0x198, 0x190, U }
#_01E09E: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0056:
#_01E0A0: db $14, $06, $0C ; Small magic  xyz:{ 0x050, 0x060, U }
#_01E0A3: db $28, $06, $0C ; Small magic  xyz:{ 0x0A0, 0x060, U }
#_01E0A6: db $18, $07, $0C ; Small magic  xyz:{ 0x060, 0x070, U }
#_01E0A9: db $24, $07, $0C ; Small magic  xyz:{ 0x090, 0x070, U }
#_01E0AC: db $0C, $08, $0B ; Heart        xyz:{ 0x030, 0x080, U }
#_01E0AF: db $30, $08, $0B ; Heart        xyz:{ 0x0C0, 0x080, U }
#_01E0B2: db $18, $09, $0C ; Small magic  xyz:{ 0x060, 0x090, U }
#_01E0B5: db $24, $09, $0C ; Small magic  xyz:{ 0x090, 0x090, U }
#_01E0B8: db $14, $0A, $07 ; Blue rupee   xyz:{ 0x050, 0x0A0, U }
#_01E0BB: db $28, $0A, $07 ; Blue rupee   xyz:{ 0x0A0, 0x0A0, U }
#_01E0BE: db $0C, $14, $08 ; Small key    xyz:{ 0x030, 0x140, U }
#_01E0C1: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0057:
#_01E0C3: db $5C, $07, $0D ; Full magic   xyz:{ 0x170, 0x070, U }
#_01E0C6: db $0C, $14, $0C ; Small magic  xyz:{ 0x030, 0x140, U }
#_01E0C9: db $5C, $17, $0A ; 1 Bomb       xyz:{ 0x170, 0x170, U }
#_01E0CC: db $64, $17, $0C ; Small magic  xyz:{ 0x190, 0x170, U }
#_01E0CF: db $54, $19, $07 ; Blue rupee   xyz:{ 0x150, 0x190, U }
#_01E0D2: db $4C, $1B, $0B ; Heart        xyz:{ 0x130, 0x1B0, U }
#_01E0D5: db $30, $14, $0C ; Small magic  xyz:{ 0x0C0, 0x140, U }
#_01E0D8: db $1E, $16, $88 ; Switch       xyz:{ 0x078, 0x160, U }
#_01E0DB: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0058:
#_01E0DD: db $60, $05, $0A ; 1 Bomb       xyz:{ 0x180, 0x050, U }
#_01E0E0: db $64, $05, $0C ; Small magic  xyz:{ 0x190, 0x050, U }
#_01E0E3: db $0C, $07, $0C ; Small magic  xyz:{ 0x030, 0x070, U }
#_01E0E6: db $5C, $07, $0B ; Heart        xyz:{ 0x170, 0x070, U }
#_01E0E9: db $6C, $07, $0B ; Heart        xyz:{ 0x1B0, 0x070, U }
#_01E0EC: db $10, $08, $0C ; Small magic  xyz:{ 0x040, 0x080, U }
#_01E0EF: db $64, $09, $0C ; Small magic  xyz:{ 0x190, 0x090, U }
#_01E0F2: db $68, $09, $0A ; 1 Bomb       xyz:{ 0x1A0, 0x090, U }
#_01E0F5: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0059:
#_01E0F7: db $1A, $2B, $0B ; Heart        xyz:{ 0x068, 0x0B0, L }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_005A:
#_01E0FA: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_005B:
#_01E0FC: db $DE, $25, $88 ; Switch       xyz:{ 0x178, 0x050, L }
#_01E0FF: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_005C:
#_01E101: db $5E, $16, $0A ; 1 Bomb       xyz:{ 0x178, 0x160, U }
#_01E104: db $5E, $1A, $0D ; Full magic   xyz:{ 0x178, 0x1A0, U }
#_01E107: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_005D:
#_01E109: db $10, $05, $0A ; 1 Bomb       xyz:{ 0x040, 0x050, U }
#_01E10C: db $2C, $05, $07 ; Blue rupee   xyz:{ 0x0B0, 0x050, U }
#_01E10F: db $10, $0B, $01 ; Green rupee  xyz:{ 0x040, 0x0B0, U }
#_01E112: db $2C, $0B, $09 ; 5 arrows     xyz:{ 0x0B0, 0x0B0, U }
#_01E115: db $0C, $14, $09 ; 5 arrows     xyz:{ 0x030, 0x140, U }
#_01E118: db $30, $14, $0A ; 1 Bomb       xyz:{ 0x0C0, 0x140, U }
#_01E11B: db $0C, $1C, $0C ; Small magic  xyz:{ 0x030, 0x1C0, U }
#_01E11E: db $30, $1C, $0A ; 1 Bomb       xyz:{ 0x0C0, 0x1C0, U }
#_01E121: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_005E:
#_01E123: db $5C, $04, $0C ; Small magic  xyz:{ 0x170, 0x040, U }
#_01E126: db $60, $04, $0C ; Small magic  xyz:{ 0x180, 0x040, U }
#_01E129: db $4C, $08, $0B ; Heart        xyz:{ 0x130, 0x080, U }
#_01E12C: db $70, $08, $0B ; Heart        xyz:{ 0x1C0, 0x080, U }
#_01E12F: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_005F:
#_01E131: db $2C, $1B, $88 ; Switch       xyz:{ 0x0B0, 0x1B0, U }
#_01E134: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0060:
#_01E136: db $4C, $04, $0B ; Heart        xyz:{ 0x130, 0x040, U }
#_01E139: db $70, $04, $0B ; Heart        xyz:{ 0x1C0, 0x040, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0061:
#_01E13C: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0062:
#_01E13E: db $D0, $15, $0B ; Heart        xyz:{ 0x140, 0x150, U }
#_01E141: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0063:
#_01E143: db $30, $08, $0B ; Heart        xyz:{ 0x0C0, 0x080, U }
#_01E146: db $0C, $0C, $08 ; Small key    xyz:{ 0x030, 0x0C0, U }
#_01E149: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0064:
#_01E14B: db $0C, $16, $0A ; 1 Bomb       xyz:{ 0x030, 0x160, U }
#_01E14E: db $10, $16, $0A ; 1 Bomb       xyz:{ 0x040, 0x160, U }
#_01E151: db $14, $16, $0A ; 1 Bomb       xyz:{ 0x050, 0x160, U }
#_01E154: db $24, $1C, $0A ; 1 Bomb       xyz:{ 0x090, 0x1C0, U }
#_01E157: db $28, $1C, $0C ; Small magic  xyz:{ 0x0A0, 0x1C0, U }
#_01E15A: db $2C, $1C, $0C ; Small magic  xyz:{ 0x0B0, 0x1C0, U }
#_01E15D: db $30, $1C, $88 ; Switch       xyz:{ 0x0C0, 0x1C0, U }
#_01E160: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0065:
#_01E162: db $64, $1C, $0A ; 1 Bomb       xyz:{ 0x190, 0x1C0, U }
#_01E165: db $68, $1C, $0A ; 1 Bomb       xyz:{ 0x1A0, 0x1C0, U }
#_01E168: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0066:
#_01E16A: db $30, $25, $09 ; 5 arrows     xyz:{ 0x0C0, 0x050, L }
#_01E16D: db $34, $25, $0A ; 1 Bomb       xyz:{ 0x0D0, 0x050, L }
#_01E170: db $38, $25, $07 ; Blue rupee   xyz:{ 0x0E0, 0x050, L }
#_01E173: db $54, $05, $0B ; Heart        xyz:{ 0x150, 0x050, U }
#_01E176: db $68, $05, $09 ; 5 arrows     xyz:{ 0x1A0, 0x050, U }
#_01E179: db $30, $26, $09 ; 5 arrows     xyz:{ 0x0C0, 0x060, L }
#_01E17C: db $34, $26, $0A ; 1 Bomb       xyz:{ 0x0D0, 0x060, L }
#_01E17F: db $38, $26, $07 ; Blue rupee   xyz:{ 0x0E0, 0x060, L }
#_01E182: db $54, $06, $0B ; Heart        xyz:{ 0x150, 0x060, U }
#_01E185: db $68, $06, $0A ; 1 Bomb       xyz:{ 0x1A0, 0x060, U }
#_01E188: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0067:
#_01E18A: db $0C, $07, $09 ; 5 arrows     xyz:{ 0x030, 0x070, U }
#_01E18D: db $30, $07, $0C ; Small magic  xyz:{ 0x0C0, 0x070, U }
#_01E190: db $60, $13, $0B ; Heart        xyz:{ 0x180, 0x130, U }
#_01E193: db $4A, $14, $0C ; Small magic  xyz:{ 0x128, 0x140, U }
#_01E196: db $12, $17, $0C ; Small magic  xyz:{ 0x048, 0x170, U }
#_01E199: db $12, $1A, $0B ; Heart        xyz:{ 0x048, 0x1A0, U }
#_01E19C: db $68, $1C, $0B ; Heart        xyz:{ 0x1A0, 0x1C0, U }
#_01E19F: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0068:
#_01E1A1: db $40, $07, $0B ; Heart        xyz:{ 0x100, 0x070, U }
#_01E1A4: db $58, $07, $0C ; Small magic  xyz:{ 0x160, 0x070, U }
#_01E1A7: db $40, $10, $0B ; Heart        xyz:{ 0x100, 0x100, U }
#_01E1AA: db $40, $18, $0C ; Small magic  xyz:{ 0x100, 0x180, U }
#_01E1AD: db $40, $19, $0B ; Heart        xyz:{ 0x100, 0x190, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0069:
RoomData_PotItems_Room_006A:
#_01E1B0: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_006B:
#_01E1B2: db $1C, $05, $0B ; Heart        xyz:{ 0x070, 0x050, U }
#_01E1B5: db $2C, $08, $0C ; Small magic  xyz:{ 0x0B0, 0x080, U }
#_01E1B8: db $1C, $0B, $0C ; Small magic  xyz:{ 0x070, 0x0B0, U }
#_01E1BB: db $62, $19, $09 ; 5 arrows     xyz:{ 0x188, 0x190, U }
#_01E1BE: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_006C:
#_01E1C0: db $14, $06, $0B ; Heart        xyz:{ 0x050, 0x060, U }
#_01E1C3: db $28, $06, $09 ; 5 arrows     xyz:{ 0x0A0, 0x060, U }
#_01E1C6: db $14, $0A, $0A ; 1 Bomb       xyz:{ 0x050, 0x0A0, U }
#_01E1C9: db $28, $0A, $0C ; Small magic  xyz:{ 0x0A0, 0x0A0, U }
#_01E1CC: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_006D:
#_01E1CE: db $1C, $1A, $0B ; Heart        xyz:{ 0x070, 0x1A0, U }
#_01E1D1: db $20, $1A, $0B ; Heart        xyz:{ 0x080, 0x1A0, U }
#_01E1D4: db $1C, $1B, $0C ; Small magic  xyz:{ 0x070, 0x1B0, U }
#_01E1D7: db $20, $1B, $0C ; Small magic  xyz:{ 0x080, 0x1B0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_006E:
RoomData_PotItems_Room_006F:
RoomData_PotItems_Room_0070:
RoomData_PotItems_Room_0071:
RoomData_PotItems_Room_0072:
#_01E1DA: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0073:
#_01E1DC: db $9A, $15, $09 ; 5 arrows     xyz:{ 0x068, 0x150, U }
#_01E1DF: db $9E, $15, $01 ; Green rupee  xyz:{ 0x078, 0x150, U }
#_01E1E2: db $14, $17, $88 ; Switch       xyz:{ 0x050, 0x170, U }
#_01E1E5: db $24, $17, $07 ; Blue rupee   xyz:{ 0x090, 0x170, U }
#_01E1E8: db $90, $18, $0B ; Heart        xyz:{ 0x040, 0x180, U }
#_01E1EB: db $A8, $18, $09 ; 5 arrows     xyz:{ 0x0A0, 0x180, U }
#_01E1EE: db $14, $1A, $0C ; Small magic  xyz:{ 0x050, 0x1A0, U }
#_01E1F1: db $24, $1A, $0B ; Heart        xyz:{ 0x090, 0x1A0, U }
#_01E1F4: db $9A, $1B, $01 ; Green rupee  xyz:{ 0x068, 0x1B0, U }
#_01E1F7: db $9E, $1B, $07 ; Blue rupee   xyz:{ 0x078, 0x1B0, U }
#_01E1FA: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0074:
#_01E1FC: db $1E, $05, $0C ; Small magic  xyz:{ 0x078, 0x050, U }
#_01E1FF: db $3E, $05, $88 ; Switch       xyz:{ 0x0F8, 0x050, U }
#_01E202: db $5E, $05, $0C ; Small magic  xyz:{ 0x178, 0x050, U }
#_01E205: db $0E, $0B, $0B ; Heart        xyz:{ 0x038, 0x0B0, U }
#_01E208: db $2E, $0B, $09 ; 5 arrows     xyz:{ 0x0B8, 0x0B0, U }
#_01E20B: db $4E, $0B, $09 ; 5 arrows     xyz:{ 0x138, 0x0B0, U }
#_01E20E: db $6E, $0B, $0B ; Heart        xyz:{ 0x1B8, 0x0B0, U }
#_01E211: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0075:
#_01E213: db $94, $16, $0C ; Small magic  xyz:{ 0x050, 0x160, U }
#_01E216: db $A0, $16, $09 ; 5 arrows     xyz:{ 0x080, 0x160, U }
#_01E219: db $AC, $16, $0B ; Heart        xyz:{ 0x0B0, 0x160, U }
#_01E21C: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0076:
#_01E21E: db $70, $0C, $0B ; Heart        xyz:{ 0x1C0, 0x0C0, U }
#_01E221: db $54, $17, $0B ; Heart        xyz:{ 0x150, 0x170, U }
#_01E224: db $60, $17, $0B ; Heart        xyz:{ 0x180, 0x170, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0077:
RoomData_PotItems_Room_0078:
RoomData_PotItems_Room_0079:
RoomData_PotItems_Room_007A:
#_01E227: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_007B:
#_01E229: db $3C, $04, $0B ; Heart        xyz:{ 0x0F0, 0x040, U }
#_01E22C: db $40, $04, $08 ; Small key    xyz:{ 0x100, 0x040, U }
#_01E22F: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_007C:
#_01E231: db $1C, $04, $0B ; Heart        xyz:{ 0x070, 0x040, U }
#_01E234: db $20, $04, $0B ; Heart        xyz:{ 0x080, 0x040, U }
#_01E237: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_007D:
#_01E239: db $70, $06, $0B ; Heart        xyz:{ 0x1C0, 0x060, U }
#_01E23C: db $6C, $14, $09 ; 5 arrows     xyz:{ 0x1B0, 0x140, U }
#_01E23F: db $72, $14, $0A ; 1 Bomb       xyz:{ 0x1C8, 0x140, U }
#_01E242: db $4C, $1C, $0A ; 1 Bomb       xyz:{ 0x130, 0x1C0, U }
#_01E245: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_007E:
#_01E247: db $56, $0F, $0B ; Heart        xyz:{ 0x158, 0x0F0, U }
#_01E24A: db $52, $1A, $0C ; Small magic  xyz:{ 0x148, 0x1A0, U }
#_01E24D: db $64, $1A, $88 ; Switch       xyz:{ 0x190, 0x1A0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_007F:
#_01E250: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0080:
#_01E252: db $30, $04, $0B ; Heart        xyz:{ 0x0C0, 0x040, U }
#_01E255: db $34, $04, $0B ; Heart        xyz:{ 0x0D0, 0x040, U }
#_01E258: db $38, $04, $0B ; Heart        xyz:{ 0x0E0, 0x040, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0081:
#_01E25B: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0082:
#_01E25D: db $4C, $32, $0B ; Heart        xyz:{ 0x130, 0x120, L }
#_01E260: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0083:
#_01E262: db $4C, $04, $09 ; 5 arrows     xyz:{ 0x130, 0x040, U }
#_01E265: db $50, $04, $01 ; Green rupee  xyz:{ 0x140, 0x040, U }
#_01E268: db $4C, $1C, $07 ; Blue rupee   xyz:{ 0x130, 0x1C0, U }
#_01E26B: db $50, $1C, $09 ; 5 arrows     xyz:{ 0x140, 0x1C0, U }
#_01E26E: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0084:
#_01E270: db $18, $07, $09 ; 5 arrows     xyz:{ 0x060, 0x070, U }
#_01E273: db $64, $07, $09 ; 5 arrows     xyz:{ 0x190, 0x070, U }
#_01E276: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0085:
#_01E278: db $2C, $1C, $0B ; Heart        xyz:{ 0x0B0, 0x1C0, U }
#_01E27B: db $30, $1C, $09 ; 5 arrows     xyz:{ 0x0C0, 0x1C0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0086:
#_01E27E: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0087:
#_01E280: db $4C, $14, $0C ; Small magic  xyz:{ 0x130, 0x140, U }
#_01E283: db $70, $14, $0D ; Full magic   xyz:{ 0x1C0, 0x140, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0088:
RoomData_PotItems_Room_0089:
RoomData_PotItems_Room_008A:
#_01E286: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_008B:
#_01E288: db $70, $0C, $08 ; Small key    xyz:{ 0x1C0, 0x0C0, U }
#_01E28B: db $20, $09, $0C ; Small magic  xyz:{ 0x080, 0x090, U }
#_01E28E: db $4C, $1C, $0B ; Heart        xyz:{ 0x130, 0x1C0, U }
#_01E291: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_008C:
#_01E293: db $4C, $0C, $88 ; Switch       xyz:{ 0x130, 0x0C0, U }
#_01E296: db $70, $0C, $0C ; Small magic  xyz:{ 0x1C0, 0x0C0, U }
#_01E299: db $4C, $14, $0A ; 1 Bomb       xyz:{ 0x130, 0x140, U }
#_01E29C: db $5C, $14, $0A ; 1 Bomb       xyz:{ 0x170, 0x140, U }
#_01E29F: db $64, $15, $09 ; 5 arrows     xyz:{ 0x190, 0x150, U }
#_01E2A2: db $68, $1A, $0A ; 1 Bomb       xyz:{ 0x1A0, 0x1A0, U }
#_01E2A5: db $58, $1B, $0A ; 1 Bomb       xyz:{ 0x160, 0x1B0, U }
#_01E2A8: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_008D:
#_01E2AA: db $CC, $0E, $0D ; Full magic   xyz:{ 0x130, 0x0E0, U }
#_01E2AD: db $1C, $17, $0B ; Heart        xyz:{ 0x070, 0x170, U }
#_01E2B0: db $24, $17, $0B ; Heart        xyz:{ 0x090, 0x170, U }
#_01E2B3: db $20, $18, $0D ; Full magic   xyz:{ 0x080, 0x180, U }
#_01E2B6: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_008E:
#_01E2B8: db $50, $05, $09 ; 5 arrows     xyz:{ 0x140, 0x050, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_008F:
RoomData_PotItems_Room_0090:
#_01E2BB: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0091:
#_01E2BD: db $54, $04, $0B ; Heart        xyz:{ 0x150, 0x040, U }
#_01E2C0: db $68, $04, $0C ; Small magic  xyz:{ 0x1A0, 0x040, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0092:
#_01E2C3: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0093:
#_01E2C5: db $1C, $07, $88 ; Switch       xyz:{ 0x070, 0x070, U }
#_01E2C8: db $60, $07, $0B ; Heart        xyz:{ 0x180, 0x070, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0094:
RoomData_PotItems_Room_0095:
#_01E2CB: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0096:
#_01E2CD: db $20, $11, $0C ; Small magic  xyz:{ 0x080, 0x110, U }
#_01E2D0: db $20, $18, $0C ; Small magic  xyz:{ 0x080, 0x180, U }
#_01E2D3: db $4C, $15, $0B ; Heart        xyz:{ 0x130, 0x150, U }
#_01E2D6: db $70, $15, $0D ; Full magic   xyz:{ 0x1C0, 0x150, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0097:
RoomData_PotItems_Room_0098:
#_01E2D9: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0099:
#_01E2DB: db $28, $14, $0C ; Small magic  xyz:{ 0x0A0, 0x140, U }
#_01E2DE: db $54, $14, $0B ; Heart        xyz:{ 0x150, 0x140, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_009A:
#_01E2E1: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_009B:
#_01E2E3: db $30, $04, $0C ; Small magic  xyz:{ 0x0C0, 0x040, U }
#_01E2E6: db $30, $0C, $08 ; Small key    xyz:{ 0x0C0, 0x0C0, U }
#_01E2E9: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_009C:
#_01E2EB: db $38, $08, $0C ; Small magic  xyz:{ 0x0E0, 0x080, U }
#_01E2EE: db $38, $09, $09 ; 5 arrows     xyz:{ 0x0E0, 0x090, U }
#_01E2F1: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_009D:
#_01E2F3: db $4C, $04, $0A ; 1 Bomb       xyz:{ 0x130, 0x040, U }
#_01E2F6: db $54, $04, $0C ; Small magic  xyz:{ 0x150, 0x040, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_009E:
#_01E2F9: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_009F:
#_01E2FB: db $8A, $13, $0B ; Heart        xyz:{ 0x028, 0x130, U }
#_01E2FE: db $B2, $13, $0B ; Heart        xyz:{ 0x0C8, 0x130, U }
#_01E301: db $28, $15, $88 ; Switch       xyz:{ 0x0A0, 0x150, U }
#_01E304: db $8A, $15, $08 ; Small key    xyz:{ 0x028, 0x150, U }
#_01E307: db $14, $1B, $0B ; Heart        xyz:{ 0x050, 0x1B0, U }
#_01E30A: db $8A, $1B, $0B ; Heart        xyz:{ 0x028, 0x1B0, U }
#_01E30D: db $B2, $1C, $0B ; Heart        xyz:{ 0x0C8, 0x1C0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00A0:
#_01E310: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00A1:
#_01E312: db $96, $06, $08 ; Small key    xyz:{ 0x058, 0x060, U }
#_01E315: db $64, $0B, $0C ; Small magic  xyz:{ 0x190, 0x0B0, U }
#_01E318: db $68, $0C, $0B ; Heart        xyz:{ 0x1A0, 0x0C0, U }
#_01E31B: db $6C, $0D, $0C ; Small magic  xyz:{ 0x1B0, 0x0D0, U }
#_01E31E: db $70, $0E, $0B ; Heart        xyz:{ 0x1C0, 0x0E0, U }
#_01E321: db $60, $17, $0B ; Heart        xyz:{ 0x180, 0x170, U }
#_01E324: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00A2:
#_01E326: db $0C, $1C, $0D ; Full magic   xyz:{ 0x030, 0x1C0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00A3:
RoomData_PotItems_Room_00A4:
RoomData_PotItems_Room_00A5:
RoomData_PotItems_Room_00A6:
RoomData_PotItems_Room_00A7:
#_01E329: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00A8:
#_01E32B: db $8A, $13, $0B ; Heart        xyz:{ 0x028, 0x130, U }
#_01E32E: db $1E, $18, $01 ; Green rupee  xyz:{ 0x078, 0x180, U }
#_01E331: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00A9:
#_01E333: db $90, $2B, $09 ; 5 arrows     xyz:{ 0x040, 0x0B0, L }
#_01E336: db $EC, $2B, $09 ; 5 arrows     xyz:{ 0x1B0, 0x0B0, L }
#_01E339: db $90, $2C, $09 ; 5 arrows     xyz:{ 0x040, 0x0C0, L }
#_01E33C: db $EC, $2C, $0B ; Heart        xyz:{ 0x1B0, 0x0C0, L }
#_01E33F: db $10, $14, $0B ; Heart        xyz:{ 0x040, 0x140, U }
#_01E342: db $6C, $14, $0B ; Heart        xyz:{ 0x1B0, 0x140, U }
#_01E345: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00AA:
#_01E347: db $D4, $05, $0B ; Heart        xyz:{ 0x150, 0x050, U }
#_01E34A: db $5E, $08, $88 ; Switch       xyz:{ 0x178, 0x080, U }
#_01E34D: db $6C, $37, $0B ; Heart        xyz:{ 0x1B0, 0x170, L }
#_01E350: db $6C, $38, $0B ; Heart        xyz:{ 0x1B0, 0x180, L }
#_01E353: db $6C, $39, $0B ; Heart        xyz:{ 0x1B0, 0x190, L }
#_01E356: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00AB:
#_01E358: db $14, $18, $08 ; Small key    xyz:{ 0x050, 0x180, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00AC:
RoomData_PotItems_Room_00AD:
#_01E35B: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00AE:
#_01E35D: db $4C, $0C, $88 ; Switch       xyz:{ 0x130, 0x0C0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00AF:
#_01E360: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00B0:
#_01E362: db $14, $15, $0A ; 1 Bomb       xyz:{ 0x050, 0x150, U }
#_01E365: db $1C, $15, $01 ; Green rupee  xyz:{ 0x070, 0x150, U }
#_01E368: db $20, $15, $07 ; Blue rupee   xyz:{ 0x080, 0x150, U }
#_01E36B: db $28, $15, $09 ; 5 arrows     xyz:{ 0x0A0, 0x150, U }
#_01E36E: db $10, $17, $07 ; Blue rupee   xyz:{ 0x040, 0x170, U }
#_01E371: db $2C, $17, $01 ; Green rupee  xyz:{ 0x0B0, 0x170, U }
#_01E374: db $24, $18, $0B ; Heart        xyz:{ 0x090, 0x180, U }
#_01E377: db $10, $19, $0B ; Heart        xyz:{ 0x040, 0x190, U }
#_01E37A: db $1C, $1B, $09 ; 5 arrows     xyz:{ 0x070, 0x1B0, U }
#_01E37D: db $28, $1B, $0A ; 1 Bomb       xyz:{ 0x0A0, 0x1B0, U }
#_01E380: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00B1:
#_01E382: db $4C, $04, $0B ; Heart        xyz:{ 0x130, 0x040, U }
#_01E385: db $70, $04, $01 ; Green rupee  xyz:{ 0x1C0, 0x040, U }
#_01E388: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00B2:
#_01E38A: db $30, $28, $01 ; Green rupee  xyz:{ 0x0C0, 0x080, L }
#_01E38D: db $4C, $28, $01 ; Green rupee  xyz:{ 0x130, 0x080, L }
#_01E390: db $4C, $29, $0B ; Heart        xyz:{ 0x130, 0x090, L }
#_01E393: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00B3:
#_01E395: db $0C, $14, $08 ; Small key    xyz:{ 0x030, 0x140, U }
#_01E398: db $30, $14, $0C ; Small magic  xyz:{ 0x0C0, 0x140, U }
#_01E39B: db $30, $1C, $88 ; Switch       xyz:{ 0x0C0, 0x1C0, U }
#_01E39E: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00B4:
#_01E3A0: db $2C, $1C, $0D ; Full magic   xyz:{ 0x0B0, 0x1C0, U }
#_01E3A3: db $30, $1C, $0B ; Heart        xyz:{ 0x0C0, 0x1C0, U }
#_01E3A6: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00B5:
#_01E3A8: db $70, $04, $07 ; Blue rupee   xyz:{ 0x1C0, 0x040, U }
#_01E3AB: db $70, $0F, $0B ; Heart        xyz:{ 0x1C0, 0x0F0, U }
#_01E3AE: db $4C, $10, $88 ; Switch       xyz:{ 0x130, 0x100, U }
#_01E3B1: db $70, $10, $0D ; Full magic   xyz:{ 0x1C0, 0x100, U }
#_01E3B4: db $70, $11, $0B ; Heart        xyz:{ 0x1C0, 0x110, U }
#_01E3B7: db $70, $1C, $0A ; 1 Bomb       xyz:{ 0x1C0, 0x1C0, U }
#_01E3BA: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00B6:
#_01E3BC: db $5E, $09, $0D ; Full magic   xyz:{ 0x178, 0x090, U }
#_01E3BF: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00B7:
#_01E3C1: db $1E, $05, $0C ; Small magic  xyz:{ 0x078, 0x050, U }
#_01E3C4: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00B8:
#_01E3C6: db $60, $0D, $88 ; Switch       xyz:{ 0x180, 0x0D0, U }
#_01E3C9: db $58, $10, $0B ; Heart        xyz:{ 0x160, 0x100, U }
#_01E3CC: db $68, $10, $0B ; Heart        xyz:{ 0x1A0, 0x100, U }
#_01E3CF: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00B9:
#_01E3D1: db $5C, $12, $01 ; Green rupee  xyz:{ 0x170, 0x120, U }
#_01E3D4: db $60, $12, $07 ; Blue rupee   xyz:{ 0x180, 0x120, U }
#_01E3D7: db $68, $12, $07 ; Blue rupee   xyz:{ 0x1A0, 0x120, U }
#_01E3DA: db $6C, $12, $01 ; Green rupee  xyz:{ 0x1B0, 0x120, U }
#_01E3DD: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00BA:
#_01E3DF: db $5E, $04, $01 ; Green rupee  xyz:{ 0x178, 0x040, U }
#_01E3E2: db $4C, $06, $0B ; Heart        xyz:{ 0x130, 0x060, U }
#_01E3E5: db $70, $06, $08 ; Small key    xyz:{ 0x1C0, 0x060, U }
#_01E3E8: db $4C, $0A, $0B ; Heart        xyz:{ 0x130, 0x0A0, U }
#_01E3EB: db $70, $0A, $0C ; Small magic  xyz:{ 0x1C0, 0x0A0, U }
#_01E3EE: db $5E, $0C, $01 ; Green rupee  xyz:{ 0x178, 0x0C0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00BB:
#_01E3F1: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00BC:
#_01E3F3: db $8A, $03, $0A ; 1 Bomb       xyz:{ 0x028, 0x030, U }
#_01E3F6: db $B2, $03, $88 ; Switch       xyz:{ 0x0C8, 0x030, U }
#_01E3F9: db $56, $04, $0B ; Heart        xyz:{ 0x158, 0x040, U }
#_01E3FC: db $66, $04, $08 ; Small key    xyz:{ 0x198, 0x040, U }
#_01E3FF: db $8A, $0C, $0B ; Heart        xyz:{ 0x028, 0x0C0, U }
#_01E402: db $B2, $0C, $0A ; 1 Bomb       xyz:{ 0x0C8, 0x0C0, U }
#_01E405: db $30, $14, $0A ; 1 Bomb       xyz:{ 0x0C0, 0x140, U }
#_01E408: db $1C, $15, $07 ; Blue rupee   xyz:{ 0x070, 0x150, U }
#_01E40B: db $20, $15, $07 ; Blue rupee   xyz:{ 0x080, 0x150, U }
#_01E40E: db $1C, $1B, $07 ; Blue rupee   xyz:{ 0x070, 0x1B0, U }
#_01E411: db $20, $1B, $07 ; Blue rupee   xyz:{ 0x080, 0x1B0, U }
#_01E414: db $0C, $1C, $0A ; 1 Bomb       xyz:{ 0x030, 0x1C0, U }
#_01E417: db $30, $1C, $0A ; 1 Bomb       xyz:{ 0x0C0, 0x1C0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00BD:
#_01E41A: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00BE:
#_01E41C: db $5C, $19, $88 ; Switch       xyz:{ 0x170, 0x190, U }
#_01E41F: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00BF:
#_01E421: db $28, $14, $09 ; 5 arrows     xyz:{ 0x0A0, 0x140, U }
#_01E424: db $2C, $14, $0B ; Heart        xyz:{ 0x0B0, 0x140, U }
#_01E427: db $30, $14, $0A ; 1 Bomb       xyz:{ 0x0C0, 0x140, U }
#_01E42A: db $28, $1C, $0C ; Small magic  xyz:{ 0x0A0, 0x1C0, U }
#_01E42D: db $2C, $1C, $0C ; Small magic  xyz:{ 0x0B0, 0x1C0, U }
#_01E430: db $30, $1C, $0C ; Small magic  xyz:{ 0x0C0, 0x1C0, U }
#_01E433: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00C0:
#_01E435: db $30, $0A, $0A ; 1 Bomb       xyz:{ 0x0C0, 0x0A0, U }
#_01E438: db $0C, $0E, $07 ; Blue rupee   xyz:{ 0x030, 0x0E0, U }
#_01E43B: db $0C, $1A, $0B ; Heart        xyz:{ 0x030, 0x1A0, U }
#_01E43E: db $1C, $1B, $01 ; Green rupee  xyz:{ 0x070, 0x1B0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00C1:
#_01E441: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00C2:
#_01E443: db $B4, $07, $88 ; Switch       xyz:{ 0x0D0, 0x070, U }
#_01E446: db $64, $2E, $0C ; Small magic  xyz:{ 0x190, 0x0E0, L }
#_01E449: db $44, $30, $01 ; Green rupee  xyz:{ 0x110, 0x100, L }
#_01E44C: db $40, $34, $09 ; 5 arrows     xyz:{ 0x100, 0x140, L }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00C3:
#_01E44F: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00C4:
#_01E451: db $54, $09, $0A ; 1 Bomb       xyz:{ 0x150, 0x090, U }
#_01E454: db $18, $0E, $0B ; Heart        xyz:{ 0x060, 0x0E0, U }
#_01E457: db $38, $11, $07 ; Blue rupee   xyz:{ 0x0E0, 0x110, U }
#_01E45A: db $54, $11, $0A ; 1 Bomb       xyz:{ 0x150, 0x110, U }
#_01E45D: db $0C, $15, $09 ; 5 arrows     xyz:{ 0x030, 0x150, U }
#_01E460: db $4C, $17, $01 ; Green rupee  xyz:{ 0x130, 0x170, U }
#_01E463: db $30, $19, $0C ; Small magic  xyz:{ 0x0C0, 0x190, U }
#_01E466: db $0C, $1A, $0B ; Heart        xyz:{ 0x030, 0x1A0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00C5:
#_01E469: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00C6:
#_01E46B: db $0C, $07, $0D ; Full magic   xyz:{ 0x030, 0x070, U }
#_01E46E: db $0C, $19, $0B ; Heart        xyz:{ 0x030, 0x190, U }
#_01E471: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00C7:
#_01E473: db $0C, $0A, $0B ; Heart        xyz:{ 0x030, 0x0A0, U }
#_01E476: db $0C, $0B, $0D ; Full magic   xyz:{ 0x030, 0x0B0, U }
#_01E479: db $0C, $16, $0C ; Small magic  xyz:{ 0x030, 0x160, U }
#_01E47C: db $0C, $1C, $09 ; 5 arrows     xyz:{ 0x030, 0x1C0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00C8:
#_01E47F: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00C9:
#_01E481: db $1E, $16, $01 ; Green rupee  xyz:{ 0x078, 0x160, U }
#_01E484: db $5E, $16, $01 ; Green rupee  xyz:{ 0x178, 0x160, U }
#_01E487: db $3C, $16, $88 ; Switch       xyz:{ 0x0F0, 0x160, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00CA:
#_01E48A: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00CB:
#_01E48C: db $58, $10, $0B ; Heart        xyz:{ 0x160, 0x100, U }
#_01E48F: db $58, $1C, $07 ; Blue rupee   xyz:{ 0x160, 0x1C0, U }
#_01E492: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00CC:
#_01E494: db $24, $04, $07 ; Blue rupee   xyz:{ 0x090, 0x040, U }
#_01E497: db $70, $04, $0B ; Heart        xyz:{ 0x1C0, 0x040, U }
#_01E49A: db $24, $1C, $07 ; Blue rupee   xyz:{ 0x090, 0x1C0, U }
#_01E49D: db $70, $1C, $0A ; 1 Bomb       xyz:{ 0x1C0, 0x1C0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00CD:
#_01E4A0: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00CE:
#_01E4A2: db $4C, $08, $0C ; Small magic  xyz:{ 0x130, 0x080, U }
#_01E4A5: db $50, $08, $0C ; Small magic  xyz:{ 0x140, 0x080, U }
#_01E4A8: db $6C, $0C, $0A ; 1 Bomb       xyz:{ 0x1B0, 0x0C0, U }
#_01E4AB: db $70, $0C, $09 ; 5 arrows     xyz:{ 0x1C0, 0x0C0, U }
#_01E4AE: db $CC, $0B, $80 ; Hole         xyz:{ 0x130, 0x0B0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00CF:
#_01E4B1: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00D0:
#_01E4B3: db $9E, $05, $0C ; Small magic  xyz:{ 0x078, 0x050, U }
#_01E4B6: db $8C, $0B, $01 ; Green rupee  xyz:{ 0x030, 0x0B0, U }
#_01E4B9: db $2A, $0D, $0C ; Small magic  xyz:{ 0x0A8, 0x0D0, U }
#_01E4BC: db $30, $10, $0B ; Heart        xyz:{ 0x0C0, 0x100, U }
#_01E4BF: db $B0, $14, $01 ; Green rupee  xyz:{ 0x0C0, 0x140, U }
#_01E4C2: db $92, $17, $07 ; Blue rupee   xyz:{ 0x048, 0x170, U }
#_01E4C5: db $0C, $1C, $0B ; Heart        xyz:{ 0x030, 0x1C0, U }
#_01E4C8: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00D1:
#_01E4CA: db $30, $04, $0D ; Full magic   xyz:{ 0x0C0, 0x040, U }
#_01E4CD: db $4C, $04, $01 ; Green rupee  xyz:{ 0x130, 0x040, U }
#_01E4D0: db $70, $04, $09 ; 5 arrows     xyz:{ 0x1C0, 0x040, U }
#_01E4D3: db $A8, $07, $01 ; Green rupee  xyz:{ 0x0A0, 0x070, U }
#_01E4D6: db $70, $0C, $01 ; Green rupee  xyz:{ 0x1C0, 0x0C0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00D2:
RoomData_PotItems_Room_00D3:
RoomData_PotItems_Room_00D4:
RoomData_PotItems_Room_00D5:
#_01E4D9: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00D6:
#_01E4DB: db $5C, $16, $0D ; Full magic   xyz:{ 0x170, 0x160, U }
#_01E4DE: db $60, $16, $0A ; 1 Bomb       xyz:{ 0x180, 0x160, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00D7:
#_01E4E1: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00D8:
#_01E4E3: db $CA, $08, $0B ; Heart        xyz:{ 0x128, 0x080, U }
#_01E4E6: db $F2, $08, $09 ; 5 arrows     xyz:{ 0x1C8, 0x080, U }
#_01E4E9: db $CA, $0A, $09 ; 5 arrows     xyz:{ 0x128, 0x0A0, U }
#_01E4EC: db $F2, $0A, $09 ; 5 arrows     xyz:{ 0x1C8, 0x0A0, U }
#_01E4EF: db $CA, $0C, $09 ; 5 arrows     xyz:{ 0x128, 0x0C0, U }
#_01E4F2: db $F2, $0C, $0B ; Heart        xyz:{ 0x1C8, 0x0C0, U }
#_01E4F5: db $5C, $18, $0B ; Heart        xyz:{ 0x170, 0x180, U }
#_01E4F8: db $60, $18, $09 ; 5 arrows     xyz:{ 0x180, 0x180, U }
#_01E4FB: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00D9:
#_01E4FD: db $5C, $14, $09 ; 5 arrows     xyz:{ 0x170, 0x140, U }
#_01E500: db $5C, $1C, $0B ; Heart        xyz:{ 0x170, 0x1C0, U }
#_01E503: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00DA:
#_01E505: db $18, $17, $09 ; 5 arrows     xyz:{ 0x060, 0x170, U }
#_01E508: db $24, $17, $09 ; 5 arrows     xyz:{ 0x090, 0x170, U }
#_01E50B: db $18, $19, $88 ; Switch       xyz:{ 0x060, 0x190, U }
#_01E50E: db $24, $19, $0B ; Heart        xyz:{ 0x090, 0x190, U }
#_01E511: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00DB:
#_01E513: db $70, $04, $07 ; Blue rupee   xyz:{ 0x1C0, 0x040, U }
#_01E516: db $58, $10, $0B ; Heart        xyz:{ 0x160, 0x100, U }
#_01E519: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00DC:
#_01E51B: db $38, $04, $07 ; Blue rupee   xyz:{ 0x0E0, 0x040, U }
#_01E51E: db $70, $04, $0A ; 1 Bomb       xyz:{ 0x1C0, 0x040, U }
#_01E521: db $44, $10, $0B ; Heart        xyz:{ 0x110, 0x100, U }
#_01E524: db $0C, $1C, $09 ; 5 arrows     xyz:{ 0x030, 0x1C0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00DD:
RoomData_PotItems_Room_00DE:
RoomData_PotItems_Room_00DF:
#_01E527: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00E0:
#_01E529: db $18, $08, $0B ; Heart        xyz:{ 0x060, 0x080, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00E1:
RoomData_PotItems_Room_00E2:
#_01E52C: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00E3:
#_01E52E: db $64, $39, $01 ; Green rupee  xyz:{ 0x190, 0x190, L }
#_01E531: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00E4:
#_01E533: db $20, $09, $07 ; Blue rupee   xyz:{ 0x080, 0x090, U }
#_01E536: db $70, $0A, $01 ; Green rupee  xyz:{ 0x1C0, 0x0A0, U }
#_01E539: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00E5:
#_01E53B: db $30, $04, $01 ; Green rupee  xyz:{ 0x0C0, 0x040, U }
#_01E53E: db $4C, $04, $01 ; Green rupee  xyz:{ 0x130, 0x040, U }
#_01E541: db $70, $10, $01 ; Green rupee  xyz:{ 0x1C0, 0x100, U }
#_01E544: db $40, $12, $07 ; Blue rupee   xyz:{ 0x100, 0x120, U }
#_01E547: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00E6:
#_01E549: db $6C, $0C, $09 ; 5 arrows     xyz:{ 0x1B0, 0x0C0, U }
#_01E54C: db $58, $10, $0B ; Heart        xyz:{ 0x160, 0x100, U }
#_01E54F: db $38, $18, $01 ; Green rupee  xyz:{ 0x0E0, 0x180, U }
#_01E552: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00E7:
#_01E554: db $44, $05, $01 ; Green rupee  xyz:{ 0x110, 0x050, U }
#_01E557: db $48, $05, $01 ; Green rupee  xyz:{ 0x120, 0x050, U }
#_01E55A: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00E8:
#_01E55C: db $60, $04, $0B ; Heart        xyz:{ 0x180, 0x040, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00E9:
RoomData_PotItems_Room_00EA:
#_01E55F: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00EB:
#_01E561: db $CE, $08, $07 ; Blue rupee   xyz:{ 0x138, 0x080, U }
#_01E564: db $D2, $08, $07 ; Blue rupee   xyz:{ 0x148, 0x080, U }
#_01E567: db $58, $0E, $0C ; Small magic  xyz:{ 0x160, 0x0E0, U }
#_01E56A: db $5C, $0E, $0B ; Heart        xyz:{ 0x170, 0x0E0, U }
#_01E56D: db $60, $0E, $0C ; Small magic  xyz:{ 0x180, 0x0E0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00EC:
RoomData_PotItems_Room_00ED:
RoomData_PotItems_Room_00EE:
RoomData_PotItems_Room_00EF:
RoomData_PotItems_Room_00F0:
#_01E570: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00F1:
#_01E572: db $40, $05, $0B ; Heart        xyz:{ 0x100, 0x050, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00F2:
RoomData_PotItems_Room_00F3:
RoomData_PotItems_Room_00F4:
RoomData_PotItems_Room_00F5:
RoomData_PotItems_Room_00F6:
RoomData_PotItems_Room_00F7:
#_01E575: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00F8:
#_01E577: db $F2, $0D, $0D ; Full magic   xyz:{ 0x1C8, 0x0D0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00F9:
RoomData_PotItems_Room_00FA:
RoomData_PotItems_Room_00FB:
RoomData_PotItems_Room_00FC:
#_01E57A: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00FD:
#_01E57C: db $58, $06, $07 ; Blue rupee   xyz:{ 0x160, 0x060, U }
#_01E57F: db $64, $06, $07 ; Blue rupee   xyz:{ 0x190, 0x060, U }
#_01E582: db $54, $17, $07 ; Blue rupee   xyz:{ 0x150, 0x170, U }
#_01E585: db $54, $18, $07 ; Blue rupee   xyz:{ 0x150, 0x180, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00FE:
#_01E588: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_00FF:
#_01E58A: db $5C, $08, $0B ; Heart        xyz:{ 0x170, 0x080, U }
#_01E58D: db $60, $08, $0B ; Heart        xyz:{ 0x180, 0x080, U }
#_01E590: db $70, $1C, $01 ; Green rupee  xyz:{ 0x1C0, 0x1C0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0100:
#_01E593: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0101:
#_01E595: db $0C, $14, $0B ; Heart        xyz:{ 0x030, 0x140, U }
#_01E598: db $E0, $13, $0E ; Cucco        xyz:{ 0x180, 0x130, U }
#_01E59B: db $E4, $13, $0B ; Heart        xyz:{ 0x190, 0x130, U }
#_01E59E: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0102:
#_01E5A0: db $92, $13, $0B ; Heart        xyz:{ 0x048, 0x130, U }
#_01E5A3: db $96, $13, $0B ; Heart        xyz:{ 0x058, 0x130, U }
#_01E5A6: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0103:
#_01E5A8: db $8C, $07, $0E ; Cucco        xyz:{ 0x030, 0x070, U }
#_01E5AB: db $0C, $0C, $0B ; Heart        xyz:{ 0x030, 0x0C0, U }
#_01E5AE: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0104:
#_01E5B0: db $CA, $15, $0B ; Heart        xyz:{ 0x128, 0x150, U }
#_01E5B3: db $CA, $16, $0B ; Heart        xyz:{ 0x128, 0x160, U }
#_01E5B6: db $CA, $17, $0B ; Heart        xyz:{ 0x128, 0x170, U }
#_01E5B9: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0105:
#_01E5BB: db $1E, $14, $0B ; Heart        xyz:{ 0x078, 0x140, U }
#_01E5BE: db $1C, $15, $0B ; Heart        xyz:{ 0x070, 0x150, U }
#_01E5C1: db $20, $15, $0B ; Heart        xyz:{ 0x080, 0x150, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0106:
#_01E5C4: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0107:
#_01E5C6: db $D6, $17, $0A ; 1 Bomb       xyz:{ 0x158, 0x170, U }
#_01E5C9: db $DE, $17, $09 ; 5 arrows     xyz:{ 0x178, 0x170, U }
#_01E5CC: db $E6, $17, $0A ; 1 Bomb       xyz:{ 0x198, 0x170, U }
#_01E5CF: db $D6, $19, $01 ; Green rupee  xyz:{ 0x158, 0x190, U }
#_01E5D2: db $E6, $19, $01 ; Green rupee  xyz:{ 0x198, 0x190, U }
#_01E5D5: db $D6, $1B, $0A ; 1 Bomb       xyz:{ 0x158, 0x1B0, U }
#_01E5D8: db $E6, $1B, $0A ; 1 Bomb       xyz:{ 0x198, 0x1B0, U }
#_01E5DB: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0108:
#_01E5DD: db $A6, $13, $0E ; Cucco        xyz:{ 0x098, 0x130, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0109:
RoomData_PotItems_Room_010A:
RoomData_PotItems_Room_010B:
#_01E5E0: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_010C:
#_01E5E2: db $58, $0E, $0B ; Heart        xyz:{ 0x160, 0x0E0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_010D:
RoomData_PotItems_Room_010E:
RoomData_PotItems_Room_010F:
RoomData_PotItems_Room_0110:
RoomData_PotItems_Room_0111:
RoomData_PotItems_Room_0112:
RoomData_PotItems_Room_0113:
#_01E5E5: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0114:
#_01E5E7: db $5C, $04, $0B ; Heart        xyz:{ 0x170, 0x040, U }
#_01E5EA: db $60, $04, $0B ; Heart        xyz:{ 0x180, 0x040, U }
#_01E5ED: db $5C, $05, $0A ; 1 Bomb       xyz:{ 0x170, 0x050, U }
#_01E5F0: db $60, $05, $0A ; 1 Bomb       xyz:{ 0x180, 0x050, U }
#_01E5F3: db $5C, $0A, $09 ; 5 arrows     xyz:{ 0x170, 0x0A0, U }
#_01E5F6: db $60, $0A, $0B ; Heart        xyz:{ 0x180, 0x0A0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0115:
RoomData_PotItems_Room_0116:
#_01E5F9: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0117:
#_01E5FB: db $8A, $03, $0B ; Heart        xyz:{ 0x028, 0x030, U }
#_01E5FE: db $8E, $03, $0B ; Heart        xyz:{ 0x038, 0x030, U }
#_01E601: db $A6, $03, $0B ; Heart        xyz:{ 0x098, 0x030, U }
#_01E604: db $AA, $03, $0B ; Heart        xyz:{ 0x0A8, 0x030, U }
#_01E607: db $8A, $04, $0B ; Heart        xyz:{ 0x028, 0x040, U }
#_01E60A: db $8E, $04, $0B ; Heart        xyz:{ 0x038, 0x040, U }
#_01E60D: db $A6, $04, $0B ; Heart        xyz:{ 0x098, 0x040, U }
#_01E610: db $AA, $04, $0B ; Heart        xyz:{ 0x0A8, 0x040, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0118:
#_01E613: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0119:
#_01E615: db $2C, $1C, $0B ; Heart        xyz:{ 0x0B0, 0x1C0, U }
#_01E618: db $30, $1C, $01 ; Green rupee  xyz:{ 0x0C0, 0x1C0, U }
#_01E61B: db $4C, $1C, $0B ; Heart        xyz:{ 0x130, 0x1C0, U }
#_01E61E: db $50, $1C, $0B ; Heart        xyz:{ 0x140, 0x1C0, U }
#_01E621: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_011A:
#_01E623: db $D6, $0A, $0B ; Heart        xyz:{ 0x158, 0x0A0, U }
#_01E626: db $DA, $0A, $0B ; Heart        xyz:{ 0x168, 0x0A0, U }
#_01E629: db $E2, $0A, $0B ; Heart        xyz:{ 0x188, 0x0A0, U }
#_01E62C: db $E6, $0A, $0B ; Heart        xyz:{ 0x198, 0x0A0, U }
#_01E62F: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_011B:
#_01E631: db $18, $36, $0B ; Heart        xyz:{ 0x060, 0x160, L }
#_01E634: db $20, $36, $0B ; Heart        xyz:{ 0x080, 0x160, L }
#_01E637: db $28, $36, $0B ; Heart        xyz:{ 0x0A0, 0x160, L }
#_01E63A: db $5C, $16, $0A ; 1 Bomb       xyz:{ 0x170, 0x160, U }
#_01E63D: db $60, $16, $0B ; Heart        xyz:{ 0x180, 0x160, U }
#_01E640: db $18, $37, $0B ; Heart        xyz:{ 0x060, 0x170, L }
#_01E643: db $5C, $17, $0A ; 1 Bomb       xyz:{ 0x170, 0x170, U }
#_01E646: db $60, $17, $0B ; Heart        xyz:{ 0x180, 0x170, U }
#_01E649: db $1C, $38, $0B ; Heart        xyz:{ 0x070, 0x180, L }
#_01E64C: db $5C, $18, $0A ; 1 Bomb       xyz:{ 0x170, 0x180, U }
#_01E64F: db $60, $18, $0B ; Heart        xyz:{ 0x180, 0x180, U }
#_01E652: db $5C, $19, $0A ; 1 Bomb       xyz:{ 0x170, 0x190, U }
#_01E655: db $60, $19, $0B ; Heart        xyz:{ 0x180, 0x190, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_011C:
#_01E658: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_011D:
#_01E65A: db $3C, $06, $07 ; Blue rupee   xyz:{ 0x0F0, 0x060, U }
#_01E65D: db $40, $06, $07 ; Blue rupee   xyz:{ 0x100, 0x060, U }
#_01E660: db $3C, $07, $07 ; Blue rupee   xyz:{ 0x0F0, 0x070, U }
#_01E663: db $40, $07, $07 ; Blue rupee   xyz:{ 0x100, 0x070, U }
#_01E666: db $3C, $08, $07 ; Blue rupee   xyz:{ 0x0F0, 0x080, U }
#_01E669: db $40, $08, $07 ; Blue rupee   xyz:{ 0x100, 0x080, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_011E:
#_01E66C: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_011F:
#_01E66E: db $AE, $1C, $0B ; Heart        xyz:{ 0x0B8, 0x1C0, U }
#_01E671: db $B2, $1C, $0B ; Heart        xyz:{ 0x0C8, 0x1C0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0120:
RoomData_PotItems_Room_0121:
RoomData_PotItems_Room_0122:
RoomData_PotItems_Room_0123:
#_01E674: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0124:
#_01E676: db $14, $14, $07 ; Blue rupee   xyz:{ 0x050, 0x140, U }
#_01E679: db $28, $14, $07 ; Blue rupee   xyz:{ 0x0A0, 0x140, U }
#_01E67C: db $14, $15, $07 ; Blue rupee   xyz:{ 0x050, 0x150, U }
#_01E67F: db $28, $15, $07 ; Blue rupee   xyz:{ 0x0A0, 0x150, U }
#_01E682: db $14, $16, $07 ; Blue rupee   xyz:{ 0x050, 0x160, U }
#_01E685: db $28, $16, $07 ; Blue rupee   xyz:{ 0x0A0, 0x160, U }
#_01E688: db $18, $18, $07 ; Blue rupee   xyz:{ 0x060, 0x180, U }
#_01E68B: db $1C, $18, $07 ; Blue rupee   xyz:{ 0x070, 0x180, U }
#_01E68E: db $20, $18, $07 ; Blue rupee   xyz:{ 0x080, 0x180, U }
#_01E691: db $24, $18, $07 ; Blue rupee   xyz:{ 0x090, 0x180, U }
#_01E694: dw $FFFF

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0125:
#_01E696: db $18, $19, $07 ; Blue rupee   xyz:{ 0x060, 0x190, U }
#_01E699: db $1C, $19, $07 ; Blue rupee   xyz:{ 0x070, 0x190, U }
#_01E69C: db $20, $19, $07 ; Blue rupee   xyz:{ 0x080, 0x190, U }
#_01E69F: db $24, $19, $07 ; Blue rupee   xyz:{ 0x090, 0x190, U }
#_01E6A2: db $58, $16, $0B ; Heart        xyz:{ 0x160, 0x160, U }
#_01E6A5: db $64, $16, $0B ; Heart        xyz:{ 0x190, 0x160, U }
#_01E6A8: db $58, $1C, $0B ; Heart        xyz:{ 0x160, 0x1C0, U }
#_01E6AB: db $64, $1C, $0B ; Heart        xyz:{ 0x190, 0x1C0, U }

;---------------------------------------------------------------------------------------------------

RoomData_PotItems_Room_0126:
RoomData_PotItems_Room_0127:
RoomData_PotItems_Room_0128:
RoomData_PotItems_Room_0129:
RoomData_PotItems_Room_012A:
RoomData_PotItems_Room_012B:
RoomData_PotItems_Room_012C:
RoomData_PotItems_Room_012D:
RoomData_PotItems_Room_012E:
RoomData_PotItems_Room_012F:
RoomData_PotItems_Room_0130:
RoomData_PotItems_Room_0131:
RoomData_PotItems_Room_0132:
RoomData_PotItems_Room_0133:
RoomData_PotItems_Room_0134:
RoomData_PotItems_Room_0135:
RoomData_PotItems_Room_0136:
RoomData_PotItems_Room_0137:
RoomData_PotItems_Room_0138:
RoomData_PotItems_Room_0139:
RoomData_PotItems_Room_013A:
RoomData_PotItems_Room_013B:
RoomData_PotItems_Room_013C:
RoomData_PotItems_Room_013D:
RoomData_PotItems_Room_013E:
RoomData_PotItems_Room_013F:
#_01E6AE: dw $FFFF

;===================================================================================================

RevealPotItem:
#_01E6B0: STA.b $04

#_01E6B2: LDA.w $0B9C
#_01E6B5: AND.w #$FF00
#_01E6B8: STA.w $0B9C

#_01E6BB: LDA.b $A0
#_01E6BD: ASL A
#_01E6BE: TAX

#_01E6BF: LDA.l RoomData_PotItems_Pointers,X
#_01E6C3: STA.b $00

#_01E6C5: LDA.w #RoomData_PotItems_Pointers>>16
#_01E6C8: STA.b $02

#_01E6CA: LDY.w #$FFFD
#_01E6CD: LDX.w #$FFFF

.check_next
#_01E6D0: INY
#_01E6D1: INY
#_01E6D2: INY

#_01E6D3: LDA.b [$00],Y
#_01E6D5: CMP.w #$FFFF
#_01E6D8: BEQ .exit

#_01E6DA: INX

; do our coordinates match?
#_01E6DB: AND.w #$7FFF
#_01E6DE: CMP.b $04
#_01E6E0: BNE .check_next

#_01E6E2: INY
#_01E6E3: INY

#_01E6E4: LDA.b [$00],Y
#_01E6E6: AND.w #$00FF
#_01E6E9: BEQ .exit

#_01E6EB: CMP.w #$0080
#_01E6EE: BCS .reveal_tile

;---------------------------------------------------------------------------------------------------

#_01E6F0: STA.b $0E

#_01E6F2: CMP.w #$0008
#_01E6F5: BEQ .is_key

#_01E6F7: TXY

#_01E6F8: LDA.b $A0
#_01E6FA: ASL A
#_01E6FB: TAX

#_01E6FC: STZ.b $00

#_01E6FE: SEC

.shift_it
#_01E6FF: ROL.b $00

#_01E701: DEY
#_01E702: BPL .shift_it

;---------------------------------------------------------------------------------------------------

#_01E704: LDA.l $7EF580,X
#_01E708: AND.b $00
#_01E70A: BNE .exit

#_01E70C: LDA.l $7EF580,X
#_01E710: ORA.b $00
#_01E712: STA.l $7EF580,X

#_01E716: LDA.b $0E

;---------------------------------------------------------------------------------------------------

.is_key
#_01E718: TSB.w $0B9C

.exit
#_01E71B: RTS

;---------------------------------------------------------------------------------------------------

.reveal_tile
#_01E71C: CMP.w #$0088
#_01E71F: BEQ .reveal_switch

#_01E721: LDX.b $06

#_01E723: LDA.l $7F2000,X
#_01E727: AND.w #$000F
#_01E72A: ASL A
#_01E72B: TAY

#_01E72C: LDA.w $0500,Y
#_01E72F: AND.w #$000F
#_01E732: ASL A
#_01E733: STA.b $00

#_01E735: TYA
#_01E736: SEC
#_01E737: SBC.b $00
#_01E739: STA.w $042C

#_01E73C: TAY

#_01E73D: LDA.w #$0004
#_01E740: STA.b $00

#_01E742: SEP #$20

#_01E744: LDA.b #!SFX3_1B
#_01E746: STA.w $012F

;---------------------------------------------------------------------------------------------------

#_01E749: REP #$20

#_01E74B: LDX.w #$05BA

.draw_next
#_01E74E: LDA.l RoomDrawObjectData+0,X
#_01E752: STA.w $0560,Y

#_01E755: LDA.l RoomDrawObjectData+2,X
#_01E759: STA.w $0580,Y

#_01E75C: LDA.l RoomDrawObjectData+4,X
#_01E760: STA.w $05A0,Y

#_01E763: LDA.l RoomDrawObjectData+6,X
#_01E767: STA.w $05C0,Y

#_01E76A: TXA
#_01E76B: CLC
#_01E76C: ADC.w #$0008
#_01E76F: TAX

#_01E770: INY
#_01E771: INY

#_01E772: DEC.b $00
#_01E774: BNE .draw_next

#_01E776: RTS

;---------------------------------------------------------------------------------------------------

.reveal_switch
#_01E777: LDY.w $042C

#_01E77A: LDA.w #$0D0B
#_01E77D: STA.w $0560,Y

#_01E780: LDA.w #$0D1B
#_01E783: STA.w $0580,Y

#_01E786: LDA.w #$4D0B
#_01E789: STA.w $05A0,Y

#_01E78C: LDA.w #$4D1B
#_01E78F: STA.w $05C0,Y

#_01E792: RTS

;===================================================================================================

pool Underworld_UpdateTileMapWithCommonTile

.replacement_tiles
#_01E793: dw $00E0 ; Y=00 - TODO ???
#_01E795: dw $0ADE ; Y=02 - Spike
#_01E797: dw $05AA ; Y=04 - Pit
#_01E799: dw $0198 ; Y=06 - Under the linoleum
#_01E79B: dw $0210 ; Y=08 - Freezor hole left
#_01E79D: dw $0218 ; Y=0A - Freezor hole right
#_01E79F: dw $1F3A ; Y=0C - Warp
#_01E7A1: dw $0EAA ; Y=0E - Pressure switch up
#_01E7A3: dw $0EB2 ; Y=10 - Pressure switch down
#_01E7A5: dw $0140 ; Y=12 - Trinexx Ice

pool off

;---------------------------------------------------------------------------------------------------

Underworld_UpdateTileMapWithCommonTile:
#_01E7A7: PHX

#_01E7A8: STY.b $0E
#_01E7AA: STZ.b $0F

#_01E7AC: PHB

#_01E7AD: LDA.b #$00
#_01E7AF: PHA
#_01E7B0: PLB

#_01E7B1: REP #$30

#_01E7B3: LDA.b $0E
#_01E7B5: CMP.w #$0008
#_01E7B8: BNE .not_freezor_hole

; Do right freezor hole first
#_01E7BA: PHA

#_01E7BB: INC A
#_01E7BC: INC A
#_01E7BD: STA.b $0E

#_01E7BF: LDA.b $00
#_01E7C1: PHA

#_01E7C2: CLC
#_01E7C3: ADC.w #$0010
#_01E7C6: STA.b $00

#_01E7C8: JSR .replace_tile

#_01E7CB: PLA
#_01E7CC: STA.b $00

#_01E7CE: PLA
#_01E7CF: STA.b $0E

;---------------------------------------------------------------------------------------------------

.not_freezor_hole
#_01E7D1: JSR .replace_tile

#_01E7D4: SEP #$30

#_01E7D6: LDA.b #$01
#_01E7D8: STA.b $14

#_01E7DA: PLB
#_01E7DB: PLX

#_01E7DC: RTL

;---------------------------------------------------------------------------------------------------

.replace_tile
#_01E7DD: LDA.b $02
#_01E7DF: INC A
#_01E7E0: AND.w #$01F8

#_01E7E3: ASL A ; x8
#_01E7E4: ASL A
#_01E7E5: ASL A

#_01E7E6: STA.b $06

#_01E7E8: LDA.b $00
#_01E7EA: AND.w #$01F8

#_01E7ED: LSR A ; /8
#_01E7EE: LSR A
#_01E7EF: LSR A

#_01E7F0: ORA.b $06
#_01E7F2: ASL A
#_01E7F3: STA.b $06

;---------------------------------------------------------------------------------------------------

#_01E7F5: LDX.b $0E

#_01E7F7: LDA.l .replacement_tiles,X
#_01E7FB: TAY

#_01E7FC: LDX.w $1000

#_01E7FF: LDA.w RoomDrawObjectData+0,Y
#_01E802: STA.w $1006,X

#_01E805: LDA.w RoomDrawObjectData+2,Y
#_01E808: STA.w $100C,X

#_01E80B: LDA.w RoomDrawObjectData+4,Y
#_01E80E: STA.w $1012,X

#_01E811: LDA.w RoomDrawObjectData+6,Y
#_01E814: STA.w $1018,X

#_01E817: LDX.b $06

#_01E819: LDA.w RoomDrawObjectData+0,Y
#_01E81C: STA.l $7E2000,X

#_01E820: LDA.w RoomDrawObjectData+2,Y
#_01E823: STA.l $7E2080,X

#_01E827: LDA.w RoomDrawObjectData+4,Y
#_01E82A: STA.l $7E2002,X

#_01E82E: LDA.w RoomDrawObjectData+6,Y
#_01E831: STA.l $7E2082,X

#_01E835: AND.w #$03FF
#_01E838: TAX

#_01E839: LDA.l $7EFE00,X
#_01E83D: AND.w #$00FF
#_01E840: STA.b $08
#_01E842: STA.b $09

#_01E844: LDA.b $06
#_01E846: LSR A
#_01E847: TAX

#_01E848: LDA.b $08
#_01E84A: STA.l $7F2000,X
#_01E84E: STA.l $7F2040,X

;---------------------------------------------------------------------------------------------------

#_01E852: LDX.w $1000

#_01E855: LDA.w #$0000
#_01E858: JSR .draw_one_corner
#_01E85B: STA.w $1002,X

#_01E85E: LDA.w #$0080
#_01E861: JSR .draw_one_corner
#_01E864: STA.w $1008,X

#_01E867: LDA.w #$0002
#_01E86A: JSR .draw_one_corner
#_01E86D: STA.w $100E,X

#_01E870: LDA.w #$0082
#_01E873: JSR .draw_one_corner
#_01E876: STA.w $1014,X

#_01E879: LDA.w #$0100
#_01E87C: STA.w $1004,X
#_01E87F: STA.w $100A,X
#_01E882: STA.w $1010,X
#_01E885: STA.w $1016,X

#_01E888: LDA.w #$FFFF
#_01E88B: STA.w $101A,X

#_01E88E: TXA
#_01E88F: CLC
#_01E890: ADC.w #$0018
#_01E893: STA.w $1000

#_01E896: RTS

;---------------------------------------------------------------------------------------------------

.draw_one_corner
#_01E897: CLC
#_01E898: ADC.b $06
#_01E89A: STA.b $0E

#_01E89C: AND.w #$0040

#_01E89F: LSR A ; /16
#_01E8A0: LSR A
#_01E8A1: LSR A
#_01E8A2: LSR A

#_01E8A3: XBA
#_01E8A4: STA.b $08

#_01E8A6: LDA.b $0E
#_01E8A8: AND.w #$303F
#_01E8AB: LSR A
#_01E8AC: ORA.b $08
#_01E8AE: STA.b $08

#_01E8B0: LDA.b $0E
#_01E8B2: AND.w #$0F80
#_01E8B5: LSR A
#_01E8B6: LSR A
#_01E8B7: ORA.b $08
#_01E8B9: XBA

#_01E8BA: RTS

;===================================================================================================

Underworld_DeleteRupeeTile:
#_01E8BB: PHB

#_01E8BC: LDA.b #$00
#_01E8BE: PHA
#_01E8BF: PLB

#_01E8C0: REP #$30

#_01E8C2: LDA.b $00
#_01E8C4: AND.w #$01F8
#_01E8C7: ASL A ; x8
#_01E8C8: ASL A
#_01E8C9: ASL A
#_01E8CA: STA.b $06

#_01E8CC: LDA.b $02
#_01E8CE: AND.w #$01F8

#_01E8D1: LSR A ; /8
#_01E8D2: LSR A
#_01E8D3: LSR A

#_01E8D4: ORA.b $06
#_01E8D6: ASL A
#_01E8D7: STA.b $06

;---------------------------------------------------------------------------------------------------

#_01E8D9: LDX.w $1000

#_01E8DC: LDA.w #$190F
#_01E8DF: STA.w $1006,X
#_01E8E2: STA.w $100C,X

#_01E8E5: LDX.b $06

#_01E8E7: STA.l $7E2000,X
#_01E8EB: STA.l $7E2080,X

#_01E8EF: AND.w #$03FF
#_01E8F2: TAX

#_01E8F3: LDA.l $7EFE00,X
#_01E8F7: AND.w #$00FF
#_01E8FA: STA.b $08
#_01E8FC: STA.b $09

#_01E8FE: LDA.b $06
#_01E900: LSR A
#_01E901: TAX

#_01E902: LDA.b $08
#_01E904: STA.l $7F2000,X
#_01E908: STA.l $7F2040,X

;---------------------------------------------------------------------------------------------------

#_01E90C: LDX.w $1000

#_01E90F: LDA.w #$0000
#_01E912: JSR .draw_half
#_01E915: STA.w $1002,X

#_01E918: LDA.w #$0080
#_01E91B: JSR .draw_half
#_01E91E: STA.w $1008,X

#_01E921: LDA.w #$0100
#_01E924: STA.w $1004,X
#_01E927: STA.w $100A,X

;---------------------------------------------------------------------------------------------------

#_01E92A: LDA.w #$FFFF
#_01E92D: STA.w $100E,X

#_01E930: TXA
#_01E931: CLC
#_01E932: ADC.w #$0018
#_01E935: STA.w $1000

#_01E938: SEP #$30

#_01E93A: LDA.w $0403
#_01E93D: ORA.b #$10
#_01E93F: STA.w $0403

#_01E942: LDA.b #$01
#_01E944: STA.b $14

#_01E946: PLB

#_01E947: RTL

;---------------------------------------------------------------------------------------------------

.draw_half
#_01E948: CLC
#_01E949: ADC.b $06
#_01E94B: STA.b $0C

#_01E94D: AND.w #$0040

#_01E950: LSR A ; /16
#_01E951: LSR A
#_01E952: LSR A
#_01E953: LSR A

#_01E954: XBA
#_01E955: STA.b $08

#_01E957: LDA.b $0C
#_01E959: AND.w #$303F
#_01E95C: LSR A
#_01E95D: ORA.b $08
#_01E95F: STA.b $08

#_01E961: LDA.b $0C
#_01E963: AND.w #$0F80
#_01E966: LSR A
#_01E967: LSR A
#_01E968: ORA.b $08
#_01E96A: XBA

#_01E96B: RTS

;===================================================================================================
; dw ROOM_ID : db ITEM_ID
; bit 7 of ROOM_ID set means it's a big chest
;===================================================================================================
RoomData_ChestItems:
#_01E96C: dw $0032 : db !ITEMGET_24
#_01E96F: dw $0055 : db !ITEMGET_12
#_01E972: dw $0071 : db !ITEMGET_0C
#_01E975: dw $00A8 : db !ITEMGET_25
#_01E978: dw $0113 : db !ITEMGET_19
#_01E97B: dw $80A9 : db !ITEMGET_0B ; big chest
#_01E97E: dw $0016 : db !ITEMGET_28
#_01E981: dw $0016 : db !ITEMGET_25
#_01E984: dw $0037 : db !ITEMGET_33
#_01E987: dw $8036 : db !ITEMGET_0A ; big chest
#_01E98A: dw $010B : db !ITEMGET_28
#_01E98D: dw $8073 : db !ITEMGET_1B ; big chest
#_01E990: dw $0067 : db !ITEMGET_25
#_01E993: dw $007E : db !ITEMGET_28
#_01E996: dw $8058 : db !ITEMGET_07 ; big chest
#_01E999: dw $0058 : db !ITEMGET_33
#_01E99C: dw $0057 : db !ITEMGET_32
#_01E99F: dw $0057 : db !ITEMGET_24
#_01E9A2: dw $001F : db !ITEMGET_32
#_01E9A5: dw $007E : db !ITEMGET_24
#_01E9A8: dw $809E : db !ITEMGET_22 ; big chest
#_01E9AB: dw $0077 : db !ITEMGET_33
#_01E9AE: dw $0005 : db !ITEMGET_28
#_01E9B1: dw $00B9 : db !ITEMGET_40
#_01E9B4: dw $0074 : db !ITEMGET_33
#_01E9B7: dw $00B8 : db !ITEMGET_32
#_01E9BA: dw $0104 : db !ITEMGET_12
#_01E9BD: dw $00FE : db !ITEMGET_41
#_01E9C0: dw $0075 : db !ITEMGET_32
#_01E9C3: dw $010C : db !ITEMGET_17
#_01E9C6: dw $0068 : db !ITEMGET_24
#_01E9C9: dw $0085 : db !ITEMGET_25
#_01E9CC: dw $0103 : db !ITEMGET_16
#_01E9CF: dw $013D : db !ITEMGET_36
#_01E9D2: dw $002E : db !ITEMGET_25
#_01E9D5: dw $012D : db !ITEMGET_36
#_01E9D8: dw $00B3 : db !ITEMGET_24
#_01E9DB: dw $003F : db !ITEMGET_33
#_01E9DE: dw $005F : db !ITEMGET_24
#_01E9E1: dw $00AE : db !ITEMGET_24
#_01E9E4: dw $0087 : db !ITEMGET_32
#_01E9E7: dw $0108 : db !ITEMGET_0C
#_01E9EA: dw $0106 : db !ITEMGET_2A
#_01E9ED: dw $011C : db !ITEMGET_46
#_01E9F0: dw $010A : db !ITEMGET_17
#_01E9F3: dw $00AA : db !ITEMGET_33
#_01E9F6: dw $8027 : db !ITEMGET_1F ; big chest
#_01E9F9: dw $0027 : db !ITEMGET_25
#_01E9FC: dw $0059 : db !ITEMGET_24
#_01E9FF: dw $00DB : db !ITEMGET_33
#_01EA02: dw $00DB : db !ITEMGET_32
#_01EA05: dw $00DC : db !ITEMGET_25
#_01EA08: dw $00CB : db !ITEMGET_36
#_01EA0B: dw $0065 : db !ITEMGET_28
#_01EA0E: dw $8044 : db !ITEMGET_1C ; big chest
#_01EA11: dw $0045 : db !ITEMGET_24
#_01EA14: dw $00B6 : db !ITEMGET_24
#_01EA17: dw $8024 : db !ITEMGET_06 ; big chest
#_01EA1A: dw $00B7 : db !ITEMGET_33
#_01EA1D: dw $00B7 : db !ITEMGET_24
#_01EA20: dw $00D6 : db !ITEMGET_25
#_01EA23: dw $0014 : db !ITEMGET_32
#_01EA26: dw $00D5 : db !ITEMGET_34
#_01EA29: dw $00D5 : db !ITEMGET_35
#_01EA2C: dw $00D5 : db !ITEMGET_36
#_01EA2F: dw $00D5 : db !ITEMGET_24
#_01EA32: dw $0004 : db !ITEMGET_24
#_01EA35: dw $003A : db !ITEMGET_32
#_01EA38: dw $002A : db !ITEMGET_24
#_01EA3B: dw $002A : db !ITEMGET_24
#_01EA3E: dw $801A : db !ITEMGET_09 ; big chest
#_01EA41: dw $001A : db !ITEMGET_25
#_01EA44: dw $001A : db !ITEMGET_35
#_01EA47: dw $000A : db !ITEMGET_24
#_01EA4A: dw $006A : db !ITEMGET_43
#_01EA4D: dw $006A : db !ITEMGET_24
#_01EA50: dw $002B : db !ITEMGET_33
#_01EA53: dw $0019 : db !ITEMGET_28
#_01EA56: dw $0019 : db !ITEMGET_24
#_01EA59: dw $0009 : db !ITEMGET_24
#_01EA5C: dw $00C2 : db !ITEMGET_24
#_01EA5F: dw $00A2 : db !ITEMGET_24
#_01EA62: dw $00C1 : db !ITEMGET_25
#_01EA65: dw $80C3 : db !ITEMGET_15 ; big chest
#_01EA68: dw $00C3 : db !ITEMGET_33
#_01EA6B: dw $00D1 : db !ITEMGET_32
#_01EA6E: dw $00B3 : db !ITEMGET_24
#_01EA71: dw $010D : db !ITEMGET_17
#_01EA74: dw $010D : db !ITEMGET_36
#_01EA77: dw $0012 : db !ITEMGET_3F
#_01EA7A: dw $00F8 : db !ITEMGET_28
#_01EA7D: dw $00F8 : db !ITEMGET_36
#_01EA80: dw $0105 : db !ITEMGET_41
#_01EA83: dw $0105 : db !ITEMGET_28
#_01EA86: dw $0105 : db !ITEMGET_41
#_01EA89: dw $0117 : db !ITEMGET_18
#_01EA8C: dw $002F : db !ITEMGET_17
#_01EA8F: dw $002F : db !ITEMGET_36
#_01EA92: dw $002F : db !ITEMGET_36
#_01EA95: dw $002F : db !ITEMGET_36
#_01EA98: dw $002F : db !ITEMGET_28
#_01EA9B: dw $0028 : db !ITEMGET_24
#_01EA9E: dw $0046 : db !ITEMGET_25
#_01EAA1: dw $0034 : db !ITEMGET_36
#_01EAA4: dw $0035 : db !ITEMGET_32
#_01EAA7: dw $0076 : db !ITEMGET_36
#_01EAAA: dw $0076 : db !ITEMGET_36
#_01EAAD: dw $0066 : db !ITEMGET_36
#_01EAB0: dw $00D0 : db !ITEMGET_24
#_01EAB3: dw $00E0 : db !ITEMGET_24
#_01EAB6: dw $007B : db !ITEMGET_28
#_01EAB9: dw $007B : db !ITEMGET_44
#_01EABC: dw $007B : db !ITEMGET_36
#_01EABF: dw $007B : db !ITEMGET_36
#_01EAC2: dw $007C : db !ITEMGET_44
#_01EAC5: dw $007C : db !ITEMGET_44
#_01EAC8: dw $007C : db !ITEMGET_28
#_01EACB: dw $007C : db !ITEMGET_28
#_01EACE: dw $007D : db !ITEMGET_24
#_01EAD1: dw $008B : db !ITEMGET_33
#_01EAD4: dw $808C : db !ITEMGET_23 ; big chest
#_01EAD7: dw $008C : db !ITEMGET_44
#_01EADA: dw $008C : db !ITEMGET_28
#_01EADD: dw $008C : db !ITEMGET_44
#_01EAE0: dw $008D : db !ITEMGET_24
#_01EAE3: dw $009D : db !ITEMGET_25
#_01EAE6: dw $009D : db !ITEMGET_34
#_01EAE9: dw $009D : db !ITEMGET_36
#_01EAEC: dw $009D : db !ITEMGET_44
#_01EAEF: dw $001C : db !ITEMGET_32
#_01EAF2: dw $001C : db !ITEMGET_44
#_01EAF5: dw $001C : db !ITEMGET_28
#_01EAF8: dw $005B : db !ITEMGET_24
#_01EAFB: dw $003D : db !ITEMGET_28
#_01EAFE: dw $003D : db !ITEMGET_28
#_01EB01: dw $003D : db !ITEMGET_24
#_01EB04: dw $004D : db !ITEMGET_36
#_01EB07: dw $0080 : db !ITEMGET_12
#_01EB0A: dw $0072 : db !ITEMGET_33
#_01EB0D: dw $011D : db !ITEMGET_17
#_01EB10: dw $011D : db !ITEMGET_36
#_01EB13: dw $011D : db !ITEMGET_36
#_01EB16: dw $011D : db !ITEMGET_36
#_01EB19: dw $011D : db !ITEMGET_36
#_01EB1C: dw $011E : db !ITEMGET_36
#_01EB1F: dw $011E : db !ITEMGET_36
#_01EB22: dw $011E : db !ITEMGET_36
#_01EB25: dw $011E : db !ITEMGET_36
#_01EB28: dw $00EF : db !ITEMGET_36
#_01EB2B: dw $00EF : db !ITEMGET_36
#_01EB2E: dw $00EF : db !ITEMGET_36
#_01EB31: dw $00EF : db !ITEMGET_36
#_01EB34: dw $00EF : db !ITEMGET_36
#_01EB37: dw $00FF : db !ITEMGET_28
#_01EB3A: dw $00FF : db !ITEMGET_44
#_01EB3D: dw $0124 : db !ITEMGET_17
#_01EB40: dw $0123 : db !ITEMGET_28
#_01EB43: dw $0123 : db !ITEMGET_36
#_01EB46: dw $0123 : db !ITEMGET_36
#_01EB49: dw $0123 : db !ITEMGET_44
#_01EB4C: dw $0120 : db !ITEMGET_08
#_01EB4F: dw $003C : db !ITEMGET_41
#_01EB52: dw $003C : db !ITEMGET_41
#_01EB55: dw $003C : db !ITEMGET_41
#_01EB58: dw $003C : db !ITEMGET_41
#_01EB5B: dw $0011 : db !ITEMGET_28
#_01EB5E: dw $0011 : db !ITEMGET_46
#_01EB61: dw $0011 : db !ITEMGET_44

;===================================================================================================

OpenChestForItem:
#_01EB64: PHB

#_01EB65: LDX.b #$00
#_01EB67: PHX
#_01EB68: PLB

#_01EB69: CMP.b #!TILETYPE_63
#_01EB6B: BNE OpenItemChest

#_01EB6D: JMP.w OpenMiniGameChest

;===================================================================================================

OpenItemChest:
#_01EB70: REP #$30

#_01EB72: AND.w #$00FF
#_01EB75: SEC
#_01EB76: SBC.w #$0058
#_01EB79: STA.b $0E

#_01EB7B: ASL A
#_01EB7C: PHA

#_01EB7D: TAY
#_01EB7E: PHY

#_01EB7F: LDA.w $06E0,Y
#_01EB82: CMP.w #$8000
#_01EB85: BCC .not_big_key_lock

#_01EB87: LDX.w $040C

#_01EB8A: LDA.l $7EF366
#_01EB8E: AND.l DungeonMask,X
#_01EB92: BNE .open_big_key_lock

; Message 0078
#_01EB94: LDA.w #$0078
#_01EB97: STA.w $1CF0

#_01EB9A: SEP #$30

#_01EB9C: JSL Interface_PrepAndDisplayMessage

#_01EBA0: REP #$30

#_01EBA2: BRA .cannot_open_big_key_lock

;---------------------------------------------------------------------------------------------------

.open_big_key_lock
#_01EBA4: LDA.w $0402
#_01EBA7: ORA.w RoomFlagMask,Y
#_01EBAA: STA.w $0402

#_01EBAD: LDA.w #(!SFX3_15<<8)|(!SFX2_29) ; queues 2 SFX
#_01EBB0: STA.w $012E

#_01EBB3: LDA.w $06E0,Y
#_01EBB6: AND.w #$7FFF
#_01EBB9: TAX

#_01EBBA: LDY.w $046A

#_01EBBD: LDA.w RoomDrawObjectData+0,Y
#_01EBC0: STA.l $7E2000,X
#_01EBC4: STA.b $02

#_01EBC6: LDA.w RoomDrawObjectData+2,Y
#_01EBC9: STA.l $7E2080,X
#_01EBCD: STA.b $04

#_01EBCF: LDA.w RoomDrawObjectData+4,Y
#_01EBD2: STA.l $7E2002,X
#_01EBD6: STA.b $06

#_01EBD8: LDA.w RoomDrawObjectData+6,Y
#_01EBDB: JMP.w .save_tile_map

;---------------------------------------------------------------------------------------------------

.no_chest_found
#_01EBDE: PLX

.cannot_open_big_key_lock
#_01EBDF: PLY
#_01EBE0: PLA

#_01EBE1: SEP #$30

#_01EBE3: PLB

#_01EBE4: CLC

#_01EBE5: RTL

;---------------------------------------------------------------------------------------------------

.not_big_key_lock
#_01EBE6: AND.w #$7FFF
#_01EBE9: TAX

#_01EBEA: PHX

#_01EBEB: INC.b $0E

#_01EBED: LDX.w #$FFFD

.next_chest_check
#_01EBF0: INX
#_01EBF1: INX
#_01EBF2: INX
#_01EBF3: CPX.w #$01F8 ; !HARDCODED table size
#_01EBF6: BEQ .no_chest_found

#_01EBF8: LDA.l RoomData_ChestItems,X
#_01EBFC: AND.w #$7FFF

; check room
#_01EBFF: CMP.b $A0
#_01EC01: BNE .next_chest_check

#_01EC03: DEC.b $0E
#_01EC05: BNE .next_chest_check

;---------------------------------------------------------------------------------------------------

#_01EC07: LDA.l RoomData_ChestItems+2,X
#_01EC0B: STA.b $0C

#_01EC0D: LDA.l RoomData_ChestItems+0,X
#_01EC11: ASL A

#_01EC12: BCC .small_chest

#_01EC14: LDX.w $040C

#_01EC17: LDA.l $7EF366
#_01EC1B: AND.l DungeonMask,X
#_01EC1F: BEQ .no_big_key_for_big_chest

#_01EC21: PLX
#_01EC22: PLA

#_01EC23: JMP.w OpenBigChest

;---------------------------------------------------------------------------------------------------

.no_big_key_for_big_chest
#_01EC26: PLX
#_01EC27: PLY
#_01EC28: PLA

; Message 0078
#_01EC29: LDA.w #$0078
#_01EC2C: STA.w $1CF0

#_01EC2F: SEP #$30

#_01EC31: JSL Interface_PrepAndDisplayMessage

#_01EC35: PLB

#_01EC36: CLC

#_01EC37: RTL

;---------------------------------------------------------------------------------------------------

.small_chest
#_01EC38: PLX

#_01EC39: LDA.w $0402
#_01EC3C: ORA.w RoomFlagMask,Y
#_01EC3F: STA.w $0402

#_01EC42: LDY.w #$14A4

#_01EC45: LDA.w RoomDrawObjectData+0,Y
#_01EC48: STA.l $7E2000,X
#_01EC4C: STA.b $02

#_01EC4E: LDA.w RoomDrawObjectData+2,Y
#_01EC51: STA.l $7E2080,X
#_01EC55: STA.b $04

#_01EC57: LDA.w RoomDrawObjectData+4,Y
#_01EC5A: STA.l $7E2002,X
#_01EC5E: STA.b $06

#_01EC60: LDA.w RoomDrawObjectData+6,Y

;---------------------------------------------------------------------------------------------------

.save_tile_map
#_01EC63: STA.l $7E2082,X
#_01EC67: STA.b $08

#_01EC69: PLY

#_01EC6A: LDA.w #$2727
#_01EC6D: STA.b $00

#_01EC6F: LDA.w $06E0,Y
#_01EC72: CMP.w #$8000
#_01EC75: BCC .not_a_lock

#_01EC77: AND.w #$7FFF
#_01EC7A: STZ.b $00

.not_a_lock
#_01EC7C: LSR A
#_01EC7D: TAX

#_01EC7E: LDA.b $00
#_01EC80: STA.l $7F2000,X
#_01EC84: STA.l $7F2040,X

;---------------------------------------------------------------------------------------------------

#_01EC88: LDX.w $1000

#_01EC8B: LDA.w #$0000
#_01EC8E: JSR RoomTag_BuildChestStripes
#_01EC91: STA.w $1002,X

#_01EC94: LDA.w #$0080
#_01EC97: JSR RoomTag_BuildChestStripes
#_01EC9A: STA.w $1008,X

#_01EC9D: LDA.w #$0002
#_01ECA0: JSR RoomTag_BuildChestStripes
#_01ECA3: STA.w $100E,X

#_01ECA6: LDA.w #$0082
#_01ECA9: JSR RoomTag_BuildChestStripes
#_01ECAC: STA.w $1014,X

;---------------------------------------------------------------------------------------------------

#_01ECAF: LDA.b $02
#_01ECB1: STA.w $1006,X

#_01ECB4: LDA.b $04
#_01ECB6: STA.w $100C,X

#_01ECB9: LDA.b $06
#_01ECBB: STA.w $1012,X

#_01ECBE: LDA.b $08
#_01ECC0: STA.w $1018,X

#_01ECC3: LDA.w #$0100
#_01ECC6: STA.w $1004,X
#_01ECC9: STA.w $100A,X
#_01ECCC: STA.w $1010,X
#_01ECCF: STA.w $1016,X

#_01ECD2: LDA.w #$FFFF
#_01ECD5: STA.w $101A,X

#_01ECD8: TXA
#_01ECD9: CLC
#_01ECDA: ADC.w #$0018
#_01ECDD: STA.w $1000

;---------------------------------------------------------------------------------------------------

#_01ECE0: SEP #$30

#_01ECE2: LDA.b #$01
#_01ECE4: STA.b $14

#_01ECE6: JSL Underworld_FlagRoomData_Quadrants

;---------------------------------------------------------------------------------------------------

#_01ECEA: LDA.w $012F
#_01ECED: BNE .skip_sfx

#_01ECEF: LDA.b #!SFX3_0E
#_01ECF1: STA.w $012F

.skip_sfx
#_01ECF4: REP #$30

#_01ECF6: PLY

#_01ECF7: LDA.w $06E0,Y
#_01ECFA: AND.w #$7FFF
#_01ECFD: STA.b $72

#_01ECFF: SEP #$31

#_01ED01: PLB

#_01ED02: RTL

;===================================================================================================

OpenBigChest:
#_01ED03: LDA.w $0402
#_01ED06: ORA.w RoomFlagMask,Y
#_01ED09: STA.w $0402

#_01ED0C: STX.b $08

#_01ED0E: LDA.w #$0004
#_01ED11: STA.b $0E

;---------------------------------------------------------------------------------------------------

#_01ED13: LDY.w #$14C4

.next_column
#_01ED16: LDA.w RoomDrawObjectData+0,Y
#_01ED19: STA.l $7E2000,X

#_01ED1D: LDA.w RoomDrawObjectData+2,Y
#_01ED20: STA.l $7E2080,X

#_01ED24: LDA.w RoomDrawObjectData+4,Y
#_01ED27: STA.l $7E2100,X

#_01ED2B: INY ; +6
#_01ED2C: INY
#_01ED2D: INY
#_01ED2E: INY
#_01ED2F: INY
#_01ED30: INY

#_01ED31: INX
#_01ED32: INX

#_01ED33: DEC.b $0E
#_01ED35: BNE .next_column

;---------------------------------------------------------------------------------------------------

#_01ED37: LDA.b $0C
#_01ED39: PHA

#_01ED3A: JSR RoomTag_WaterOff_AdjustOverlay

#_01ED3D: LDY.b $0C

#_01ED3F: LDA.w #$FFFF
#_01ED42: STA.w $1100,Y

#_01ED45: PLA
#_01ED46: STA.b $0C

#_01ED48: PLY

#_01ED49: LDA.w $06E0,Y
#_01ED4C: AND.w #$7FFF
#_01ED4F: PHA

#_01ED50: INC A
#_01ED51: INC A
#_01ED52: STA.b $72

;---------------------------------------------------------------------------------------------------

#_01ED54: PLA
#_01ED55: LSR A
#_01ED56: TAX

#_01ED57: LDA.w #$2727
#_01ED5A: STA.l $7F2000,X
#_01ED5E: STA.l $7F2002,X
#_01ED62: STA.l $7F2040,X
#_01ED66: STA.l $7F2042,X
#_01ED6A: STA.l $7F2080,X
#_01ED6E: STA.l $7F2082,X

;---------------------------------------------------------------------------------------------------

#_01ED72: SEP #$31

#_01ED74: PLB

#_01ED75: JSL Underworld_FlagRoomData_Quadrants

#_01ED79: LDA.b #!SFX3_0E
#_01ED7B: STA.w $012F

#_01ED7E: LDA.b #$01
#_01ED80: STA.b $18
#_01ED82: STA.w $0B9E

#_01ED85: SEC

#_01ED86: RTL

;===================================================================================================

OpenMiniGameChestFail:
.not_started
#_01ED87: STA.b $C8

#_01ED89: REP #$20

; Message 0160
#_01ED8B: LDA.w #$0160
#_01ED8E: BRA .show_message

;---------------------------------------------------------------------------------------------------

.out_of_credits
#_01ED90: REP #$20

; Message 0161
#_01ED92: LDA.w #$0161

;---------------------------------------------------------------------------------------------------

.show_message
#_01ED95: STA.w $1CF0

#_01ED98: SEP #$20

#_01ED9A: JSL Interface_PrepAndDisplayMessage

#_01ED9E: PLB

#_01ED9F: CLC

#_01EDA0: RTL

;===================================================================================================

VoOChestGamePrizes:
#_01EDA1: db !ITEMGET_40 ; 100 RUPEES
#_01EDA2: db !ITEMGET_41 ; 50 RUPEES
#_01EDA3: db !ITEMGET_34 ; 1 RUPEE
#_01EDA4: db !ITEMGET_42 ; HEART
#_01EDA5: db !ITEMGET_43 ; ARROW
#_01EDA6: db !ITEMGET_44 ; 10 ARROWS
#_01EDA7: db !ITEMGET_27 ; BOMB
#_01EDA8: db !ITEMGET_17 ; HEART PIECE

;---------------------------------------------------------------------------------------------------

OpenMiniGameChest:
#_01EDA9: LDA.w $04C4
#_01EDAC: BEQ OpenMiniGameChestFail_out_of_credits

#_01EDAE: CMP.b #$FF
#_01EDB0: BEQ OpenMiniGameChestFail_not_started

#_01EDB2: DEC.w $04C4

;---------------------------------------------------------------------------------------------------

#_01EDB5: REP #$30

#_01EDB7: LDA.b $20
#_01EDB9: SEC
#_01EDBA: SBC.w #$0004
#_01EDBD: STA.b $00

#_01EDBF: AND.w #$01F8

#_01EDC2: ASL A ; x8
#_01EDC3: ASL A
#_01EDC4: ASL A

#_01EDC5: STA.b $06

#_01EDC7: LDA.b $22
#_01EDC9: CLC
#_01EDCA: ADC.w #$0007
#_01EDCD: STA.b $02

#_01EDCF: AND.w #$01F8

#_01EDD2: LSR A ; /8
#_01EDD3: LSR A
#_01EDD4: LSR A

#_01EDD5: ORA.b $06
#_01EDD7: TAX

;---------------------------------------------------------------------------------------------------

#_01EDD8: LDA.l $7F2000,X
#_01EDDC: CMP.w #$6363
#_01EDDF: BEQ .indeed_minigame_chest

#_01EDE1: DEX

#_01EDE2: LDA.l $7F2000,X
#_01EDE6: CMP.w #$6363
#_01EDE9: BEQ .indeed_minigame_chest

#_01EDEB: INX
#_01EDEC: INX

;---------------------------------------------------------------------------------------------------

.indeed_minigame_chest
#_01EDED: LDA.w #$0202
#_01EDF0: STA.l $7F2000,X
#_01EDF4: STA.l $7F2040,X

#_01EDF8: TXA
#_01EDF9: ASL A
#_01EDFA: STA.b $72

#_01EDFC: CLC
#_01EDFD: ADC.w #$0100
#_01EE00: TAX

#_01EE01: STA.b $0C

#_01EE03: LDY.w #$14A4

#_01EE06: LDA.w RoomDrawObjectData+0,Y
#_01EE09: STA.l $7E2000,X
#_01EE0D: STA.b $02

#_01EE0F: LDA.w RoomDrawObjectData+2,Y
#_01EE12: STA.l $7E2080,X
#_01EE16: STA.b $04

#_01EE18: LDA.w RoomDrawObjectData+4,Y
#_01EE1B: STA.l $7E2002,X
#_01EE1F: STA.b $06

#_01EE21: LDA.w RoomDrawObjectData+6,Y
#_01EE24: STA.l $7E2082,X
#_01EE28: STA.b $08

;---------------------------------------------------------------------------------------------------

#_01EE2A: LDX.w $1000

#_01EE2D: LDA.b $0C
#_01EE2F: JSR RoomTag_BuildChestStripes
#_01EE32: STA.w $1002,X

#_01EE35: LDA.b $0C
#_01EE37: CLC
#_01EE38: ADC.w #$0080
#_01EE3B: JSR RoomTag_BuildChestStripes
#_01EE3E: STA.w $1008,X

#_01EE41: LDA.b $0C
#_01EE43: CLC
#_01EE44: ADC.w #$0002
#_01EE47: JSR RoomTag_BuildChestStripes
#_01EE4A: STA.w $100E,X

#_01EE4D: LDA.b $0C
#_01EE4F: CLC
#_01EE50: ADC.w #$0082
#_01EE53: JSR RoomTag_BuildChestStripes
#_01EE56: STA.w $1014,X

;---------------------------------------------------------------------------------------------------

#_01EE59: LDA.b $02
#_01EE5B: STA.w $1006,X

#_01EE5E: LDA.b $04
#_01EE60: STA.w $100C,X

#_01EE63: LDA.b $06
#_01EE65: STA.w $1012,X

#_01EE68: LDA.b $08
#_01EE6A: STA.w $1018,X

#_01EE6D: LDA.w #$0100
#_01EE70: STA.w $1004,X
#_01EE73: STA.w $100A,X
#_01EE76: STA.w $1010,X
#_01EE79: STA.w $1016,X

#_01EE7C: LDA.w #$FFFF
#_01EE7F: STA.w $101A,X

#_01EE82: TXA
#_01EE83: CLC
#_01EE84: ADC.w #$0018
#_01EE87: STA.w $1000

;---------------------------------------------------------------------------------------------------

#_01EE8A: SEP #$31

#_01EE8C: LDA.b $A0
#_01EE8E: BEQ OpenMiniGameChest_HighStake

#_01EE90: CMP.b #$18
#_01EE92: BEQ OpenMiniGameChest_LowStake

;===================================================================================================

OpenMiniGameChest_VoO:
#_01EE94: JSL GetRandomNumber
#_01EE98: AND.b #$07
#_01EE9A: TAX

#_01EE9B: CPX.b #$02
#_01EE9D: BCC .dont_nudge

#_01EE9F: CPX.b $C8
#_01EEA1: BNE .dont_nudge

#_01EEA3: TXA
#_01EEA4: INC A
#_01EEA5: AND.b #$07
#_01EEA7: TAX

.dont_nudge
#_01EEA8: CPX.b #$07
#_01EEAA: BNE .dont_flag_heart_piece

#_01EEAC: LDA.w $0403
#_01EEAF: AND.b #$40
#_01EEB1: BNE .heart_obtained_already

#_01EEB3: LDA.w $0403
#_01EEB6: ORA.b #$40
#_01EEB8: STA.w $0403

#_01EEBB: BRA .dont_flag_heart_piece

.heart_obtained_already
#_01EEBD: LDX.b #$00

.dont_flag_heart_piece
#_01EEBF: LDA.l VoOChestGamePrizes,X

;===================================================================================================

FinalizeChestGamePrize:
#_01EEC3: STX.b $C8

#_01EEC5: STA.b $0C
#_01EEC7: STZ.b $0D

#_01EEC9: LDA.b #$01
#_01EECB: STA.b $14

#_01EECD: LDA.b #!SFX3_0E
#_01EECF: STA.w $012F

#_01EED2: PLB

#_01EED3: SEC

#_01EED4: RTL

;===================================================================================================

OtherChestGamePrizes:
.high_stakes
#_01EED5: db !ITEMGET_47 ; 20 RUPEES GREEN
#_01EED6: db !ITEMGET_34 ; 1 RUPEE
#_01EED7: db !ITEMGET_46 ; 300 RUPEES
#_01EED8: db !ITEMGET_34 ; 1 RUPEE
#_01EED9: db !ITEMGET_46 ; 300 RUPEES
#_01EEDA: db !ITEMGET_46 ; 300 RUPEES
#_01EEDB: db !ITEMGET_34 ; 1 RUPEE
#_01EEDC: db !ITEMGET_47 ; 20 RUPEES GREEN
#_01EEDD: db !ITEMGET_46 ; 300 RUPEES
#_01EEDE: db !ITEMGET_47 ; 20 RUPEES GREEN
#_01EEDF: db !ITEMGET_34 ; 1 RUPEE
#_01EEE0: db !ITEMGET_46 ; 300 RUPEES
#_01EEE1: db !ITEMGET_47 ; 20 RUPEES GREEN
#_01EEE2: db !ITEMGET_34 ; 1 RUPEE
#_01EEE3: db !ITEMGET_46 ; 300 RUPEES
#_01EEE4: db !ITEMGET_47 ; 20 RUPEES GREEN

;---------------------------------------------------------------------------------------------------

.low_stakes
#_01EEE5: db !ITEMGET_34 ; 1 RUPEE
#_01EEE6: db !ITEMGET_47 ; 20 RUPEES GREEN
#_01EEE7: db !ITEMGET_41 ; 50 RUPEES
#_01EEE8: db !ITEMGET_47 ; 20 RUPEES GREEN
#_01EEE9: db !ITEMGET_41 ; 50 RUPEES
#_01EEEA: db !ITEMGET_41 ; 50 RUPEES
#_01EEEB: db !ITEMGET_47 ; 20 RUPEES GREEN
#_01EEEC: db !ITEMGET_34 ; 1 RUPEE
#_01EEED: db !ITEMGET_41 ; 50 RUPEES
#_01EEEE: db !ITEMGET_34 ; 1 RUPEE
#_01EEEF: db !ITEMGET_47 ; 20 RUPEES GREEN
#_01EEF0: db !ITEMGET_41 ; 50 RUPEES
#_01EEF1: db !ITEMGET_34 ; 1 RUPEE
#_01EEF2: db !ITEMGET_47 ; 20 RUPEES GREEN
#_01EEF3: db !ITEMGET_41 ; 50 RUPEES
#_01EEF4: db !ITEMGET_34 ; 1 RUPEE

;---------------------------------------------------------------------------------------------------

OpenMiniGameChest_HighStake:
#_01EEF5: JSL GetRandomNumber
#_01EEF9: AND.b #$0F

#_01EEFB: BRA .set_prize

;===================================================================================================

#OpenMiniGameChest_LowStake:
#_01EEFD: JSL GetRandomNumber
#_01EF01: AND.b #$0F
#_01EF03: CLC
#_01EF04: ADC.b #$10

;---------------------------------------------------------------------------------------------------

.set_prize
#_01EF06: TAX

#_01EF07: LDA.l OtherChestGamePrizes,X

#_01EF0B: BRA FinalizeChestGamePrize

;===================================================================================================

RoomTag_BuildChestStripes:
#_01EF0D: CLC
#_01EF0E: ADC.w $06E0,Y
#_01EF11: STA.b $0E

#_01EF13: AND.w #$0040

#_01EF16: LSR A
#_01EF17: LSR A
#_01EF18: LSR A
#_01EF19: LSR A

#_01EF1A: XBA
#_01EF1B: STA.b $0A

#_01EF1D: LDA.b $0E
#_01EF1F: AND.w #$303F
#_01EF22: LSR A
#_01EF23: ORA.b $0A
#_01EF25: STA.b $0A

#_01EF27: LDA.b $0E
#_01EF29: AND.w #$0F80
#_01EF2C: LSR A
#_01EF2D: LSR A
#_01EF2E: ORA.b $0A
#_01EF30: XBA

#_01EF31: RTS

;===================================================================================================

pool IncrementallyDrainSwampPool

.window_direction
#_01EF32: dw $FFFF, $FFFF, $FFFF, $0001
#_01EF3A: dw $FFFF, $FFFF, $FFFF, $0001
#_01EF42: dw $FFFF, $FFFF, $FFFF, $0001
#_01EF4A: dw $FFFF, $FFFF, $FFFF, $0001

pool off

;---------------------------------------------------------------------------------------------------

IncrementallyDrainSwampPool:
#_01EF52: LDA.w $0424
#_01EF55: AND.b #$07
#_01EF57: BNE .dont_step_drainage

#_01EF59: LDA.w $0424
#_01EF5C: AND.b #$0C
#_01EF5E: LSR A
#_01EF5F: TAX

#_01EF60: REP #$20

; vertical window
#_01EF62: LDA.w $0684
#_01EF65: CMP.w $0688
#_01EF68: BEQ .done_draining

#_01EF6A: CLC
#_01EF6B: ADC.l .window_direction,X
#_01EF6F: STA.w $0684

; horizontal window
#_01EF72: LDA.w $0686
#_01EF75: CLC
#_01EF76: ADC.l .window_direction,X
#_01EF7A: STA.w $0686

#_01EF7D: SEP #$30

#_01EF7F: INC.w $0424

#_01EF82: JSL AdjustWaterHDMAWindow

#_01EF86: RTL

;---------------------------------------------------------------------------------------------------

.dont_step_drainage
#_01EF87: SEP #$30

#_01EF89: INC.w $0424

#_01EF8C: JSL AdjustWaterHDMAWindow

#_01EF90: RTL

;---------------------------------------------------------------------------------------------------

.done_draining
#_01EF91: SEP #$30

#_01EF93: LDA.b #$02
#_01EF95: STA.b $99

#_01EF97: LDA.b #$32
#_01EF99: STA.b $9A

#_01EF9B: STZ.w SUBDES
#_01EF9E: STZ.b $1D

#_01EFA0: STZ.b $96

#_01EFA2: STZ.w $046C

#_01EFA5: REP #$30

#_01EFA7: STZ.b $1E

#_01EFA9: LDX.w $0442
#_01EFAC: BEQ .no_props_to_edit

;---------------------------------------------------------------------------------------------------

#_01EFAE: LDY.w #$0000

.next_a
#_01EFB1: LDX.w $06B8,Y

#_01EFB4: LDA.w #$1D1D
#_01EFB7: STA.l $7F2041,X
#_01EFBB: STA.l $7F2081,X

#_01EFBF: INY
#_01EFC0: INY
#_01EFC1: CPY.w $0442
#_01EFC4: BNE .next_a

;---------------------------------------------------------------------------------------------------

.no_props_to_edit
#_01EFC6: LDX.w $04AE
#_01EFC9: BEQ .exit_trigger_advance

#_01EFCB: LDY.w #$0000

.next_b
#_01EFCE: LDX.w $06EC,Y

#_01EFD1: LDA.w #$1D1D
#_01EFD4: STA.l $7F2041,X
#_01EFD8: STA.l $7F2081,X

#_01EFDC: INY
#_01EFDD: INY
#_01EFDE: CPY.w $04AE
#_01EFE1: BNE .next_b

;---------------------------------------------------------------------------------------------------

.exit_trigger_advance
#_01EFE3: SEP #$30

#_01EFE5: INC.b $15
#_01EFE7: INC.b $B0

#_01EFE9: RTL

;===================================================================================================

DeleteSwampPoolWaterOverlay:
#_01EFEA: REP #$30

#_01EFEC: LDX.w #$0000
#_01EFEF: LDY.w #$01E0

#_01EFF2: LDA.w RoomDrawObjectData+0,Y

.next
#_01EFF5: STA.l $7E4000,X
#_01EFF9: STA.l $7E4200,X
#_01EFFD: STA.l $7E4400,X
#_01F001: STA.l $7E4600,X

#_01F005: STA.l $7E4800,X
#_01F009: STA.l $7E4A00,X
#_01F00D: STA.l $7E4C00,X
#_01F011: STA.l $7E4E00,X

#_01F015: STA.l $7E5000,X
#_01F019: STA.l $7E5200,X
#_01F01D: STA.l $7E5400,X
#_01F021: STA.l $7E5600,X

#_01F025: STA.l $7E5800,X
#_01F029: STA.l $7E5A00,X
#_01F02D: STA.l $7E5C00,X
#_01F031: STA.l $7E5E00,X

#_01F035: INX
#_01F036: INX
#_01F037: CPX.w #$0200
#_01F03A: BNE .next

#_01F03C: SEP #$30

#_01F03E: STZ.w $045C

#_01F041: INC.b $B0

#_01F043: RTL

;===================================================================================================

Underworld_FloodSwampWater_PrepTileMap:
#_01F044: JSL WaterFlood_BuildOneQuadrantForVRAM

#_01F048: LDA.w $045C
#_01F04B: CLC
#_01F04C: ADC.b #$04
#_01F04E: STA.w $045C

#_01F051: INC.b $B0

#_01F053: LDA.b $B0
#_01F055: CMP.b #$06
#_01F057: BNE .exit

#_01F059: STZ.w $045C

#_01F05C: STZ.b $B0
#_01F05E: STZ.b $11

.exit
#_01F060: RTL

;===================================================================================================

WaterDrainSpeed:

.tub_fill
#_01F061: dw $0001
#_01F063: dw $0001
#_01F065: dw $0001
#_01F067: dw $FFFF

.floor_flood
#_01F069: dw $0001
#_01F06B: dw $0002
#_01F06D: dw $0001
#_01F06F: dw $FFFF

.flood_width
#_01F071: dw $0001
#_01F073: dw $FFFF
#_01F075: dw $0001
#_01F077: dw $FFFF

;===================================================================================================

pool Underworld_FloodSwampWater

.vectors
#_01F079: dw Underworld_FloodSwampWater_PrepTileMap  ; 0x00
#_01F07B: dw Underworld_FloodSwampWater_PrepTileMap  ; 0x01
#_01F07D: dw Underworld_FloodSwampWater_PrepTileMap  ; 0x02
#_01F07F: dw Underworld_FloodSwampWater_PrepTileMap  ; 0x03
#_01F081: dw Underworld_FloodSwampWater_VomitWater   ; 0x04
#_01F083: dw Underworld_FloodSwampWater_VomitWater   ; 0x05
#_01F085: dw Underworld_FloodSwampWater_VomitWater   ; 0x06
#_01F087: dw Underworld_FloodSwampWater_VomitWater   ; 0x07
#_01F089: dw Underworld_FloodSwampWater_VomitWater   ; 0x08
#_01F08B: dw Underworld_FloodSwampWater_SpillToFloor ; 0x09
#_01F08D: dw Underworld_FloodSwampWater_CoverFloor   ; 0x0A
#_01F08F: dw Underworld_FloodSwampWater_RiseInLevel  ; 0x0B

pool off

;---------------------------------------------------------------------------------------------------

Underworld_FloodSwampWater:
#_01F091: LDA.b $B0
#_01F093: ASL A
#_01F094: TAX

#_01F095: JMP.w (.vectors,X)

;===================================================================================================

#EXIT_01F098:
#_01F098: RTL

;---------------------------------------------------------------------------------------------------

Underworld_FloodSwampWater_VomitWater:
#_01F099: DEC.w $0424
#_01F09C: BNE EXIT_01F098

#_01F09E: LDA.b #$04
#_01F0A0: STA.w $0424

#_01F0A3: INC.b $B0

#_01F0A5: LDA.b $B0
#_01F0A7: SEC
#_01F0A8: SBC.b #$04
#_01F0AA: STA.b $0E
#_01F0AC: STZ.b $0F

#_01F0AE: REP #$30

#_01F0B0: LDA.w #$0008
#_01F0B3: STA.w $0686

#_01F0B6: STZ.w $068A

#_01F0B9: LDA.w #$0030
#_01F0BC: STA.w $0684

#_01F0BF: LDA.w #$1654
#_01F0C2: CLC
#_01F0C3: ADC.w #$0010
#_01F0C6: TAY

;===================================================================================================

Underworld_AdjustWaterVomit:
#_01F0C7: LDA.w $047C
#_01F0CA: CLC
#_01F0CB: ADC.w #$0100
#_01F0CE: STA.b $08

#_01F0D0: TAX

.next_draw
#_01F0D1: LDA.w RoomDrawObjectData+0,Y
#_01F0D4: STA.l $7E2000,X

#_01F0D8: LDA.w RoomDrawObjectData+2,Y
#_01F0DB: STA.l $7E2002,X

#_01F0DF: LDA.w RoomDrawObjectData+4,Y
#_01F0E2: STA.l $7E2004,X

#_01F0E6: LDA.w RoomDrawObjectData+6,Y
#_01F0E9: STA.l $7E2006,X

#_01F0ED: TYA
#_01F0EE: CLC
#_01F0EF: ADC.w #$0008
#_01F0F2: TAY

#_01F0F3: TXA
#_01F0F4: CLC
#_01F0F5: ADC.w #$0080
#_01F0F8: TAX

#_01F0F9: DEC.b $0E
#_01F0FB: BNE .next_draw

;---------------------------------------------------------------------------------------------------

#_01F0FD: LDA.w #$0004
#_01F100: STA.b $0A

#_01F102: LDY.w #$0000

.next_tilemap_update
#_01F105: LDX.b $08
#_01F107: TXA

#_01F108: AND.w #$0040
#_01F10B: LSR A ; /16
#_01F10C: LSR A
#_01F10D: LSR A
#_01F10E: LSR A
#_01F10F: XBA
#_01F110: STA.b $00

#_01F112: TXA
#_01F113: AND.w #$303F
#_01F116: LSR A
#_01F117: ORA.b $00
#_01F119: STA.b $00

#_01F11B: TXA
#_01F11C: AND.w #$0F80
#_01F11F: LSR A
#_01F120: LSR A
#_01F121: ORA.b $00
#_01F123: XBA
#_01F124: STA.w $1002,Y

#_01F127: LDA.w #$0980
#_01F12A: STA.w $1004,Y

#_01F12D: LDA.l $7E2000,X
#_01F131: STA.w $1006,Y

#_01F134: LDA.l $7E2080,X
#_01F138: STA.w $1008,Y

#_01F13B: LDA.l $7E2100,X
#_01F13F: STA.w $100A,Y

#_01F142: LDA.l $7E2180,X
#_01F146: STA.w $100C,Y

#_01F149: LDA.l $7E2200,X
#_01F14D: STA.w $100E,Y

#_01F150: INC.b $08
#_01F152: INC.b $08

#_01F154: TYA
#_01F155: CLC
#_01F156: ADC.w #$000E
#_01F159: TAY

#_01F15A: DEC.b $0A
#_01F15C: BNE .next_tilemap_update

;---------------------------------------------------------------------------------------------------

#_01F15E: LDA.w #$FFFF
#_01F161: STA.w $1002,Y

#_01F164: SEP #$30

#_01F166: LDA.b #$01
#_01F168: STA.b $14

#_01F16A: RTL

;===================================================================================================

Underworld_FloodSwampWater_SpillToFloor:
#_01F16B: LDA.b #$03
#_01F16D: STA.b $96

#_01F16F: STZ.b $97
#_01F171: STZ.b $98

#_01F173: LDA.b #$16
#_01F175: STA.b $1E

; enable BG1 for subscreen and subscreen window
#_01F177: LDA.b #$01
#_01F179: STA.b $1F
#_01F17B: STA.b $1D

; use subscreen for color math
#_01F17D: LDA.b #$02
#_01F17F: STA.b $99

; half color math on CGRAM0 and BG2
#_01F181: LDA.b #$62
#_01F183: STA.b $9A

#_01F185: STZ.w $0424

#_01F188: INC.b $B0

;===================================================================================================

Underworld_FloodSwampWater_CoverFloor:
#_01F18A: LDA.w $0424
#_01F18D: AND.b #$03
#_01F18F: ASL A
#_01F190: TAX

#_01F191: REP #$20

#_01F193: LDA.w #$0688
#_01F196: SEC
#_01F197: SBC.b $E8
#_01F199: SEC
#_01F19A: SBC.w #$0024
#_01F19D: STA.b $00

#_01F19F: LDA.w $0686
#_01F1A2: CLC
#_01F1A3: ADC.l WaterDrainSpeed_flood_width,X
#_01F1A7: STA.w $0686

#_01F1AA: LDA.w $068A
#_01F1AD: CLC
#_01F1AE: ADC.l WaterDrainSpeed_floor_flood,X
#_01F1B2: STA.w $068A

#_01F1B5: CMP.b $00
#_01F1B7: BCC .still_filling

#_01F1B9: SEP #$20

#_01F1BB: LDA.b #$07
#_01F1BD: STA.w $0414

#_01F1C0: INC.b $B0

;---------------------------------------------------------------------------------------------------

.still_filling
#_01F1C2: REP #$30

#_01F1C4: INC.w $0424

#_01F1C7: LDA.w #$0688
#_01F1CA: SEC
#_01F1CB: SBC.b $E8
#_01F1CD: SEC
#_01F1CE: SBC.w $0684
#_01F1D1: STA.w $0674

#_01F1D4: CLC
#_01F1D5: ADC.w $068A
#_01F1D8: STA.b $0A

#_01F1DA: JSL AdjustWaterHDMAWindow_Horizontal

#_01F1DE: RTL

;===================================================================================================

Underworld_FloodSwampWater_RiseInLevel:
#_01F1DF: LDA.w $0424
#_01F1E2: AND.b #$07
#_01F1E4: BNE .dont_step

#_01F1E6: LDA.w $0424
#_01F1E9: AND.b #$0C
#_01F1EB: LSR
#_01F1EC: TAX

#_01F1ED: REP #$20

#_01F1EF: LDA.w $0684
#_01F1F2: CMP.w $0688
#_01F1F5: BEQ .not_done

;---------------------------------------------------------------------------------------------------

#_01F1F7: CLC
#_01F1F8: ADC.l WaterDrainSpeed_tub_fill,X
#_01F1FC: STA.w $0684

#_01F1FF: LDA.w $0686
#_01F202: CLC
#_01F203: ADC.l WaterDrainSpeed_tub_fill,X
#_01F207: STA.w $0686

;---------------------------------------------------------------------------------------------------

#_01F20A: REP #$10

#_01F20C: LDY.w #$16B4

#_01F20F: LDA.w $0688
#_01F212: SEC
#_01F213: SBC.w $0684
#_01F216: BEQ .adjust_mouth_spill

#_01F218: CMP.w #$0008
#_01F21B: BNE .dont_adjust_mouth_spill

#_01F21D: LDY.w #$168C

.adjust_mouth_spill
#_01F220: LDA.w #$0005
#_01F223: STA.b $0E

#_01F225: JSL Underworld_AdjustWaterVomit

;---------------------------------------------------------------------------------------------------

.dont_adjust_mouth_spill
#_01F229: SEP #$30

.dont_step
#_01F22B: SEP #$30

#_01F22D: INC.w $0424

#_01F230: JSL AdjustWaterHDMAWindow

#_01F234: RTL

;---------------------------------------------------------------------------------------------------

.not_done
#_01F235: REP #$30

#_01F237: STZ.b $1E

#_01F239: LDX.w $0440
#_01F23C: BEQ .skip_a

#_01F23E: LDY.w #$0000

.next_a
#_01F241: LDX.w $06B8,Y

#_01F244: LDA.w #$0003
#_01F247: STA.l $7F2000,X

#_01F24B: XBA
#_01F24C: STA.l $7F2002,X

#_01F250: LDA.w #$0A03
#_01F253: STA.l $7F3000,X

#_01F257: XBA
#_01F258: STA.l $7F3002,X

#_01F25C: LDA.w #$0808
#_01F25F: STA.l $7F2040,X
#_01F263: STA.l $7F2042,X
#_01F267: STA.l $7F3040,X
#_01F26B: STA.l $7F3042,X

#_01F26F: STA.l $7F3080,X
#_01F273: STA.l $7F3082,X
#_01F277: STA.l $7F30C0,X
#_01F27B: STA.l $7F30C2,X

#_01F27F: INY
#_01F280: INY
#_01F281: CPY.w $0440
#_01F284: BNE .next_a

;---------------------------------------------------------------------------------------------------

.skip_a
#_01F286: LDX.w $049E
#_01F289: BEQ .skip_b

#_01F28B: LDY.w #$0000

.next_b
#_01F28E: LDX.w $06EC,Y

#_01F291: LDA.w #$0003
#_01F294: STA.l $7F20C0,X

#_01F298: XBA
#_01F299: STA.l $7F20C2,X

#_01F29D: LDA.w #$0A03
#_01F2A0: STA.l $7F30C0,X

#_01F2A4: XBA
#_01F2A5: STA.l $7F30C2,X

#_01F2A9: LDA.w #$0808
#_01F2AC: STA.l $7F2080,X
#_01F2B0: STA.l $7F2082,X
#_01F2B4: STA.l $7F3000,X
#_01F2B8: STA.l $7F3002,X

#_01F2BC: STA.l $7F3040,X
#_01F2C0: STA.l $7F3042,X
#_01F2C4: STA.l $7F3080,X
#_01F2C8: STA.l $7F3082,X

#_01F2CC: INY
#_01F2CD: INY
#_01F2CE: CPY.w $049E
#_01F2D1: BNE .next_b

;---------------------------------------------------------------------------------------------------

.skip_b
#_01F2D3: STZ.b $11
#_01F2D5: STZ.b $B0

#_01F2D7: RTL

;===================================================================================================

UNREACHABLE_01F2D8:
#_01F2D8: dw $0008, $0010, $0018, $0020
#_01F2E0: dw $0000, $FFF8, $FFF8

;===================================================================================================

FloodGateTileOffsets:
#_01F2E6: dw $FFF8
#_01F2E8: dw $12F8
#_01F2EA: dw $1348
#_01F2EC: dw $1398
#_01F2EE: dw $13E8

;===================================================================================================

pool Underworld_FloodDam

.vectors
#_01F2F0: dw FloodDam_PrepTiles_init ; 0x00
#_01F2F2: dw FloodDam_PrepTiles      ; 0x01
#_01F2F4: dw FloodDam_PrepTiles      ; 0x02
#_01F2F6: dw FloodDam_PrepTiles      ; 0x03
#_01F2F8: dw FloodDam_Expand         ; 0x04
#_01F2FA: dw FloodDam_Fill           ; 0x05

pool off

;---------------------------------------------------------------------------------------------------

Underworld_FloodDam:
#_01F2FC: JSL FloodDam_PrepFloodHDMA

#_01F300: LDA.b $B0
#_01F302: ASL A
#_01F303: TAX

#_01F304: JMP.w (.vectors,X)

;===================================================================================================

#EXIT_01F307:
#_01F307: SEP #$30

#_01F309: RTL

;---------------------------------------------------------------------------------------------------

FloodDam_Expand:
#_01F30A: INC.w $0470

#_01F30D: LDA.w $0470
#_01F310: LSR A
#_01F311: STA.w $0686

#_01F314: SEC
#_01F315: SBC.b #$08
#_01F317: STA.b $00

#_01F319: LDA.w $0678
#_01F31C: STA.w $0676

#_01F31F: LDA.w $067A
#_01F322: CLC
#_01F323: ADC.b #$01
#_01F325: STA.w $067A

#_01F328: CLC
#_01F329: ADC.b $00
#_01F32B: STA.w $0684

;---------------------------------------------------------------------------------------------------

#_01F32E: LDA.w $0470
#_01F331: AND.b #$0F
#_01F333: BNE EXIT_01F307

#_01F335: LDA.w $0470
#_01F338: CMP.b #$40
#_01F33A: BNE .dont_advance

#_01F33C: INC.b $B0

.dont_advance
#_01F33E: REP #$30

#_01F340: LDA.w $0470
#_01F343: LSR A
#_01F344: LSR A
#_01F345: LSR A
#_01F346: TAX

#_01F347: LDA.l FloodGateTileOffsets,X
#_01F34B: TAY

#_01F34C: LDX.w $0472
#_01F34F: STX.b $08

;---------------------------------------------------------------------------------------------------

#_01F351: LDA.w #$000A
#_01F354: STA.b $0E

.next
#_01F356: LDA.w RoomDrawObjectData+0,Y
#_01F359: STA.l $7E2000,X

#_01F35D: LDA.w RoomDrawObjectData+2,Y
#_01F360: STA.l $7E2080,X

#_01F364: LDA.w RoomDrawObjectData+4,Y
#_01F367: STA.l $7E2100,X

#_01F36B: LDA.w RoomDrawObjectData+6,Y
#_01F36E: STA.l $7E2180,X

#_01F372: TYA
#_01F373: CLC
#_01F374: ADC.w #$0008
#_01F377: TAY

#_01F378: INX
#_01F379: INX

#_01F37A: DEC.b $0E
#_01F37C: BNE .next

;---------------------------------------------------------------------------------------------------

#_01F37E: STZ.b $0C

#_01F380: LDA.w #$0003
#_01F383: STA.b $0E

.add_next_stripe
#_01F385: LDA.b $08
#_01F387: PHA

#_01F388: LDA.w #$0004
#_01F38B: STA.b $0A

#_01F38D: LDY.b $0C

#_01F38F: LDA.w #$0881
#_01F392: STA.b $06

#_01F394: JSR TranslucentOverlay_FinalizeStripes

#_01F397: PLA
#_01F398: CLC
#_01F399: ADC.w #$0006
#_01F39C: STA.b $08

#_01F39E: DEC.b $0E
#_01F3A0: BNE .add_next_stripe

#_01F3A2: JMP.w RoomDraw_CloseStripes

;===================================================================================================

FloodDam_PrepTiles_init:
#_01F3A5: STZ.w $045C

;===================================================================================================

FloodDam_PrepTiles:
#_01F3A8: STZ.w $0418

#_01F3AB: JSL WaterFlood_BuildOneQuadrantForVRAM

#_01F3AF: LDA.w $045C
#_01F3B2: CLC
#_01F3B3: ADC.b #$04
#_01F3B5: STA.w $045C

#_01F3B8: INC.b $B0

#_01F3BA: RTL

;===================================================================================================

FloodDam_Fill:
#_01F3BB: INC.w $0684

#_01F3BE: LDA.w $0684
#_01F3C1: CLC
#_01F3C2: ADC.w $0676
#_01F3C5: CMP.b #$E1
#_01F3C7: BCC .exit

#_01F3C9: STZ.w $045C

#_01F3CC: STZ.b $11
#_01F3CE: STZ.b $B0

#_01F3D0: STZ.b $1E
#_01F3D2: STZ.b $1F

#_01F3D4: JSL IrisSpotlight_ResetTable

.exit
#_01F3D8: RTL

;===================================================================================================

FAIL_01F3D9:
#_01F3D9: STZ.w $0333

#_01F3DC: RTL

;---------------------------------------------------------------------------------------------------

UNREACHABLE_01F3DD:
#_01F3DD: LDA.w $0333
#_01F3E0: AND.b #$F0
#_01F3E2: CMP.b #$C0
#_01F3E4: BNE FAIL_01F3D9

#_01F3E6: LDA.b #$00
#_01F3E8: BRA Underworld_LightTorch_continue

;===================================================================================================

Underworld_LightTorch:
#_01F3EA: LDA.w $0333
#_01F3ED: AND.b #$F0
#_01F3EF: CMP.b #$C0
#_01F3F1: BNE FAIL_01F3D9

#_01F3F3: LDA.b #$C0

; Are we in ganon's room?
#_01F3F5: LDY.b $A0
#_01F3F7: BNE .continue

#_01F3F9: LDA.b #$80

.continue
#_01F3FB: STA.b $08
#_01F3FD: STZ.b $09

;---------------------------------------------------------------------------------------------------

#_01F3FF: PHA
#_01F400: PHB

#_01F401: LDA.b #$00
#_01F403: PHA
#_01F404: PLB

#_01F405: REP #$30

#_01F407: LDA.w $0333
#_01F40A: AND.w #$000F
#_01F40D: ASL A

#_01F40E: CLC ; !USELESS
#_01F40F: ADC.w $0478
#_01F412: TAY

#_01F413: LDA.w $0520,Y
#_01F416: AND.w #$00FF
#_01F419: TAX

#_01F41A: LDA.w $0540,Y
#_01F41D: ASL A
#_01F41E: BCS .exit

#_01F420: LSR A
#_01F421: ORA.w #$8000
#_01F424: STA.w $0540,Y

;---------------------------------------------------------------------------------------------------

#_01F427: LDA.b $08
#_01F429: BNE .start_adjustment

#_01F42B: LDA.w $0540,Y
#_01F42E: STA.l $7EFB40,X

.start_adjustment
#_01F432: LDA.w $0540,Y
#_01F435: AND.w #$3FFF
#_01F438: TAX

#_01F439: STX.b $08

#_01F43B: PHX

#_01F43C: LDY.w #$0ECA
#_01F43F: JSR RoomDraw_AdjustTorchLightingChange

#_01F442: LDY.b $0C

#_01F444: LDA.w #$FFFF
#_01F447: STA.w $1100,Y

#_01F44A: PLA

#_01F44B: SEP #$30

#_01F44D: AND.b #$7F
#_01F44F: ASL A
#_01F450: JSL CalculateSFXPan_Arbitrary

#_01F454: ORA.b #!SFX2_2A
#_01F456: STA.w $012E

#_01F459: PLB

#_01F45A: LDA.b #$01
#_01F45C: STA.b $18

;---------------------------------------------------------------------------------------------------

#_01F45E: LDA.l $7EC005
#_01F462: BEQ .no_fixed_coloring

#_01F464: LDA.w $045A

#_01F467: INC.w $045A

#_01F46A: CMP.b #$03
#_01F46C: BCS .no_fixed_coloring

#_01F46E: STZ.b $1D

#_01F470: LDX.w $045A

#_01F473: LDA.l RoomEffectFixedColors,X
#_01F477: STA.l $7EC017

#_01F47B: LDA.b #$0A
#_01F47D: STA.b $11

#_01F47F: STZ.b $B0

;---------------------------------------------------------------------------------------------------

.no_fixed_coloring
#_01F481: LDA.w $0333
#_01F484: AND.b #$0F
#_01F486: TAX

#_01F487: PLA
#_01F488: STA.w $04F0,X

#_01F48B: STZ.w $0333

#_01F48E: RTL

;---------------------------------------------------------------------------------------------------

.exit
#_01F48F: SEP #$30

#_01F491: PLB
#_01F492: PLA

#_01F493: RTL

;===================================================================================================

Ganon_ExtinguishTorch_adjust_translucency:
#_01F494: JSL Palette_AssertTranslucencySwap

#_01F498: LDA.b #$C0
#_01F49A: STA.w $0333

#_01F49D: BRA Underworld_ExtinguishTorch

;===================================================================================================

Ganon_ExtinguishTorch:
#_01F49F: LDA.b #$C1
#_01F4A1: STA.w $0333

;===================================================================================================

Underworld_ExtinguishTorch:
#_01F4A4: LDA.b #$C0
#_01F4A6: STA.b $08
#_01F4A8: STZ.b $09

#_01F4AA: PHA
#_01F4AB: PHB

#_01F4AC: LDA.b #$00
#_01F4AE: PHA
#_01F4AF: PLB

#_01F4B0: REP #$30

#_01F4B2: LDA.w $0333
#_01F4B5: AND.w #$000F
#_01F4B8: ASL A

#_01F4B9: CLC
#_01F4BA: ADC.w $0478
#_01F4BD: TAY

#_01F4BE: LDA.w $0520,Y
#_01F4C1: AND.w #$00FF
#_01F4C4: TAX

#_01F4C5: LDA.w $0540,Y
#_01F4C8: ASL A
#_01F4C9: LSR A
#_01F4CA: STA.w $0540,Y
#_01F4CD: STA.l $7EFB40,X

#_01F4D1: AND.w #$3FFF
#_01F4D4: TAX

#_01F4D5: STX.b $08

#_01F4D7: LDY.w #$0EC2
#_01F4DA: JSR RoomDraw_AdjustTorchLightingChange

#_01F4DD: LDY.b $0C

#_01F4DF: LDA.w #$FFFF
#_01F4E2: STA.w $1100,Y

;---------------------------------------------------------------------------------------------------

#_01F4E5: SEP #$30

#_01F4E7: PLB

#_01F4E8: LDA.b #$01
#_01F4EA: STA.b $18

#_01F4EC: LDA.l $7EC005
#_01F4F0: BEQ .no_subscreen_changes

#_01F4F2: LDA.w $045A
#_01F4F5: BEQ .no_subscreen_changes

#_01F4F7: DEC A
#_01F4F8: STA.w $045A

#_01F4FB: CMP.b #$03
#_01F4FD: BCS .no_subscreen_changes

#_01F4FF: CMP.b #$00
#_01F501: BNE .only_fixed_color

#_01F503: LDA.b #$01
#_01F505: STA.b $1D

;---------------------------------------------------------------------------------------------------

.only_fixed_color
#_01F507: LDX.w $045A

#_01F50A: LDA.l RoomEffectFixedColors,X
#_01F50E: STA.l $7EC017

#_01F512: LDA.b #$0A
#_01F514: STA.b $11

#_01F516: STZ.b $B0

;---------------------------------------------------------------------------------------------------

.no_subscreen_changes
#_01F518: LDA.w $0333
#_01F51B: AND.b #$0F
#_01F51D: TAX

#_01F51E: PLA

#_01F51F: STZ.w $04F0,X
#_01F522: STZ.w $0333

#_01F525: RTL

;===================================================================================================

SpiralStairs_MakeNearbyWallsHighPriority_Entering:
#_01F526: REP #$30

#_01F528: LDA.w $0462
#_01F52B: AND.w #$0003
#_01F52E: ASL A
#_01F52F: TAY

#_01F530: LDA.w $06B0,Y
#_01F533: ASL A
#_01F534: SEC
#_01F535: SBC.w #$0008
#_01F538: TAX

#_01F539: STX.w $048C
#_01F53C: STX.b $08

#_01F53E: PHX

;---------------------------------------------------------------------------------------------------

#_01F53F: LDY.w #$0004

.next
#_01F542: LDA.l $7E2000,X
#_01F546: ORA.w #$2000
#_01F549: STA.l $7E2000,X

#_01F54D: LDA.l $7E2080,X
#_01F551: ORA.w #$2000
#_01F554: STA.l $7E2080,X

#_01F558: LDA.l $7E2100,X
#_01F55C: ORA.w #$2000
#_01F55F: STA.l $7E2100,X

#_01F563: LDA.l $7E2180,X
#_01F567: ORA.w #$2000
#_01F56A: STA.l $7E2180,X

#_01F56E: INX
#_01F56F: INX

#_01F570: DEY
#_01F571: BPL .next

;---------------------------------------------------------------------------------------------------

#_01F573: JSR RoomTag_WaterOff_AdjustOverlay

#_01F576: PLA
#_01F577: CLC
#_01F578: ADC.w #$0008
#_01F57B: STA.b $08

#_01F57D: JSR Underworld_PrepNextTileMapUpdateDMA

#_01F580: JMP.w RoomDraw_CloseStripes

;===================================================================================================

SpiralStairs_MakeNearbyWallsLowPriority:
#_01F583: REP #$30

#_01F585: LDX.w $048C
#_01F588: STX.b $08

#_01F58A: PHX

;---------------------------------------------------------------------------------------------------

#_01F58B: LDY.w #$0004

.next
#_01F58E: LDA.l $7E2000,X
#_01F592: AND.w #$DFFF
#_01F595: STA.l $7E2000,X

#_01F599: LDA.l $7E2080,X
#_01F59D: AND.w #$DFFF
#_01F5A0: STA.l $7E2080,X

#_01F5A4: LDA.l $7E2100,X
#_01F5A8: AND.w #$DFFF
#_01F5AB: STA.l $7E2100,X

#_01F5AF: LDA.l $7E2180,X
#_01F5B3: AND.w #$DFFF
#_01F5B6: STA.l $7E2180,X

#_01F5BA: INX
#_01F5BB: INX

#_01F5BC: DEY
#_01F5BD: BPL .next

;---------------------------------------------------------------------------------------------------

#_01F5BF: JSR RoomTag_WaterOff_AdjustOverlay

#_01F5C2: PLA
#_01F5C3: CLC
#_01F5C4: ADC.w #$0008
#_01F5C7: STA.b $08

#_01F5C9: JSR Underworld_PrepNextTileMapUpdateDMA

#_01F5CC: JMP.w RoomDraw_CloseStripes

;===================================================================================================

pool RoomDraw_OpenTriforceDoor

.tile
#_01F5CF: dw $2556, $2596, $25D6, $2616

pool off

;---------------------------------------------------------------------------------------------------

#EXIT_01F5D7:
#_01F5D7: RTL

;---------------------------------------------------------------------------------------------------

RoomDraw_OpenTriforceDoor:
#_01F5D8: LDA.b #$01
#_01F5DA: STA.w $02E4

#_01F5DD: LDA.b $C8
#_01F5DF: ORA.b $C9
#_01F5E1: BEQ .delay_sfx

#_01F5E3: DEC.b $C8
#_01F5E5: BNE EXIT_01F5D7

#_01F5E7: DEC.b $C9
#_01F5E9: BNE EXIT_01F5D7

#_01F5EB: LDA.b #!SFX1_15
#_01F5ED: STA.w $012D

#_01F5F0: STZ.w $03EF
#_01F5F3: STZ.b $50

;---------------------------------------------------------------------------------------------------

.delay_sfx
#_01F5F5: STZ.w $02E4

#_01F5F8: INC.b $B0

#_01F5FA: LDA.b $B0
#_01F5FC: AND.b #$03
#_01F5FE: BNE EXIT_01F5D7

#_01F600: REP #$30

#_01F602: LDA.b $B0
#_01F604: SEC
#_01F605: SBC.w #$0004
#_01F608: LSR A
#_01F609: TAX

#_01F60A: LDA.l .tile,X
#_01F60E: TAY

;---------------------------------------------------------------------------------------------------

#_01F60F: LDX.w #$0000

.next_draw
#_01F612: LDA.w RoomDrawObjectData+0,Y
#_01F615: STA.l $7E21D8,X

#_01F619: LDA.w RoomDrawObjectData+2,Y
#_01F61C: STA.l $7E2258,X

#_01F620: LDA.w RoomDrawObjectData+4,Y
#_01F623: STA.l $7E22D8,X

#_01F627: LDA.w RoomDrawObjectData+6,Y
#_01F62A: STA.l $7E2358,X

#_01F62E: TYA
#_01F62F: CLC
#_01F630: ADC.w #$0008
#_01F633: TAY

#_01F634: INX
#_01F635: INX

#_01F636: CPX.w #$0010
#_01F639: BNE .next_draw

;---------------------------------------------------------------------------------------------------

#_01F63B: LDA.w #$0008
#_01F63E: STA.b $0A

#_01F640: LDA.w #$0881
#_01F643: STA.b $06

#_01F645: LDX.w #$01D8
#_01F648: STX.b $08

#_01F64A: STZ.b $0C

#_01F64C: LDY.b $0C
#_01F64E: JSR TranslucentOverlay_FinalizeStripes

#_01F651: LDY.b $0C

#_01F653: LDA.w #$FFFF
#_01F656: STA.w $1100,Y

#_01F659: LDA.b $B0
#_01F65B: CMP.w #$0010
#_01F65E: BNE .finished

#_01F660: LDA.w #$0202
#_01F663: STA.l $7F216C
#_01F667: STA.l $7F21AC

#_01F66B: LDA.w #$0200
#_01F66E: STA.l $7F2172
#_01F672: STA.l $7F21B2

;---------------------------------------------------------------------------------------------------

#_01F676: LDX.w #$0000
#_01F679: LDA.w #$0000

.next_tilemap_update
#_01F67C: STA.l $7F202D,X
#_01F680: STA.l $7F206D,X
#_01F684: STA.l $7F20AD,X
#_01F688: STA.l $7F20ED,X

#_01F68C: STA.l $7F212D,X
#_01F690: STA.l $7F216D,X
#_01F694: STA.l $7F21AD,X

#_01F698: INX
#_01F699: INX
#_01F69A: CPX.w #$0006
#_01F69D: BNE .next_tilemap_update

;---------------------------------------------------------------------------------------------------

#_01F69F: LDA.w #$FFC0
#_01F6A2: STA.w $0600

#_01F6A5: SEP #$20

#_01F6A7: STZ.b $11
#_01F6A9: STZ.b $B0

.finished
#_01F6AB: SEP #$30

#_01F6AD: LDA.b #$01
#_01F6AF: STA.b $18

#_01F6B1: RTL

;===================================================================================================

UNREACHABLE_01F6B2:
#_01F6B2: LDA.w #$0004
#_01F6B5: STA.b $0A

#_01F6B7: LDY.b $0C

#_01F6B9: LDA.w #$0080
#_01F6BC: STA.b $06

#_01F6BE: LDA.b $08
#_01F6C0: AND.w #$003F
#_01F6C3: CMP.w #$003A
#_01F6C6: BCC .next

#_01F6C8: INC.b $06

;---------------------------------------------------------------------------------------------------

.next
#_01F6CA: LDX.b $08
#_01F6CC: TXA
#_01F6CD: AND.w #$0040

#_01F6D0: LSR A ; /16
#_01F6D1: LSR A
#_01F6D2: LSR A
#_01F6D3: LSR A

#_01F6D4: XBA
#_01F6D5: STA.b $00

#_01F6D7: TXA
#_01F6D8: AND.w #$303F
#_01F6DB: LSR A
#_01F6DC: STA.b $02

#_01F6DE: TXA
#_01F6DF: AND.w #$0F80
#_01F6E2: LSR A
#_01F6E3: LSR A
#_01F6E4: ORA.b $00
#_01F6E6: ORA.b $02
#_01F6E8: STA.w $1100,Y

#_01F6EB: LDX.w $045E

#_01F6EE: LDA.w $1600,X
#_01F6F1: STA.w $1104,Y

#_01F6F4: LDA.b $06
#_01F6F6: STA.w $1102,Y

#_01F6F9: LSR A
#_01F6FA: BCS .skip

;---------------------------------------------------------------------------------------------------

#_01F6FC: LDA.w $1602,X
#_01F6FF: STA.w $1106,Y

#_01F702: LDA.w $1604,X
#_01F705: STA.w $1108,Y

#_01F708: LDA.w $1606,X
#_01F70B: STA.w $110A,Y

#_01F70E: LDA.b $08
#_01F710: CLC
#_01F711: ADC.w #$0080
#_01F714: STA.b $08

#_01F716: TXA
#_01F717: CLC
#_01F718: ADC.w #$0008
#_01F71B: TAX

#_01F71C: BRA .continue

;---------------------------------------------------------------------------------------------------

.skip
#_01F71E: LDA.w $1608,X
#_01F721: STA.w $1106,Y

#_01F724: LDA.w $1610,X
#_01F727: STA.w $1108,Y

#_01F72A: LDA.w $1618,X
#_01F72D: STA.w $110A,Y

#_01F730: INC.b $08
#_01F732: INC.b $08

#_01F734: INX
#_01F735: INX

;---------------------------------------------------------------------------------------------------

.continue
#_01F736: STX.w $045E

#_01F739: TYA
#_01F73A: CLC
#_01F73B: ADC.w #$000C
#_01F73E: TAY

#_01F73F: DEC.b $0A
#_01F741: BNE .next

#_01F743: RTS

;===================================================================================================

RoomDraw_AdjustTorchLightingChange:
#_01F744: LDA.w RoomDrawObjectData+0,Y
#_01F747: STA.l $7E2000,X

#_01F74B: LDA.w RoomDrawObjectData+2,Y
#_01F74E: STA.l $7E2080,X

#_01F752: LDA.w RoomDrawObjectData+4,Y
#_01F755: STA.l $7E2002,X

#_01F759: LDA.w RoomDrawObjectData+6,Y
#_01F75C: STA.l $7E2082,X

;===================================================================================================
; TODO better name
RoomTag_WaterOff_AdjustOverlay:
#_01F760: STZ.b $0C

;===================================================================================================

Underworld_PrepNextTileMapUpdateDMA:
#_01F762: LDA.w #$0004
#_01F765: STA.b $0A

#_01F767: LDY.b $0C

#_01F769: LDA.w #$0880
#_01F76C: STA.b $06

#_01F76E: LDA.b $08
#_01F770: AND.w #$003F
#_01F773: CMP.w #$003A
#_01F776: BCC TranslucentOverlay_FinalizeStripes

#_01F778: INC.b $06

;===================================================================================================

TranslucentOverlay_FinalizeStripes:
.next
#_01F77A: LDX.b $08

#_01F77C: TXA
#_01F77D: AND.w #$0040

#_01F780: LSR A ; /16
#_01F781: LSR A
#_01F782: LSR A
#_01F783: LSR A

#_01F784: XBA
#_01F785: STA.b $00

#_01F787: TXA
#_01F788: AND.w #$303F
#_01F78B: LSR A
#_01F78C: ORA.b $00
#_01F78E: STA.b $00

#_01F790: TXA
#_01F791: AND.w #$0F80
#_01F794: LSR A
#_01F795: LSR A
#_01F796: ORA.b $00
#_01F798: STA.w $1100,Y

#_01F79B: LDA.l $7E2000,X
#_01F79F: STA.w $1104,Y

#_01F7A2: LDA.b $06
#_01F7A4: STA.w $1102,Y

#_01F7A7: LSR A
#_01F7A8: BCS .high

;---------------------------------------------------------------------------------------------------

#_01F7AA: LDA.l $7E2002,X
#_01F7AE: STA.w $1106,Y

#_01F7B1: LDA.l $7E2004,X
#_01F7B5: STA.w $1108,Y

#_01F7B8: LDA.l $7E2006,X
#_01F7BC: STA.w $110A,Y

#_01F7BF: LDA.b $08
#_01F7C1: CLC
#_01F7C2: ADC.w #$0080
#_01F7C5: STA.b $08

#_01F7C7: BRA .continue

;---------------------------------------------------------------------------------------------------

.high
#_01F7C9: LDA.l $7E2080,X
#_01F7CD: STA.w $1106,Y

#_01F7D0: LDA.l $7E2100,X
#_01F7D4: STA.w $1108,Y

#_01F7D7: LDA.l $7E2180,X
#_01F7DB: STA.w $110A,Y

#_01F7DE: INC.b $08
#_01F7E0: INC.b $08

;---------------------------------------------------------------------------------------------------

.continue
#_01F7E2: TYA
#_01F7E3: CLC
#_01F7E4: ADC.w #$000C
#_01F7E7: TAY

#_01F7E8: DEC.b $0A
#_01F7EA: BNE .next

#_01F7EC: STY.b $0C

#_01F7EE: RTS

;===================================================================================================

pool ClearAndStripeExplodingWall

.offset
#_01F7EF: dw $0004, $0008, $000C, $0010
#_01F7F7: dw $0014, $0018, $001C, $0020
#_01F7FF: dw $0100, $0200, $0300, $0400
#_01F807: dw $0500, $0600, $0700, $0800

pool off

;---------------------------------------------------------------------------------------------------

ClearAndStripeExplodingWall:
#_01F80F: LDA.w #$0080
#_01F812: STA.b $06

#_01F814: STZ.b $0E

#_01F816: LDA.w $0454
#_01F819: CLC
#_01F81A: ADC.w #$0003
#_01F81D: STA.b $0A

#_01F81F: SEC
#_01F820: SBC.w #$0006
#_01F823: CMP.w #$0002
#_01F826: BMI .no_adjust

#_01F828: STA.b $02

#_01F82A: INC.b $0E

#_01F82C: LDA.w #$0003
#_01F82F: STA.b $0A

.no_adjust
#_01F831: LDY.b $0C

#_01F833: LDX.w $0460

#_01F836: LDA.w $19C0,X
#_01F839: AND.w #$0002
#_01F83C: BNE .next

#_01F83E: INC.b $06

;---------------------------------------------------------------------------------------------------

.next
#_01F840: LDX.b $08
#_01F842: TXA
#_01F843: AND.w #$0040

#_01F846: LSR A ; /16
#_01F847: LSR A
#_01F848: LSR A
#_01F849: LSR A

#_01F84A: XBA
#_01F84B: STA.b $00

#_01F84D: TXA
#_01F84E: AND.w #$303F
#_01F851: LSR A
#_01F852: ORA.b $00
#_01F854: STA.b $00

#_01F856: TXA
#_01F857: AND.w #$0F80
#_01F85A: LSR A
#_01F85B: LSR A
#_01F85C: ORA.b $00
#_01F85E: STA.w $1100,Y

#_01F861: PHA

#_01F862: LDA.l $7E2000,X
#_01F866: STA.w $1104,Y

#_01F869: LDA.b $06
#_01F86B: ORA.w #$0A00
#_01F86E: STA.w $1102,Y

#_01F871: LDA.b $06
#_01F873: ORA.w #$0E00
#_01F876: STA.w $1110,Y

#_01F879: PLA

#_01F87A: CLC
#_01F87B: ADC.w #$04A0
#_01F87E: STA.w $110E,Y

#_01F881: LDA.l $7E2080,X
#_01F885: STA.w $1106,Y

#_01F888: LDA.l $7E2100,X
#_01F88C: STA.w $1108,Y

#_01F88F: LDA.l $7E2180,X
#_01F893: STA.w $110A,Y

#_01F896: LDA.l $7E2200,X
#_01F89A: STA.w $110C,Y

#_01F89D: LDA.l $7E2280,X
#_01F8A1: STA.w $1112,Y

#_01F8A4: LDA.l $7E2300,X
#_01F8A8: STA.w $1114,Y

#_01F8AB: LDA.l $7E2380,X
#_01F8AF: STA.w $1116,Y

#_01F8B2: LDA.l $7E2400,X
#_01F8B6: STA.w $1118,Y

#_01F8B9: LDA.l $7E2480,X
#_01F8BD: STA.w $111A,Y

#_01F8C0: LDA.l $7E2500,X
#_01F8C4: STA.w $111C,Y

#_01F8C7: LDA.l $7E2580,X
#_01F8CB: STA.w $111E,Y

#_01F8CE: INC.b $08
#_01F8D0: INC.b $08

#_01F8D2: TYA
#_01F8D3: CLC
#_01F8D4: ADC.w #$0020
#_01F8D7: TAY

#_01F8D8: DEC.b $0A
#_01F8DA: BEQ .do_more

#_01F8DC: JMP.w .next

;---------------------------------------------------------------------------------------------------

.do_more
#_01F8DF: LDA.b $0E
#_01F8E1: BEQ .finished

#_01F8E3: DEC.b $0E

#_01F8E5: LDX.b $02

#_01F8E7: LDA.b $06
#_01F8E9: LSR A
#_01F8EA: BCS .dont_move_down

#_01F8EC: TXA
#_01F8ED: CLC
#_01F8EE: ADC.w #$0010
#_01F8F1: TAX

.dont_move_down
#_01F8F2: LDA.l .offset-2,X
#_01F8F6: CLC
#_01F8F7: ADC.b $08
#_01F8F9: STA.b $08

#_01F8FB: LDA.w #$0003
#_01F8FE: STA.b $0A

#_01F900: JMP.w .next

;---------------------------------------------------------------------------------------------------

.finished
#_01F903: STY.b $0C

#_01F905: RTS

;===================================================================================================

UNREACHABLE_01F906:
#_01F906: STA.b $0C

#_01F908: STY.b $0E
#_01F90A: STY.b $0A

#_01F90C: LDY.w #$0000

.next
#_01F90F: TXA
#_01F910: AND.w #$0040
#_01F913: LSR A
#_01F914: LSR A
#_01F915: LSR A
#_01F916: LSR A
#_01F917: XBA
#_01F918: STA.b $00

#_01F91A: TXA
#_01F91B: AND.w #$303F
#_01F91E: LSR A
#_01F91F: STA.b $02

#_01F921: TXA
#_01F922: AND.w #$0F80
#_01F925: LSR A
#_01F926: LSR A
#_01F927: ORA.b $00
#_01F929: ORA.b $02
#_01F92B: XBA
#_01F92C: STA.w $1002,Y

#_01F92F: LDA.w #$0100
#_01F932: STA.w $1004,Y

#_01F935: LDA.l $7E4000,X
#_01F939: STA.w $1006,Y

#_01F93C: INY ; +6
#_01F93D: INY
#_01F93E: INY
#_01F93F: INY
#_01F940: INY
#_01F941: INY

#_01F942: INX
#_01F943: INX

#_01F944: DEC.b $0E
#_01F946: BNE .next

#_01F948: LDA.b $0A
#_01F94A: STA.b $0E

#_01F94C: TXA
#_01F94D: CLC
#_01F94E: ADC.w #$0070
#_01F951: TAX

#_01F952: DEC.b $0C
#_01F954: BNE .next

;---------------------------------------------------------------------------------------------------

#_01F956: LDA.w #$FFFF
#_01F959: STA.w $1002,Y

#_01F95C: SEP #$20

#_01F95E: LDA.b #$01
#_01F960: STA.b $14

#_01F962: REP #$20

#_01F964: RTS

;===================================================================================================

Underworld_DrawRoomOverlay:
.next
#_01F965: REP #$30

#_01F967: STZ.b $B2
#_01F969: STZ.b $B4

#_01F96B: LDY.b $BA

#_01F96D: LDA.b [$B7],Y
#_01F96F: CMP.w #$FFFF
#_01F972: BEQ .done

#_01F974: STA.b $00

#_01F976: JSR .draw_chunk

#_01F979: BRA .next

.done
#_01F97B: SEP #$30

#_01F97D: RTS

;---------------------------------------------------------------------------------------------------

.draw_chunk
#_01F97E: SEP #$20

#_01F980: LDA.b [$B7],Y
#_01F982: AND.b #$FC
#_01F984: STA.b $08

#_01F986: INY
#_01F987: INY

#_01F988: LDA.b [$B7],Y
#_01F98A: STA.b $04
#_01F98C: STZ.b $05

#_01F98E: LDA.b $01

#_01F990: LSR A ; /8
#_01F991: LSR A
#_01F992: LSR A

#_01F993: ROR.b $08
#_01F995: STA.b $09

#_01F997: INY
#_01F998: STY.b $BA

#_01F99A: REP #$20

#_01F99C: LDA.b $04
#_01F99E: LDX.b $08

#_01F9A0: CMP.w #$00A4
#_01F9A3: BNE .draw_solid_floor

;---------------------------------------------------------------------------------------------------

.draw_hole
#_01F9A5: LDY.w #$05AA
#_01F9A8: LDA.w RoomDrawObjectData+0,Y
#_01F9AB: STA.l $7E2080,X
#_01F9AF: STA.l $7E2082,X
#_01F9B3: STA.l $7E2084,X
#_01F9B7: STA.l $7E2086,X
#_01F9BB: STA.l $7E2100,X
#_01F9BF: STA.l $7E2102,X
#_01F9C3: STA.l $7E2104,X
#_01F9C7: STA.l $7E2106,X

#_01F9CB: LDY.w #$063C
#_01F9CE: LDA.w RoomDrawObjectData+2,Y
#_01F9D1: STA.l $7E2000,X
#_01F9D5: STA.l $7E2002,X
#_01F9D9: STA.l $7E2004,X
#_01F9DD: STA.l $7E2006,X

#_01F9E1: LDY.w #$0642
#_01F9E4: LDA.w RoomDrawObjectData+2,Y
#_01F9E7: STA.l $7E2180,X
#_01F9EB: STA.l $7E2182,X
#_01F9EF: STA.l $7E2184,X
#_01F9F3: STA.l $7E2186,X

#_01F9F7: RTS

;---------------------------------------------------------------------------------------------------

.draw_solid_floor
#_01F9F8: LDY.w $046A

#_01F9FB: LDA.w RoomDrawObjectData+0,Y
#_01F9FE: STA.l $7E2000,X
#_01FA02: STA.l $7E2004,X
#_01FA06: STA.l $7E2100,X
#_01FA0A: STA.l $7E2104,X

#_01FA0E: LDA.w RoomDrawObjectData+2,Y
#_01FA11: STA.l $7E2002,X
#_01FA15: STA.l $7E2006,X
#_01FA19: STA.l $7E2102,X
#_01FA1D: STA.l $7E2106,X

#_01FA21: LDA.w RoomDrawObjectData+8,Y
#_01FA24: STA.l $7E2080,X
#_01FA28: STA.l $7E2084,X
#_01FA2C: STA.l $7E2180,X
#_01FA30: STA.l $7E2184,X

#_01FA34: LDA.w RoomDrawObjectData+10,Y
#_01FA37: STA.l $7E2082,X
#_01FA3B: STA.l $7E2086,X
#_01FA3F: STA.l $7E2182,X
#_01FA43: STA.l $7E2186,X

#_01FA47: RTS

;===================================================================================================

GetDoorDrawDataIndex_North_clean_door_index:
#_01FA48: LDA.w $0460
#_01FA4B: AND.w #$00FF
#_01FA4E: STA.b $04

#_01FA50: BRA GetDoorDrawDataIndex_North

;===================================================================================================

DoorDoorStep1_North:
#_01FA52: LDA.w $0460
#_01FA55: PHA

#_01FA56: AND.w #$000F
#_01FA59: STA.b $04

#_01FA5B: TXA
#_01FA5C: AND.w #$1FFF
#_01FA5F: CMP.w DoorTileMapPositions_NorthMiddle
#_01FA62: BCC .one_sided_door

#_01FA64: TXA
#_01FA65: SEC
#_01FA66: SBC.w #$0500
#_01FA69: STA.b $08

#_01FA6B: PHX

#_01FA6C: LDX.w $0460

#_01FA6F: LDA.w $1980,X
#_01FA72: AND.w #$00FE
#_01FA75: CMP.w #$0042
#_01FA78: BCC .upper_layer_door

#_01FA7A: LDA.b $08
#_01FA7C: SEC
#_01FA7D: SBC.w #$0300
#_01FA80: STA.b $08

.upper_layer_door
#_01FA82: LDA.w $0460
#_01FA85: EOR.w #$0010
#_01FA88: STA.w $0460

#_01FA8B: JSR GetDoorDrawDataIndex_South
#_01FA8E: JSR Underworld_PrepNextTileMapUpdateDMA

#_01FA91: LDY.w $0460
#_01FA94: JSR Underworld_LoadSingleDoorAttribute

#_01FA97: PLX
#_01FA98: STX.b $08

.one_sided_door
#_01FA9A: PLA
#_01FA9B: STA.w $0460

;===================================================================================================
; TODO other door types
GetDoorDrawDataIndex_North:
#_01FA9E: LDX.w $0460

#_01FAA1: LDA.w $1980,X
#_01FAA4: AND.w #$00FE

#_01FAA7: LDX.w $0692
#_01FAAA: BEQ DrawDoorToTileMap_North

#_01FAAC: CPX.w #$0004
#_01FAAF: BEQ DrawDoorToTileMap_North

#_01FAB1: CMP.w #$0024
#_01FAB4: BEQ .advance_data_index

#_01FAB6: CMP.w #$0026
#_01FAB9: BEQ .advance_data_index

#_01FABB: CMP.w #$0042
#_01FABE: BCC .dont_advance_data_index

.advance_data_index
#_01FAC0: INX
#_01FAC1: INX
#_01FAC2: INX
#_01FAC3: INX

.dont_advance_data_index
#_01FAC4: CMP.w #$0018
#_01FAC7: BEQ .shutter_door

#_01FAC9: CMP.w #$0044
#_01FACC: BNE .not_shutter_door

.shutter_door
#_01FACE: INX
#_01FACF: INX

.not_shutter_door
#_01FAD0: LDY.w DoorAnimGFXDataOffset_North,X

#_01FAD3: BRA .continue

;===================================================================================================

#DrawDoorToTileMap_North:
#_01FAD5: JSR GetDoorGraphicsIndex

#_01FAD8: LDY.w DoorGFXDataOffset_North,X

.continue
#_01FADB: LDX.w $0460

#_01FADE: LDA.w $19A0,X
#_01FAE1: TAX

#_01FAE2: LDA.w #$0004
#_01FAE5: STA.b $0E

;---------------------------------------------------------------------------------------------------

.next_draw
#_01FAE7: LDA.w RoomDrawObjectData+0,Y
#_01FAEA: STA.l $7E2000,X

#_01FAEE: LDA.w RoomDrawObjectData+2,Y
#_01FAF1: STA.l $7E2080,X

#_01FAF5: LDA.w RoomDrawObjectData+4,Y
#_01FAF8: STA.l $7E2100,X

#_01FAFC: TYA
#_01FAFD: CLC
#_01FAFE: ADC.w #$0006
#_01FB01: TAY

#_01FB02: INX
#_01FB03: INX

#_01FB04: DEC.b $0E
#_01FB06: BNE .next_draw

#_01FB08: RTS

;===================================================================================================

GetDoorDrawDataIndex_South_clean_door_index:
#_01FB09: LDA.w $0460
#_01FB0C: AND.w #$00FF
#_01FB0F: STA.b $04

#_01FB11: BRA GetDoorDrawDataIndex_South

;===================================================================================================

DoorDoorStep1_South:
#_01FB13: LDA.w $0460
#_01FB16: PHA

#_01FB17: AND.w #$000F
#_01FB1A: STA.b $04

#_01FB1C: TXA
#_01FB1D: AND.w #$1FFF
#_01FB20: CMP.w DoorTileMapPositions_LowerLayerEntrance
#_01FB23: BCS .one_sided_door

#_01FB25: TXA
#_01FB26: CLC
#_01FB27: ADC.w #$0500
#_01FB2A: STA.b $08

#_01FB2C: PHX

#_01FB2D: LDX.w $0460

#_01FB30: LDA.w $1980,X
#_01FB33: AND.w #$00FE
#_01FB36: CMP.w #$0042
#_01FB39: BCC .upper_layer_door

#_01FB3B: LDA.b $08
#_01FB3D: CLC
#_01FB3E: ADC.w #$0300
#_01FB41: STA.b $08

.upper_layer_door
#_01FB43: LDA.w $0460
#_01FB46: EOR.w #$0010
#_01FB49: STA.w $0460

#_01FB4C: JSR GetDoorDrawDataIndex_North
#_01FB4F: JSR Underworld_PrepNextTileMapUpdateDMA

#_01FB52: LDY.w $0460
#_01FB55: JSR Underworld_LoadSingleDoorAttribute

#_01FB58: PLX
#_01FB59: STX.b $08

.one_sided_door
#_01FB5B: PLA
#_01FB5C: STA.w $0460

;===================================================================================================

GetDoorDrawDataIndex_South:
#_01FB5F: LDX.w $0460

#_01FB62: LDA.w $1980,X
#_01FB65: AND.w #$00FE

#_01FB68: LDX.w $0692
#_01FB6B: BEQ DrawDoorToTileMap_South

#_01FB6D: CPX.w #$0004
#_01FB70: BEQ DrawDoorToTileMap_South

#_01FB72: CMP.w #$0042
#_01FB75: BCC .dont_advance_data_index

#_01FB77: INX
#_01FB78: INX
#_01FB79: INX
#_01FB7A: INX

.dont_advance_data_index
#_01FB7B: CMP.w #$0018
#_01FB7E: BEQ .shutter_door

#_01FB80: CMP.w #$0044
#_01FB83: BNE .not_shutter_door

.shutter_door
#_01FB85: INX
#_01FB86: INX

.not_shutter_door
#_01FB87: LDY.w DoorAnimGFXDataOffset_South,X

#_01FB8A: BRA .continue

;===================================================================================================

#DrawDoorToTileMap_South:
#_01FB8C: JSR GetDoorGraphicsIndex

#_01FB8F: LDY.w DoorGFXDataOffset_South,X

.continue
#_01FB92: LDX.w $0460

#_01FB95: LDA.w $19A0,X
#_01FB98: TAX

#_01FB99: LDA.w #$0004
#_01FB9C: STA.b $0E

.next_draw
#_01FB9E: LDA.w RoomDrawObjectData+0,Y
#_01FBA1: STA.l $7E2080,X

#_01FBA5: LDA.w RoomDrawObjectData+2,Y
#_01FBA8: STA.l $7E2100,X

#_01FBAC: LDA.w RoomDrawObjectData+4,Y
#_01FBAF: STA.l $7E2180,X

#_01FBB3: TYA
#_01FBB4: CLC
#_01FBB5: ADC.w #$0006
#_01FBB8: TAY

#_01FBB9: INX
#_01FBBA: INX

#_01FBBB: DEC.b $0E
#_01FBBD: BNE .next_draw

#_01FBBF: RTS

;===================================================================================================

GetDoorDrawDataIndex_West_clean_door_index:
#_01FBC0: LDA.w $0460
#_01FBC3: AND.w #$00FF
#_01FBC6: STA.b $04

#_01FBC8: BRA GetDoorDrawDataIndex_West

;===================================================================================================

DoorDoorStep1_West:
#_01FBCA: LDA.w $0460
#_01FBCD: PHA

#_01FBCE: AND.w #$000F
#_01FBD1: STA.b $04

#_01FBD3: TXA
#_01FBD4: AND.w #$07FF
#_01FBD7: CMP.w DoorTileMapPositions_WestMiddle
#_01FBDA: BCC .one_sided_door

#_01FBDC: TXA
#_01FBDD: SEC
#_01FBDE: SBC.w #$0010
#_01FBE1: STA.b $08

#_01FBE3: PHX

#_01FBE4: LDX.w $0460

#_01FBE7: LDA.w $1980,X
#_01FBEA: AND.w #$00FE
#_01FBED: CMP.w #$0042
#_01FBF0: BCC .upper_layer_door

#_01FBF2: LDA.b $08
#_01FBF4: SEC
#_01FBF5: SBC.w #$000C
#_01FBF8: STA.b $08

.upper_layer_door
#_01FBFA: LDA.w $0460
#_01FBFD: EOR.w #$0010
#_01FC00: STA.w $0460

#_01FC03: JSR GetDoorDrawDataIndex_East
#_01FC06: JSR Underworld_PrepNextTileMapUpdateDMA

#_01FC09: LDY.w $0460
#_01FC0C: JSR Underworld_LoadSingleDoorAttribute

#_01FC0F: PLX
#_01FC10: STX.b $08

.one_sided_door
#_01FC12: PLA
#_01FC13: STA.w $0460

;===================================================================================================

GetDoorDrawDataIndex_West:
#_01FC16: LDX.w $0460

#_01FC19: LDA.w $1980,X
#_01FC1C: AND.w #$00FE

#_01FC1F: LDX.w $0692
#_01FC22: BEQ DrawDoorToTileMap_West

#_01FC24: CPX.w #$0004
#_01FC27: BEQ DrawDoorToTileMap_West

#_01FC29: CMP.w #$0042
#_01FC2C: BCC .dont_advance_data_index

#_01FC2E: INX
#_01FC2F: INX
#_01FC30: INX
#_01FC31: INX

.dont_advance_data_index
#_01FC32: CMP.w #$0018
#_01FC35: BEQ .shutter_door

#_01FC37: CMP.w #$0044
#_01FC3A: BNE .not_shutter_door

.shutter_door
#_01FC3C: INX
#_01FC3D: INX

.not_shutter_door
#_01FC3E: LDY.w DoorAnimGFXDataOffset_West,X

#_01FC41: BRA .continue

;===================================================================================================

#DrawDoorToTileMap_West:
#_01FC43: JSR GetDoorGraphicsIndex

#_01FC46: LDY.w DoorGFXDataOffset_West,X

.continue
#_01FC49: LDX.w $0460

#_01FC4C: LDA.w $19A0,X
#_01FC4F: TAX

#_01FC50: LDA.w #$0003
#_01FC53: STA.b $0E

.next_draw
#_01FC55: LDA.w RoomDrawObjectData+0,Y
#_01FC58: STA.l $7E2000,X

#_01FC5C: LDA.w RoomDrawObjectData+2,Y
#_01FC5F: STA.l $7E2080,X

#_01FC63: LDA.w RoomDrawObjectData+4,Y
#_01FC66: STA.l $7E2100,X

#_01FC6A: LDA.w RoomDrawObjectData+6,Y
#_01FC6D: STA.l $7E2180,X

#_01FC71: TYA
#_01FC72: CLC
#_01FC73: ADC.w #$0008
#_01FC76: TAY

#_01FC77: INX
#_01FC78: INX

#_01FC79: DEC.b $0E
#_01FC7B: BNE .next_draw

#_01FC7D: RTS

;===================================================================================================

GetDoorDrawDataIndex_East_clean_door_index:
#_01FC7E: LDA.w $0460
#_01FC81: AND.w #$00FF
#_01FC84: STA.b $04

#_01FC86: BRA GetDoorDrawDataIndex_East

;===================================================================================================

DoorDoorStep1_East:
#_01FC88: LDA.w $0460
#_01FC8B: PHA

#_01FC8C: AND.w #$000F
#_01FC8F: STA.b $04

#_01FC91: TXA

#_01FC92: AND.w #$07FF
#_01FC95: CMP.w DoorTileMapPositions_EastWall
#_01FC98: BCS .one_sided_door

#_01FC9A: TXA
#_01FC9B: CLC
#_01FC9C: ADC.w #$0010
#_01FC9F: STA.b $08

#_01FCA1: PHX

#_01FCA2: LDX.w $0460

#_01FCA5: LDA.w $1980,X
#_01FCA8: AND.w #$00FE
#_01FCAB: CMP.w #$0042
#_01FCAE: BCC .upper_layer_door

#_01FCB0: LDA.b $08
#_01FCB2: CLC
#_01FCB3: ADC.w #$000C
#_01FCB6: STA.b $08

.upper_layer_door
#_01FCB8: LDA.w $0460
#_01FCBB: EOR.w #$0010
#_01FCBE: STA.w $0460

#_01FCC1: JSR GetDoorDrawDataIndex_West
#_01FCC4: JSR Underworld_PrepNextTileMapUpdateDMA

#_01FCC7: LDY.w $0460
#_01FCCA: JSR Underworld_LoadSingleDoorAttribute

#_01FCCD: PLX
#_01FCCE: STX.b $08

.one_sided_door
#_01FCD0: PLA
#_01FCD1: STA.w $0460

;===================================================================================================

GetDoorDrawDataIndex_East:
#_01FCD4: LDX.w $0460

#_01FCD7: LDA.w $1980,X
#_01FCDA: AND.w #$00FE

#_01FCDD: LDX.w $0692
#_01FCE0: BEQ DrawDoorToTileMap_East

#_01FCE2: CPX.w #$0004
#_01FCE5: BEQ DrawDoorToTileMap_East

#_01FCE7: CMP.w #$0042
#_01FCEA: BCC .dont_advance_data_index

#_01FCEC: INX
#_01FCED: INX
#_01FCEE: INX
#_01FCEF: INX

.dont_advance_data_index
#_01FCF0: CMP.w #$0018
#_01FCF3: BEQ .shutter_door

#_01FCF5: CMP.w #$0044
#_01FCF8: BNE .not_shutter_door

.shutter_door
#_01FCFA: INX
#_01FCFB: INX

.not_shutter_door
#_01FCFC: LDY.w DoorAnimGFXDataOffset_East,X

#_01FCFF: BRA .continue

;===================================================================================================

#DrawDoorToTileMap_East:
#_01FD01: JSR GetDoorGraphicsIndex

#_01FD04: LDY.w DoorGFXDataOffset_East,X

.continue
#_01FD07: LDX.w $0460

#_01FD0A: LDA.w $19A0,X
#_01FD0D: TAX

#_01FD0E: LDA.w #$0003
#_01FD11: STA.b $0E

.next_draw
#_01FD13: LDA.w RoomDrawObjectData+0,Y
#_01FD16: STA.l $7E2002,X

#_01FD1A: LDA.w RoomDrawObjectData+2,Y
#_01FD1D: STA.l $7E2082,X

#_01FD21: LDA.w RoomDrawObjectData+4,Y
#_01FD24: STA.l $7E2102,X

#_01FD28: LDA.w RoomDrawObjectData+6,Y
#_01FD2B: STA.l $7E2182,X

#_01FD2F: TYA
#_01FD30: CLC
#_01FD31: ADC.w #$0008
#_01FD34: TAY

#_01FD35: INX
#_01FD36: INX

#_01FD37: DEC.b $0E
#_01FD39: BNE .next_draw

#_01FD3B: RTS

;===================================================================================================

ClearDoorCurtainsFromTileMap:
#_01FD3C: LDX.w #$0056

#_01FD3F: LDY.w DoorGFXDataOffset_North,X

#_01FD42: LDX.w $0460

#_01FD45: LDA.w $19A0,X
#_01FD48: TAX

#_01FD49: LDA.w #$0004
#_01FD4C: STA.b $0E

;---------------------------------------------------------------------------------------------------

.next
#_01FD4E: LDA.w RoomDrawObjectData+0,Y
#_01FD51: STA.l $7E2000,X

#_01FD55: LDA.w RoomDrawObjectData+2,Y
#_01FD58: STA.l $7E2080,X

#_01FD5C: LDA.w RoomDrawObjectData+4,Y
#_01FD5F: STA.l $7E2100,X

#_01FD63: LDA.w RoomDrawObjectData+6,Y
#_01FD66: STA.l $7E2180,X

#_01FD6A: TYA
#_01FD6B: CLC
#_01FD6C: ADC.w #$0008
#_01FD6F: TAY

#_01FD70: INX
#_01FD71: INX

#_01FD72: DEC.b $0E
#_01FD74: BNE .next

#_01FD76: RTS

;===================================================================================================

GetDoorGraphicsIndex:
#_01FD77: LDY.w $0460

#_01FD7A: LDA.w $1980,Y
#_01FD7D: AND.w #$00FE
#_01FD80: TAX

#_01FD81: LDY.b $04

#_01FD83: LDA.w $068C
#_01FD86: AND.w DungeonMask,Y
#_01FD89: BEQ .exit

#_01FD8B: LDA.w DoorwayReplacementDoorGFX,X
#_01FD8E: TAX

.exit
#_01FD8F: RTS

;===================================================================================================

ClearExplodingWallFromTileMap:
#_01FD90: LDY.w #$31EA

#_01FD93: JSR ClearExplodingWallFromTileMap_ClearOnePair

#_01FD96: LDA.w $0454
#_01FD99: DEC A
#_01FD9A: STA.b $0E
#_01FD9C: BEQ .skip

#_01FD9E: LDA.w RoomDrawObjectData+0,Y

;---------------------------------------------------------------------------------------------------

.next
#_01FDA1: STA.l $7E2000,X
#_01FDA5: STA.l $7E2080,X
#_01FDA9: STA.l $7E2100,X
#_01FDAD: STA.l $7E2180,X

#_01FDB1: STA.l $7E2200,X
#_01FDB5: STA.l $7E2280,X
#_01FDB9: STA.l $7E2300,X
#_01FDBD: STA.l $7E2380,X

#_01FDC1: STA.l $7E2400,X
#_01FDC5: STA.l $7E2480,X
#_01FDC9: STA.l $7E2500,X
#_01FDCD: STA.l $7E2580,X

#_01FDD1: INX
#_01FDD2: INX

#_01FDD3: DEC.b $0E
#_01FDD5: BNE .next

;---------------------------------------------------------------------------------------------------

.skip
#_01FDD7: INY
#_01FDD8: INY

;===================================================================================================

ClearExplodingWallFromTileMap_ClearOnePair:
#_01FDD9: LDA.w #$0002
#_01FDDC: STA.b $0E

.next
#_01FDDE: LDA.w RoomDrawObjectData+0,Y
#_01FDE1: STA.l $7E2000,X

#_01FDE5: LDA.w RoomDrawObjectData+2,Y
#_01FDE8: STA.l $7E2080,X

#_01FDEC: LDA.w RoomDrawObjectData+4,Y
#_01FDEF: STA.l $7E2100,X

#_01FDF3: LDA.w RoomDrawObjectData+6,Y
#_01FDF6: STA.l $7E2180,X

#_01FDFA: LDA.w RoomDrawObjectData+8,Y
#_01FDFD: STA.l $7E2200,X

#_01FE01: LDA.w RoomDrawObjectData+10,Y
#_01FE04: STA.l $7E2280,X

#_01FE08: LDA.w RoomDrawObjectData+12,Y
#_01FE0B: STA.l $7E2300,X

#_01FE0F: LDA.w RoomDrawObjectData+14,Y
#_01FE12: STA.l $7E2380,X

#_01FE16: LDA.w RoomDrawObjectData+16,Y
#_01FE19: STA.l $7E2400,X

#_01FE1D: LDA.w RoomDrawObjectData+18,Y
#_01FE20: STA.l $7E2480,X

#_01FE24: LDA.w RoomDrawObjectData+20,Y
#_01FE27: STA.l $7E2500,X

#_01FE2B: LDA.w RoomDrawObjectData+22,Y
#_01FE2E: STA.l $7E2580,X

#_01FE32: INX
#_01FE33: INX

#_01FE34: TYA
#_01FE35: CLC
#_01FE36: ADC.w #$0018
#_01FE39: TAY

#_01FE3A: DEC.b $0E
#_01FE3C: BNE .next

#_01FE3E: RTS

;===================================================================================================

Underworld_DrawRoomOverlay_Apply:
#_01FE3F: STA.b $08

#_01FE41: LDA.w #$0004
#_01FE44: STA.b $0A

.next_super
#_01FE46: LDX.b $08

#_01FE48: LDA.l $7E2000,X
#_01FE4C: STA.b $00

#_01FE4E: LDA.l $7E2002,X
#_01FE52: STA.b $02

#_01FE54: LDA.l $7E2004,X
#_01FE58: STA.b $04

#_01FE5A: LDA.l $7E2006,X
#_01FE5E: STA.b $06

#_01FE60: LDX.w #$0006

.next
#_01FE63: LDA.b $00,X
#_01FE65: STZ.b $00,X
#_01FE67: AND.w #$03FE
#_01FE6A: CMP.w #$00EE
#_01FE6D: BEQ .skip

#_01FE6F: CMP.w #$00FE
#_01FE72: BEQ .skip

#_01FE74: LDA.w #$0020
#_01FE77: STA.b $00,X

.skip
#_01FE79: DEX
#_01FE7A: DEX
#_01FE7B: BPL .next

;---------------------------------------------------------------------------------------------------

#_01FE7D: LDA.b $08
#_01FE7F: LSR A
#_01FE80: TAX

#_01FE81: SEP #$20

#_01FE83: LDA.b $00
#_01FE85: STA.l $7F2000,X

#_01FE89: LDA.b $02
#_01FE8B: STA.l $7F2001,X

#_01FE8F: LDA.b $04
#_01FE91: STA.l $7F2002,X

#_01FE95: LDA.b $06
#_01FE97: STA.l $7F2003,X

#_01FE9B: REP #$20

#_01FE9D: LDA.b $08
#_01FE9F: CLC
#_01FEA0: ADC.w #$0080
#_01FEA3: STA.b $08

#_01FEA5: DEC.b $0A
#_01FEA7: BNE .next_super

#_01FEA9: RTS

;===================================================================================================
; FREE ROM: 0x06
;===================================================================================================
NULL_01FEAA:
#_01FEAA: db $FF, $FF, $FF, $FF, $FF, $FF

;===================================================================================================

ApplyGrayscaleFixed_Incremental:
#_01FEB0: LDA.b $9C
#_01FEB2: AND.b #$1F
#_01FEB4: CMP.l $7EC017
#_01FEB8: BEQ EXIT_01FED1

#_01FEBA: DEC A
#_01FEBB: BCS .darkening

#_01FEBD: INC A
#_01FEBE: INC A

.darkening
#_01FEBF: STA.b $00

;===================================================================================================

; Enters with A
ApplyGrayscaleFixed_Parameterized:
#_01FEC1: ORA.b #$20
#_01FEC3: STA.b $9C

#_01FEC5: AND.b #$1F
#_01FEC7: ORA.b #$40
#_01FEC9: STA.b $9D

#_01FECB: AND.b #$1F
#_01FECD: ORA.b #$80
#_01FECF: STA.b $9E

;---------------------------------------------------------------------------------------------------

#EXIT_01FED1:
#_01FED1: RTL

;===================================================================================================

LinkZap_HandleMosaic:
#_01FED2: LDA.w $0647
#_01FED5: BNE .negative

#_01FED7: LDA.l $7EC011
#_01FEDB: CLC
#_01FEDC: ADC.b #$10
#_01FEDE: CMP.b #$C0
#_01FEE0: BNE .set

#_01FEE2: INC.w $0647
#_01FEE5: BRA .set

.negative
#_01FEE7: LDA.l $7EC011
#_01FEEB: SEC
#_01FEEC: SBC.b #$10
#_01FEEE: BNE .set

;===================================================================================================

#LinkZap_ResetMosaic:
#_01FEF0: STZ.w $0647

.set
#_01FEF3: STA.l $7EC011

#_01FEF7: LDA.b #$09
#_01FEF9: STA.b $94

#_01FEFB: LDA.l $7EC011
#_01FEFF: LSR A
#_01FF00: ORA.b #$03
#_01FF02: STA.b $95

#_01FF04: RTL

;===================================================================================================

Underworld_HandleLayerChange:
#_01FF05: LDA.b #$01
#_01FF07: STA.w $0476

#_01FF0A: LDA.w $044A
#_01FF0D: BNE .dont_change_rooms

; !WEIRD layer change code!
#_01FF0F: LDA.b $A0
#_01FF11: CLC
#_01FF12: ADC.b #$10
#_01FF14: STA.b $A0

.dont_change_rooms
#_01FF16: LDA.w $044A
#_01FF19: CMP.b #$02
#_01FF1B: BEQ .dont_swap_layer

#_01FF1D: LDA.b #$01
#_01FF1F: STA.b $EE

.dont_swap_layer
#_01FF21: STZ.w $047A

#_01FF24: JML SetAndSaveVisitedQuadrantFlags

;===================================================================================================

CacheCameraProperties:
#_01FF28: REP #$20

#_01FF2A: LDA.b $E2
#_01FF2C: STA.l $7EC180

#_01FF30: LDA.b $E8
#_01FF32: STA.l $7EC182

#_01FF36: LDA.b $20
#_01FF38: STA.l $7EC184

#_01FF3C: LDA.b $22
#_01FF3E: STA.l $7EC186

;---------------------------------------------------------------------------------------------------

#_01FF42: LDA.w $0600
#_01FF45: STA.l $7EC188

#_01FF49: LDA.w $0604
#_01FF4C: STA.l $7EC18A

#_01FF50: LDA.w $0608
#_01FF53: STA.l $7EC18C

#_01FF57: LDA.w $060C
#_01FF5A: STA.l $7EC18E

#_01FF5E: LDA.w $0610
#_01FF61: STA.l $7EC190

#_01FF65: LDA.w $0612
#_01FF68: STA.l $7EC192

#_01FF6C: LDA.w $0614
#_01FF6F: STA.l $7EC194

#_01FF73: LDA.w $0616
#_01FF76: STA.l $7EC196

#_01FF7A: LDA.w $0618
#_01FF7D: STA.l $7EC198

#_01FF81: LDA.w $061C
#_01FF84: STA.l $7EC19A

#_01FF88: LDA.b $A6
#_01FF8A: STA.l $7EC19C

#_01FF8E: LDA.b $A9
#_01FF90: STA.l $7EC19E

;---------------------------------------------------------------------------------------------------

#_01FF94: SEP #$20

#_01FF96: LDA.b $2F
#_01FF98: STA.l $7EC1A6

#_01FF9C: LDA.b $EE
#_01FF9E: STA.l $7EC1A7

#_01FFA2: LDA.w $0476
#_01FFA5: STA.l $7EC1A8

#_01FFA9: LDA.b $6C
#_01FFAB: STA.l $7EC1A9

#_01FFAF: LDA.b $A4
#_01FFB1: STA.l $7EC1AA

#_01FFB5: RTL

;===================================================================================================

CheckAbilityToSwim:
#_01FFB6: LDA.w $02E0
#_01FFB9: BNE .bunny

#_01FFBB: LDA.l $7EF356
#_01FFBF: BNE .exit

.bunny
#_01FFC1: LDA.l $7EF357
#_01FFC5: BEQ .no_pearl

#_01FFC7: STZ.w $02E0

.no_pearl
#_01FFCA: LDA.b #$0C
#_01FFCC: STA.b $4B

#_01FFCE: LDA.b #$2A

#_01FFD0: LDX.b $1B
#_01FFD2: BEQ .outdoors

#_01FFD4: LDA.b #$14

.outdoors
#_01FFD6: STA.b $11

.exit
#_01FFD8: RTL

;===================================================================================================
; In practice, this is only ever called from the overworld.
;===================================================================================================
TakeDamageFromPit:
#_01FFD9: LDA.b #$0C
#_01FFDB: STA.b $4B

#_01FFDD: LDA.b #$2A

#_01FFDF: LDX.b $1B
#_01FFE1: BEQ .outside

#_01FFE3: LDA.b #$14

.outside
#_01FFE5: STA.b $11

#_01FFE7: LDA.l $7EF36D
#_01FFEB: SEC
#_01FFEC: SBC.b #$08
#_01FFEE: STA.l $7EF36D

; die if too much health
#_01FFF2: CMP.b #$A8
#_01FFF4: BCC .exit

#_01FFF6: LDA.b #$00
#_01FFF8: STA.l $7EF36D

.exit
#_01FFFC: RTL

;===================================================================================================
; FREE ROM: 0x03
;===================================================================================================
NULL_01FFFD:
#_01FFFD: db $FF, $FF, $FF
